define("typescript/dropbox/proto/ccpa_data/ccpa_data_pb",["require","exports","@bufbuild/protobuf"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CCPALogContext=void 0;class i extends n.Message{constructor(e){super(),this.userAgent="",this.sessionId="",this.anonIp="",this.localeUserSelected="",this.localeBrowserHeader="",this.country="",this.uaBrowserName="",this.uaBrowserVersion="",this.uaOsName="",this.uaOsVersion="",n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new i).fromBinary(e,t)}static fromJson(e,t){return(new i).fromJson(e,t)}static fromJsonString(e,t){return(new i).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(i,e,t)}}t.CCPALogContext=i,i.runtime=n.proto3,i.typeName="ccpa_data.CCPALogContext",i.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"user_agent",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"anon_ip",kind:"scalar",T:9},{no:4,name:"locale_user_selected",kind:"scalar",T:9},{no:5,name:"locale_browser_header",kind:"scalar",T:9},{no:6,name:"country",kind:"scalar",T:9},{no:7,name:"ua_browser_name",kind:"scalar",T:9},{no:8,name:"ua_browser_version",kind:"scalar",T:9},{no:9,name:"ua_os_name",kind:"scalar",T:9},{no:10,name:"ua_os_version",kind:"scalar",T:9}])})),define("typescript/dropbox/proto/js_init_data/privacy_consent/privacy_consent_pb",["require","exports","@bufbuild/protobuf","../../ccpa_data/ccpa_data_pb","../web_timing_logger/web_timing_logger_pb"],(function(e,t,n,i,o){"use strict";var s,a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.CCPADNSVerificationInitData_DNSVerificationStatus=t.CCPADNSVerificationInitData=t.CCPAIFrameInitData=t.PrivacyConsentInitData_LoggedInState=t.PrivacyConsentInitData=t.UserDNSInitState=void 0,(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOGGED_OUT_NOT_ENROLLED=1]="LOGGED_OUT_NOT_ENROLLED",e[e.LOGGED_OUT_EMAIL_PENDING=2]="LOGGED_OUT_EMAIL_PENDING",e[e.LOGGED_OUT_ENROLLED=3]="LOGGED_OUT_ENROLLED",e[e.LOGGED_OUT_GPC_ENABLED=7]="LOGGED_OUT_GPC_ENABLED",e[e.LOGGED_IN_NOT_ENROLLED=4]="LOGGED_IN_NOT_ENROLLED",e[e.LOGGED_IN_EMAIL_PENDING=5]="LOGGED_IN_EMAIL_PENDING",e[e.LOGGED_IN_ENROLLED=6]="LOGGED_IN_ENROLLED"})(s=t.UserDNSInitState||(t.UserDNSInitState={})),n.proto3.util.setEnumType(s,"privacy_consent.UserDNSInitState",[{no:0,name:"UNKNOWN"},{no:1,name:"LOGGED_OUT_NOT_ENROLLED"},{no:2,name:"LOGGED_OUT_EMAIL_PENDING"},{no:3,name:"LOGGED_OUT_ENROLLED"},{no:7,name:"LOGGED_OUT_GPC_ENABLED"},{no:4,name:"LOGGED_IN_NOT_ENROLLED"},{no:5,name:"LOGGED_IN_EMAIL_PENDING"},{no:6,name:"LOGGED_IN_ENROLLED"}]);class c extends n.Message{constructor(e){super(),this.iframeOrigin="",this.countryCode="",this.isCcpaEnabled=!1,this.loggedInState=a.UNKNOWN,n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new c).fromBinary(e,t)}static fromJson(e,t){return(new c).fromJson(e,t)}static fromJsonString(e,t){return(new c).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(c,e,t)}}t.PrivacyConsentInitData=c,c.runtime=n.proto3,c.typeName="privacy_consent.PrivacyConsentInitData",c.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"iframe_origin",kind:"scalar",T:9},{no:2,name:"country_code",kind:"scalar",T:9},{no:3,name:"is_ccpa_enabled",kind:"scalar",T:8},{no:4,name:"logged_in_state",kind:"enum",T:n.proto3.getEnumType(a)}]),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOGGED_OUT=1]="LOGGED_OUT",e[e.LOGGED_IN=2]="LOGGED_IN"})(a=t.PrivacyConsentInitData_LoggedInState||(t.PrivacyConsentInitData_LoggedInState={})),n.proto3.util.setEnumType(a,"privacy_consent.PrivacyConsentInitData.LoggedInState",[{no:0,name:"UNKNOWN"},{no:1,name:"LOGGED_OUT"},{no:2,name:"LOGGED_IN"}]);class l extends n.Message{constructor(e){super(),this.consentIframeOrigin="",this.dnsState=s.UNKNOWN,this.userEmails=[],this.verifiedEmails=[],this.unverifiedEmails=[],this.ccpaToken="",this.isGpcEnabled=!1,this.localizedTextOverrides={},this.csrfToken="",n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new l).fromBinary(e,t)}static fromJson(e,t){return(new l).fromJson(e,t)}static fromJsonString(e,t){return(new l).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(l,e,t)}}t.CCPAIFrameInitData=l,l.runtime=n.proto3,l.typeName="privacy_consent.CCPAIFrameInitData",l.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"consent_iframe_origin",kind:"scalar",T:9},{no:2,name:"dns_state",kind:"enum",T:n.proto3.getEnumType(s)},{no:3,name:"user_emails",kind:"scalar",T:9,repeated:!0},{no:4,name:"verified_emails",kind:"scalar",T:9,repeated:!0},{no:5,name:"unverified_emails",kind:"scalar",T:9,repeated:!0},{no:6,name:"logging_context",kind:"message",T:i.CCPALogContext},{no:7,name:"ccpa_token",kind:"scalar",T:9},{no:8,name:"is_gpc_enabled",kind:"scalar",T:8},{no:9,name:"localized_text_overrides",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:10,name:"csrf_token",kind:"scalar",T:9}]);class d extends n.Message{constructor(e){super(),this.confirmationStatus=r.UNKNOWN,this.userEmailToken="",this.countryCode="",this.locale="",this.hasError=!1,n.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new d).fromBinary(e,t)}static fromJson(e,t){return(new d).fromJson(e,t)}static fromJsonString(e,t){return(new d).fromJsonString(e,t)}static equals(e,t){return n.proto3.util.equals(d,e,t)}}t.CCPADNSVerificationInitData=d,d.runtime=n.proto3,d.typeName="privacy_consent.CCPADNSVerificationInitData",d.fields=n.proto3.util.newFieldList(()=>[{no:1,name:"confirmation_status",kind:"enum",T:n.proto3.getEnumType(r)},{no:2,name:"user_email_token",kind:"scalar",T:9},{no:3,name:"country_code",kind:"scalar",T:9},{no:4,name:"locale",kind:"scalar",T:9},{no:5,name:"has_error",kind:"scalar",T:8},{no:6,name:"web_timing_logger_server_context",kind:"message",T:o.WebTimingLoggerServerContext}]),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CONFIRMED=1]="CONFIRMED",e[e.CANCELED=2]="CANCELED",e[e.PENDING=3]="PENDING"})(r=t.CCPADNSVerificationInitData_DNSVerificationStatus||(t.CCPADNSVerificationInitData_DNSVerificationStatus={})),n.proto3.util.setEnumType(r,"privacy_consent.CCPADNSVerificationInitData.DNSVerificationStatus",[{no:0,name:"UNKNOWN"},{no:1,name:"CONFIRMED"},{no:2,name:"CANCELED"},{no:3,name:"PENDING"}])})),define("metaserver/static/js/clean/privacy_consent",["require","exports","tslib","js/proto_utils/unpack","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/modules/constants/page_load","typescript/dropbox/proto/js_init_data/privacy_consent/privacy_consent_pb","metaserver/static/js/core/browser","metaserver/static/js/modules/constants/locales","metaserver/static/js/core/i18n","metaserver/static/js/clean/active_user","metaserver/static/js/privacy_consent/chat_client","metaserver/static/js/privacy_consent/i18n","metaserver/static/js/privacy_consent/log","metaserver/static/js/privacy_consent/marketing_tracker","metaserver/static/js/privacy_consent/privacy_consent_platform","metaserver/static/js/clean/privacy_consent_header"],(function(e,t,n,i,o,s,a,r,c,l,d,_,C,h,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moduleInit=t.initialize_module=t.PrivacyConsentPlatform=t.maybeReloadPage=void 0,a=n.__importStar(a),r=n.__importStar(r),c=n.__importStar(c);const g=[".footer--minimal","#locale-container",".ui-bar.footer, .ui-body-w.page, body>.auth-connect"],E=new _.ChatClientInjectorImpl(5e3),v=()=>{let e=r.get_pathname();for(const{localeCode:t}of c.LIST_OF_LOCALES_WITHOUT_INTERNAL){const n=`/${t}`;if(e===n){e="/";break}const i=`${n}/`;if(e.startsWith(i)){e=e.substring(i.length);break}}const t=["/account","/automations","/collections","/deleted_files","/h","/home","/personal","/preview","/recents","/requests","/s","/scl","/security_checkup","/share","/shared","/shop/create","/shop/customers","/shop/discounts","/shop/embed/create","/shop/orders","/shop/payments_settings","/shop/products","/shop/setup","/shop/settings","/shop/store/edit","/shop/terms","/starred","/team/admin","/work"];for(const n of t){if(e===n)return!0;const t=`${n}/`;if(e.startsWith(t))return!0}return!1},f=()=>["/transfer","/transfer/manage"].includes(window.location.pathname)||v(),b=(e=0)=>{const t=!!e,n=g.map(e=>document.querySelector(e)).find(Boolean)||null;((e=0,t)=>{if(!e||!t)return;const n=document.getElementById("privacy-consent-bottom-styles")||document.createElement("style");n.id="privacy-consent-bottom-styles";const i=g.join(", ").split(/,\s*/).map(e=>`${e}::after`).join(", ");n.textContent=`\n    ${i} {\n      display: block;\n      margin-bottom: var(--privacy-consent-banner-height);\n      content: '';\n      height: 0;\n      line-height: 0;\n      clear: both;\n      float: left;\n    }`,n.parentNode!==document.head&&document.head.appendChild(n)})(e,!!n),E.setCookieBannerInfo(t),n&&(t?n.style.marginBottom="var(--privacy-consent-banner-height, 0px)":n.style.removeProperty("margin-bottom"))},S=e=>{let t;if(null==e||0===e){const e=(0,d.getActiveUserId)();t=void 0!==e&&0!==e}else t=e===a.PrivacyConsentInitData_LoggedInState.LOGGED_IN;return t&&v()};function I(e){t.PrivacyConsentPlatform.config||t.PrivacyConsentPlatform.init(e,{onBannerVisible:b,onBannerNotVisible:b,disableBanner:S(e.loggedInState),consentChangedCallback:t.maybeReloadPage,priorConsentCallback:(e,n)=>{n&&(0,t.maybeReloadPage)(e)},injectFloatingButton:!f(),injectToFooter:!0,getManualReEntryProvided:()=>S(e.loggedInState)&&f()&&(0,m.getManualReEntryProvided)(),locale:s.USER_LOCALE})}t.maybeReloadPage=e=>{e&&e.all||window.location.reload(!0)},t.PrivacyConsentPlatform=new p.PrivacyConsentPlatformSingleton({intlText:(0,C.getIntlText)(l.intl),log:new h.PrivacyConsentLogImpl,updateConsentCategories:u.updateConsentCategories,redirect:r.redirect,ttiTimeout:5e3,waitForTTI:o.waitForTTI}),t.initialize_module=I,t.moduleInit=function(e){I((0,i.unmarshalProto)(e,a.PrivacyConsentInitData))}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};define("metaserver/static/js/privacy_consent/chat_client",["require","exports","metaserver/static/js/clean/web_timing_logger"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatClientInjectorImpl=void 0;class i{constructor(e){if(i.instance)return i.instance;i.instance=this,this.ttiTimeout=e}loadChatModule(){return this.chatLoadPromise?this.chatLoadPromise:(this.chatLoadPromise=(0,n.waitForTTI)({timeoutMS:this.ttiTimeout}).then(()=>new Promise((t,n)=>{e(["metaserver/static/js/chat/chat_client"],t,n)}).then(__importStar)),this.chatLoadPromise)}setCookieBannerInfo(e){this.loadChatModule().then(t=>{const n=t.ChatClientSingleton;n.isSetup()&&n.setCookieBannerInfo(e)})}}t.ChatClientInjectorImpl=i})),define("metaserver/static/js/privacy_consent/i18n",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIntlText=void 0;t.getIntlText=e=>({manageCookies:e.formatMessage({id:"yF4LPz",defaultMessage:"Manage cookies"}),cookiesAndCCPA:e.formatMessage({id:"glGIgS",defaultMessage:"Cookies & CCPA preferences"}),cookiePolicy:e.formatMessage({id:"t0O/69",defaultMessage:"Cookie policy"}),consentIframeTitle:e.formatMessage({id:"C4AGEz",defaultMessage:"Cookies & CCPA Preferences - Dropbox"}),sandboxRedirectTitle:e.formatMessage({id:"fy9qFc",defaultMessage:"Error"}),sandboxRedirectDetails:e.formatMessage({id:"yIZcC9",defaultMessage:"Cookie preferences cannot be confirmed on this page. If you wish to continue cookie consent selection, click the Cookie preferences button below."}),sandboxRedirectLinkText:e.formatMessage({id:"59MGG1",defaultMessage:"Cookie preferences"}),doNotSellRedirectTitle:e.formatMessage({id:"B/scGc",defaultMessage:"Do not sell or share my information"}),doNotSellRedirectDetails1:e.formatMessage({id:"0l+dTX",defaultMessage:"Do Not Sell preferences cannot be confirmed on this page. If you wish to continue Do Not Sell selection, visit our"}),doNotSellLinkText:e.formatMessage({id:"LNz7a7",defaultMessage:"Do Not Sell"}),doNotSellRedirectDetails2:e.formatMessage({id:"my7axt",defaultMessage:"page."})})})),define("metaserver/static/js/privacy_consent/log",["require","exports","tslib","metaserver/static/js/privacy_consent/stats","metaserver/static/js/ux_analytics/lazy_ux_analytics","metaserver/static/js/ux_analytics/dispatch_custom_event","metaserver/static/js/core/exception"],(function(e,t,n,i,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentLogImpl=void 0,s=n.__importStar(s);t.PrivacyConsentLogImpl=class{logIframeLoad(e,t){const n=(new Date).valueOf()-e.valueOf();r("privacyConsentIframeLoaded",{total_time:n.toString(),iframe_uri:t}),i.PrivacyConsentStats.logDuration(i.PrivacyConsentAmpMetrics.CROWNPEAK_LOAD_LATENCY,{},n),i.PrivacyConsentStats.logCounter(i.PrivacyConsentAmpMetrics.EVENTS,{eventName:i.PrivacyConsentEvent.SETUP_REENTRY_START})}logPrivacyConsentResult(e){const t=e?i.PrivacyConsentEvent.SETUP_REENTRY_SUCCESS:i.PrivacyConsentEvent.SETUP_REENTRY_FAILURE;i.PrivacyConsentStats.logCounter(i.PrivacyConsentAmpMetrics.EVENTS,{event_name:t}),e||(0,a.reportException)({err:new Error(`Privacy consent module is not visible on page ${window.location.pathname}`),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"]})}logPrivacyConsentScriptLoaded(e){r("privacyConsentScriptLoaded",{script_id:e.scriptId,script_url:e.scriptUrl})}logPrivacyConsentScriptLoadError(e){r("privacyConsentScriptLoadError",{script_id:e.scriptId,script_url:e.scriptUrl}),(0,a.reportException)({err:new Error("Privacy consent module is running into load error"),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"]})}logCCPAIframeLoad(e){i.PrivacyConsentStats.logCounter(i.PrivacyConsentAmpMetrics.EVENTS,{event_name:i.CCPAEvent.IFRAME_LOAD_SUCCESS}),i.PrivacyConsentStats.logDuration(i.PrivacyConsentAmpMetrics.CCPA_IFRAME_LOAD_LATENCY,{},e)}logCCPAIframeError(e){const t=Date.now()-e.start_time;i.PrivacyConsentStats.logCounter(i.PrivacyConsentAmpMetrics.EVENTS,{event_name:i.CCPAEvent.IFRAME_LOAD_ERROR}),i.PrivacyConsentStats.logDuration(i.PrivacyConsentAmpMetrics.CCPA_IFRAME_LOAD_LATENCY,{},t),(0,a.reportException)({err:new Error("CCPA iframe failed to load"),severity:a.SEVERITY.CRITICAL,tags:["privacy_consent","ccpa_iframe"]})}logInvalidCookieCategoryException(e){(0,a.reportException)({err:new Error("Invalid cookie category id"),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"],exc_extra:{cookie_id:e}})}logCookieParseException(e,t){(0,a.reportException)({err:new Error(`Cookie ${e} could not be parsed`),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"],exc_extra:{cookie_str:t}})}};const r=(e,t)=>{const n={detail:{eventType:e,extra:t}};(0,o.runAfterUxaListening)(()=>{s.dispatchCustomEvent("privacy_consent_custom_event",n)})}})),define("metaserver/static/js/privacy_consent/marketing_tracker",["require","exports","metaserver/static/js/clean/marketing_tracker"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateConsentCategories=void 0;t.updateConsentCategories=e=>{n.MarketingTracker.tryPushEvent("updateConsentCategories",n.EventTypeEnum.Link,{consent_categories:e.join(",")})}})),define("metaserver/static/js/privacy_consent/privacy_consent_platform",["require","exports","metaserver/static/js/privacy_consent/privacy_consent_cookies","metaserver/static/js/privacy_consent/consent_iframe_wrapper","metaserver/static/js/privacy_consent/sandbox_redirect"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentPlatformSingleton=t.PRIVACY_CONSENT_STYLE_TAG_ID=void 0;t.PRIVACY_CONSENT_STYLE_TAG_ID="privacy-consent-styles";const s=(e,t=0)=>{let n;return void 0===e?e:function(){let i=this,o=arguments;const s=!n;clearTimeout(n),n=setTimeout((function(){n=null,s||e.apply(i,o)}),t),s&&e.apply(i,o)}};class a{constructor(e){if(this.manageCookiesSet=!1,this.manageCookiesInjected=!1,this.floatingButtonVisible=!1,this.bannerVisible=!1,this.isInIframe=!1,this.getManualReEntryProvided=()=>!1,this.gpcSignal=!1,this.isFooterLoading=!1,a.instance)return a.instance;a.instance=this,this.log=e.log,this.updateConsentCategories=e.updateConsentCategories,this.intlText=e.intlText,this.ttiTimeout=e.ttiTimeout,this.waitForTTI=e.waitForTTI,this.redirect=e.redirect,this.isInIframe=window!=window.top,this.openOptionsDialog=this.openOptionsDialog.bind(this),this.getConsentCategories=this.getConsentCategories.bind(this)}init(e,t){var o,a,r,c;this.config=e,this.redirectUrlForSandboxedPage=null===(o=null==t?void 0:t.thirdPartyConfig)||void 0===o?void 0:o.redirectUrlForSandboxedPage;const l={};if((null===(a=null==t?void 0:t.thirdPartyConfig)||void 0===a?void 0:a.cookieDomain)&&(l.cookieDomain=t.thirdPartyConfig.cookieDomain),this.cookieStore=new n.ConsentCookieStore(l,this.log),this.updateTealiumDataLayer(),!e.iframeOrigin||(null===(r=this.consentIframeWrapper)||void 0===r?void 0:r.iframeExists())||document.getElementById("consent-iframe")||this.isInIframe)return;(null==t?void 0:t.initCallback)&&t.initCallback(),this.priorConsentDeclinedCallback=null==t?void 0:t.priorConsentDeclinedCallback,this.cookieStore.hasPreviouslyDeclinedConsent()&&this.onPriorConsentDeclinedOnInit();const d=!(null==t||!t.disableBanner)&&(null==t?void 0:t.disableBanner);this.setBannerVisibilityOnClient=s((e=0)=>{this.setPrivacyConsentCSSPropertiesOnClient(e),e>0?(null==t?void 0:t.onBannerVisible)&&(null==t||t.onBannerVisible(e)):(null==t?void 0:t.onBannerNotVisible)&&(null==t||t.onBannerNotVisible())},100),this.consentChangedCallback=null==t?void 0:t.consentChangedCallback,this.priorConsentCallback=null==t?void 0:t.priorConsentCallback,this.consentDeclinedCallback=null==t?void 0:t.consentDeclinedCallback,this.disableFloatingButton=!!t&&!t.injectFloatingButton,this.injectToFooter=!t||t.injectToFooter,this.getManualReEntryProvided=null!==(c=null==t?void 0:t.getManualReEntryProvided)&&void 0!==c?c:()=>!1;const _=new URLSearchParams(window.location.search);this.consentIframeWrapper=new i.ConsentIframeWrapper({log:this.log,waitForTTI:this.waitForTTI,ttiTimeout:this.ttiTimeout,iframeOrigin:`https://${e.iframeOrigin}`,iframeTitle:this.intlText.consentIframeTitle,clientInfo:_.get("client_info")||"",disableBanner:d,isCcpaEnabled:this.config.isCcpaEnabled,isGpcEnabled:this.isGPCEnabled(),hideGdpr:this.getHideGDPR(_.get("hide_gdpr")),sandboxRedirect:void 0!==this.redirectUrlForSandboxedPage,ccpaToken:this.getCCPAToken(_.get("ccpa_token")),locale:null==t?void 0:t.locale,urlHash:window.location.hash,onRenderSandboxRedirect:this.onRenderSandboxRedirect.bind(this),onBannerVisible:e=>this.onBannerVisibilityChange(e),onBannerNotVisible:()=>this.onBannerVisibilityChange(0),onIframeLoad:()=>this.onIframeLoad(),setupSettingsReEntry:()=>this.setupSettingsReEntry(),onEvidonCookieWrite:e=>{var t;return null===(t=this.cookieStore)||void 0===t?void 0:t.bakeEvidonCookie(e)},onPriorConsent:e=>this.onPriorConsent(e),onConsentChanged:e=>this.onConsentChanged(e),onConsentDeclined:e=>this.onConsentDeclined(e),onPriorConsentDeclined:()=>this.onPriorConsentDeclined(),onDNSEnabled:(e,t)=>this.onDNSEnabled(e,t),onDNSDisabled:()=>this.onDNSDisabled(),onGPCEnabled:()=>this.onGPCEnabled(),redirect:e=>this.redirect(e)}),this.gpcSignal=this.isGPCEnabled(),this.consentIframeWrapper.createIframe()}getHideGDPR(e){return("true"===e||"false"===e)&&"true"===e}getCCPAToken(e){var t,i;if(null!==e){const n=new Date;n.setDate(n.getDate()+1),null===(t=this.cookieStore)||void 0===t||t.bakeCCPATokenCookie({ccpaToken:e,expireDate:n.toISOString()});const i=/&?ccpa_token=[^&^#]+/,o=window.location.search.replace(i,""),s=`${window.location.pathname}${o}${window.location.hash}`;return window.history.replaceState({},"",s),e}const o=null===(i=this.cookieStore)||void 0===i?void 0:i.getCurrentCookieObj(n.CCPA_TOKEN_COOKIE_NAME);return o&&o.ccpaToken?o.ccpaToken:""}onIframeLoad(){var e;null===(e=this.consentIframeWrapper)||void 0===e||e.sendCCPARedirectText({doNotSellRedirectTitle:this.intlText.doNotSellRedirectTitle,doNotSellRedirectDetails1:this.intlText.doNotSellRedirectDetails1,doNotSellLinkText:this.intlText.doNotSellLinkText,doNotSellRedirectDetails2:this.intlText.doNotSellRedirectDetails2}),this.setupSettingsReEntry(),this.logPrivacyConsentResult()}onFooterLoaded(){this.waitForTTI({timeoutMS:this.ttiTimeout}).then(()=>{var e;this.setupSettingsReEntry();const t=null===(e=this.consentIframeWrapper)||void 0===e?void 0:e.getBannerHeight();void 0!==t&&void 0!==this.onBannerVisibilityChange&&this.onBannerVisibilityChange(t)})}setupSettingsReEntry(){!this.config||this.manageCookiesSet||this.manageCookiesInjected||(this.injectToFooter&&(this.setManageCookies(),this.injectManageCookies()),this.maybeUseFloatingButton())}setManageCookies(){if(this.manageCookiesSet||this.manageCookiesInjected)return;const e=this.findManageCookies();e&&(e.setAttribute("href","#manage-cookies"),e.onclick=e=>this.onClickManageCookies(e),e.textContent=this.config.isCcpaEnabled?this.intlText.cookiesAndCCPA:this.intlText.manageCookies,this.manageCookiesSet=!0)}openOptionsDialog(){var e;null===(e=this.consentIframeWrapper)||void 0===e||e.openOptionsDialog()}getConsentCategories(){if(this.cookieStore){const e=this.cookieStore.getCurrentCookieObj(n.SHADOW_COOKIE_NAME);return(null==e?void 0:e.categories)?e.categories:{}}throw new Error("Unable to read consent cookies. Do not call until after initCallback is triggered")}onPriorConsentDeclinedOnInit(){this.priorConsentDeclinedCallback&&this.priorConsentDeclinedCallback({})}onPriorConsentDeclined(){var e,t;let n=!1;if(this.cookieStore&&(n=this.cookieStore.havePreferencesChanged({})),n){const n=null===(e=this.cookieStore)||void 0===e?void 0:e.createShadowCookieValue({},!0);void 0!==n&&(null===(t=this.cookieStore)||void 0===t||t.bakeShadowCookie(n)),this.priorConsentDeclinedCallback&&this.priorConsentDeclinedCallback({})}}isGPCEnabled(){return this.config.isCcpaEnabled&&navigator.globalPrivacyControl}onGPCEnabled(){var e;const t=new Date;t.setMonth(t.getMonth()+12),null===(e=this.cookieStore)||void 0===e||e.bakeDNSCookie({optInToDNS:!0,expireDate:t.toISOString()})}maybeUseFloatingButton(){var e,t;this.disableFloatingButton||null===(e=this.consentIframeWrapper)||void 0===e||!e.iframeExists()||this.manageCookiesSet||this.manageCookiesInjected||this.isFooterLoading||(null===(t=this.consentIframeWrapper)||void 0===t||t.sendShowFloatingButton(this.config.isCcpaEnabled?this.intlText.cookiesAndCCPA:void 0),this.floatingButtonVisible=!0)}updateTealiumDataLayer(){this.updateConsentCategories&&this.cookieStore&&this.updateConsentCategories(this.cookieStore.getAllowedCategories())}onPriorConsent(e){var t,n,i;const o=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{};let s=!0;this.cookieStore&&(s=null===(n=this.cookieStore)||void 0===n?void 0:n.havePreferencesChanged(o)),(!(null===(i=this.cookieStore)||void 0===i?void 0:i.hasUserInteracted())&&!this.gpcSignal||s)&&this.saveShadowCookie(e,!0),this.priorConsentCallback&&this.priorConsentCallback(o,s)}onConsentChanged(e){var t,n;const i=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{},o=null===(n=this.cookieStore)||void 0===n?void 0:n.havePreferencesChanged(i);this.saveShadowCookie(e,!0),o&&this.consentChangedCallback&&this.consentChangedCallback(i)}onConsentDeclined(e){var t;if(this.saveShadowCookie(e,!0),this.consentDeclinedCallback){const n=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{};this.consentDeclinedCallback(n)}}onDNSEnabled(e,t){var n;null!=t&&""!==t&&null!=e&&(null===(n=this.cookieStore)||void 0===n||n.bakeDNSCookie({optInToDNS:e,expireDate:t}))}onDNSDisabled(){var e;null===(e=this.cookieStore)||void 0===e||e.clearDNSCookie()}onClickManageCookies(e){var t;e.preventDefault(),void 0!==this.redirectUrlForSandboxedPage?this.onRenderSandboxRedirect():null===(t=this.consentIframeWrapper)||void 0===t||t.openOptionsDialog()}onRenderSandboxRedirect(){(0,o.renderSandboxRedirect)({sandboxRedirectTitle:this.intlText.sandboxRedirectTitle,sandboxRedirectDetails:this.intlText.sandboxRedirectDetails,sandboxRedirectLinkText:this.intlText.sandboxRedirectLinkText,href:this.redirectUrlForSandboxedPage})}onBannerVisibilityChange(e=0){var t;!(null===(t=this.cookieStore)||void 0===t?void 0:t.hasUserInteracted())&&e>0&&this.saveShadowCookie({},!1),this.setBannerVisibilityOnClient&&this.setBannerVisibilityOnClient(e)}setPrivacyConsentCSSPropertiesOnClient(e=0){const n=document.getElementById(t.PRIVACY_CONSENT_STYLE_TAG_ID)||document.createElement("style");n.id=t.PRIVACY_CONSENT_STYLE_TAG_ID,n.textContent=`:root{--privacy-consent-banner-height:${e}px;}`,e>0&&(n.textContent+=":root{--privacy-consent-banner-onetap-visibility-hidden:hidden;--privacy-consent-banner-onetap-opacity:0}"),n.parentNode!==document.head&&document.head.appendChild(n)}saveShadowCookie(e,t){var i,o,s;if(this.cookieStore){const a=null===(i=this.cookieStore)||void 0===i?void 0:i.mapCookies(e),r=null===(o=this.cookieStore)||void 0===o?void 0:o.createShadowCookieValue(a,t);if(null===(s=this.cookieStore)||void 0===s||s.bakeShadowCookie(r),this.consentIframeWrapper){const e=new Date(r.expireDate).toUTCString(),t=(0,n.createCookieStr)("dropbox.com",n.SHADOW_COOKIE_NAME,r,e,"None");this.consentIframeWrapper.writeShadowCookie(t)}}}findManageCookies(){return document.querySelector('a[href*="#manage-cookies"], a.evidon-notice-link')||null}findCookiePolicy(e){return(null==e?void 0:e.querySelector('a[href*="/terms/cookies"],a[href*="/accounts-billing/security/cookies"]'))||null}getLinkWrapper(e){return e.closest("li")}createManageCookies(e){const t=this.getLinkWrapper(e);if(t){const n=t.cloneNode(),i=document.createElement("a");return i.textContent=this.config.isCcpaEnabled?this.intlText.cookiesAndCCPA:this.intlText.manageCookies,i.setAttribute("class",e.className),i.setAttribute("href","#manage-cookies"),i.onclick=e=>this.onClickManageCookies(e),n.appendChild(i),n}return null}findFooter(){const e=["pre-footer","matrix__footer","footer-cta","footer-secondary-cta","cta-footer"],t=["div","section","footer"],n=Array.from(document.querySelectorAll(["footer",'[id="footer"]','[class="footer"]','[class^="footer "]','[class*=" footer "]','[class$=" footer"]','[id*="-footer"]','[id^="footer-"]','[id*="_footer"]','[id^="footer_"]','[class*="-footer"]','[class^="footer-"]','[class*="_footer"]','[class^="footer_"]'].join(","))).filter(n=>t.includes(n.tagName.toLowerCase())&&!e.some(e=>n.classList.contains(e)));return n.length?n[0]:null}injectManageCookies(){if(this.manageCookiesSet||this.manageCookiesInjected)return;const e=this.findFooter(),t=e?this.findCookiePolicy(e):null;if(!this.manageCookiesSet&&t){const e=this.createManageCookies(t),n=this.getLinkWrapper(t);e&&n&&(n.insertAdjacentElement("afterend",e),this.renameCookiePolicyLink(t),this.manageCookiesInjected=!0)}}renameCookiePolicyLink(e){e.textContent=this.intlText.cookiePolicy}logPrivacyConsentResult(){var e;const t=this.manageCookiesSet||this.manageCookiesInjected||this.floatingButtonVisible||this.bannerVisible||this.getManualReEntryProvided();null===(e=this.log)||void 0===e||e.logPrivacyConsentResult(t)}}t.PrivacyConsentPlatformSingleton=a})),define("metaserver/static/js/privacy_consent/stats",["require","exports","metaserver/static/js/metrics/index","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/core/exception"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentStats=t.PrivacyConsentStatsSingleton=t.PrivacyConsentAmpMetrics=t.PrivacyConsentEvent=t.CCPAEvent=void 0;(function(e){e.DNS_OPT_IN="dns_opt_in_submitted",e.DNS_OPT_OUT="dns_opt_out_submitted",e.IFRAME_LOAD_SUCCESS="ccpa_iframe_load_success",e.IFRAME_LOAD_ERROR="ccpa_iframe_load_error",e.LOGGED_IN_OPT_OUT_DNS_ERROR="ccpa_logged_in_opt_out_dns_error",e.LOGGED_IN_OPT_IN_DNS_ERROR="ccpa_logged_in_opt_in_dns_error",e.LOGGED_IN_RESEND_EMAIL_ERROR="ccpa_logged_in_resend_email_error",e.LOGGED_OUT_OPT_OUT_DNS_ERROR="ccpa_logged_out_opt_out_dns_error",e.LOGGED_OUT_OPT_IN_DNS_ERROR="ccpa_logged_out_opt_in_dns_error",e.LOGGED_OUT_RESEND_EMAIL_ERROR="ccpa_logged_out_resend_email_error",e.EMAIL_VERIFICATION_PAGE_VISIT="ccpa_email_verification_page_visited",e.EMAIL_VERIFICATION_PAGE_ERROR="ccpa_email_verification_page_error",e.EMAIL_VERIFICATION_CONFIRM_CLICKED="ccpa_email_confirm_clicked",e.EMAIL_VERIFICATION_CANCEL_CLICKED="ccpa_email_cancel_clicked",e.CSRF_TOKEN_ERROR="csrf_token_error"})(t.CCPAEvent||(t.CCPAEvent={})),(function(e){e.SETUP_REENTRY_SUCCESS="setup_reentry_success",e.SETUP_REENTRY_FAILURE="setup_reentry_failure",e.SETUP_REENTRY_START="setup_reentry_start"})(t.PrivacyConsentEvent||(t.PrivacyConsentEvent={})),(function(e){e.CCPA_IFRAME_LOAD_LATENCY="ccpa_iframe_load_latency",e.CROWNPEAK_LOAD_LATENCY="crownpeak_load_latency",e.EVENTS="events"})(t.PrivacyConsentAmpMetrics||(t.PrivacyConsentAmpMetrics={}));class s{constructor(){}get metricsReporter(){return this.metricsReporterInstance||(this.metricsReporterInstance=(0,n.getMetricsReporter)()),this.metricsReporterInstance}createCounter(e,t={}){return this.metricsReporter.createCounter({ns:"privacy_consent",name:e},t)}createStats(e,t={}){return this.metricsReporter.createStats({ns:"privacy_consent",name:e},t)}logCounter(e,t={}){try{const n=this.createCounter(e,t);n.increment(),n.record()}catch(t){(0,o.reportStack)(`PrivacyConsentAmpLogError: Failed to log AMP metric for event: ${e}.`,{severity:o.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}}logDuration(e,t={},n){try{this.createStats(e,t).recordDuration(n,i.TimeUnit.MILLISECONDS)}catch(t){(0,o.reportStack)(`PrivacyConsentAmpLogError: Failed to log AMP metric for event: ${e}.`,{severity:o.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}}logStats(e,t={},n){try{this.createStats(e,t).record(n)}catch(t){(0,o.reportStack)(`PrivacyConsentAmpLogError: Failed to log AMP metric for event: ${e}.`,{severity:o.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}}}t.PrivacyConsentStatsSingleton=s,t.PrivacyConsentStats=new s})),define("metaserver/static/js/privacy_consent/consent_iframe_wrapper",["require","exports","tslib","metaserver/static/js/privacy_consent/privacy_consent_cookies","metaserver/static/js/privacy_consent/privacy_consent.module.css"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsentIframeWrapper=void 0,o=n.__importDefault(o);var s,a;(function(e){e.shadowCookieWrite="SHADOW_COOKIE_WRITE",e.csrfHandshakeEnd="CSRF_HANDSHAKE_END",e.ccpaRedirectText="CCPA_REDIRECT_TEXT"})(s||(s={})),(function(e){e.bodyContentChange="BODY_CONTENT_CHANGE",e.bannerResize="BANNER_RESIZE",e.displayButton="DISPLAY_BUTTON",e.priorConsent="PRIOR_CONSENT",e.consentChanged="CONSENT_CHANGED",e.consentWithdrawn="CONSENT_WITHDRAWN",e.consentDeclined="CONSENT_DECLINED",e.priorConsentDeclined="PRIOR_CONSENT_DECLINED",e.scriptLoaded="SCRIPT_LOADED",e.scriptLoadError="SCRIPT_LOAD_ERROR",e.toggleButtonMinimize="TOGGLE_BUTTON_MINIMIZE",e.dnsEnabled="DNS_ENABLED",e.dnsDisabled="DNS_DISABLED",e.ccpaConsentSettingsRegistered="CCPA_CONSENT_SETTINGS_REGISTERED",e.ccpaCookieFaqClick="CCPA_COOKIE_FAQ_CLICK",e.dnsPageClick="DNS_PAGE_CLICK",e.ccpaIframeLoad="CCPA_IFRAME_LOAD",e.ccpaIframeError="CCPA_IFRAME_ERROR",e.evidonCookieWrite="EVIDON_COOKIE_WRITE",e.setCookieSettingsMinimized="SET_COOKIE_SETTINGS_MINIMIZED",e.csrfHandshakeStart="CSRF_HANDSHAKE_START",e.renderSandboxRedirect="RENDER_SANDBOX_REDIRECT",e.privacyConsentServiceReady="PRIVACY_CONSENT_SERVICE_READY"})(a||(a={}));t.ConsentIframeWrapper=class{constructor(e){this.bannerVisible=!1,this.optionsButtonLoaded=!1,this.manageCookiesSet=!1,this.log=e.log,this.waitForTTI=e.waitForTTI,this.ttiTimeout=e.ttiTimeout,this.iframeOrigin=e.iframeOrigin,this.iframeTitle=e.iframeTitle,this.clientInfo=e.clientInfo,this.disableBanner=e.disableBanner,this.countryCode=e.countryCode,this.isCcpaEnabled=e.isCcpaEnabled,this.isGpcEnabled=e.isGpcEnabled,this.hideGdpr=e.hideGdpr,this.sandboxRedirect=e.sandboxRedirect,this.ccpaToken=e.ccpaToken,this.locale=e.locale,this.urlHash=e.urlHash,this.onIframeLoad=e.onIframeLoad,this.setupSettingsReEntry=e.setupSettingsReEntry,this.onEvidonCookieWrite=e.onEvidonCookieWrite,this.onRenderSandboxRedirect=e.onRenderSandboxRedirect,this.onBannerVisible=e.onBannerVisible,this.onBannerNotVisible=e.onBannerNotVisible,this.onPriorConsent=e.onPriorConsent,this.onConsentChanged=e.onConsentChanged,this.onConsentDeclined=e.onConsentDeclined,this.onPriorConsentDeclined=e.onPriorConsentDeclined,this.onDNSEnabled=e.onDNSEnabled,this.onDNSDisabled=e.onDNSDisabled,this.onGPCEnabled=e.onGPCEnabled,this.redirect=e.redirect,this.asyncPrivacyConsentService=new Promise((e,t)=>this.resolvePrivacyConsentService=e)}createIframe(){const e=new Date,t=document.createElement("iframe"),n=new URLSearchParams;n.append("hide_gdpr",String(this.hideGdpr)),n.append("is_ccpa_enabled",String(this.isCcpaEnabled)),n.append("gpc_signal",String(this.isGpcEnabled)),n.append("origin",encodeURIComponent(window.location.origin)),n.append("sandbox_redirect",String(this.sandboxRedirect)),this.locale&&n.append("locale",this.locale),this.ccpaToken&&n.append("ccpa_token",this.ccpaToken),void 0!==window.sandbox_verifier&&n.append("sandbox_verifier",window.sandbox_verifier);const s=this.isCrossOrigin(),a=(0,i.getCookieStr)(i.EVIDON_CONSENT_COOKIE_NAME),r=(0,i.getCookieStr)(i.EVIDON_SUPPRESS_COOKIE_NAME);s&&""!==a&&n.append(i.EVIDON_CONSENT_COOKIE_NAME,encodeURIComponent(a)),s&&""!==r&&n.append(i.EVIDON_SUPPRESS_COOKIE_NAME,encodeURIComponent(r));let c=null;try{c=sessionStorage.getItem("cookie-settings-minimized")}catch(e){}null!=c&&n.append("minimized",c);const l=`${this.iframeOrigin}?${n.toString()}${this.urlHash}`;t.src=l,t.referrerPolicy="strict-origin",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms"),t.setAttribute("class",`${o.default.consentIframe} ${this.disableBanner?o.default.noBanner:""}`),t.setAttribute("id","consent-iframe"),t.setAttribute("allowTransparency","true"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("hidden","true"),t.setAttribute("scrolling","no"),t.setAttribute("title",this.iframeTitle),t.setAttribute("tabindex","1"),document.body.insertBefore(t,document.body.firstChild),t.addEventListener("load",()=>{this.handleIframeLoad(e,this.iframeOrigin)}),window.addEventListener("message",e=>this.receiveMessage(e),!1),this.iframeEl=t}iframeExists(){return void 0!==this.iframeEl}receiveMessage(e){var t,n,i,o;const r=e.data,c=e.origin;let l="UNKNOWN";const d=`https://${null!==(t="www.dropbox.com")?t:"www.dropbox.com"}`;if(e.source===window)l="SELF";else if(e.source===window.parent)l="PARENT";else if(e.source===(null===(n=this.iframeEl)||void 0===n?void 0:n.contentWindow))l="CONSENT_IFRAME";else if(c===d&&(null===(i=this.iframeEl)||void 0===i?void 0:i.contentWindow))for(let t=0,n=this.iframeEl.contentWindow.length;t<n;++t){const n=this.iframeEl.contentWindow[t];if(e.source===n){l="CCPA_IFRAME";break}}if("CONSENT_IFRAME"===l&&c===this.iframeOrigin||"CCPA_IFRAME"===l&&c===d)switch(this.resolvePrivacyConsentService(this.iframeEl),l+":"+r.message_type){case"CONSENT_IFRAME:"+a.bodyContentChange:this.onBodyContentChange(r);break;case"CONSENT_IFRAME:"+a.bannerResize:this.onBannerResize(r);break;case"CONSENT_IFRAME:"+a.displayButton:this.onDisplayButton(r);break;case"CONSENT_IFRAME:"+a.priorConsent:this.onPriorConsent(r.categories);break;case"CONSENT_IFRAME:"+a.consentChanged:case"CONSENT_IFRAME:"+a.consentWithdrawn:this.onConsentChanged(r.categories);break;case"CONSENT_IFRAME:"+a.consentDeclined:this.onConsentDeclined(r.categories);break;case"CONSENT_IFRAME:"+a.priorConsentDeclined:this.onPriorConsentDeclined();break;case"CONSENT_IFRAME:"+a.scriptLoaded:this.onScriptLoaded(r);break;case"CONSENT_IFRAME:"+a.scriptLoadError:this.onScriptLoadError(r);break;case"CONSENT_IFRAME:"+a.toggleButtonMinimize:this.onToggleButtonMinimize(r.buttonMinimized);break;case"CONSENT_IFRAME:"+a.dnsEnabled:this.onDNSEnabled(r.optInToDNS,r.expireDate);break;case"CONSENT_IFRAME:"+a.dnsDisabled:this.onDNSDisabled();break;case"CONSENT_IFRAME:"+a.ccpaConsentSettingsRegistered:break;case"CONSENT_IFRAME:"+a.ccpaCookieFaqClick:this.redirect("https://help.dropbox.com/accounts-billing/security/cookies");break;case"CONSENT_IFRAME:"+a.dnsPageClick:window.open("https://www.dropbox.com/ccpa-consent-settings?hide_gdpr=true","_blank","noopener,noreferrer");break;case"CONSENT_IFRAME:"+a.ccpaIframeLoad:this.onCCPAIFrameLoad(r);break;case"CONSENT_IFRAME:"+a.ccpaIframeError:null===(o=this.log)||void 0===o||o.logCCPAIframeError(r);break;case"CONSENT_IFRAME:"+a.evidonCookieWrite:this.onEvidonCookieWrite(r.cookie);break;case"CONSENT_IFRAME:"+a.setCookieSettingsMinimized:try{sessionStorage.setItem("cookie-settings-minimized",r.minimized)}catch(e){}break;case"CCPA_IFRAME:"+a.csrfHandshakeStart:this.send({message_type:s.csrfHandshakeEnd,token:r.token});break;case"CONSENT_IFRAME:"+a.renderSandboxRedirect:this.onRenderSandboxRedirect();break;case"CONSENT_IFRAME:"+a.privacyConsentServiceReady:}}openOptionsDialog(){this.send({message_type:"OPEN_OPTIONS_DIALOG"})}sendShowFloatingButton(e){this.send({message_type:"SHOW_FLOATING_BUTTON",text_override:e})}getBannerHeight(){var e,t;if(this.bannerVisible){if(null===(e=this.iframeEl)||void 0===e?void 0:e.classList.contains(o.default.noBanner))return 0;return(null===(t=this.iframeEl)||void 0===t?void 0:t.height)?parseInt(this.iframeEl.height,10):0}}writeShadowCookie(e){this.isCrossOrigin()&&this.send({message_type:s.shadowCookieWrite,cookie:e})}sendCCPARedirectText(e){this.isCrossOrigin()&&this.send({message_type:s.ccpaRedirectText,localized_text:e})}send(e){this.asyncPrivacyConsentService.then(t=>{var n;const i=window.sandbox_verifier?"*":this.iframeOrigin;null===(n=t.contentWindow)||void 0===n||n.postMessage(e,i)})}handleGPCSignal(){this.isGpcEnabled&&(this.onGPCEnabled(),this.send({message_type:"DNS_GPC_SIGNAL"}))}sendCountryCode(){this.countryCode&&this.send({message_type:"COUNTRY_CODE",country_code:this.countryCode})}handleIframeLoad(e,t){var n;null===(n=this.log)||void 0===n||n.logIframeLoad(e,t),this.waitForTTI({timeoutMS:this.ttiTimeout}).then(()=>{this.handleGPCSignal(),this.sendCountryCode(),this.bannerVisible&&this.triggerOnBannerVisible(),this.onIframeLoad()})}onBodyContentChange(e){var t,n,i,s,a,r;const{bannerVisible:c,dialogVisible:l,optionsButtonVisible:d,optionsButtonLoaded:_}=e;this.bannerVisible=c&&!this.isGpcEnabled;const C=!this.bannerVisible&&!l&&!d;if(null===(t=this.iframeEl)||void 0===t||t.classList.toggle(o.default.bannerVisible,c),null===(n=this.iframeEl)||void 0===n||n.classList.toggle(o.default.dialogOpen,l),null===(i=this.iframeEl)||void 0===i||i.classList.toggle(o.default.buttonEnabled,d),_&&!this.optionsButtonLoaded&&(this.optionsButtonLoaded=!0,this.setupSettingsReEntry()),C?(this.setIframeHeight("0"),this.setIframeWidth("0")):null===(s=this.iframeEl)||void 0===s||s.removeAttribute("hidden"),this.bannerVisible?this.triggerOnBannerVisible():this.onBannerNotVisible&&this.onBannerNotVisible(),d){let e=!1;try{e="true"===sessionStorage.getItem("cookie-settings-minimized")}catch(e){}null===(a=this.iframeEl)||void 0===a||a.classList.toggle("prev-collapsed",e)}else null===(r=this.iframeEl)||void 0===r||r.classList.remove(o.default.prevCollapsed,o.default.collapsed,o.default.expanded)}onBannerResize(e){var t;e.bannerHeight&&e.bannerHeight!==(null===(t=this.iframeEl)||void 0===t?void 0:t.height)&&(this.setIframeHeight(e.bannerHeight),this.onBannerVisible&&this.triggerOnBannerVisible())}onDisplayButton(e){!this.manageCookiesSet&&e.buttonHeight&&e.buttonWidth&&(this.setIframeHeight(e.buttonHeight),this.setIframeWidth(e.buttonWidth))}onToggleButtonMinimize(e){var t,n,i,s;null===(t=this.iframeEl)||void 0===t||t.classList.remove(o.default.prevCollapsed),null===(n=this.iframeEl)||void 0===n||n.classList.toggle(o.default.collapsed,e),null===(i=this.iframeEl)||void 0===i||i.classList.toggle(o.default.expanded,!e);try{sessionStorage.setItem("cookie-settings-minimized",(null===(s=this.iframeEl)||void 0===s?void 0:s.classList.contains("collapsed"))?"true":"false")}catch(e){}}onScriptLoaded(e){var t;null===(t=this.log)||void 0===t||t.logPrivacyConsentScriptLoaded(e)}onScriptLoadError(e){var t;null===(t=this.log)||void 0===t||t.logPrivacyConsentScriptLoadError(e)}onCCPAIFrameLoad(e){var t;this.sendPrivacyConsentPageInfo();const n=Date.now()-e.start_time;null===(t=this.log)||void 0===t||t.logCCPAIframeLoad(n)}setIframeHeight(e){this.iframeEl&&(this.iframeEl.height=e)}setIframeWidth(e){this.iframeEl&&(this.iframeEl.width=e)}triggerOnBannerVisible(){this.onBannerVisible&&this.onBannerVisible(this.getBannerHeight()||0)}sendPrivacyConsentPageInfo(){const e=window.location.hostname;this.send({message_type:"PRIVACY_CONSENT_PAGE_INFO",hostname:e,foreign_session_id:null,client_info:this.clientInfo})}isCrossOrigin(){return!(window.location.host.endsWith("dropbox.com")||window.location.host.endsWith(".dev.corp.dropbox.com")&&5===window.location.host.split(".").length)||void 0!==window.sandbox_verifier}}})),define("metaserver/static/js/privacy_consent/privacy_consent.module.css",["require","exports","css!metaserver/static/js/privacy_consent/privacy_consent.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expanded=t.prevCollapsed=t.collapsed=t.buttonEnabled=t.dialogOpen=t.noBanner=t.bannerVisible=t.consentIframe=void 0,t.consentIframe="_consent-iframe_5ksqc_1",t.bannerVisible="_banner-visible_5ksqc_11",t.noBanner="_no-banner_5ksqc_15",t.dialogOpen="_dialog-open_5ksqc_15",t.buttonEnabled="_button-enabled_5ksqc_25",t.collapsed="_collapsed_5ksqc_29",t.prevCollapsed="_prev-collapsed_5ksqc_35",t.expanded="_expanded_5ksqc_39";t.default={consentIframe:"_consent-iframe_5ksqc_1",bannerVisible:"_banner-visible_5ksqc_11",noBanner:"_no-banner_5ksqc_15",dialogOpen:"_dialog-open_5ksqc_15",buttonEnabled:"_button-enabled_5ksqc_25",collapsed:"_collapsed_5ksqc_29",prevCollapsed:"_prev-collapsed_5ksqc_35",expanded:"_expanded_5ksqc_39"}})),define("metaserver/static/js/privacy_consent/sandbox_redirect",["require","exports","tslib","react","react-dom","metaserver/static/js/privacy_consent/sandbox_redirect.module.css"],(function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderSandboxRedirect=t.SandboxRedirect=void 0,i=n.__importDefault(i),o=n.__importDefault(o),s=n.__importDefault(s);t.SandboxRedirect=e=>i.default.createElement("div",{className:s.default.sandboxRedirectContainer},i.default.createElement("h1",null,e.sandboxRedirectTitle),i.default.createElement("p",{className:s.default.sandboxRedirectDetails},e.sandboxRedirectDetails),i.default.createElement("a",{href:e.href,className:s.default.sandboxRedirectButton},e.sandboxRedirectLinkText));t.renderSandboxRedirect=e=>{if(null!==document.querySelector(`.${s.default.sandboxRedirectContainer}`))return;const n=document.querySelectorAll(".birch-page__container, #main");let a=document.body;n.length>=1&&(a=n[0]);const r=i.default.createElement(t.SandboxRedirect,Object.assign({},e));a.innerHTML="",o.default.render(r,a),a.scrollIntoView()}})),define("metaserver/static/js/privacy_consent/sandbox_redirect.module.css",["require","exports","css!metaserver/static/js/privacy_consent/sandbox_redirect.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sandboxRedirectButton=t.sandboxRedirectDetails=t.sandboxRedirectContainer=void 0,t.sandboxRedirectContainer="_sandbox_redirect_container_1fd8s_1",t.sandboxRedirectDetails="_sandbox_redirect_details_1fd8s_11",t.sandboxRedirectButton="_sandbox_redirect_button_1fd8s_15";t.default={sandboxRedirectContainer:"_sandbox_redirect_container_1fd8s_1",sandboxRedirectDetails:"_sandbox_redirect_details_1fd8s_11",sandboxRedirectButton:"_sandbox_redirect_button_1fd8s_15"}}));
//# sourceMappingURL=pkg-privacy-consent-post-tti.min.js-vflzbXuZI.map