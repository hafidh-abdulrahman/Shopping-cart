define("metaserver/static/js/account_page/tabs/connected_apps",["require","exports","tslib","react","react-redux","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/account_page/widgets/connected_services/view","metaserver/static/js/account_page/widgets/linked_apps/view","metaserver/static/js/account_page/util","metaserver/static/js/account_page/widgets/linked_apps/logger","metaserver/static/js/account_page/selectors","metaserver/static/js/clean/active_user","metaserver/static/js/account_page/widgets/google_shortcuts_settings/view","metaserver/static/js/account_page/widgets/preferred_editor/view","metaserver/static/js/account_page/widgets/desktop_settings/view","metaserver/static/js/vault/components/vault_account_section_async"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.moduleInit=t.ConnectedAppsTab=void 0,r=o.__importDefault(r),n=o.__importStar(n);class g extends r.default.Component{constructor(e){super(e)}componentDidMount(){(0,l.logEvent)("view_apps_page"),this.checkTTIstate()}componentDidUpdate(){this.checkTTIstate()}checkTTIstate(){this.props.dataLoadedForTTI&&(0,s.mark_time_to_interactive)()}render(){var e;const{expBetterConnectedAppsPage:t}=this.props,o=(0,p.mustGetActiveUser)(),n=null===(e=(0,c.getTeamInfo)())||void 0===e?void 0:e.teamName;return r.default.createElement("div",{className:"account-page-tab"},r.default.createElement(a.ConnectedServices,{expBetterConnectedAppsPage:t}),r.default.createElement(i.LinkedApps,{userId:o.id,appType:"user",expBetterConnectedAppsPage:t}),void 0!==n&&r.default.createElement(i.LinkedApps,{userId:o.id,appType:"team",teamName:n,expBetterConnectedAppsPage:t}),r.default.createElement(_.PreferredEditors,{gddMigrationHideDefaultApps:this.props.gddMigrationHideDefaultApps}),this.props.showPaperDesktopSettings?r.default.createElement(m.DesktopSettings,{ref:"desktopSettings"}):null,r.default.createElement(f.AsyncVaultAccountSection,{userId:o.id,expVaultTCSecurityEnhancement:this.props.expVaultTCSecurityEnhancement}),this.props.gddMigrationAcccountSettingsEnabled&&r.default.createElement(u.GoogleShortcutsSettingsRow,{user:o}))}}g.displayName="ConnectedAppsTabComponent",t.ConnectedAppsTab=n.connect(e=>({dataLoadedForTTI:(0,d.getConnectedAppsLoaded)(e)}))(g),t.moduleInit=function(e){},t.initialize_module=function(e){}})),define("metaserver/static/js/account_page/widgets/connected_services/action_creators",["require","exports","tslib","metaserver/static/js/clean/active_user","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/core/assert","metaserver/static/js/account_page/widgets/connected_services/api"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refreshServices=t.loadUserSettings=t.updateModalState=t.deauthUserWithService=t.authUserWithService=t.loadDataIfNecessary=void 0,s=o.__importStar(s);const c=new n.ProfileServicesLinkingHandler;function l(e=[]){return e.map(e=>s.ServiceRequestType.to_api_v2(e))}t.loadDataIfNecessary=function(){return(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===t().connectedServices.loadingState){e({type:"connected_services_load_services"});const t=(0,i.getProfileServices)((0,r.mustGetActiveUser)()),o=(0,i.getFeatureAvailability)((0,r.mustGetActiveUser)()),n=(0,i.getUserSettings)((0,r.mustGetActiveUser)()),s=yield t,a=yield o,c=yield n;e({type:"connected_services_feature_availability_loaded",features:a.features}),e({type:"connected_services_services_loaded",services:s.services,connections:s.linked_services}),e({type:"connected_services_user_settings_loaded",settings:c})}}))},t.authUserWithService=function(e,t,r,n){return i=>o.__awaiter(this,void 0,void 0,(function*(){var o;if("facebook_legacy"===t[".tag"])return(0,a.assert)(!1,"facebook linking has been deprecated"),null;const d=yield c.auth_service_with_user_promise(s.default.from_api_service_type(t),e.id,null,r,void 0,void 0,void 0,void 0,n);return d.success&&i({type:"connected_services_service_connected",service_type:s.default.to_api_service_type(d.provider),displayName:d.display_name,granted_permissions:l(d.granted_request_types),missing_permissions:l(d.missing_request_types),external_service_id:(null===(o=d.profile)||void 0===o?void 0:o.service_id)||""}),d}))},t.deauthUserWithService=function(e,t,r){return(n,s)=>o.__awaiter(this,void 0,void 0,(function*(){const o=s().connectedServices.connections.filter(e=>e.service_type[".tag"]===t[".tag"]).length;return yield(0,i.unlinkUserFromService)(e,t,r),n({type:"connected_services_service_disconnected",service_type:t,external_service_id:r,connections:r?o-1:0}),!0}))},t.updateModalState=function(e,t,r){return(n,s)=>o.__awaiter(this,void 0,void 0,(function*(){return n({type:"connected_services_modal_state_updated",modal_type:e,service:t,service_data:r}),!0}))},t.loadUserSettings=function(){return(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){const t=yield(0,i.getUserSettings)((0,r.mustGetActiveUser)());e({type:"connected_services_user_settings_loaded",settings:t})}))},t.refreshServices=function(){return(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){const t=yield(0,i.getProfileServices)((0,r.mustGetActiveUser)());e({type:"connected_services_services_loaded",services:t.services,connections:t.linked_services})}))}})),define("metaserver/static/js/account_page/widgets/connected_services/api",["require","exports","tslib","metaserver/static/js/api_v2/default_user_client"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkUserFromService=t.getUserSettings=t.getFeatureAvailability=t.getProfileServices=void 0,t.getProfileServices=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return new r.DefaultUserApiV2Client(e).ns("profile_services").rpc("list_linked_services",void 0,{})}))},t.getFeatureAvailability=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return new r.DefaultUserApiV2Client(e).ns("integrations").rpc("are_features_available",{features:[{feature:"profile_card_v2",entry_point:"connected_apps"}]},{})}))},t.getUserSettings=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return new r.DefaultUserApiV2Client(e).ns("integrations").rpc("get_user_settings",{},{})}))},t.unlinkUserFromService=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function*(){return new r.DefaultUserApiV2Client(e).ns("profile_services").rpc("unlink",{service:t,external_service_id:n||void 0},{}).then(e=>e.success).catch(()=>!1)}))}})),define("metaserver/static/js/account_page/widgets/connected_services/view",["require","exports","tslib","react","react-redux","styled-components","dig-components/buttons","dig-components/typography","metaserver/static/js/account_page/widgets/connected_services/action_creators","metaserver/static/js/account_page/components/loading","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/clean/active_user","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/core/i18n","metaserver/static/js/clean/static_urls","typescript/component_libraries/deep-integrations/src/instrumentation/connect_service_flow_wrapper","metaserver/static/js/integrations/log_event","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","typescript/component_libraries/deep-integrations/src/instrumentation/constants","typescript/component_libraries/deep-integrations/src/platform/log_event","typescript/component_libraries/deep-integrations/src/instrumentation/common_context","typescript/component_libraries/deep-integrations/src/instrumentation/instr_feature_component","metaserver/static/js/integrations/performance_timer","typescript/component_libraries/deep-integrations/src/async","metaserver/static/js/account_page/widgets/connected_services/zoom_settings","metaserver/static/js/account_page/widgets/connected_services/disconnect_modal","metaserver/static/js/account_page/components/disconnect_snackbar","metaserver/static/js/account_page/widgets/connected_services/multi_account_settings","metaserver/static/js/account_page/components/connected_services_accordion","metaserver/static/js/account_page/components/linked_apps_accordion","metaserver/static/js/account_page/selectors","metaserver/static/js/account_page/widgets/linked_apps/action_creators","metaserver/static/js/account_page/components/connected_apps_accordion","metaserver/static/js/account_page/components/connected_apps_empty_content","metaserver/static/js/account_page/widgets/connected_services/slack_settings","metaserver/static/js/account_page/widgets/linked_apps/page_info"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E,h,y,S,b,O,C,M,T,A,I,R,k,w,P,N,D,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedServices=t.ConnectedServicesComponent=void 0,r=o.__importDefault(r),n=o.__importStar(n),s=o.__importDefault(s),d=o.__importDefault(d);const L=s.default.div`
  background-color: var(--color__standard__background);
  border: 1px solid var(--color__faint__border);
  border-radius: var(--spacing__unit--0_5);
`,j=s.default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing__unit--3);
  &:not(:first-child) {
    border-top: 1px solid var(--color__faint__border);
  }
`,F=s.default.div`
  display: flex;
  align-items: center;
`,G=s.default.img`
  padding-right: 2px;
`,U=s.default.span`
  margin-right: var(--spacing__unit--2);
`,V=s.default.div`
  display: flex;
`,B=s.default.img`
  width: var(--spacing__unit--4);
  height: var(--spacing__unit--4);
`,W=s.default.div`
  padding-left: var(--spacing__unit--2);
  display: flex;
  flex-direction: column;
`,X=s.default.div`
  font-size: var(--type__body__standard--fontsize);
  padding-bottom: 10px;
  line-height: 1em;
`,H=s.default.div`
  display: flex;
  flex-direction: column;
  font-size: var(--type__body__small--fontsize);
  line-height: 1em;
  color: var(--color__faint__text);
`,q=s.default.a`
  padding-left: 5px;
`,K=s.default.span`
  line-height: 1.5em;
  .mc-tertiary-icon-text {
    line-height: 1.5em;
  }
`,z=s.default.span`
  line-height: 1em;
  .mc-tertiary-icon-text {
    line-height: 1em;
    font-size: var(--type__body__small--fontsize);
  }
`,Y=E.InstrFeatureType.ConnectedServices;t.ConnectedServicesComponent=e=>r.default.createElement(S.InstrFeatureComponent,{logEvent:(0,h.withDefaults)(e.logEvent,{feature_name:Y}),performanceTimer:b.WebPerformanceTimer,criticalAsyncProps:["ready"===e.loadingState?(0,O.fulfilled)(null):O.pending]},r.default.createElement(J,Object.assign({},e)));class J extends r.default.Component{constructor(){super(...arguments),this.unlinkApp=(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){try{yield this.props.unlinkApp((0,p.mustGetActiveUser)().id,e,!t),(0,T.showSuccessSnackbar)(e.name)}catch(t){(0,T.showFailureSnackbar)(e.name)}})),this.getServiceList=()=>[...this.props.services].sort(this.serviceCompare.bind(this)),this.getServiceInfoMap=()=>{var e;const t=this.props.connections,o=new Map;for(const r of t){const t=r.service_type[".tag"],n=null!==(e=o.get(t))&&void 0!==e?e:[];n.push(r),o.set(t,n)}return o},this.isServiceEnabled=e=>{var t;return"enabled"===(null===(t=null==e?void 0:e.service_availability)||void 0===t?void 0:t[".tag"])},this.isServiceConnected=e=>{var t;return"is_connected"===(null===(t=null==e?void 0:e.connection_state)||void 0===t?void 0:t[".tag"])},this.hasConnections=({serviceInfos:e})=>!!(null==e?void 0:e.length),this.getServiceData=e=>this.getServiceDataWithFeatureCheck(e,["profile_card_v2"]),this.getConnectedServices=()=>{const e=this.getServiceList().filter(this.isServiceEnabled),t=this.getServiceInfoMap();return e.map(e=>{var o,r;return{service:e,serviceInfos:null!==(r=null===(o=t.get(e.service_type[".tag"]))||void 0===o?void 0:o.filter(this.isServiceConnected))&&void 0!==r?r:[],serviceData:this.getServiceData(e.service_type)}}).filter(this.hasConnections)},this.getConnectedServicesConnectionInfo=(e,t)=>{const o=(0,p.mustGetActiveUser)(),r=(0,v.functionWrapperProvider)(this.props.logEvent,Y),n=e.service_type[".tag"];return(e.supports_multiple_links?t:t.slice(0,1)).map(t=>({serviceType:n,displayName:t.display_name,externalServiceId:t.external_service_id,onClickDisconnect:(0,v.onClickWrapper)(r,E.InstrActionType.DisconnectService,()=>this.disconnectService(o,e,e.supports_multiple_links?t:null,Y),{serviceType:n}),onClickSetDefault:(0,v.onClickWrapper)(r,E.InstrActionType.SetDefaultWorkspace,()=>{D.SlackSettingsUtils.setSlackDefaultWorkspace(o,t.external_service_id,this.props.loadUserSettings)},{serviceType:e.service_type[".tag"],extra:{service_id:t.external_service_id}})}))},this.getConnectedServicesSettingsHandler=e=>{const t=(0,v.functionWrapperProvider)(this.props.logEvent,Y);return"zoom"===e.service_type[".tag"]?(0,v.onClickWrapper)(t,E.InstrActionType.ModifyServiceSettings,()=>{this.props.updateModalState("zoom_settings",e,null)},{serviceType:e.service_type[".tag"]}):null},this.getConnectedServicesConnectHandler=(e,t)=>{const o=(0,v.functionWrapperProvider)(this.props.logEvent,Y),r=(0,p.mustGetActiveUser)(),n=t.action;return e.supports_multiple_links&&n?(0,v.onClickWrapper)(o,E.InstrActionType.ConnectService,()=>{this.connectService(r,e,n,null,Y)},{serviceType:e.service_type[".tag"]}):null},this.getConnectedServicesDefaultService=e=>{var t;const o=e.service_type[".tag"];return e.supports_multiple_links&&"slack_dropbox"===o&&(null===(t=this.props.userSettings.slack_settings)||void 0===t?void 0:t.default_slack_service_id)||null},this.getConnectedServicesInfo=()=>this.getConnectedServices().map(({service:e,serviceInfos:t,serviceData:o})=>{var r;const n=d.default.from_api_to_img(e.service_type);return{connections:this.getConnectedServicesConnectionInfo(e,t),iconUrl:n?(0,m.static_url)(n):null,name:d.default.from_api_to_name(e.service_type),defaultServiceId:this.getConnectedServicesDefaultService(e),onClickSettings:this.getConnectedServicesSettingsHandler(e),onClickConnect:this.getConnectedServicesConnectHandler(e,o),pageUrl:null===(r=(0,x.getServicePageInfo)(this.props.pageInfos,e.service_type))||void 0===r?void 0:r.page_url}}),this.showAccordion=()=>"ON_SERVICE_ACCORDION"===this.props.expBetterConnectedAppsPage,this.getConnectedAppsAccordionItems=()=>{const e=this.getConnectedServicesInfo().map(I.getConnectedServicesAccordionItemContents),t=(0,R.getLinkedAppsAccordionItemContents)(this.props.linkedApps.filter(k.isAppAction),this.props.pageInfos,this.unlinkApp);return e.concat(t)},this.listPageInfoArgs=()=>({app_identifiers:[...this.getConnectedServices().map(({service:e})=>(0,x.getServiceAppId)(e.service_type)),...this.props.linkedApps.map(x.getAppInfoAppId)]}),this.renderExtensionsTable=()=>{const e=this.getServiceList(),t=this.getServiceInfoMap(),o=e.map(e=>{var o;const r=e.service_type[".tag"];return this.renderServiceRow(e,null!==(o=t.get(r))&&void 0!==o?o:[])});return r.default.createElement(L,{className:"connected-services"},o)}}componentDidMount(){this.props.fetchServices(),this.showAccordion()&&this.props.loadApps((0,p.mustGetActiveUser)().id)}componentDidUpdate(){this.showAccordion()&&this.props.connectedAppsLoaded&&this.props.listPageInfo((0,p.mustGetActiveUser)().id,this.listPageInfoArgs())}connectService(e,t,r,n,s){return o.__awaiter(this,void 0,void 0,(function*(){const o=n?n.connection_state:{".tag":"never_connected"};this.props.logEvent((0,f.buildStartEvent)(t.service_type,o,s,E.InstrConnectServiceFlowOutcome.Connected,{service_action:r}));try{const o=yield this.props.connectService(e,t.service_type,r,n?n.external_service_id:null);null!=o&&u.ProfileServicesLinkingHandler.show_import_notifications(o);const a=o&&o.success?E.InstrConnectServiceFlowOutcome.Connected:E.InstrConnectServiceFlowOutcome.Error;this.props.logEvent((0,f.buildEndEvent)(t.service_type,s,E.InstrConnectServiceFlowOutcome.Connected,a,{service_action:r})),t.supports_multiple_links&&this.props.refreshServices()}catch(e){this.props.logEvent((0,f.buildEndEvent)(t.service_type,s,E.InstrConnectServiceFlowOutcome.Connected,E.InstrConnectServiceFlowOutcome.Error,{service_action:r,error:JSON.stringify(e)}))}}))}disconnectService(e,t,o,r){const{logEvent:n,disconnectService:s,openDisconnectModal:a}=this.props;n((0,f.buildStartEvent)(t.service_type,o?o.connection_state:{".tag":"is_connected"},r,E.InstrConnectServiceFlowOutcome.Disconnected));const i=d.default.from_api_to_name(t.service_type);(this.showAccordion()?s:a)(e,t,o).then(e=>{n((0,f.buildEndEvent)(t.service_type,r,E.InstrConnectServiceFlowOutcome.Disconnected,e?E.InstrConnectServiceFlowOutcome.Disconnected:E.InstrConnectServiceFlowOutcome.Abort)),e&&(0,T.showSuccessSnackbar)(i)}).catch(e=>{(0,T.showFailureSnackbar)(i),n((0,f.buildEndEvent)(t.service_type,r,E.InstrConnectServiceFlowOutcome.Disconnected,E.InstrConnectServiceFlowOutcome.Error,{error:JSON.stringify(e)}))})}renderServiceRow(e,t){const o=(0,p.mustGetActiveUser)(),n=e.service_type,s=e.service_availability,a=e.supports_multiple_links,i=t.length>0,c=d.default.from_api_service_type(n),l=this.getServiceDataWithFeatureCheck(n,["profile_card_v2"]);let u=null,_=null;if(0===t.length)u=this.renderDisconnectedConnectionBlock(o,e,l);else if(a)u=this.renderMultiAccountConnectionBlock(e,l,t);else{_=t[0];for(const e of t)"is_connected"===e.connection_state[".tag"]&&(_=e);u=this.renderSingleAccountConnectionBlock(o,e,l,_)}return i||l.action&&"enabled"===s[".tag"]?r.default.createElement(j,{"data-service":c,key:c,className:"connected-services__row"},this.renderServiceInfoBlock(o,e,_,l.permissions,l.learn_more_page),u):null}renderSingleAccountConnectionBlock(e,t,o,n){const s=t.service_type,a=d.default.from_api_to_name(s),i=o.action,c=n.connection_state,l=n.display_name;let p="",u=null;const f=(0,v.functionWrapperProvider)(this.props.logEvent,Y);return"zoom"===s[".tag"]?"is_connected"===c[".tag"]?(p=_.intl.formatMessage({id:"iyqtlQ",defaultMessage:"Settings"}),u=(0,v.onClickWrapper)(f,E.InstrActionType.ModifyServiceSettings,()=>{this.props.updateModalState("zoom_settings",t,null)},{serviceType:t.service_type[".tag"]})):(p=_.intl.formatMessage({id:"QpcX0N",defaultMessage:"Reconnect to {service_name}"},{service_name:a}),i&&(u=(0,v.onClickWrapper)(f,E.InstrActionType.ReconnectService,()=>{this.connectService(e,t,i,n,Y)},{serviceType:s[".tag"]}))):"is_connected"===c[".tag"]?(p=_.intl.formatMessage({id:"6q467U",defaultMessage:"Disconnect"}),u=(0,v.onClickWrapper)(f,E.InstrActionType.DisconnectService,()=>{this.disconnectService(e,t,null,Y)},{serviceType:s[".tag"]})):(p=_.intl.formatMessage({id:"QpcX0N",defaultMessage:"Reconnect to {service_name}"},{service_name:a}),i&&(u=(0,v.onClickWrapper)(f,E.InstrActionType.ReconnectService,()=>{this.connectService(e,t,i,n,Y)},{serviceType:s[".tag"]}))),r.default.createElement(F,{className:"connected-services__service-connection-block"},"is_connected"===c[".tag"]&&r.default.createElement(G,{src:(0,m.static_url)("/static/metaserver/static/images/check-green-vfl4z9rpV.svg"),alt:_.intl.formatMessage({id:"ygWyU0",defaultMessage:"Connected"})}),l&&r.default.createElement(U,{className:"connected-services__service-connection-display-name"},l),r.default.createElement(K,null,this.maybeGetActionButton(p,u)))}renderDisconnectedConnectionBlock(e,t,o){const n=t.service_type,s=d.default.from_api_to_name(n),a=o.action,i=_.intl.formatMessage({id:"cv7wtw",defaultMessage:"Connect to {service_name}"},{service_name:s});let c=null;const l=(0,v.functionWrapperProvider)(this.props.logEvent,Y);return a&&(c=(0,v.onClickWrapper)(l,E.InstrActionType.ConnectService,()=>{this.connectService(e,t,a,null,Y)},{serviceType:n[".tag"]})),r.default.createElement(F,{className:"connected-services__service-connection-block"},r.default.createElement(K,null,this.maybeGetActionButton(i,c)))}resolveBlockDisplayName(e,t){if("slack_dropbox"===e&&this.props.userSettings.slack_settings){const{default_slack_service_id:e,default_workspace_name:o}=this.props.userSettings.slack_settings;return!!t.find(t=>"is_connected"===t.connection_state[".tag"]&&!!t.external_service_id&&e===t.external_service_id)&&o||""}return""}renderMultiAccountConnectionBlock(e,t,o){const n=e.service_type;let s=null;const a=(0,v.functionWrapperProvider)(this.props.logEvent,Y);s=(0,v.onClickWrapper)(a,E.InstrActionType.ModifyServiceSettings,()=>{this.props.updateModalState("multiple_account_settings",e,t)},{serviceType:n[".tag"]});const i=this.resolveBlockDisplayName(n[".tag"],o);return r.default.createElement(F,{className:"connected-services__service-connection-block"},i&&r.default.createElement(G,{src:(0,m.static_url)("/static/metaserver/static/images/check-green-vfl4z9rpV.svg"),alt:_.intl.formatMessage({id:"dpfspe",defaultMessage:"Connected"})}),i&&r.default.createElement(U,{className:"connected-services__service-connection-display-name"},i),r.default.createElement(K,null,this.maybeGetActionButton(_.intl.formatMessage({id:"iyqtlQ",defaultMessage:"Settings"}),s)))}maybeGetActionButton(e,t){return t?r.default.createElement(a.Button,{variant:"transparent",onClick:t},e):null}renderServiceInfoBlock(e,t,o,n,s){const a=t.service_type,i=d.default.from_api_to_name(a),c=d.default.from_api_to_img(a),l=(0,v.functionWrapperProvider)(this.props.logEvent,Y);return r.default.createElement(V,{className:"connected-services__service-info-block"},r.default.createElement("div",null,r.default.createElement(B,{src:(0,m.static_url)(c),alt:i})),r.default.createElement(W,null,r.default.createElement(X,null,i),r.default.createElement(H,null,r.default.createElement("div",null,n,s&&r.default.createElement(q,{onClick:(0,v.onClickWrapper)(l,E.InstrActionType.LearnMore,void 0,{serviceType:a[".tag"]}),href:s,target:"_blank",rel:"noopener noreferrer"},_.intl.formatMessage({id:"vrRyJy",defaultMessage:"Learn More"}))),this.renderConnectGoogleCalendar(e,t,o),this.renderConnectSlackFilesRead(e,t,o))))}render(){if("ready"!==this.props.loadingState)return r.default.createElement("div",{className:"account-page-block account-page-block--connected-apps"},r.default.createElement(l.Loading,null));const e=this.getConnectedAppsAccordionItems();return r.default.createElement("div",{className:"account-page-block account-page-block--no-border"},r.default.createElement(i.Title,{style:{marginBottom:"var(--spacing__base_unit)"},size:"small"},this.showAccordion()?_.intl.formatMessage({id:"juQS1k",defaultMessage:"Launch from Dropbox"}):_.intl.formatMessage({id:"ZiMXGI",defaultMessage:"Connect apps to Dropbox"})),r.default.createElement(i.Text,{style:{display:"inline-block",marginBottom:"var(--spacing__unit--2)"},size:"small",color:"faint"},this.showAccordion()?_.intl.formatMessage({id:"7+6z6E",defaultMessage:"Open, share, and collaborate on your content with these apps you can launch while using Dropbox."}):_.intl.formatMessage({id:"vKX8er",defaultMessage:"Integrated features from these apps make it easier to collaborate with people you know on Dropbox."})),this.showAccordion()?(null==e?void 0:e.length)?r.default.createElement(P.ConnectedAppsAccordion,{contents:e}):r.default.createElement(N.ConnectedAppsEmptyUserContent,null):this.renderExtensionsTable(),this.renderCurrentModal())}renderCurrentModal(){if(null==this.props.modalState)return null;const e=(0,p.mustGetActiveUser)(),t=()=>{this.props.updateModalState(null,null,null)};if("multiple_account_settings"===this.props.modalState.type){const o=this.props.modalState.service,r=this.props.modalState.serviceData;return o&&r?(0,A.renderMultiAccountSettingsModal)(e,o,r,(e,t,o,r,n)=>{this.connectService(e,t,o,r,n)},(e,t,o,r)=>{this.disconnectService(e,t,o,r)},t):null}if("zoom_settings"===this.props.modalState.type){const o=this.props.modalState.service;return o?(0,C.renderZoomSettingsModal)(e,o,(e,t,o,r)=>{this.disconnectService(e,t,o,r)},t,this.showAccordion()):null}return null}renderConnectGoogleCalendar(e,t,o){if(null==o)return null;return this.isFeatureAvailable("profile_card_v2")&&"google"===t.service_type[".tag"]&&"is_connected"===o.connection_state[".tag"]&&J.containsPermission(o.missing_permissions,"calendar")&&r.default.createElement(z,null,this.maybeGetActionButton(_.intl.formatMessage({id:"hSZf0R",defaultMessage:"Connect Google Calendar"}),()=>{this.connectService(e,t,"link_calendar",o,Y)}))}renderConnectSlackFilesRead(e,t,o){if(null==o)return null;return"slack_dropbox"===t.service_type[".tag"]&&"is_connected"===o.connection_state[".tag"]&&J.containsPermission(o.missing_permissions,"read_files")&&r.default.createElement(z,null,this.maybeGetActionButton(_.intl.formatMessage({id:"bjLf+T",defaultMessage:"Reconnect to Slack to enable new features"}),()=>{this.connectService(e,t,"link_read_files",o,Y)}))}static containsPermission(e,t){return!!e.find(e=>e[".tag"]===t)}isFeatureAvailable(e){for(const t of this.props.features)if(t.feature===e&&"available"===t.available[".tag"])return!0;return!1}getServiceDataWithFeatureCheck(e,t){for(const o of t)if(this.isFeatureAvailable(o)){const t=d.default.get_gated_service_data(e,o);if(t)return t}return d.default.get_service_data(e)}serviceCompare(e,t){const o=this.getServiceDataWithFeatureCheck(e.service_type,["profile_card_v2"]),r=this.getServiceDataWithFeatureCheck(t.service_type,["profile_card_v2"]),n=o.order-r.order;return 0!==n?n:o.friendly_name<r.friendly_name?-1:o.friendly_name>r.friendly_name?1:0}}J.displayName="ConnectedServicesComponentImpl",t.ConnectedServices=n.connect(e=>({services:e.connectedServices.services,connections:e.connectedServices.connections,loadingState:e.connectedServices.loadingState,features:e.connectedServices.features,logEvent:(0,y.decorateCommonContext)((0,g.createIntegrationsActionsLogger)().logEvent,{services:e.connectedServices.services,serviceList:e.connectedServices.connections,featureGates:e.connectedServices.features}),modalState:e.connectedServices.modalState,linkedApps:(0,k.getUserLinkedApps)(e),connectedAppsLoaded:(0,k.getConnectedAppsLoaded)(e),userSettings:e.connectedServices.userSettings,pageInfos:(0,k.getPageInfos)(e)}),e=>({fetchServices:()=>e((0,c.loadDataIfNecessary)()),connectService:(t,o,r,n)=>e((0,c.authUserWithService)(t,o,r,n||void 0)),disconnectService:(t,o,r)=>{const n=null!=r?r.external_service_id:null;return e((0,c.deauthUserWithService)(t,o.service_type,n))},openDisconnectModal:(t,o,r)=>{const n=null!=r?r.external_service_id:null,s=null!=r?r.display_name:null;return e((0,M.disconnectModalActionCreator)(t,o.service_type,n,s))},updateModalState:(t,o,r)=>e((0,c.updateModalState)(t,o,r)),loadApps:t=>e((0,w.loadDataIfNecessary)(t)),unlinkApp:(t,o,r)=>e((0,w.unlinkApp)(t,"user",o,r)),loadUserSettings:()=>e((0,c.loadUserSettings)()),refreshServices:()=>e((0,c.refreshServices)()),listPageInfo:(t,o)=>e((0,w.listPageInfoAction)(t,o))}))(t.ConnectedServicesComponent)})),define("metaserver/static/js/account_page/widgets/connected_services/connection_buttons",["require","exports","tslib","metaserver/static/js/core/i18n","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","spectrum/tertiary_link/index","react","typescript/component_libraries/deep-integrations/src/instrumentation/constants","metaserver/static/js/profile_services/profile_services_constants","styled-components"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReconnectServiceButton=t.DisconnectServiceButton=void 0,a=o.__importDefault(a),c=o.__importDefault(c);const d=(l=o.__importDefault(l)).default.div`
  .mc-tertiary-icon-text {
    color: var(--color__error__text);
  }
`;class p extends a.default.PureComponent{constructor(){super(...arguments),this.render=()=>{const e=r.intl.formatMessage({id:"EDBJwx",defaultMessage:"Disconnect"}),t=(0,n.onClickWrapper)(this.props.functionWrapper,i.InstrActionType.DisconnectService,()=>{this.props.onDisconnect(this.props.user,this.props.service,this.props.connection,this.props.featureType)},{serviceType:this.props.connection.service_type[".tag"]});return a.default.createElement(d,null,a.default.createElement(s.TertiaryLink,{onClick:t},e))}}}t.DisconnectServiceButton=p,p.displayName="DisconnectServiceButton";class u extends a.default.PureComponent{constructor(){super(...arguments),this.render=()=>{const e=this.props.serviceAction,t=this.props.service.service_type,o=c.default.from_api_to_name(t),l=r.intl.formatMessage({id:"hsXGK8",defaultMessage:"Reconnect to {service_name}"},{service_name:o}),d=(0,n.onClickWrapper)(this.props.functionWrapper,i.InstrActionType.ReconnectService,()=>{this.props.onConnect(this.props.user,this.props.service,e,this.props.connection,this.props.featureType)},{serviceType:t[".tag"]});return a.default.createElement("div",null,a.default.createElement(s.TertiaryLink,{onClick:d},l))}}}t.ReconnectServiceButton=u,u.displayName="ReconnectServiceButton"})),define("metaserver/static/js/account_page/widgets/connected_services/disconnect_modal",["require","exports","tslib","react","metaserver/static/js/account_page/widgets/connected_services/action_creators","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/core/i18n","spectrum/modal/index","metaserver/static/js/components/ui/modal","metaserver/static/js/integrations/log_event","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","typescript/component_libraries/deep-integrations/src/instrumentation/constants"],(function(e,t,o,r,n,s,a,i,c,l,d,p){"use strict";function u(e,t,o,n){const{logEvent:u}=(0,l.createIntegrationsActionsLogger)(),_=(0,d.functionWrapperProvider)(u,p.InstrFeatureType.ConnectedServices),m=s.default.from_api_to_name(e),f="slack_dropbox"===e[".tag"],g=f&&t?a.intl.formatMessage({id:"rj7/iE",defaultMessage:"Disconnect {workspace_name}?"},{workspace_name:t}):a.intl.formatMessage({id:"zlbejP",defaultMessage:"Disconnect {service_name} integration?"},{service_name:m}),v=f&&t?a.intl.formatMessage({id:"zFOP6g",defaultMessage:"Are you sure you want to disconnect <st>{workspace_name}</st>? You’ll need to reconnect to this {service_name} workspace to continue using it with Dropbox."},{st:e=>r.default.createElement("strong",null,e),workspace_name:t,service_name:m}):a.intl.formatMessage({id:"UnFd0B",defaultMessage:"Are you sure you want to disconnect <st>{service_name}</st>? You’ll need to reconnect again to continue using {service_name} integrations on Dropbox."},{st:e=>r.default.createElement("strong",null,e),service_name:m});c.Modal.showInstance(r.default.createElement(i.UtilityModal,{ariaLabel:g,title:g,overlayClickClose:!0,primaryAction:a.intl.formatMessage({id:"7SjgaG",defaultMessage:"Disconnect"}),secondaryAction:a.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),shouldFocusAfterRender:!0,onPrimaryAction:(0,d.onClickWrapper)(_,p.InstrActionType.DisconnectServiceConfirm,o,{serviceType:e[".tag"]}),open:!0,onSecondaryAction:(0,d.onClickWrapper)(_,p.InstrActionType.DisconnectServiceAbort,n,{serviceType:e[".tag"]}),onRequestClose:()=>c.Modal.close(),appElement:document.getElementById("embedded-app")},v))}Object.defineProperty(t,"__esModule",{value:!0}),t.showDisconnectModal=t.disconnectModalActionCreator=void 0,r=o.__importDefault(r),s=o.__importDefault(s),t.disconnectModalActionCreator=function(e,t,r,s){return(a,i)=>{const c=(0,n.deauthUserWithService)(e,t,r);return new Promise((e,r)=>{u(t,s,()=>o.__awaiter(this,void 0,void 0,(function*(){try{const t=yield c(a,i);e(t)}catch(e){r(e)}})),()=>{e(!1)})})}},t.showDisconnectModal=u})),define("metaserver/static/js/account_page/widgets/connected_services/multi_account_settings",["require","exports","tslib","react","styled-components","spectrum/tertiary_link/index","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/core/i18n","spectrum/modal/index","metaserver/static/js/integrations/log_event","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","typescript/component_libraries/deep-integrations/src/instrumentation/constants","react-redux","typescript/component_libraries/deep-integrations/src/instrumentation/common_context","typescript/component_libraries/deep-integrations/src/instrumentation/instr_feature_component","metaserver/static/js/integrations/performance_timer","typescript/component_libraries/deep-integrations/src/platform/log_event","metaserver/static/js/account_page/widgets/connected_services/slack_settings","metaserver/static/js/account_page/widgets/connected_services/connection_buttons"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiAccountSettings=t.renderMultiAccountSettingsModal=t.MultiAccountSettingsComponentImpl=t.MultiAccountSettingsComponent=void 0,r=o.__importDefault(r),n=o.__importDefault(n),a=o.__importDefault(a),u=o.__importStar(u);const h=n.default.div`
  border-top: 1px solid var(--color__faint__border);
  padding: 9px 0;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`,y=n.default.div`
  font-size: var(--type__body__small--fontsize);
  color: var(--color__standard__text);
  .mc-tertiary-icon-text {
    font-size: var(--type__body__small--fontsize);
  }
  .mc-tertiary-link-button {
    display: inline;
  }
`,S=n.default.div`
  border-top: 1px solid var(--color__faint__border);
  padding-top: 9px;
`,b=n.default.div`
  display: flex;
  flex-direction: column;
`,O=p.InstrFeatureType.MultiAccountSettings;t.MultiAccountSettingsComponent=e=>r.default.createElement(m.InstrFeatureComponent,{logEvent:(0,g.withDefaults)(e.logEvent,{feature_name:O}),performanceTimer:f.WebPerformanceTimer},r.default.createElement(C,Object.assign({},e)));class C extends r.default.Component{constructor(e){super(e)}getServiceConnections(){return this.props.connections.filter(e=>e.service_type[".tag"]===this.props.service.service_type[".tag"])}renderConnectAnotherAccount(){const{logEvent:e}=(0,l.createIntegrationsActionsLogger)(),t=(0,d.functionWrapperProvider)(e,O),o=this.props.serviceData.action;if(!o)return null;const n=this.props.service,c=n.service_type,u=a.default.from_api_to_name(c),_=(0,d.onClickWrapper)(t,p.InstrActionType.ConnectService,()=>{this.props.onConnect(this.props.user,n,o,null,O)},{serviceType:c[".tag"]}),m=i.intl.formatMessage({id:"TivL0w",defaultMessage:"Connect another {service_name} account"},{service_name:u});return r.default.createElement(S,null,r.default.createElement(s.TertiaryLink,{onClick:_},m))}renderPermissionsList(e){const t=this.props.service,o=[];if(M(e.granted_permissions,"contacts")&&o.push(i.intl.formatMessage({id:"OTPvT6",defaultMessage:"Contacts"})),M(e.granted_permissions,"calendar"))o.push(i.intl.formatMessage({id:"plHZl8",defaultMessage:"Calendar"}));else if("google"===t.service_type[".tag"]&&M(e.missing_permissions,"calendar")){const{logEvent:n}=(0,l.createIntegrationsActionsLogger)(),a=(0,d.functionWrapperProvider)(n,O),c=(0,d.onClickWrapper)(a,p.InstrActionType.ConnectService,()=>{this.props.onConnect(this.props.user,t,"link_calendar",e,O)},{serviceType:t.service_type[".tag"]});o.push(r.default.createElement(s.TertiaryLink,{onClick:c},i.intl.formatMessage({id:"Mn0ge1",defaultMessage:"Link Calendar"})))}const n=i.intl.formatList(o,{style:"narrow",type:"conjunction"});return r.default.createElement(y,{className:"connected-services__service-settings-service-list-entry-info-permissions"},n)}renderServicesList(e){const{logEvent:t}=(0,l.createIntegrationsActionsLogger)(),o=(0,d.functionWrapperProvider)(t,O);return e.map(e=>{const t=e.display_name;let n=null;return"is_connected"===e.connection_state[".tag"]?n=r.default.createElement(E.DisconnectServiceButton,{user:this.props.user,service:this.props.service,connection:e,functionWrapper:o,featureType:O,onDisconnect:this.props.onDisconnect}):this.props.serviceData.action&&(n=r.default.createElement(E.ReconnectServiceButton,{user:this.props.user,service:this.props.service,serviceAction:this.props.serviceData.action,connection:e,functionWrapper:o,featureType:O,onConnect:this.props.onConnect})),r.default.createElement(h,{className:"connected-services__service-settings-service-list-entry",key:e.external_service_id},r.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-info"},r.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-name"},t),this.renderPermissionsList(e)),r.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-button"},n))})}render(){const e=this.props.service.service_type,t=a.default.from_api_to_name(e),o=this.getServiceConnections(),n=i.intl.formatMessage({id:"lRIjKv",defaultMessage:"{service_name} settings"},{service_name:t}),s="slack_dropbox"===e[".tag"]?r.default.createElement(v.SlackConnectionList,{user:this.props.user,service:this.props.service,serviceData:this.props.serviceData,connections:o,onConnect:this.props.onConnect,onDisconnect:this.props.onDisconnect}):this.renderServicesList(o),l=this.renderConnectAnotherAccount();return r.default.createElement(c.UtilityModal,{className:"connected-services__service-settings-modal",ariaLabel:n,title:n,overlayClickClose:!0,primaryAction:i.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onRequestClose:this.props.onClose,shouldFocusAfterRender:!0,open:!0,appElement:document.getElementById("embedded-app"),shouldRequestCloseOnActions:!0},r.default.createElement(b,null,s),l)}}function M(e,t){return!!e.find(e=>e[".tag"]===t)}t.MultiAccountSettingsComponentImpl=C,C.displayName="MultiAccountSettingsComponentImpl",t.renderMultiAccountSettingsModal=function(e,o,n,s,a,i){return r.default.createElement(t.MultiAccountSettings,{service:o,serviceData:n,user:e,onConnect:s,onDisconnect:a,onClose:i})},t.MultiAccountSettings=u.connect(e=>({connections:e.connectedServices.connections,logEvent:(0,_.decorateCommonContext)((0,l.createIntegrationsActionsLogger)().logEvent,{serviceList:e.connectedServices.connections})}))(t.MultiAccountSettingsComponent)})),define("metaserver/static/js/account_page/widgets/connected_services/slack_settings",["require","exports","tslib","metaserver/static/js/clean/static_urls","metaserver/static/js/core/i18n","react","react-redux","styled-components","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","typescript/component_libraries/deep-integrations/src/instrumentation/constants","spectrum/tertiary_link/index","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/integrations/log_event","metaserver/static/js/account_page/widgets/connected_services/action_creators","metaserver/static/js/account_page/widgets/connected_services/connection_buttons"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlackConnectionList=t.SlackConnectionListImpl=t.SlackSettingsUtils=void 0,s=o.__importDefault(s),a=o.__importStar(a);const g=(i=o.__importDefault(i)).default.div`
  display: flex;
  flex: 1;
  justify-content: space-between;
  align-items: center;
`,v=i.default.div`
  font-weight: bold;
`,E=i.default.div`
  display: flex;
  margin-right: var(--spacing__unit--3);
`,h=i.default.img`
  padding-right: 2px;
`,y=i.default.div`
  display: flex;
  margin-right: var(--spacing__unit--3);
`,S=(0,i.default)(d.TertiaryLink)`
  padding-right: 0;
`,b=i.default.div`
  border-top: 1px solid var(--color__faint__border) l;
  padding: 9px 0;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`;t.SlackSettingsUtils={setSlackDefaultWorkspace:function(e,t,o){const r=n.intl.formatMessage({id:"l4OzW8",defaultMessage:"Default workspace updated."}),s=n.intl.formatMessage({id:"8gpuN1",defaultMessage:"Couldn’t set to your default workspace. Try again later."});new p.DefaultUserApiV2Client(e).ns("integrations").rpc("set_user_settings",{slack_settings:{default_slack_service_id:t}},{}).then(e=>{u.Snackbar.complete(r),o&&o()},e=>{u.Snackbar.fail(s)})}};const O=l.InstrFeatureType.SlackSettings;class C extends s.default.Component{componentDidMount(){this.props.refreshUserSettings()}getSetAsDefaultBlock(e,o){const r=(0,c.onClickWrapper)(e,l.InstrActionType.SetDefaultWorkspace,()=>{t.SlackSettingsUtils.setSlackDefaultWorkspace(this.props.user,o.external_service_id,this.props.refreshUserSettings)},{serviceType:o.service_type[".tag"]}),a=n.intl.formatMessage({id:"3dQivP",defaultMessage:"Set as Default"},{});return s.default.createElement(y,{className:"connected-services__slack-settings-slack-info-set-default-button"},s.default.createElement(S,{onClick:r},a))}getCurrentDefaultBlock(){return s.default.createElement(E,null,s.default.createElement(h,{src:(0,r.static_url)("/static/metaserver/static/images/check-green-vfl4z9rpV.svg"),alt:n.intl.formatMessage({id:"uZV5CG",defaultMessage:"Default"})}),s.default.createElement("span",{className:"connected-services__slack-settings-default-workspace-text"},"Default"))}renderListItem(e,t){var o;const r=t.display_name,n=null===(o=this.props.slackSettings)||void 0===o?void 0:o.default_slack_service_id,a=!!n&&n===t.external_service_id?this.getCurrentDefaultBlock():this.getSetAsDefaultBlock(e,t);return s.default.createElement(g,{className:"connected-services__slack-settings-slack-info"},s.default.createElement(v,{className:"connected-services__slack-settings-slack-info-name"},r),a)}render(){const{logEvent:e}=(0,_.createIntegrationsActionsLogger)(),t=(0,c.functionWrapperProvider)(e,O);return this.props.connections.map(e=>{let o=null;return"is_connected"===e.connection_state[".tag"]?o=s.default.createElement(f.DisconnectServiceButton,{user:this.props.user,service:this.props.service,connection:e,functionWrapper:t,featureType:O,onDisconnect:this.props.onDisconnect}):this.props.serviceData.action&&(o=s.default.createElement(f.ReconnectServiceButton,{user:this.props.user,service:this.props.service,serviceAction:this.props.serviceData.action,connection:e,functionWrapper:t,featureType:O,onConnect:this.props.onConnect})),s.default.createElement(b,{className:"connected-services__service-settings-service-list-entry",key:e.external_service_id},this.renderListItem(t,e),s.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-button"},o))})}}t.SlackConnectionListImpl=C,C.displayName="SlackConnectionListImpl",t.SlackConnectionList=a.connect(e=>({slackSettings:e.connectedServices.userSettings.slack_settings}),e=>({refreshUserSettings:()=>e((0,m.loadUserSettings)())}))(C)})),define("metaserver/static/js/account_page/widgets/connected_services/zoom_settings",["require","exports","tslib","react","styled-components","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/core/i18n","spectrum/modal/index","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/integrations/log_event","typescript/component_libraries/deep-integrations/src/instrumentation/function_wrapper","typescript/component_libraries/deep-integrations/src/instrumentation/constants","spectrum/checkbox/checkbox","metaserver/static/js/api_v2/default_user_client","dig-components/typography","dig-components/controls","dig-components/progress_indicators","metaserver/static/js/account_page/components/connected_apps_modal","react-redux"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderZoomSettingsModal=t.ZoomSettings=t.ZoomSettingsComponent=void 0,r=o.__importDefault(r),n=o.__importStar(n),s=o.__importDefault(s),E=o.__importStar(E);const h=n.css`
  flex-shrink: 0;
`,y=(0,n.default)(f.Checkbox)`
  ${h}
`,S=(0,n.default)(u.Checkbox)`
  ${h}
`,b=n.default.div`
  display: flex;
  flex-direction: row;
  margin-top: 5px;
  margin-bottom: 15px;

  .connected-services__service-setting-checkbox-name {
    margin-left: 15px;
  }

  .connected-services__service-setting-checkbox-name--disabled {
    color: var(--color__disabled__text);
  }
`,O=n.default.div`
  margin-bottom: 15px;
`,C=p.InstrFeatureType.ZoomSettings;class M extends r.default.Component{constructor(e){super(e),this.handleSaveMeetingRecordingsCheckboxChange=()=>{this.setState(e=>({saveMeetingRecordings:!e.saveMeetingRecordings}))},this.fetchZoomSettings=()=>{this.setState({isFetching:!0}),new _.DefaultUserApiV2Client(this.props.user).ns("integrations").rpc("get_user_settings",{},{}).then(e=>{const t=!(!e.zoom_settings||!e.zoom_settings.save_meeting_recordings),o=!(!e.zoom_settings||!e.zoom_settings.meeting_recordings_disabled_by_admin);this.setState({isFetching:!1,initialSaveMeetingRecordings:t,adminHasDisabledSaveMeetingRecordings:o,saveMeetingRecordings:t})},e=>{this.setState({isFetching:!1})})},this.confirmNewSettings=()=>{const e=a.intl.formatMessage({id:"Ge2zdm",defaultMessage:"Setting updated."}),t=a.intl.formatMessage({id:"XrLuJX",defaultMessage:"Couldn’t update setting. Try again later."});if(this.state.saveMeetingRecordings!==this.state.initialSaveMeetingRecordings){new _.DefaultUserApiV2Client(this.props.user).ns("integrations").rpc("set_user_settings",{zoom_settings:{save_meeting_recordings:this.state.saveMeetingRecordings}},{}).then(t=>{c.Snackbar.complete(e)},e=>{c.Snackbar.fail(t)})}else c.Snackbar.complete(e)},this.state={isFetching:!0,initialSaveMeetingRecordings:!1,adminHasDisabledSaveMeetingRecordings:!1,saveMeetingRecordings:!1}}componentDidMount(){this.fetchZoomSettings()}getServiceConnections(){return this.props.connections.filter(e=>e.service_type[".tag"]===this.props.service.service_type[".tag"])}getCheckboxComponent(){return this.props.showDigComponents?r.default.createElement(y,{disabled:this.state.adminHasDisabledSaveMeetingRecordings,checked:this.state.saveMeetingRecordings&&!this.state.adminHasDisabledSaveMeetingRecordings,onChange:this.handleSaveMeetingRecordingsCheckboxChange}):r.default.createElement(S,{disabled:this.state.adminHasDisabledSaveMeetingRecordings,checked:this.state.saveMeetingRecordings&&!this.state.adminHasDisabledSaveMeetingRecordings?"checked":"unchecked",onChange:this.handleSaveMeetingRecordingsCheckboxChange})}getSettingsComponent(){return this.state.isFetching?this.props.showDigComponents?r.default.createElement(g.Spinner,{"aria-valuetext":"Loading xsmall",size:"xsmall"}):r.default.createElement("div",null):r.default.createElement(r.default.Fragment,null,r.default.createElement(b,null,this.getCheckboxComponent(),r.default.createElement("span",{className:this.state.adminHasDisabledSaveMeetingRecordings?"connected-services__service-setting-checkbox-name--disabled":"connected-services__service-setting-checkbox-name"},r.default.createElement(O,null,a.intl.formatMessage({id:"emoz3Z",defaultMessage:"Copy Zoom cloud recordings to Dropbox"})),r.default.createElement("div",null,a.intl.formatMessage({id:"5eEVpZ",defaultMessage:"After a meeting you host is recorded to Zoom cloud, the recording will be copied from Zoom cloud to your Zoom folder in Dropbox. We’ll notify you when files are copied. This feature requires certain settings in your Zoom account to be enabled."})," ",r.default.createElement(m.Link,{href:"https://help.dropbox.com/installs-integrations/third-party/zoom#cloudrecordings",target:"_blank",rel:"noopener noreferrer",hasNoUnderline:!0},a.intl.formatMessage({id:"NXXPcB",defaultMessage:"Learn more"}))))))}render(){const e=this.getServiceConnections();if(0===e.length)return null;const t=e[0],{logEvent:o}=(0,l.createIntegrationsActionsLogger)(),n=(0,d.functionWrapperProvider)(o,C),c=s.default.from_api_to_name(this.props.service.service_type),u=a.intl.formatMessage({id:"TyLekI",defaultMessage:"{service_name} settings"},{service_name:c}),_=(0,d.onClickWrapper)(n,p.InstrActionType.ModifyServiceSettingsConfirm,this.confirmNewSettings,{serviceType:this.props.service.service_type[".tag"]}),m=(0,d.onClickWrapper)(n,p.InstrActionType.DisconnectService,()=>{this.props.onDisconnect(this.props.user,this.props.service,t,C)},{serviceType:this.props.service.service_type[".tag"]});return this.props.showDigComponents?r.default.createElement(v.ConnectedAppsSettingsModal,{name:s.default.from_api_to_name(this.props.service.service_type),open:!0,onClickClose:this.props.onClose,onClickUpdate:()=>{_(),this.props.onClose()}},this.getSettingsComponent()):r.default.createElement(i.UtilityModal,{className:"connected-services__service-settings-modal",ariaLabel:u,title:u,overlayClickClose:!0,primaryAction:a.intl.formatMessage({id:"tFVI8B",defaultMessage:"Update"}),secondaryAction:a.intl.formatMessage({id:"5Pnscd",defaultMessage:"Cancel"}),shouldFocusAfterRender:!0,onPrimaryAction:_,open:!0,link:a.intl.formatMessage({id:"pz/yrN",defaultMessage:"Disconnect Zoom"}),onLink:m,onRequestClose:this.props.onClose,appElement:document.getElementById("embedded-app")},this.getSettingsComponent())}}t.ZoomSettingsComponent=M,M.displayName="ZoomSettingsComponent",t.ZoomSettings=E.connect(e=>({connections:e.connectedServices.connections}))(M),t.renderZoomSettingsModal=function(e,o,n,s,a){return"zoom"!==o.service_type[".tag"]?null:r.default.createElement(t.ZoomSettings,{user:e,service:o,onDisconnect:n,onClose:s,showDigComponents:a})}})),define("metaserver/static/js/account_page/widgets/linked_apps/action_creators",["require","exports","tslib","metaserver/static/js/account_page/widgets/linked_apps/api"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkApp=t.listPageInfoAction=t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e){return(t,n)=>o.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===n().linkedApps.loadingState){t({type:"linked_apps_load_apps"});const o=yield(0,r.getLinkedApps)(e);t({type:"linked_apps_apps_loaded",apps:o})}}))},t.listPageInfoAction=function(e,t){return(n,s)=>o.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===s().linkedApps.listPageInfoState){n({type:"linked_apps_list_page_info"});const o=yield(0,r.listPageInfo)(e,t);n({type:"linked_apps_list_page_info_result",listPageInfoResult:o})}}))},t.unlinkApp=function(e,t,n,s){return(a,i)=>o.__awaiter(this,void 0,void 0,(function*(){return a({type:"linked_apps_unlink_app",appType:t,app:n}),"app_action"===n.type?yield(0,r.unlinkAppAction)(e,n):yield(0,r.unlinkApp)(e,n,s),a({type:"linked_apps_app_unlinked",appType:t,app:n}),!0}))}})),define("metaserver/static/js/account_page/widgets/linked_apps/api",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listPageInfo=t.unlinkAppAction=t.unlinkApp=t.getLinkedApps=void 0,t.getLinkedApps=function(e){return(0,n.WebRequest)({url:"/account/get_linked_apps",subject_user:e,dataType:"json"})},t.unlinkApp=function(e,t,o){return(new r.UserApiV2Client).ns("security_settings").rpc("uninstall_app_v2",{app_id:t.id,keep_sandbox_files:o},{subjectUserId:e})},t.unlinkAppAction=function(e,t){return(new r.UserApiV2Client).ns("security_settings").rpc("uninstall_app_action_v2",{action_id:t.action_id},{subjectUserId:e})},t.listPageInfo=function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(new r.UserApiV2Client).ns("app_directory").rpc("list_page_info",t,{subjectUserId:e})}))}})),define("metaserver/static/js/account_page/widgets/linked_apps/page_info",["require","exports","tslib","metaserver/static/js/profile_services/profile_services_constants"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceAppId=t.getAppInfoAppId=t.getApiAppInfoAppId=t.getAppActionInfoAppId=t.getAppInfoPageInfo=t.getServicePageInfo=t.getPageInfoMaps=void 0,r=o.__importDefault(r);t.getPageInfoMaps=e=>{var t;const o=new Map,r=new Map;for(const s of e){const e=null!==(t=null==s?void 0:s.app_identifiers)&&void 0!==t?t:[];for(const t of e)if("api_app"===t[".tag"]){const e=n(t);o.set(e,s)}else if("first_party_app"===t[".tag"]){const e=t.first_party_app;r.set(e,s)}}return{apiAppPageInfoMap:o,firstPartyAppPageInfoMap:r}};t.getServicePageInfo=(e,o)=>{const{firstPartyAppPageInfoMap:r}=(0,t.getPageInfoMaps)(e),n=(0,t.getServiceAppId)(o);return r.get(n.first_party_app)};t.getAppInfoPageInfo=(e,o)=>{const{firstPartyAppPageInfoMap:r,apiAppPageInfoMap:n}=(0,t.getPageInfoMaps)(e);if("api_app"===o.type)return n.get(o.id);{const e=(0,t.getAppActionInfoAppId)(o);return r.get(e.first_party_app)}};const n=({api_app:e})=>parseInt(e,10),s=e=>r.default.from_api_to_name(e).toLowerCase().replace(/[^a-z]/gi,"");t.getAppActionInfoAppId=({action_id:e})=>({".tag":"first_party_app",first_party_app:e.replace("fp_action_id:","")});t.getApiAppInfoAppId=({id:e})=>({".tag":"api_app",api_app:e.toString()});t.getAppInfoAppId=e=>"api_app"===e.type?(0,t.getApiAppInfoAppId)(e):(0,t.getAppActionInfoAppId)(e);t.getServiceAppId=e=>({".tag":"first_party_app",first_party_app:s(e)})})),define("metaserver/static/js/account_page/widgets/linked_apps/view",["require","exports","tslib","react","react-redux","metaserver/static/js/core/i18n","metaserver/static/js/account_page/components/loading","metaserver/static/js/account_page/widgets/linked_apps/action_creators","metaserver/static/js/account_page/components/linked_apps_accordion","metaserver/static/js/account_page/selectors","dig-components/typography","metaserver/static/js/account_page/components/disconnect_snackbar","metaserver/static/js/account_page/components/connected_apps_empty_content"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedApps=t.LinkedAppsComponent=void 0,r=o.__importDefault(r),n=o.__importStar(n);class _ extends r.default.Component{constructor(){super(...arguments),this.uninstallApp=(e,t)=>o.__awaiter(this,void 0,void 0,(function*(){try{yield this.props.unlinkApp(this.props.userId,this.props.appType,e,!t),(0,p.showSuccessSnackbar)(e.name)}catch(t){(0,p.showFailureSnackbar)(e.name)}})),this.isLinkedAppsEmpty=()=>{var e,t;return 0===(null!==(t=null===(e=this.getAppInfos())||void 0===e?void 0:e.length)&&void 0!==t?t:0)},this.getSectionHeaders=()=>{const{appType:e,teamName:t,expBetterConnectedAppsPage:o}=this.props,r="ON_SERVICE_ACCORDION"===o;if(this.isLinkedAppsEmpty()&&!r){if("user"===e){const e=s.intl.formatMessage({id:"qmkIog",defaultMessage:"You haven’t given any third-party apps access to your Dropbox account."});return[s.intl.formatMessage({id:"XAMjLd",defaultMessage:"Apps with access to your Dropbox"}),e]}return[s.intl.formatMessage({id:"VF7AsU",defaultMessage:"Apps managed for your team"}),s.intl.formatMessage({id:"qmkIog",defaultMessage:"You haven’t given any third-party apps access to your Dropbox account."})]}if(r){if("user"===e){const e=s.intl.formatMessage({id:"PqIIiR",defaultMessage:"View and make changes to your Dropbox content while using these apps outside of Dropbox. If you don’t recognize an app, disconnect it."});return[s.intl.formatMessage({id:"hadLkQ",defaultMessage:"View Dropbox content"}),e]}return[s.intl.formatMessage({id:"+1MsbO",defaultMessage:"Apps managed for your team"}),s.intl.formatMessage({id:"APqTeb",defaultMessage:"An admin on your team manages these apps for your {teamName} Dropbox account."},{teamName:t})]}if("user"===e){const e=s.intl.formatMessage({id:"/L9p47",defaultMessage:"You’ve given these apps permission to access your Dropbox files on your behalf."});return[s.intl.formatMessage({id:"XAMjLd",defaultMessage:"Apps with access to your Dropbox"}),e]}return[s.intl.formatMessage({id:"+1MsbO",defaultMessage:"Apps managed for your team"}),s.intl.formatMessage({id:"Oe2LfB",defaultMessage:"An administrator at {teamName} has given these apps access to your {teamName} Dropbox account."},{teamName:t})]},this.getAppInfos=()=>{var e;const{appType:t,apps:o,linkedApiApps:r,expBetterConnectedAppsPage:n}=this.props,s="ON_SERVICE_ACCORDION"===n?r:o;return null!==(e="user"===t?null==s?void 0:s.user_apps:null==s?void 0:s.team_apps)&&void 0!==e?e:[]}}componentWillMount(){this.props.loadApps(this.props.userId)}render(){const{loadingState:e,appType:t,expBetterConnectedAppsPage:o,pageInfos:n}=this.props;if("ready"!==e)return r.default.createElement("div",{className:"account-page-block account-page-block--linked-apps"},r.default.createElement(a.Loading,null));const[s,i]=this.getSectionHeaders(),l="team"===t,p="ON_SERVICE_ACCORDION"===o,_=l?r.default.createElement(u.ConnectedAppsEmptyTeamContent,null):r.default.createElement(u.ConnectedAppsEmptyUserContent,null);return r.default.createElement("div",{className:"account-page-block account-page-block--no-border"},r.default.createElement(d.Title,{style:{marginBottom:"var(--spacing__base_unit)"},size:"small"},s),r.default.createElement(d.Text,{style:{display:"inline-block",marginBottom:"var(--spacing__unit--2)"},size:"small",color:"faint"},i),this.isLinkedAppsEmpty()&&p?_:r.default.createElement(c.LinkedAppsAccordion,{disconnectDisabled:l,appInfos:this.getAppInfos(),pageInfos:n,onClickDisconnect:this.uninstallApp}))}}t.LinkedAppsComponent=_,_.displayName="LinkedAppsComponent",t.LinkedApps=n.connect(e=>({apps:e.linkedApps.apps,loadingState:e.linkedApps.loadingState,linkedApiApps:(0,l.getLinkedApiApps)(e),pageInfos:(0,l.getPageInfos)(e)}),e=>({loadApps:t=>e((0,i.loadDataIfNecessary)(t)),unlinkApp:(t,o,r,n)=>e((0,i.unlinkApp)(t,o,r,n))}))(_)})),define("metaserver/static/js/account_page/components/disconnect_snackbar",["require","exports","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/i18n"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showFailureSnackbar=t.showSuccessSnackbar=void 0;t.showSuccessSnackbar=e=>{o.Snackbar.complete(r.intl.formatMessage({id:"hJASAE",defaultMessage:"Successfully disconnected {name}"},{name:e}),"disconnect-snackbar",!0)};t.showFailureSnackbar=e=>{o.Snackbar.fail(r.intl.formatMessage({id:"F7owMq",defaultMessage:"Could not disconnect {name}, try again later"},{name:e}),"disconnect-snackbar",!0)}})),define("metaserver/static/js/account_page/components/linked_apps_accordion",["require","exports","tslib","react","styled-components","react-intl","metaserver/static/js/core/i18n","dompurify","metaserver/static/js/components/ui/css","dig-components/controls","dig-components/typography","metaserver/static/js/account_page/widgets/linked_apps/logger","metaserver/static/js/account_page/components/connected_apps_modal","metaserver/static/js/account_page/components/connected_apps_accordion","metaserver/static/js/account_page/components/connected_apps_info_table","metaserver/static/js/account_page/widgets/linked_apps/page_info"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedAppsAccordion=t.getLinkedAppsAccordionItemContents=void 0,r=o.__importStar(r),n=o.__importDefault(n),i=o.__importDefault(i);const g=n.default.div`
  display: flex;
  justify-content: flex-end;
  border-top: 1px solid var(--color__standard__border);
  align-items: center;
`,v=n.default.div`
  display: flex;
  align-items: center;
`,E=n.default.label`
  margin-left: var(--spacing__base_unit);
`,h=n.default.div`
  .remove-app-folder {
    display: flex;
    align-items: center;
    padding-top: var(--spacing__unit--3);
    &__checkbox {
      margin-right: var(--spacing__base_unit);
    }
  }
  .app-link {
    color: var(--color__dbx__blue--100);
  }
  .account-page-block--app-actions {
    .account-toggle-block {
      height: auto;
    }
  }
`,y=({accessType:e,accessTypeDescription:t})=>{const o=a.intl.formatMessage({id:"kHube8",defaultMessage:"This app no longer has access to your files because you deleted its app folder. You will need to reinstall the app for it to work again."});return r.default.createElement(d.Text,null,"no_access"===e?o:t)};y.displayName="LinkedAppsAccessTypeText";const S=({permissions:e})=>r.default.createElement("ul",{className:"linked-apps-info-table__value-ul"},e.map(e=>r.default.createElement("li",{className:"linked-apps-info-table__value-li",key:e,dangerouslySetInnerHTML:{__html:i.default.sanitize(e)}})));S.displayName="LinkedAppsPermissionsList";const b=({name:e,checked:t,onChange:o})=>{const n=(0,s.defineMessage)({id:"hbjEja",defaultMessage:"Also remove <st>{name}</st> folder from my Dropbox."}),i=a.intl.formatMessage(n,{st:e=>r.default.createElement("strong",null,e),name:e});return r.default.createElement(v,{className:"linked-apps-modal__checkbox"},r.default.createElement(l.Checkbox,{checked:t,onChange:o,id:"linked-apps-modal__checkbox"}),r.default.createElement(E,{htmlFor:"linked-apps-modal__checkbox",className:"linked-apps-modal__checkbox-message"},r.default.createElement(d.Text,null,i)))};b.displayName="LinkedAppsRemoveFolderCheckbox";const O=({name:e})=>{const t=(0,s.defineMessage)({id:"5UnsXT",defaultMessage:"Disconnecting this app will prevent <st>{name}</st> from accessing your Dropbox."}),o=a.intl.formatMessage(t,{st:e=>r.default.createElement("strong",null,e),name:e});return r.default.createElement(d.Text,null,o)};O.displayName="LinkedAppsDisconnectText";const C=({appInfo:e,pageUrl:t,onClickDisconnect:o,disconnectDisabled:n})=>{var s;const[a,i]=(0,r.useState)(!1),[c,l]=(0,r.useState)(!1);return r.default.createElement(r.default.Fragment,null,r.default.createElement(h,{className:"linked-apps-body"},r.default.createElement(m.ConnectedAppsInfoTable,null,e.first_linked_ts?r.default.createElement(m.ConnectedAppsConnectedDateRow,{date:e.first_linked_ts}):null,r.default.createElement(m.ConnectedAppsDeveloperInfoRow,{developer:e.publisher_company||e.name,developerUrl:e.publisher_url,onClick:()=>(0,p.logEvent)("click_developer_link",(0,p.appInfoExtras)(e))}),r.default.createElement(m.ConnectedAppsPermissionsRow,null,"app_action"!==e.type&&(null===(s=e.scope_list_messages)||void 0===s?void 0:s.length)?r.default.createElement(S,{permissions:e.scope_list_messages}):r.default.createElement(y,{accessType:e.access_type,accessTypeDescription:e.access_type_desc}))),r.default.createElement(g,{className:"linked-apps-actions"},t?r.default.createElement(m.ConnectedAppsAppCenterLink,{url:t,onClick:()=>(0,p.logEvent)("click_view_app_directory",(0,p.appInfoExtras)(e))}):null,r.default.createElement(m.ConnectedAppsDisconnectButton,{onClick:()=>{(0,p.logEvent)("click_disconnect_app",(0,p.appInfoExtras)(e)),i(!0)},disabled:n}))),o?r.default.createElement(u.ConnectedAppsDisconnectModal,{open:a,name:e.name,onClickDisconnect:()=>{(0,p.logEvent)("click_confirm_disconnect_app",(0,p.appInfoExtras)(e)),o(e,c)},onClickClose:()=>i(!1)},r.default.createElement(O,{name:e.name}),"app_action"!==e.type&&e.uses_sandbox&&e.app_folder?r.default.createElement(b,{name:e.name,checked:c,onChange:()=>l(!c)}):null):null)};C.displayName="LinkedAppsAccordionBody";const M=(e,t,o,n)=>({id:"api_app"===e.type?e.id:e.action_id,headline:r.default.createElement(_.ConnectedAppsAccordionHeadline,{name:e.name,publisher:e.publisher_company||e.name,iconUrl:e.icon_url}),body:r.default.createElement(C,{appInfo:e,pageUrl:o,onClickDisconnect:t,disconnectDisabled:n})}),T=(e,t)=>{var o,r;return(null!==(o=t.first_linked_ts)&&void 0!==o?o:0)-(null!==(r=e.first_linked_ts)&&void 0!==r?r:0)};t.getLinkedAppsAccordionItemContents=(e,t,o,r)=>e.sort(T).map(e=>{var n;return{content:M(e,o,null===(n=(0,f.getAppInfoPageInfo)(t,e))||void 0===n?void 0:n.page_url,r),onClick:()=>(0,p.logEvent)("click_expand_connected_app_details",(0,p.appInfoExtras)(e))}});const A=({disconnectDisabled:e,appInfos:o,pageInfos:n,onClickDisconnect:s})=>{const a=(0,t.getLinkedAppsAccordionItemContents)(o,n,s,e);return r.default.createElement(_.ConnectedAppsAccordion,{contents:a})};A.displayName="LinkedAppsAccordionComponent",t.LinkedAppsAccordion=(0,c.requireCssWithComponent)(A,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"])})),define("metaserver/static/js/account_page/components/connected_apps_accordion",["require","exports","tslib","react","styled-components","dig-components/typography","dig-components/icons","dig-components/icons/src","typescript/component_libraries/spectrum-arbor/src/components/arbor_expander/index","metaserver/static/js/components/ui/css","metaserver/static/js/core/i18n"],(function(e,t,o,r,n,s,a,i,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedAppsAccordion=t.ConnectedAppsAccordionHeadline=void 0,r=o.__importStar(r);const p=(n=o.__importStar(n)).css`
  width: var(--spacing__unit--5);
  height: var(--spacing__unit--5);
  margin: 0 var(--spacing__unit--2);
`,u=(0,n.default)(a.UIIcon)`
  ${p}
`,_=n.default.img`
  ${p}
`,m=n.default.div`
  display: flex;
  align-items: center;
`,f=n.default.div`
  display: flex;
  flex-direction: column;
`,g=n.default.div`
  &__empty-text {
    text-align: center;
    padding: var(--spacing__unit--4) 0;
    border-bottom: 1px solid var(--color__standard__border);
  }
  .arbor-expander-item__arrow {
    border-radius: 0;
    border-right: 1px solid var(--color__black);
    border-top: 1px solid var(--color__black);
    border-bottom: none;
    transform: rotate(45deg);
    height: 10px;
    width: 10px;
    bottom: 0;

    &--active {
      transform: rotate(135deg);
    }
  }
  .arbor-expander-item {
    padding: 6px 0;
    border-color: var(--color__faint__border);
    &:first-of-type {
      border-top: none;
    }
    &:last-of-type {
      border-color: var(--color__standard__border);
    }
  }
  .arbor-expander-item__copy-container {
    width: 100%;
  }
`,v=n.default.div`
  margin-top: var(--spacing__unit--2_5);
`;t.ConnectedAppsAccordionHeadline=({iconUrl:e,name:t,publisher:o})=>r.default.createElement(m,{className:"linked-apps-headline"},e?r.default.createElement(_,{src:e,className:"linked-apps-headline__icon",alt:""}):r.default.createElement(u,{className:"linked-apps-headline__icon",size:"large",src:i.ImageLine}),r.default.createElement(f,{className:"linked-apps-headline__heading"},r.default.createElement(s.Text,{isBold:!0},t),r.default.createElement(s.Text,{size:"small",color:"faint"},o))),t.ConnectedAppsAccordionHeadline.displayName="ConnectedAppsAccordionHeadline";const E=({contents:e,collapseToMaxItems:t=3})=>{const[o,n]=(0,r.useState)(!1),a=e.map(({content:e})=>e),i=a.length>t,l=!o&&i,p=l?a.slice(0,t):a;return r.default.createElement(r.default.Fragment,null,r.default.createElement(g,{className:"linked-apps-accordion"},r.default.createElement(c.ArborExpander,{items:p,onClick:(t,o)=>{var r,n;o===c.ArborExpanderItemAction.OPEN&&(null===(n=null===(r=e[t])||void 0===r?void 0:r.onClick)||void 0===n||n.call(r))}})),l&&r.default.createElement(v,null,r.default.createElement(s.Link,{href:()=>n(!0),isBold:!0},d.intl.formatMessage({id:"r8GMYU",defaultMessage:"Show {numItems} more"},{numItems:a.length-3}))),o&&i&&r.default.createElement(v,null,r.default.createElement(s.Link,{href:()=>n(!1),isBold:!0},d.intl.formatMessage({id:"zu4CVS",defaultMessage:"Collapse list"}))))};E.displayName="ConnectedAppsAccordionComponent",t.ConnectedAppsAccordion=(0,l.requireCssWithComponent)(E,["/static/typescript/component_libraries/spectrum-arbor/src/index.web-vfl6IG1ez.css"])})),define("metaserver/static/js/account_page/components/connected_apps_empty_content",["require","exports","tslib","react","styled-components","dig-components/typography","react-intl","metaserver/static/js/core/i18n","metaserver/static/js/components/ui/css","metaserver/static/js/account_page/widgets/linked_apps/logger"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedAppsEmptyTeamContent=t.ConnectedAppsEmptyUserContent=void 0,r=o.__importDefault(r);const d=(n=o.__importDefault(n)).default.div`
  text-align: center;
  padding: var(--spacing__unit--4) 0;
  border-bottom: 1px solid var(--color__standard__border);
`,p=()=>{const e=(0,a.defineMessage)({id:"VkzHp1",defaultMessage:"Apps you connect will show up here. Get started on <link>App Center</link>."}),t=i.intl.formatMessage(e,{link:e=>r.default.createElement("a",{href:"/apps",onClick:()=>(0,l.logEvent)("click_view_app_directory_empty_state"),className:"account-page-block__link"},e)});return r.default.createElement(d,{className:"linked-apps-accordion__empty-text"},r.default.createElement(s.Text,null,t))};p.displayName="ConnectedAppsEmptyUserContentComponent",t.ConnectedAppsEmptyUserContent=(0,c.requireCssWithComponent)(p,["/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"]);const u=()=>r.default.createElement(d,{className:"linked-apps-accordion__empty-text"},r.default.createElement(s.Text,null,i.intl.formatMessage({id:"K197gQ",defaultMessage:"To get an app enabled for your team, contact your admin."})));u.displayName="ConnectedAppsEmptyTeamContentComponent",t.ConnectedAppsEmptyTeamContent=(0,c.requireCssWithComponent)(u,["/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"])})),define("metaserver/static/js/account_page/components/connected_apps_modal",["require","exports","tslib","react","metaserver/static/js/core/i18n","dig-components/buttons","dig-components/modal","dig-components/typography"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedAppsSettingsModal=t.ConnectedAppsAccountsModal=t.ConnectedAppsDisconnectModal=void 0,r=o.__importDefault(r);t.ConnectedAppsDisconnectModal=({open:e,name:t,onClickClose:o,onClickDisconnect:c,children:l})=>r.default.createElement(a.Modal,{open:e,overlayClassName:"linked-apps-modal",onRequestClose:o},r.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(i.Title,null,n.intl.formatMessage({id:"214UkM",defaultMessage:"Disconnect the {name} app?"},{name:t}))),r.default.createElement(a.Modal.Body,null,l),r.default.createElement(a.Modal.Footer,null,r.default.createElement(s.Button,{variant:"opacity",onClick:o,autoFocus:!0},n.intl.formatMessage({id:"5Pnscd",defaultMessage:"Cancel"})),r.default.createElement(s.Button,{variant:"primary",onClick:()=>{c(),o()}},n.intl.formatMessage({id:"fuFQob",defaultMessage:"Disconnect"})))),t.ConnectedAppsDisconnectModal.displayName="ConnectedAppsDisconnectModal";t.ConnectedAppsAccountsModal=({open:e,name:t,onClickClose:o,children:c})=>r.default.createElement(a.Modal,{open:e,overlayClassName:"linked-apps-modal",onRequestClose:o},r.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(i.Title,null,n.intl.formatMessage({id:"BQJPmf",defaultMessage:"{name} accounts"},{name:t}))),r.default.createElement(a.Modal.Body,null,c),r.default.createElement(a.Modal.Footer,null,r.default.createElement(s.Button,{variant:"primary",onClick:o,autoFocus:!0},n.intl.formatMessage({id:"WAQpuN",defaultMessage:"Close"})))),t.ConnectedAppsAccountsModal.displayName="ConnectedAppsAccountsModal";t.ConnectedAppsSettingsModal=({open:e,name:t,onClickClose:o,onClickUpdate:c,children:l})=>r.default.createElement(a.Modal,{open:e,overlayClassName:"linked-apps-modal",onRequestClose:o},r.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(i.Title,null,n.intl.formatMessage({id:"twi6Bc",defaultMessage:"{name} settings"},{name:t}))),r.default.createElement(a.Modal.Body,null,l),r.default.createElement(a.Modal.Footer,null,r.default.createElement(s.Button,{variant:"opacity",onClick:o,autoFocus:!0},n.intl.formatMessage({id:"5Pnscd",defaultMessage:"Cancel"})),r.default.createElement(s.Button,{variant:"primary",onClick:c},n.intl.formatMessage({id:"tFVI8B",defaultMessage:"Update"})))),t.ConnectedAppsSettingsModal.displayName="ConnectedAppsSettingsModal"})),define("metaserver/static/js/account_page/components/connected_apps_info_table",["require","exports","tslib","react","styled-components","metaserver/static/js/core/i18n","spectrum/table/index","dig-components/buttons","dig-components/typography","metaserver/static/js/datetime/datetime"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedAppsSettingsRow=t.ConnectedAppsAccountRow=t.ConnectedAppsAccountsRow=t.ConnectedAppsManageButton=t.ConnectedAppsDisconnectButton=t.ConnectedAppsAppCenterLink=t.ConnectedAppsInfoTable=t.ConnectedAppsPermissionsRow=t.ConnectedAppsConnectedDateRow=t.ConnectedAppsDeveloperInfoRow=void 0,r=o.__importDefault(r);const d=(0,(n=o.__importDefault(n)).default)(a.Table)`
  margin: var(--spacing__unit--2) var(--spacing__base_unit) var(--spacing__base_unit)
    var(--spacing__unit--3);
`,p=(0,n.default)(a.TableRow)`
  && {
    background: var(--color__standard__background);
    border-bottom-style: none;
    color: var(--color__standard__text);
    margin-bottom: var(--spacing__unit--2);
  }
`,u=(0,n.default)(a.TableCell)`
  && {
    min-width: 100px;
    margin-right: var(--spacing__base_unit);
  }
`,_=(0,n.default)(a.TableCell)`
  &-ul {
    list-style: disc inside;
  }

  &-li {
    margin-bottom: var(--spacing__unit--1_5);
  }
`,m=n.default.div`
  white-space: nowrap;
`,f=n.default.div`
  margin: var(--spacing__unit--2);
  margin-right: 48px;
`;t.ConnectedAppsDeveloperInfoRow=({developer:e,developerUrl:t,onClick:o})=>r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"zIdt+I",defaultMessage:"Developer"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},t?r.default.createElement(c.Link,{href:t,target:"_blank",rel:"noopener noreferrer",onClick:o,hasNoUnderline:!0},e):r.default.createElement(c.Text,null,e))),t.ConnectedAppsDeveloperInfoRow.displayName="ConnectedAppsDeveloperInfoRow";t.ConnectedAppsConnectedDateRow=({date:e})=>{const t=e?(0,l.format_date)(new Date(e),"MMMM d, yyyy"):null;return r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"MEciBR",defaultMessage:"Connected on"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},r.default.createElement(c.Text,null,t)))},t.ConnectedAppsConnectedDateRow.displayName="ConnectedAppsConnectedDateRow";t.ConnectedAppsPermissionsRow=({children:e})=>r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"abKScz",defaultMessage:"Permissions"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},e)),t.ConnectedAppsPermissionsRow.displayName="ConnectedAppsPermissionsRow";t.ConnectedAppsInfoTable=({children:e})=>r.default.createElement(d,{columnFlex:[1,7],className:"linked-apps-info-table"},r.default.createElement(a.TableBody,null,e)),t.ConnectedAppsInfoTable.displayName="ConnectedAppsInfoTable";t.ConnectedAppsAppCenterLink=({url:e,onClick:t})=>r.default.createElement(m,{className:"linked-apps-actions__link"},r.default.createElement(c.Link,{href:e,target:"_blank",onClick:t,hasNoUnderline:!0},s.intl.formatMessage({id:"Z43Z5g",defaultMessage:"View on App Center"}))),t.ConnectedAppsAppCenterLink.displayName="ConnectedAppsAppCenterLink";t.ConnectedAppsDisconnectButton=({onClick:e,disabled:t})=>r.default.createElement(f,{className:"linked-apps-actions__button"},r.default.createElement(i.Button,{variant:"primary",onClick:e,disabled:t},s.intl.formatMessage({id:"fuFQob",defaultMessage:"Disconnect"}))),t.ConnectedAppsDisconnectButton.displayName="ConnectedAppsDisconnectButton";t.ConnectedAppsManageButton=({onClick:e})=>r.default.createElement(f,{className:"linked-apps-actions__button"},r.default.createElement(i.Button,{variant:"primary",onClick:e},s.intl.formatMessage({id:"g4hBjB",defaultMessage:"Manage"}))),t.ConnectedAppsManageButton.displayName="ConnectedAppsManageButton";t.ConnectedAppsAccountsRow=({count:e})=>r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"5D+GvS",defaultMessage:"Accounts"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},r.default.createElement(c.Text,null,s.intl.formatMessage({id:"PWMYmg",defaultMessage:"{count} accounts connected"},{count:e})))),t.ConnectedAppsAccountsRow.displayName="ConnectedAppsAccountsRow";t.ConnectedAppsAccountRow=({name:e})=>r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"5KdZmA",defaultMessage:"Account"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},r.default.createElement(c.Text,null,e))),t.ConnectedAppsAccountRow.displayName="ConnectedAppsAccountRow";t.ConnectedAppsSettingsRow=({name:e,onClick:t})=>r.default.createElement(p,{className:"linked-apps-info-table__row"},r.default.createElement(u,{className:"linked-apps-info-table__key"},r.default.createElement(c.Text,{color:"faint",isBold:!0},s.intl.formatMessage({id:"/dvzu+",defaultMessage:"Settings"}))),r.default.createElement(_,{className:"linked-apps-info-table__value"},r.default.createElement(i.Button,{onClick:t,variant:"transparent",hasNoUnderline:!0},s.intl.formatMessage({id:"FM0J2d",defaultMessage:"Edit settings for {name}"},{name:e})))),t.ConnectedAppsSettingsRow.displayName="ConnectedAppsSettingsRow"})),define("metaserver/static/js/account_page/components/connected_services_accordion",["require","exports","tslib","react","styled-components","react-intl","metaserver/static/js/components/ui/css","metaserver/static/js/core/i18n","metaserver/static/js/account_page/components/connected_apps_accordion","metaserver/static/js/account_page/components/connected_apps_modal","metaserver/static/js/account_page/components/connected_apps_info_table","metaserver/static/js/account_page/widgets/linked_apps/logger","dig-components/typography","dig-components/buttons","dig-components/icons/src","dig-components/icons"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConnectedServicesAccordionItemContents=t.ConnectedServicesAccordionBody=void 0,r=o.__importStar(r);const g=(n=o.__importDefault(n)).default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid var(--color__standard__border);
  padding-top: var(--spacing__unit--2);
  &:last-of-type {
    border-bottom: 1px solid var(--color__standard__border);
    padding-bottom: var(--spacing__unit--2);
  }
`,v=n.default.div`
  display: flex;
`,E=n.default.div`
  margin-right: var(--spacing__unit--3);
  &__button {
    margin: var(--spacing__unit--2);
    margin-right: 48px;
  }
  &__link {
    white-space: nowrap;
  }
`,h=n.default.div`
  display: flex;
  justify-content: flex-end;
  border-top: 1px solid var(--color__standard__border);
  align-items: center;
  &__button {
    margin: var(--spacing__unit--2);
    margin-right: 48px;
  }
  &__link {
    white-space: nowrap;
  }
`,y=n.default.div`
  display: flex;
  margin-right: var(--spacing__unit--3);
`,S=({name:e})=>{const t=(0,s.defineMessage)({id:"Y6TflF",defaultMessage:"Are you sure you want to disconnect <st>{name}</st>? You’ll need to reconnect again to continue using <st>{name}</st> on Dropbox."}),o=i.intl.formatMessage(t,{st:e=>r.default.createElement("strong",null,e),name:e});return r.default.createElement(u.Text,null,o)};S.displayName="ConnectedServicesDisconnectText";const b=({workspaceName:e})=>{const t=(0,s.defineMessage)({id:"BlFhZY",defaultMessage:"Are you sure you want to disconnect <st>{workspaceName}</st>? You’ll need to reconnect to this {serviceName} workspace to continue using it with Dropbox."}),o=i.intl.formatMessage(t,{st:e=>r.default.createElement("strong",null,e),workspaceName:e,serviceName:"Slack"});return r.default.createElement(u.Text,null,o)};b.displayName="SlackConnectedServicesDisconnectText";const O=()=>r.default.createElement(y,{className:"linked-apps-modal__default-connection"},r.default.createElement(f.UIIcon,{src:m.CheckmarkLine,"aria-label":"default-service"}),r.default.createElement(u.Text,{isBold:!0},i.intl.formatMessage({id:"vsSXdX",defaultMessage:"Default"})));O.displayName="ConnectedServicesDefaultServiceBlock";const C=({onClickSetDefault:e})=>r.default.createElement(E,{className:"linked-apps-modal__non-default-connection"},r.default.createElement(_.Button,{variant:"transparent",onClick:e},i.intl.formatMessage({id:"jeeivT",defaultMessage:"Set as Default"})));C.displayName="ConnectedServicesNonDefaultServiceBlock";const M=({name:e,connections:t,defaultServiceId:o,onClickConnect:n})=>{const[s,a]=(0,r.useState)(!1),[c,d]=(0,r.useState)(o),m=!!c;return r.default.createElement(r.default.Fragment,null,t.map(({serviceType:t,displayName:o,externalServiceId:n,onClickDisconnect:f,onClickSetDefault:E})=>r.default.createElement(r.default.Fragment,{key:o},r.default.createElement(g,{className:"linked-apps-modal__connections"},r.default.createElement(u.Text,null,o),r.default.createElement(v,{className:"linked-apps-modal__connections-actions"},m&&(n===c?r.default.createElement(O,null):r.default.createElement(C,{onClickSetDefault:()=>{(0,p.logEvent)("click_set_default_service",(0,p.serviceExtras)(e)),E(),d(n)}})),r.default.createElement(_.Button,{variant:"opacity",size:"small",onClick:()=>{(0,p.logEvent)("click_disconnect_app",(0,p.serviceExtras)(e)),a(!0)}},i.intl.formatMessage({id:"fuFQob",defaultMessage:"Disconnect"})))),r.default.createElement(l.ConnectedAppsDisconnectModal,{open:s,name:"slack_dropbox"===t?o:e,onClickDisconnect:()=>{(0,p.logEvent)("click_confirm_disconnect_app",(0,p.serviceExtras)(e)),f()},onClickClose:()=>a(!1)},"slack_dropbox"===t?r.default.createElement(b,{workspaceName:o}):r.default.createElement(S,{name:e})))),n?r.default.createElement(_.Button,{variant:"transparent",onClick:()=>{(0,p.logEvent)("click_connect_account",(0,p.serviceExtras)(e)),n()}},i.intl.formatMessage({id:"gqYNX6",defaultMessage:"Connect another {name} account"},{name:e})):null)};M.displayName="ConnectedServicesAccountsModalBody";const T=({connections:e,name:t,defaultServiceId:o,pageUrl:n,onClickSettings:s,onClickConnect:a})=>{const[c,_]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!1),g=1===e.length?e[0]:null;return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"linked-apps-body"},r.default.createElement(d.ConnectedAppsInfoTable,null,g?r.default.createElement(d.ConnectedAppsAccountRow,{name:g.displayName}):r.default.createElement(d.ConnectedAppsAccountsRow,{count:e.length}),r.default.createElement(d.ConnectedAppsPermissionsRow,null,r.default.createElement(u.Text,null,i.intl.formatMessage({id:"fetgCI",defaultMessage:"You connected this third-party app to your Dropbox account. To learn more about information this app can share with Dropbox, visit their website"}))),s?r.default.createElement(d.ConnectedAppsSettingsRow,{name:t,onClick:()=>{(0,p.logEvent)("click_edit_settings",(0,p.serviceExtras)(t)),s()}}):null),r.default.createElement(h,{className:"linked-apps-actions"},n?r.default.createElement(d.ConnectedAppsAppCenterLink,{url:n,onClick:()=>(0,p.logEvent)("click_view_app_directory",(0,p.serviceExtras)(t))}):null,a?r.default.createElement(d.ConnectedAppsManageButton,{onClick:()=>{(0,p.logEvent)("click_manage_app",(0,p.serviceExtras)(t)),f(!0)}}):r.default.createElement(d.ConnectedAppsDisconnectButton,{onClick:()=>{(0,p.logEvent)("click_disconnect_app",(0,p.serviceExtras)(t)),_(!0)}}))),g?r.default.createElement(l.ConnectedAppsDisconnectModal,{open:c,name:t,onClickDisconnect:()=>{(0,p.logEvent)("click_confirm_disconnect_app",(0,p.serviceExtras)(t)),g.onClickDisconnect()},onClickClose:()=>_(!1)},r.default.createElement(S,{name:t})):null,r.default.createElement(l.ConnectedAppsAccountsModal,{open:m,name:t,onClickClose:()=>f(!1)},r.default.createElement(M,{name:t,defaultServiceId:o,connections:e,onClickConnect:a})))};T.displayName="ConnectedServicesAccordionBodyComponent",t.ConnectedServicesAccordionBody=(0,a.requireCssWithComponent)(T,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"]);t.getConnectedServicesAccordionItemContents=({connections:e,name:o,iconUrl:n,defaultServiceId:s,pageUrl:a,onClickSettings:i,onClickConnect:l})=>({content:{id:o,headline:r.default.createElement(c.ConnectedAppsAccordionHeadline,{name:o,publisher:o,iconUrl:n}),body:r.default.createElement(t.ConnectedServicesAccordionBody,{connections:e,name:o,defaultServiceId:s,pageUrl:a,onClickSettings:i,onClickConnect:l})},onClick:()=>(0,p.logEvent)("click_expand_connected_app_details",(0,p.serviceExtras)(o))})})),define("metaserver/static/js/account_page/selectors",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPageInfos=t.getConnectedAppsLoaded=t.getUserLinkedApps=t.getLinkedApiApps=t.isAppAction=t.isApiApp=t.getLinkedApps=void 0;t.getLinkedApps=e=>{var t;return null===(t=null==e?void 0:e.linkedApps)||void 0===t?void 0:t.apps};t.isApiApp=e=>"api_app"===(null==e?void 0:e.type)&&!e.is_app_actions_only;t.isAppAction=e=>"app_action"===(null==e?void 0:e.type)||(null==e?void 0:e.is_app_actions_only);t.getLinkedApiApps=e=>{var o,r,n;const s=(0,t.getLinkedApps)(e);return{team_apps:null!==(o=null==s?void 0:s.team_apps)&&void 0!==o?o:[],user_apps:null!==(n=null===(r=null==s?void 0:s.user_apps)||void 0===r?void 0:r.filter(t.isApiApp))&&void 0!==n?n:[]}};t.getUserLinkedApps=e=>{var o,r;return null!==(r=null===(o=(0,t.getLinkedApps)(e))||void 0===o?void 0:o.user_apps)&&void 0!==r?r:[]};t.getConnectedAppsLoaded=e=>{var t,o;return"ready"===(null===(t=null==e?void 0:e.connectedServices)||void 0===t?void 0:t.loadingState)&&"ready"===(null===(o=null==e?void 0:e.linkedApps)||void 0===o?void 0:o.loadingState)};t.getPageInfos=e=>{var t,o;return null!==(o=null===(t=null==e?void 0:e.linkedApps)||void 0===t?void 0:t.listPageInfoResult.page_infos)&&void 0!==o?o:[]}})),define("metaserver/static/js/account_page/widgets/google_shortcuts_settings/view",["require","exports","tslib","react","dig-components/buttons","dig-components/typography","metaserver/static/js/account_page/components/button_block","metaserver/static/js/account_page/components/dropdown_block","metaserver/static/js/clean/analytics","metaserver/static/js/core/i18n","metaserver/static/js/api_v2/user_client","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/ts_utils","metaserver/static/js/cloud_docs/gdd_migration/ui/controllers/configure_migration_controller"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_){"use strict";var m,f;Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleShortcutsSettingsRow=void 0,r=o.__importStar(r),(function(e){e.ALWAYS=l.intl.formatMessage({id:"7IwKzN",defaultMessage:"Always"}),e.NEVER=l.intl.formatMessage({id:"mfRjuO",defaultMessage:"Never"}),e.ASK_EACH_TIME=l.intl.formatMessage({id:"cO4Fjk",defaultMessage:"Ask each time"}),e.FAILED_TO_FETCH_SETTINGS=l.intl.formatMessage({id:"g63t7P",defaultMessage:"Failed to fetch Google shortcut settings."}),e.FAILED_TO_SAVE_SETTINGS=l.intl.formatMessage({id:"iukQSd",defaultMessage:"Failed to save Google shortcut settings."}),e.TRY_AGAIN=l.intl.formatMessage({id:"Aaxna3",defaultMessage:"Try again"}),e.CLOSE=l.intl.formatMessage({id:"1dhg8/",defaultMessage:"Close"}),e.SECTION_TITLE=l.intl.formatMessage({id:"AnDvHR",defaultMessage:"Google shortcuts settings"}),e.MIGRATION_HEADER=l.intl.formatMessage({id:"ogtWfp",defaultMessage:"Google files migration"}),e.MIGRATION_SUBTEXT=l.intl.formatMessage({id:"/Nj41m",defaultMessage:"Migrate your Google files to Google Drive or convert files ahead of time."}),e.CONFIGURE=l.intl.formatMessage({id:"VknG6u",defaultMessage:"Configure"}),e.COPY_PERMISSIONS_HEADER=l.intl.formatMessage({id:"JPF8nN",defaultMessage:"Maintain file permissions"}),e.COPY_PERMISSIONS_SUBTEXT=l.intl.formatMessage({id:"YzWN7F",defaultMessage:"Allow the same people who have access to the original file to have access to the converted file."})})(m||(m={})),(function(e){e[e.ALWAYS=1]="ALWAYS",e[e.NEVER=2]="NEVER",e[e.ASK_EACH_TIME=3]="ASK_EACH_TIME"})(f||(f={}));const g={[f.ALWAYS]:m.ALWAYS,[f.NEVER]:m.NEVER,[f.ASK_EACH_TIME]:m.ASK_EACH_TIME},v=e=>{switch(e){case f.ALWAYS:return{".tag":"always"};case f.NEVER:return{".tag":"never"};case f.ASK_EACH_TIME:break;default:(0,u.enforceExhaustive)(e)}return{".tag":"ask_each_time"}},E=e=>o.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(t=>setTimeout(t,e))})),h=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const s=new d.UserApiV2Client;try{const o=yield s.ns("cloud_docs").rpc("google_shortcut_settings/get",void 0,{subjectUserId:e.id});t(o)}catch(s){p.Snackbar.show(r.default.createElement(p.Snackbar,{forceDig:!0,title:r.default.createElement(r.default.Fragment,null,m.FAILED_TO_FETCH_SETTINGS," ",r.default.createElement(n.Button,{variant:"transparent",onClick:()=>o.__awaiter(void 0,void 0,void 0,(function*(){p.Snackbar.close(),yield E(1e3),h(e,t)})),inverse:!0},m.TRY_AGAIN)),closeButtonText:m.CLOSE,variant:"fail"}))}})),y=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const s=new d.UserApiV2Client;try{yield s.ns("cloud_docs").rpc("google_shortcut_settings/set",t,{subjectUserId:e.id})}catch(s){p.Snackbar.show(r.default.createElement(p.Snackbar,{forceDig:!0,title:r.default.createElement(r.default.Fragment,null,m.FAILED_TO_SAVE_SETTINGS," ",r.default.createElement(n.Button,{variant:"transparent",onClick:()=>o.__awaiter(void 0,void 0,void 0,(function*(){p.Snackbar.close(),yield E(1e3),y(e,t)})),inverse:!0},m.TRY_AGAIN)),closeButtonText:m.CLOSE,variant:"fail"}))}}));t.GoogleShortcutsSettingsRow=({user:e})=>{const[t,o]=(0,r.useState)(!1),[n,l]=(0,r.useState)(f.ASK_EACH_TIME);return(0,r.useEffect)(()=>{h(e,e=>{l((e=>{switch(e[".tag"]){case"always":return f.ALWAYS;case"never":return f.NEVER;case"ask_each_time":case"other":break;default:(0,u.enforceExhaustive)(e)}return f.ASK_EACH_TIME})(e.copy_permissions_to_google_shortcut)),o(!0)})},[e]),r.default.createElement("div",{className:"account-page-block account-page-block--no-border google-shortcut-settings-block"},r.default.createElement(s.Title,{style:{marginBottom:"var(--spacing__base_unit)"},size:"small"},m.SECTION_TITLE),r.default.createElement(a.ButtonBlock,{label:m.MIGRATION_HEADER,subtext:m.MIGRATION_SUBTEXT,buttonText:m.CONFIGURE,kind:"transparent",buttonAction:{kind:"function",handler:()=>{c.UserActivityLogger.log("web","configure_google_migration_clicked"),(0,_.showConfigureMigrationUiFlow)(e)}},className:"gdd-migration-settings-block"}),t&&r.default.createElement(r.default.Fragment,null,r.default.createElement(i.DropdownBlock,{label:m.COPY_PERMISSIONS_HEADER,subLabel:m.COPY_PERMISSIONS_SUBTEXT,items:g,selected:n,onItemSelected:t=>{c.UserActivityLogger.log("web","copy_permissions_to_google_shortcut_clicked"),l(t),y(e,{copy_permissions_to_google_shortcut:v(t)})},className:"copy-permissions-to-google-shortcut-block"})))},t.GoogleShortcutsSettingsRow.displayName="GoogleShortcutsSettingsRow"})),define("metaserver/static/js/account_page/widgets/linked_apps/logger",["require","exports","tslib","metaserver/static/js/logging/telemetry","metaserver/static/js/logging/hive/schemas/web-app_directory_connected_apps"],(function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appInfoExtras=t.serviceExtras=t.logEvent=void 0;const s=new((r=o.__importStar(r)).HiveLogger);t.logEvent=(e,t)=>{const o=new n.AppDirectoryConnectedAppsRow({event_name:e,event_extras:JSON.stringify(t)});s.log(o)};t.serviceExtras=e=>({app_type:"profile_services",app_name:e});t.appInfoExtras=e=>({app_type:e.type,app_id:"api_app"===e.type?e.id:void 0,action_id:"app_action"===e.type?e.action_id:void 0,app_name:e.name})})),define("metaserver/static/js/logging/hive/schemas/web-app_directory_connected_apps",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppDirectoryConnectedAppsRow=void 0;t.AppDirectoryConnectedAppsRow=class{constructor(e){this.category="web-app_directory_connected_apps",this.user_id=null,this.session_id=null,this.request_id=null,this.url=null,this.event_name=e.event_name,this.event_extras=e.event_extras,Object.seal(this)}}})),define("metaserver/static/js/cloud_docs/cloud_doc_api_client",["require","exports","tslib"],(function(e,t,o){"use strict";function r(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.encryptEmail=t.logTokenInUse=t.getPreferredUrl=t.getTeamSettings=t.setSignInSnackbarAsync=t.getSignInSnackbarAsync=t.setUserEducationSnackbarAsync=t.getUserEducationSnackbarAsync=t.setPassSnackbarAsync=t.getPassSnackbarAsync=t.dismissPreferredEditorPrompt=t.getNavigationProperties=t.getLockProviderAsync=t.getCloudDocToken=void 0,t.getCloudDocToken=function(e,t,n,s){(function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_token",{cloud_doc_id:t},{subjectUserId:e})}))})(e,t).then(n,s)},t.getLockProviderAsync=function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_lock_provider",{file_id:t},{subjectUserId:e})}))},t.getNavigationProperties=function(e,t,n,s){(function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_navigation_properties",{cloud_doc_id:t},{subjectUserId:e})}))})(e,t).then(n,s)},t.dismissPreferredEditorPrompt=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("preferred_editor_prompt/disable",{integration_name:t,preferred_editor_doc_type:n},{subjectUserId:e})}))},t.getPassSnackbarAsync=function(e,t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("pass_snackbar/get",{cloud_doc_id:t},{subjectUserId:e})}))},t.setPassSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("pass_snackbar/set",void 0,{subjectUserId:e})}))},t.getUserEducationSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("user_education_snackbar/get",void 0,{subjectUserId:e})}))},t.setUserEducationSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("user_education_snackbar/set",void 0,{subjectUserId:e})}))},t.getSignInSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("signin_snackbar/get",void 0,{subjectUserId:e})}))},t.setSignInSnackbarAsync=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("signin_snackbar/set",void 0,{subjectUserId:e})}))},t.getTeamSettings=function(e){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("team_settings/get",void 0,{subjectUserId:e})}))},t.getPreferredUrl=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("get_preferred_editor_url",{file_id:t,file_ext:n},{subjectUserId:e})}))},t.logTokenInUse=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function*(){return(yield r()).rpc("log_token_in_use",{doc_id:t,auth_token:n},{subjectUserId:e}).catch(()=>new Promise(()=>null))}))},t.encryptEmail=function(t){return o.__awaiter(this,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{NoAuthApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/noauth_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("logged_out/encrypt_email",{email:t},{})}))}})),define("metaserver/static/js/cloud_docs/create_api",["require","exports","tslib","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/api_v2/user_client","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/create_pointer_modal","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","js/filepath/filepath","metaserver/static/js/logging/hive/schemas/web-modal-activity","metaserver/static/js/clean/ui/async_file_modal_controller","metaserver/static/js/folder_dialog/async","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/browse/api","metaserver/static/js/browse/action_logger","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/core/browser","js/browser/cookies","metaserver/static/js/core/i18n","spectrum/util/uuid_generator","metaserver/static/js/metrics/index","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/create_google_shortcut_modal","metaserver/static/js/cloud_docs/gdd_migration/auth","metaserver/static/js/clean/ts_utils","metaserver/static/js/clean/referrer_cleansing_redirect"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E,h,y,S,b,O,C,M,T,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCreateActionSource=t.createNewPointer=t.createNewGoogleShortcut=t.createNewCloudOnlyDoc=t.createPlaceholderTabForNewCloudDoc=t.constructFormForCreateNewMicrosoftFile=t.createNewFile=t.showAsyncFolderDialog=t.logCreateFileSuccessCallback=t.logCreateFileCallback=t.logCreateFileAttempt=t.getDepthFromPath=t.CloudDocSnackbarId=void 0,l=o.__importStar(l),p=o.__importStar(p),u=o.__importStar(u),f=o.__importStar(f),E=o.__importStar(E);const I=y.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),R=y.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),k=y.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),w=y.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc";t.getDepthFromPath=e=>(e.replace(/\/$/,"").match(/\//g)||[]).length;t.logCreateFileAttempt=(e,t)=>{(0,i.logUserAction)({actionEvent:c.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})};t.logCreateFileCallback=({ts:e,documentType:t,selection_mode:n,emptyFolder:s,error:a})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=(0,b.getMetricsReporter)(),i={};i.document_type=t||"unknown",i.selection_mode=n||"undefined",i.empty_folder=String(s),i.error=a?"true":"false",o.createStats({ns:O.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},i).recordDuration(Date.now()-e,r.TimeUnit.MILLISECONDS)}));t.logCreateFileSuccessCallback=({ts:e,openId:o,selection_mode:r,empty_folder:n})=>s=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:s.documentType,selection_mode:r,emptyFolder:n}),(0,g.logFileCreateSuccess)({uid:s.userId,document_type:s.documentType,time_elapsed:Date.now()-e,open_id:o,selection_mode:r,empty_folder:n}),(0,i.logUserAction)({actionEvent:c.UserActionEventType.CREATE,userId:s.userId,docPathOrId:s.fq_path,actionSource:s.action_source,data:{webOpenId:o}})};t.showAsyncFolderDialog=({user:e,source:o,documentType:r,selection_mode:n,empty_folder:a,handleClickNewFolder:i,initialPath:c})=>{const l=(0,s.isPointerFileType)(r),p=l?R:I,_=l?w:k;u.showFolderDialog({modalName:d.ModalName.CLOUD_DOCS_CREATE,user:e,title:p,primaryActionLabel:_,handleClickNewFolder:i,initialPath:c,useApiV2:!0,onSuccess:(s,i)=>{const c=s||"/";(0,g.logFileCreateClick)({uid:e.id,source:o,action:v.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:(0,t.getDepthFromPath)(c),selection_mode:n,empty_folder:a}),(0,t.createNewFile)({user:e,path:c,documentType:r,source:o,selection_mode:n,empty_folder:a})}})};t.createNewFile=({user:r,path:n,documentType:c,source:l,selection_mode:d,empty_folder:p,defaultUrl:u,useApiV2ForPifsCreation:_,createShortcutForGdssFile:m})=>o.__awaiter(void 0,void 0,void 0,(function*(){return Promise.all([new Promise((t,o)=>{e(["metaserver/static/js/account/email"],t,o)}).then(o.__importStar),new Promise((t,o)=>{e(["metaserver/static/js/account/email_verify_reasons"],t,o)}).then(o.__importStar)]).then(([{EmailVerification:e},{EmailVerificationReasons:o}])=>{if(!e.get_for_user(r).verified_or_show(o.CLOUD_DOCS))return;const f=(0,S.generateUUID)("web-create");if((0,s.isMicrosoftFileType)(c)){(0,t.logCreateFileAttempt)(f,{userId:r.id,action_source:(0,i.getActionSourceFromNewFileMenuType)(l)});const e=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:f,selection_mode:d,empty_folder:p});P({userId:r.id,path:n,documentType:c,logSuccessCallback:e,source:l})}else if((0,s.isPointerFileType)(c))a.CreatePointerModal.showInstance({createOnSubmit:e=>{(0,t.logCreateFileAttempt)(f,{userId:r.id,action_source:(0,i.getActionSourceFromNewFileMenuType)(l)});const o=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:f,selection_mode:d,empty_folder:p});(0,t.createNewPointer)({userId:r.id,pathName:n,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:o,source:l})},defaultUrl:u});else{(0,t.logCreateFileAttempt)(f,{userId:r.id,action_source:(0,i.getActionSourceFromNewFileMenuType)(l)});const e=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:f,selection_mode:d,empty_folder:p});(0,t.createNewCloudOnlyDoc)({user:r,pathName:n,title:y.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:c,logSuccessCallback:e,source:l,openId:f,selection_mode:d,empty_folder:p,useApiV2ForPifsCreation:_,createShortcutForGdssFile:m})}})}));const P=({userId:e,path:o,documentType:r,logSuccessCallback:n,source:s})=>{const a={fq_path:o,extension:r,action_source:(0,t.getCreateActionSource)(s),_subject_uid:String(e),t:h.Cookies.read("__Host-js_csrf")},c=(0,t.constructFormForCreateNewMicrosoftFile)(a);document.body.appendChild(c),c.submit(),n({userId:e,documentType:r,action_source:(0,i.getActionSourceFromNewFileMenuType)(s)})};t.constructFormForCreateNewMicrosoftFile=e=>{const t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(const o of Object.keys(e)){const r=document.createElement("input");r.type="hidden",r.name=o,r.value=e[o],t.appendChild(r)}return t};t.createPlaceholderTabForNewCloudDoc=()=>E.open_tab(s.LOADING_PAGE_URL,!0);t.createNewCloudOnlyDoc=({user:e,pathName:o,title:r,documentType:a,logSuccessCallback:c,source:d,openId:u,selection_mode:_,empty_folder:g,useApiV2ForPifsCreation:v,createShortcutForGdssFile:h})=>{const S=y.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),b=y.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"});if(v&&(a===s.PaperNewFileTypes.PAPER||a===s.PaperNewFileTypes.PAPER_TEMPLATE)){m.Snackbar.sync(S,!0,t.CloudDocSnackbarId);const p=new n.UserApiV2Client,u={".tag":a===s.PaperNewFileTypes.PAPER_TEMPLATE?"paper_template":"paper"};return void p.ns("cloud_docs").rpc("create",{to_path:l.normalize(o)||"/",title:r,cloud_doc_type:u},{subjectUserId:e.id}).then(o=>{m.Snackbar.complete(b,t.CloudDocSnackbarId),c({userId:e.id,documentType:a,fq_path:o.result_path,action_source:(0,i.getActionSourceFromNewFileMenuType)(d)}),E.open_tab(o.url)}).catch(()=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:a,selection_mode:_,emptyFolder:g,error:!0}),m.Snackbar.fail(y.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),t.CloudDocSnackbarId)})}if(h&&Object.values(s.GoogleFileTypes).includes(a))return void(0,C.showCreateGoogleShortcutModal)({fileType:a,onCreate:r=>{(0,t.createNewGoogleShortcut)({user:e,path:l.joinPathWithFileName({fqPath:l.normalize(o)||"/",fileName:r+(r.endsWith(".web")?"":".web")}),documentType:a,source:d,logSuccessCallback:c})}});const O=e=>(e.preventDefault(),e.returnValue="","");window.addEventListener("beforeunload",O);let M=(0,t.createPlaceholderTabForNewCloudDoc)();const T=n=>{m.Snackbar.sync(S,!0,t.CloudDocSnackbarId),f.createCloudDoc({pathName:o,title:r,documentType:a,userId:e.id,onSuccess:({changesets:o,createdFile:r,failureDetails:n})=>{if(n){const e=()=>{c=(0,t.logCreateFileSuccessCallback)({ts:Date.now(),openId:u,selection_mode:_,empty_folder:g}),M=(0,t.createPlaceholderTabForNewCloudDoc)(),T(!1)};M.close(),m.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",O),p.showFileSystemWarningsModal({fsws:n,confirmText:y.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:e})}else if(m.Snackbar.complete(b,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",O),null!==r&&(c({userId:e.id,documentType:a,fq_path:r.fq_path,action_source:(0,i.getActionSourceFromNewFileMenuType)(d)}),M)){let e=r.open_to_url;try{const t=new URL(e);t.searchParams.set("web_open_id",u),e=t.toString()}catch(e){}M.location.replace(e)}},onError:e=>{(0,t.logCreateFileCallback)({ts:Date.now(),documentType:a,selection_mode:_,emptyFolder:g,error:!0}),m.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",O)},checkFSWs:n})};T(!0)};t.createNewGoogleShortcut=({user:e,path:r,documentType:s,source:a,logSuccessCallback:c})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=y.intl.formatMessage({id:"vp4BPc",defaultMessage:"Creating new web shortcut..."}),l=y.intl.formatMessage({id:"QwCwX6",defaultMessage:"Web shortcut created!"});m.Snackbar.sync(o,!0,t.CloudDocSnackbarId);try{if((yield(0,M.ensureUserHasGddMigrationCompatibleLink)(e))!==M.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK)return void m.Snackbar.fail(y.intl.formatMessage({id:"4Mo3Jb",defaultMessage:"Google authentication failed"}),t.CloudDocSnackbarId);const o=new n.UserApiV2Client,{shortcut:d}=yield o.ns("cloud_docs").rpc("create_web_shortcut_to_external_file",{dest_service:{".tag":"gdrive"},dest_doc_type:{".tag":s},shortcut_file_path:r},{subjectUserId:e.id});c({userId:e.id,documentType:s,fq_path:r,action_source:(0,i.getActionSourceFromNewFileMenuType)(a)}),m.Snackbar.complete(l,t.CloudDocSnackbarId),(0,A.safe_open_tab_and_redirect)(d.url)}catch(e){m.Snackbar.fail((e=>{switch(e[".tag"]){case"invalid_dest_service":return y.intl.formatMessage({id:"naF0qP",defaultMessage:"The provided destination service is not valid"});case"invalid_dest_doc_type":return y.intl.formatMessage({id:"7dGke6",defaultMessage:"The selected destination document type is not valid"});case"invalid_shortcut_file_path":return y.intl.formatMessage({id:"OzwVRj",defaultMessage:"The file path provided is not valid"});case"missing_linked_service":return y.intl.formatMessage({id:"ZjHKoP",defaultMessage:"The provided linked service could not be found"});case"external_api_error":switch(e.error_sub_type[".tag"]){case"create_folder":return y.intl.formatMessage({id:"R4+Bie",defaultMessage:"Could not create destination folder"});case"find_unused_filename":return y.intl.formatMessage({id:"BaVK9c",defaultMessage:"Could not find unused filename"});case"create_file":return y.intl.formatMessage({id:"O6K4d3",defaultMessage:"Could not create file"});case"upload":case"delete_file":case"grant_role":case"other":break;default:(0,T.enforceExhaustive)(e.error_sub_type)}break;case"shortcut_already_exists":case"quota_exceeded":case"other":break;default:(0,T.enforceExhaustive)(e)}return y.intl.formatMessage({id:"ANR8dr",defaultMessage:"Could not create web shortcut"})})(e.error),t.CloudDocSnackbarId)}}));t.createNewPointer=({userId:e,pathName:t,name:o,url:r,onError:a,logSuccessCallback:d,source:p})=>{const u=new n.UserApiV2Client,f=y.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),g=y.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return m.Snackbar.sync(f,!0,"create-cloud-shortcut"),u.ns("cloud_docs").rpc("create",{to_path:l.normalize(t)||"/",title:o,cloud_doc_type:c.SimplePointer,pointer_url:r},{subjectUserId:e}).then(t=>{d({userId:e,documentType:s.PointerFileTypes.SIMPLE_POINTER,fq_path:t.result_path,action_source:(0,i.getActionSourceFromNewFileMenuType)(p)}),_.Modal.close(),m.Snackbar.complete(`${g} "${l.filename(t.result_path)}"`,"create-cloud-shortcut")}).catch(e=>{a(),m.Snackbar.fail(y.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")})};t.getCreateActionSource=e=>{switch(e){case s.NewFileMenuFromType.BROWSE:return s.ActionSourceValue.WEB_BROWSE;case s.NewFileMenuFromType.HOME:return s.ActionSourceValue.WEB_HOME;default:return s.ActionSourceValue.WEB}}})),define("metaserver/static/js/cloud_docs/create_pointer_modal",["require","exports","tslib","react","metaserver/static/js/cloud_docs/pointers_common","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","metaserver/static/js/core/i18n","dig-components/modal","dig-components/buttons"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerModal=void 0,r=o.__importDefault(r);const d=i.intl.formatMessage({id:"8yzGEK",defaultMessage:"Create a new shortcut"}),p=i.intl.formatMessage({id:"S8dvWz",defaultMessage:"Create"}),u=i.intl.formatMessage({id:"I5Fo4y",defaultMessage:"Creating..."}),_=i.intl.formatMessage({id:"vPeF94",defaultMessage:"Name"}),m=i.intl.formatMessage({id:"nYdrYR",defaultMessage:"URL"}),f=i.intl.formatMessage({id:"U1i5X8",defaultMessage:"Invalid URL"});class g extends r.default.Component{constructor(e){super(e),this.onChange=e=>{this.setState({pointerData:e})},this.handleCreateOnClick=()=>{this.setState({creationInProgress:!0}),this.props.createOnSubmit({pointerData:{name:this.state.pointerData.name.trim(),url:this.state.pointerData.url.trim()},onError:this.handleSubmitError})},this.handleSubmitError=()=>{this.setState({creationInProgress:!1})},this.closeModal=()=>{a.Modal.close()},this.state={pointerData:{name:"",url:""},creationInProgress:!1}}render(){const e=n.CreatePointerFields.canSubmit(this.state.pointerData)&&!this.state.creationInProgress;return r.default.createElement(c.Modal,{title:d,"aria-label":"Shortcut Creation Modal",open:!0},r.default.createElement(c.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(c.Modal.Title,null,d)),r.default.createElement(c.Modal.Body,{hasVerticalSpacing:!1},r.default.createElement(n.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:_,urlLabel:m,urlValidationMessage:f,urlPrepopulateFunction:()=>Promise.resolve(this.props.defaultUrl)})),r.default.createElement(c.Modal.Footer,null,r.default.createElement(l.Button,{variant:"opacity",onClick:this.closeModal},i.intl.formatMessage({id:"gZIlfg",defaultMessage:"Cancel"})),r.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:this.handleCreateOnClick},this.state.creationInProgress?u:p)))}static showInstance(e){return a.Modal.showInstance(r.default.createElement(v,Object.assign({},e)))}}t.CreatePointerModal=g,g.displayName="CreatePointerModal";const v=(0,s.requireCssWithComponent)(g,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("metaserver/static/js/cloud_docs/event_logging",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/logging/hive/schemas/web-user-action","metaserver/static/js/logging/telemetry","metaserver/static/js/file_viewer/constants","metaserver/static/js/cloud_docs/constants","metaserver/static/js/perf_tools/web_timing_utils","metaserver/static/js/core/exception","js/filepath/filepath"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLoggedOutUXSnackBarAction=t.logInterstitialLoginAction=t.logFileConvertPromptAction=t.logFileOpenPromptAction=t.getActionSourceFromNewFileMenuType=t.getActionSourceFromSourceArgs=t.getActionSourceFromSurface=t.checkAndLogNpu=t.logLoggedOutUserAction=t.logUserAction=t.logClientEvent=t.logViewEvent=t.getStartTime=void 0,a=o.__importStar(a),l=o.__importStar(l);let f=void 0;t.getStartTime=()=>{try{f=f||window.performance.timing.fetchStart}catch(e){(0,_.reportStack)("Unable to get fetchStart from browser.",{severity:_.SEVERITY.NONCRITICAL}),f=a.start_time()}return f},t.logViewEvent=function(e,t,o){const n={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":o}}]};(new r.UserApiV2Client).ns("seen_state").rpc("log_file_view",n,{subjectUserId:e})},t.logClientEvent=function(e,o,r,i,c){const l=c||[];l.push({key:"time_on_page_with_redirect",value:a.time_since_start().toString()}),l.some(e=>"time_now"===e.key)||l.push({key:"time_now",value:Date.now().toString()}),(new n.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:s.editorTypeToClient[o],doc_id:e,event_name:r,auth_token:i,time_on_page:u.WebTimingUtil.getNow()-(0,t.getStartTime)(),extras:l},{})},t.logUserAction=function(e){const t=(new r.UserApiV2Client).ns("cloud_docs");let o;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(o={".tag":"path_or_id",path_or_id:e.docPathOrId});const n=e.data&&e.data.webOpenId,s=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;t.rpc("log_user_action",{action:e.actionEvent,doc_id:o,source:e.actionSource,open_id:n,orig_dest:s,routing_dest:a,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){const t=(new n.NoAuthApiV2Client).ns("cloud_docs");let o;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(o={".tag":"path_or_id",path_or_id:e.docPathOrId});const r=e.data&&e.data.webOpenId,s=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;t.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:o,source:e.actionSource,open_id:r,orig_dest:s,routing_dest:a,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,o,n,s){(new r.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:(0,m.file_extension)(o),cloud_editor:n,platform:s},{subjectUserId:e})};t.getActionSourceFromSurface=e=>"search"===e?s.UserActionSourceType.WEB_SEARCH:"previews"===e?s.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?s.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?s.UserActionSourceType.WEB_BROWSE:s.UserActionSourceType.WEB;t.getActionSourceFromSourceArgs=e=>e.fileViewOrigin===d.FileViewOriginType.SEARCH?s.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===d.FileViewOriginType.BROWSE?s.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===d.FileViewOriginType.HOME?s.UserActionSourceType.WEB_HOME:s.UserActionSourceType.WEB;t.getActionSourceFromNewFileMenuType=e=>{switch(e){case p.NewFileMenuFromType.BROWSE:return s.UserActionSourceType.WEB_BROWSE;case p.NewFileMenuFromType.HOME:return s.UserActionSourceType.WEB_HOME;default:return s.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,o,r,n){(new l.HiveLogger).log(new c.WebUserActionRow({user_id:e,event_name:i.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:o,prompt_action:r,ask_again:n}}))},t.logFileConvertPromptAction=function(e,t,o,r){(new l.HiveLogger).log(new c.WebUserActionRow({user_id:e,event_name:i.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:o,file_extension:r}}))},t.logInterstitialLoginAction=function(e,t,o){(new l.HiveLogger).log(new c.WebUserActionRow({event_name:i.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:o}}))},t.logLoggedOutUXSnackBarAction=function(e,t,o,r){(new l.HiveLogger).log(new c.WebUserActionRow({event_name:i.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:o||"",logged_out_ux_paper_variant:r||""}}))}})),define("metaserver/static/js/cloud_docs/open_with_utils",["require","exports","tslib","typescript/libraries/shared/apex-metrics/src/index","metaserver/static/js/core/browser","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/types","metaserver/static/js/clean/referrer_cleansing_redirect","metaserver/static/js/cloud_docs/constants","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/utils","metaserver/static/js/clean/open_with","spectrum/util/uuid_generator","metaserver/static/js/core/browser_detection","metaserver/static/js/cloud_docs/create_api","metaserver/static/js/metrics/index"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g){"use strict";let v;Object.defineProperty(t,"__esModule",{value:!0}),t.getGoogleEditorType=t.isCloudBasedDoc=t.isShortcut=t.isGoogleDoc=t.getOpenWithWopiEditorInfo=t.getOpenWithGoogleEditorInfo=t.getOpenWithCloudEditorInfo=t.OpenWithCloudDocProvider=t.openCloudDoc=t.openWithCloudEditor=t.fileToOpenWithParams=t.openCloudEditorUrl=t.isInEdgeIframe=t.handleError=t.decodeAPIError=t.getCloudEditorUrl=t.getCloudEditorUrlCached=void 0,c=o.__importStar(c),u=o.__importDefault(u),m=o.__importStar(m);t.getCloudEditorUrlCached=(e,r)=>o.__awaiter(void 0,void 0,void 0,(function*(){return v||(v=(0,t.getCloudEditorUrl)(e,r)),v}));function E(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function h(e){switch(E(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}t.getCloudEditorUrl=(t,r)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(yield(function(){return o.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/api_v2/user_client"],t,o)}).then(o.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("get_cloud_editor_url",{file_id:r},{subjectUserId:t})})),t.decodeAPIError=E,t.handleError=h;function y(e,t,o,r,s,c,l){const p=(0,_.generateUUID)("web_open_id"),u=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:s,web_open_id:p});c&&u.updateQuery({ignore_lock:"1"});const m=u.toString();m&&(void 0===l&&(l=i.UserActionSourceType.WEB),(0,a.logUserAction)({actionEvent:i.UserActionEventType.PRE_OPEN,userId:r,docPathOrId:o,actionSource:l,data:{webOpenId:p}}),null!=t?(0,n.redirect)(m,t):(0,n.open_tab)(m))}t.isInEdgeIframe=()=>{let e=!1;if(m.edge||m.msie||m.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=y;t.fileToOpenWithParams=e=>({fileId:e.file_id,openToUrl:e.open_to_url});t.openWithCloudEditor=({fileId:e,openToUrl:n},a,i,c,l)=>o.__awaiter(void 0,void 0,void 0,(function*(){try{const o=performance.now(),d=(0,g.getMetricsReporter)(),p={};try{p.editor=i,l&&(p.source=l[".tag"]);const u=(0,t.isInEdgeIframe)();if(p.isInEdgeIframe=String(u),n&&n.startsWith("https://www.dropbox.com/scl/fi/")){p.usedOpenToURLFromFile="true",y({cloud_editor_url:n},null,e,a,i,c,l)}else{p.usedOpenToURLFromFile="false";const o=u?null:(0,f.createPlaceholderTabForNewCloudDoc)();y(u?yield(0,t.getCloudEditorUrlCached)(a,e):yield(0,t.getCloudEditorUrl)(a,e),o,e,a,i,c,l)}p.error="false"}catch(e){p.error="true",h(e)}finally{d.createStats({ns:s.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},p).recordDuration(performance.now()-o,r.TimeUnit.MILLISECONDS)}}catch(e){h(e)}}));var S;t.openCloudDoc=(t,r,l)=>{if(l||(l=i.UserActionSourceType.WEB),t.href)if((0,s.isPointerByExtension)(t.ns_path))c.safe_open_tab_and_redirect(t.href),(0,a.logUserAction)({actionEvent:i.UserActionEventType.PRE_OPEN,userId:r.id,docPathOrId:t.file_id,actionSource:l});else{const e=(0,_.generateUUID)("web_open_id"),o=d.URI.parse(t.href).updateQuery("web_open_id",e).toString();(0,n.open_tab)(o),(0,a.logUserAction)({actionEvent:i.UserActionEventType.PRE_OPEN,userId:r.id,docPathOrId:t.file_id,actionSource:l,data:{webOpenId:e}})}else{const n=(0,f.createPlaceholderTabForNewCloudDoc)();new Promise((t,o)=>{e(["metaserver/static/js/previews/data/actions"],t,o)}).then(o.__importStar).then(e=>e.fetchPreviewUrl(t,r)).then(e=>{e&&null!==n&&c.redirect(e,n,!0)})}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(S=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={}));t.getOpenWithCloudEditorInfo=(e,o,r,n)=>{const s=[],a=(0,t.getOpenWithWopiEditorInfo)(e,o,n);a&&r.wopi&&s.push(a);const i=(0,t.getOpenWithGoogleEditorInfo)(e,o,n);return i&&r.gdd&&s.push(i),s};t.getOpenWithGoogleEditorInfo=(e,o,r)=>{const n=C(e,o);return n?{text:l.DSS_TYPE_TO_TEXT[n],iconUrl:l.DSS_TYPE_TO_OPEN_WITH_ICONS[n],handler:()=>(0,t.openWithCloudEditor)((0,t.fileToOpenWithParams)(e),o.id,n,!1,r),provider:S.GoogleDSS}:null};function b(e){return[".gdoc",".gsheet",".gslides"].indexOf((0,p.getFileExt)(e))>=0}function O(e){return".web"===(0,p.getFileExt)(e)}function C(e,t){const o=(0,p.getFileExt)(e);for(const e of Object.keys(l.DSS_TYPE_TO_SUPPORTED_EXTS)){const t=e;if(l.DSS_TYPE_TO_SUPPORTED_EXTS[t].indexOf(o)>=0)return t}switch(o){case".gdoc":return l.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return l.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return l.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}t.getOpenWithWopiEditorInfo=(e,o,r)=>{const n=u.default.getWopiOpenWithButtonInfo(e);return n?{text:n.name,spriteName:n.icon,handler:()=>(0,t.openWithCloudEditor)((0,t.fileToOpenWithParams)(e),o.id,n.editor,!1,r),provider:S.OfficeOnline}:null},t.isGoogleDoc=b,t.isShortcut=O,t.isCloudBasedDoc=function(e){return!!b(e)||!!O(e)},t.getGoogleEditorType=C})),define("metaserver/static/js/cloud_docs/pointers_common",["require","exports","tslib","ts-key-enum","react","dig-components/text_fields"],(function(e,t,o,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerFields=void 0,n=o.__importStar(n);class a extends n.Component{constructor(){super(...arguments),this.handleKeyPress=e=>{e.key===r.Key.Enter&&a.canSubmit({name:this.props.name,url:this.props.url})&&this.props.onSubmit()},this.handleNameChange=e=>{const t=e.target.value;this.props.onChange({name:t,url:this.props.url})},this.handleUrlChange=e=>{const t=e.target.value;this.props.onChange({name:this.props.name,url:t})},this.setNameFieldRef=e=>{this.nameRef=e}}render(){const e=""===this.props.url||a.isUrlValid(this.props.url);let t="";return e||(t=this.props.urlValidationMessage),n.createElement("div",{className:"create-pointer--fields"},n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),n.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,n.createElement(s.TextInput,{id:"create-pointer--link_input",className:"create-pointer--link_input",isInvalid:!e,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,placeholder:this.props.urlPlaceholder,autoFocus:!0}))),n.createElement("div",{className:"create-pointer--url-validation-warning"},t),n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),n.createElement(s.TextInput,{id:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,ref:this.setNameFieldRef,placeholder:this.props.namePlaceholder})))}componentDidMount(){return o.__awaiter(this,void 0,void 0,(function*(){if(this.props.urlPrepopulateFunction){const e=yield this.props.urlPrepopulateFunction();e&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus())}}))}}t.CreatePointerFields=a,a.isUrlValid=e=>/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim()),a.canSubmit=e=>""!==e.name&&""!==e.url&&a.isUrlValid(e.url),a.displayName="CreatePointerFields"})),define("metaserver/static/js/cloud_docs/preferred_editor_utils",["require","exports","tslib","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/core/exception","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/utils","metaserver/static/js/cloud_docs/types","react","js/filepath/filepath","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/core/uri","metaserver/static/js/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","metaserver/static/js/cloud_docs/preferred_editor_constants","metaserver/static/js/cloud_docs/create_api"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreferredEditorPrompt=t.openInPreferredEditor=t.hasPreferredEditorSupport=void 0,l=o.__importDefault(l),t.hasPreferredEditorSupport=function(e){const t=(0,i.getFileExt)(e);return f.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,o,r,l){const d=(0,i.getFileExt)(t),v=o[e.id];let E="";if(v)try{const o=v[f.EXTENSION_TO_DOC_TYPE[d]],i=o===f.PreferredEditorTypes.GoogleDSS||o===f.PreferredEditorTypes.OfficeOnline,h=(0,m.generateUUID)("web_open_id");if(t.is_in_vault_folder)return i&&(0,a.logUserAction)({actionEvent:c.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,a.getActionSourceFromSourceArgs)(l),data:{webOpenId:h},extra:{block_vault_content:"true"}}),void r();if(i){const o=(0,g.createPlaceholderTabForNewCloudDoc)();(0,p.getCloudEditorUrl)(e.id,t.file_id).then(n=>{E=u.URI.parse(n.cloud_editor_url).updateQuery("web_open_id",h).toString(),o?o.location.replace(E):r(),(0,a.logUserAction)({actionEvent:c.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,a.getActionSourceFromSourceArgs)(l),data:{webOpenId:h}})}).catch(e=>{(0,s.reportStack)("Error getting cloud editor url from preferred editor open.",{severity:s.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:d,preferred_editor_configs:v,error:e.message}}),o&&o.close(),r()})}else(0,_.getPreferredUrl)(e.id,t.file_id,d).then(o=>{o.preferred_editor_url&&(E=u.URI.parse(o.preferred_editor_url).updateQuery("web_open_id",h).toString(),(0,a.logUserAction)({actionEvent:c.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:(0,a.getActionSourceFromSourceArgs)(l),data:{webOpenId:h}}),(0,n.redirect)(E))}).catch(e=>{(0,s.reportStack)("Error getting preferred editor url from preferred editor open.",{severity:s.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:d,preferred_editor_configs:v,error:e.message}})}),r()}catch(e){(0,s.reportStack)("Error opening docs in preferred editor.",{severity:s.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:E,file_ext:d,preferred_editor_configs:v,error:e.message}}),r()}else r()},t.getPreferredEditorPrompt=function(e,t){const o="."+(0,d.file_extension)(e),n=f.EXTENSION_TO_DOC_TYPE[o],s=f.INTEGRATION_NAME_TO_PROMPT[t][n];return s?{title:r.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:o,web_editor_name:s,b:e=>l.default.createElement("b",null,e)}),body:r.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:o,web_editor_name:s,b:e=>l.default.createElement("b",null,e)})}:null}})),define("metaserver/static/js/cloud_docs/preferred_editor_constants",["require","exports","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/types"],(function(e,t,o,r){"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationNameToPreferredEditorEnums=t.INTEGRATION_NAME_TO_PROMPT=t.PREFERRED_EDITOR_SUPPORTED_EXTS=t.EXTENSION_TO_DOC_TYPE=t.PreferredEditorOptionsMap=t.PreferredEditorDocTypes=t.PreferredEditorTypes=void 0,(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(n=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(s=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap={[s.WORD]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:o.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},[s.EXCEL]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:o.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},[s.POWERPOINT]:{1:o.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:o.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:o.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})}},t.EXTENSION_TO_DOC_TYPE={".docx":s.WORD,".doc":s.WORD,".xlsx":s.EXCEL,".xls":s.EXCEL,".pptx":s.POWERPOINT,".ppt":s.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT={[r.IntegrationName.GOOGLE_DSS]:{[s.WORD]:o.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),[s.EXCEL]:o.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),[s.POWERPOINT]:o.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},[r.IntegrationName.OFFICE_ONLINE]:{[s.WORD]:o.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),[s.EXCEL]:o.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),[s.POWERPOINT]:o.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"})},[r.IntegrationName.PAPER_INTEGRATION]:{}},t.IntegrationNameToPreferredEditorEnums={[r.IntegrationName.GOOGLE_DSS]:n.GoogleDSS,[r.IntegrationName.OFFICE_ONLINE]:n.OfficeOnline,[r.IntegrationName.PAPER_INTEGRATION]:n.Unknown}})),define("metaserver/static/js/cloud_docs/utils",["require","exports","js/filepath/filepath","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/cloud_docs/types"],(function(e,t,o,r,n){"use strict";function s(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInvalidURLFilenameChars=t.replaceInvalidFilenameChars=t.integrationNameToShareActionOrigin=t.getFileExt=void 0,t.getFileExt=function(e){let t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=(0,o.file_extension)(e.filename),t&&(t="."+t)):(t=(0,o.file_extension)(e),t&&(t="."+t)),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case n.IntegrationName.GOOGLE_DSS:return r.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case n.IntegrationName.PAPER_INTEGRATION:return r.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case n.IntegrationName.OFFICE_ONLINE:return r.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=s,t.replaceInvalidURLFilenameChars=function(e){return s(e).replace(/\ /g,"-")}})),define("metaserver/static/js/account_page/widgets/desktop_settings/view",["require","exports","tslib","metaserver/static/js/core/i18n","react","js/browser/cookies","metaserver/static/js/account_page/components/dropdown_block","metaserver/static/js/core/notify"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopSettings=void 0,n=o.__importDefault(n);const c={desktopSettingsHeader:r.intl.formatMessage({id:"8r3ApF",defaultMessage:"Paper desktop app"}),desktopSettingsMessage:r.intl.formatMessage({id:"z6Rf6I",defaultMessage:"Choose what happens when you click a link to a Paper doc on this computer."}),desktopOption:r.intl.formatMessage({id:"pCdNnf",defaultMessage:"Open in desktop app"}),webOption:r.intl.formatMessage({id:"1NiPiC",defaultMessage:"Open in web browser"})},l={0:c.desktopOption,1:c.webOption};class d extends n.default.PureComponent{constructor(e){super(e),this.handleChangeDesktopAutoRedirect=e=>{0===Number(e)?this.enableDesktopAutoRedirectForDevice():this.disableDesktopAutoRedirectForDevice(),this.setState({desktopAutoRedirectEnabled:0===Number(e)}),i.Notify.success(r.intl.formatMessage({id:"MmMgu9",defaultMessage:"Paper app setting updated."}))},this.state={desktopAutoRedirectEnabled:this.isDesktopAutoRedirectEnabledForDevice()}}isDesktopAutoRedirectEnabledForDevice(){const e=this.getDesktopAutoRedirectSnoozeForDevice();return Date.now()>e}getDesktopAutoRedirectSnoozeForDevice(){const e=s.Cookies.read("dc_ars")||"",t=parseFloat(e);return isNaN(t)?"0"===s.Cookies.read("dc_ar")?2**42:0:t}enableDesktopAutoRedirectForDevice(){this.setDesktopAutoRedirectForDevice(0)}disableDesktopAutoRedirectForDevice(){this.setDesktopAutoRedirectForDevice(2**42)}setDesktopAutoRedirectForDevice(e){s.Cookies.create("dc_ars",`${e}`,730,".dropbox.com"),s.Cookies.delete("dc_ar")}render(){const e=this.state.desktopAutoRedirectEnabled;return n.default.createElement(a.DropdownBlock,{label:c.desktopSettingsHeader,subLabel:c.desktopSettingsMessage,selected:e?0:1,items:l,onItemSelected:this.handleChangeDesktopAutoRedirect,className:"paper-desktop-connected-apps-dropdown"})}}t.DesktopSettings=d,d.displayName="DesktopSettings"})),define("metaserver/static/js/account_page/widgets/preferred_editor/api",["require","exports","tslib","metaserver/static/js/api_v2/user_client"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preferredEditorSet=t.preferredEditorGet=void 0;t.preferredEditorGet=e=>o.__awaiter(void 0,void 0,void 0,(function*(){return(new r.UserApiV2Client).ns("cloud_docs").rpc("preferred_editor/get",void 0,{subjectUserId:e})}));t.preferredEditorSet=(e,t,n)=>o.__awaiter(void 0,void 0,void 0,(function*(){return(new r.UserApiV2Client).ns("cloud_docs").rpc("preferred_editor/set",{editor_enum:Number(n),doc_type:t},{subjectUserId:e})}))})),define("metaserver/static/js/account_page/widgets/preferred_editor/view",["require","exports","tslib","react","styled-components","spectrum/icon_partners/index","metaserver/static/js/account_page/components/action_table","metaserver/static/js/clean/active_user","dig-components/buttons","dig-components/menu","dig-components/typography","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/i18n","metaserver/static/js/account_page/widgets/preferred_editor/api","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/cloud_docs/preferred_editor_constants"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreferredEditors=void 0,r=o.__importDefault(r),n=o.__importDefault(n),m=o.__importStar(m);class E extends a.ActionTable{}const h=n.default.div`
  display: flex;
  align-items: center;
`,y=n.default.span`
  margin-right: var(--spacing__base_unit);
  margin-top: 6px;
`;class S extends r.default.Component{constructor(e){super(e),this.preferredEditorGet=e=>m.preferredEditorGet(e).then(e=>{const t=e.preferred_editor_map;for(const e of Object.keys(t)){const o=e;t[o]===v.PreferredEditorTypes.Unknown?t[o]=v.PreferredEditorTypes.FileViewer:this.state.supportedEditorTypes[t[o]]||(t[o]=v.PreferredEditorTypes.FileViewer)}this.setState({preferredEditors:t})}).catch(e=>{p.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}),this.teamSettingsGet=e=>o.__awaiter(this,void 0,void 0,(function*(){const t=this.state.supportedEditorTypes;try{const o=yield(0,f.getTeamSettings)(e);t[v.PreferredEditorTypes.GoogleDSS]=o.settings[g.CloudDocProviderIntegration.GDD_INTEGRATION][".tag"]===g.IntegrationCreateAndEdit[".tag"],this.setState({supportedEditorTypes:t})}catch(e){e.error&&"not_in_team"===e.error[".tag"]?t[v.PreferredEditorTypes.GoogleDSS]=!0:p.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}})),this.populateSettings=()=>o.__awaiter(this,void 0,void 0,(function*(){this.state.user.is_team&&(yield this.teamSettingsGet(this.state.user.id)),yield this.preferredEditorGet(this.state.user.id),this.setState({allSettingsFetched:!0}),(0,u.mark_time_to_interactive)()})),this.preferredEditorSet=(e,t,o)=>m.preferredEditorSet(e,t,o).then(()=>{const e=this.state.preferredEditors;e[t]=o,this.setState({preferredEditors:e})}).catch(e=>{p.Snackbar.fail(_.intl.formatMessage({id:"xfMCig",defaultMessage:"Ooops, something went wrong."}))}),this.renderEditorDetail=(e,t)=>{switch(t){case"file_type":return this.renderFileType(e);case"extensions":return e.extensions;case"open_with":const t=e.file_type,o=this.state.preferredEditors[t],n=v.PreferredEditorOptionsMap[t][o],s=[],a=e=>{this.handleSelection(t,e)},i=t+"-preferred-editor";for(const e of Object.keys(this.state.supportedEditorTypes)){const o=Number(e);o==v.PreferredEditorTypes.GoogleDSS&&this.props.gddMigrationHideDefaultApps||this.state.supportedEditorTypes[o]&&o!==v.PreferredEditorTypes.Unknown&&(s[o]=v.PreferredEditorOptionsMap[t][o])}return r.default.createElement(l.Menu.Wrapper,{className:i,style:{display:"block"},onSelection:a},({getContentProps:e,getTriggerProps:t})=>r.default.createElement(r.default.Fragment,null,r.default.createElement(c.Button,Object.assign({},t(),{withDropdownIcon:!0,style:{width:"100%"},variant:"outline"}),r.default.createElement("span",{style:{flexGrow:2,textAlign:"left"}},n)),r.default.createElement(l.Menu.Content,Object.assign({},e()),r.default.createElement(l.Menu.Segment,null,this.renderMenuItems(s,o)))))}return null};const t=(0,i.mustGetActiveUser)();this.state={preferredEditors:{[v.PreferredEditorDocTypes.WORD]:v.PreferredEditorTypes.FileViewer,[v.PreferredEditorDocTypes.EXCEL]:v.PreferredEditorTypes.FileViewer,[v.PreferredEditorDocTypes.POWERPOINT]:v.PreferredEditorTypes.FileViewer},supportedEditorTypes:{[v.PreferredEditorTypes.Unknown]:!0,[v.PreferredEditorTypes.FileViewer]:!0,[v.PreferredEditorTypes.GoogleDSS]:!t.is_team,[v.PreferredEditorTypes.OfficeOnline]:!0},allSettingsFetched:!1,user:t}}componentDidMount(){this.populateSettings()}renderFileType(e){const t=r.default.createElement(s.IconPartners,{name:e.icon_name,width:"24px",height:"24px"});return r.default.createElement(h,{className:"app-name"},r.default.createElement(y,{className:"app-name__icon"},t),r.default.createElement("span",null,e.name))}renderMenuItems(e,t){const o=[];for(const n of Object.keys(e)){const s=Number(n);o.push(r.default.createElement(l.Menu.SelectItem,{key:s,value:s,selected:s===t},e[s]))}return o}handleSelection(e,t){this.state.preferredEditors[e]!==t&&this.preferredEditorSet(this.state.user.id,e,t)}getPreferredEditorInfo(){const e=[];return e.push({id:0,name:_.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),icon_name:"microsoft_docx",extensions:".docx, .doc",file_type:v.PreferredEditorDocTypes.WORD,preferredEditor:this.state.preferredEditors[v.PreferredEditorDocTypes.WORD]}),e.push({id:1,name:_.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),icon_name:"microsoft_xlsx",extensions:".xlsx, .xls",file_type:v.PreferredEditorDocTypes.EXCEL,preferredEditor:this.state.preferredEditors[v.PreferredEditorDocTypes.EXCEL]}),e.push({id:2,name:_.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),icon_name:"microsoft_pptx",extensions:".pptx, .ppt",file_type:v.PreferredEditorDocTypes.POWERPOINT,preferredEditor:this.state.preferredEditors[v.PreferredEditorDocTypes.POWERPOINT]}),e}render(){const e={keys:["file_type","extensions","open_with"],headers:{file_type:_.intl.formatMessage({id:"cHI0C1",defaultMessage:"File type"}),extensions:_.intl.formatMessage({id:"ZWvP4o",defaultMessage:"Extensions"}),open_with:_.intl.formatMessage({id:"jqiXoh",defaultMessage:"Open with"})},data:this.getPreferredEditorInfo(),renderRowDetail:this.renderEditorDetail,onClosePressed:()=>{},hideClose:()=>!0,dismissAriaLabel:()=>"",dismissHeaderAriaLabel:"",hasActionsColumn:!1},t=_.intl.formatMessage({id:"tUQkb5",defaultMessage:"Default editing apps"});return this.state.allSettingsFetched?r.default.createElement("div",{className:"account-page-block preferred-editor-settings"},r.default.createElement(d.Title,{style:{marginBottom:"var(--spacing__base_unit)"},size:"small"},t),r.default.createElement(d.Text,{size:"small",color:"faint",style:{display:"inline-block",marginBottom:"var(--spacing__unit--2)"}},_.intl.formatMessage({id:"U5HRoh",defaultMessage:"You can select how you’d like each file type to open in Dropbox."})),r.default.createElement(E,Object.assign({},e))):null}}t.PreferredEditors=S,S.displayName="PreferredEditors"})),define("metaserver/static/js/vault/components/vault_account_section_async",["require","exports","tslib","react"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncVaultAccountSection=void 0,r=o.__importDefault(r);const{lazy:n,Suspense:s}=r.default,a=n(()=>o.__awaiter(void 0,void 0,void 0,(function*(){const{StyledVaultAccountSection:t}=yield new Promise((t,o)=>{e(["metaserver/static/js/vault/components/vault_account_section"],t,o)}).then(o.__importStar);return{default:t}})));t.AsyncVaultAccountSection=e=>r.default.createElement(s,{fallback:r.default.createElement("div",null)},r.default.createElement(a,Object.assign({},e)))})),define("metaserver/static/js/cloud_docs/gdd_migration/auth",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/profile_services/profile_services_constants"],(function(e,t,o,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUserHasGddMigrationCompatibleLink=t.fetchUserHasGddMigrationCompatibleLink=t.GddMigrationCompatibleLinkStatus=void 0,s=o.__importDefault(s);const a=["documents"];var i;function c(e,t){return o.__awaiter(this,void 0,void 0,(function*(){const o=new r.UserApiV2Client,n=yield o.ns("profile_services").rpc("list_linked_services",void 0,{subjectUserId:e.id});let s=!1;for(const e of n.linked_services){if("google"===e.service_type[".tag"]&&("is_connected"===e.connection_state[".tag"]&&a.every(t=>e.granted_permissions.some(e=>e[".tag"]===t))&&(s=!0,!t||e.display_name===t)))return i.HAS_COMPATIBLE_LINK}return s?i.HAS_INCOMPATIBLE_LINK:i.NOT_LINKED}))}(function(e){e[e.HAS_COMPATIBLE_LINK=0]="HAS_COMPATIBLE_LINK",e[e.HAS_INCOMPATIBLE_LINK=1]="HAS_INCOMPATIBLE_LINK",e[e.NOT_LINKED=2]="NOT_LINKED"})(i=t.GddMigrationCompatibleLinkStatus||(t.GddMigrationCompatibleLinkStatus={})),t.fetchUserHasGddMigrationCompatibleLink=c,t.ensureUserHasGddMigrationCompatibleLink=function(e){return o.__awaiter(this,void 0,void 0,(function*(){const t=e.email,l=yield c(e,t);if(l===i.HAS_COMPATIBLE_LINK)return i.HAS_COMPATIBLE_LINK;if(l===i.HAS_INCOMPATIBLE_LINK)try{yield(function(e){return o.__awaiter(this,void 0,void 0,(function*(){const t=new r.UserApiV2Client;yield t.ns("profile_services").rpc("unlink",{service:{".tag":"google"}},{subjectUserId:e.id})}))})(e)}catch(e){}const d=new n.ProfileServicesLinkingHandler,p=yield d.auth_service_with_user_promise(s.default.GOOGLE,e.id,null,"link_read_files",void 0,void 0,a,void 0,t);return p.success?p.display_name===t?i.HAS_COMPATIBLE_LINK:i.HAS_INCOMPATIBLE_LINK:i.NOT_LINKED}))}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/controllers/configure_migration_controller",["require","exports","tslib","react","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/intro_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/whats_happening_to_google_files_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/what_do_you_want_to_do_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/link_google_account_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/could_not_connect_to_google_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/recommend_move_to_google_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_convert_to_ms_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_migrate_to_google_modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template","metaserver/static/js/cloud_docs/gdd_migration/auth","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/components/ui/modal","metaserver/static/js/cloud_docs/gdd_migration/ui/utils","metaserver/static/js/clean/ts_utils"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E){"use strict";var h,y;Object.defineProperty(t,"__esModule",{value:!0}),t.showConfigureMigrationUiFlow=t.MigrationType=void 0,r=o.__importStar(r),(function(e){e.MIGRATE_TO_GOOGLE="MIGRATE_TO_GOOGLE",e.CONVERT_TO_MS="CONVERT_TO_MS"})(h=t.MigrationType||(t.MigrationType={})),(function(e){e.INTRO="INTRO",e.WHATS_HAPPENING="WHATS_HAPPENING",e.MIGRATE_NOT_NOW="MIGRATE_NOT_NOW",e.WHAT_TO_DO="WHAT_TO_DO",e.LINK_GOOGLE="LINK_GOOGLE",e.CONVERT_TO_MS="CONVERT_TO_MS",e.MIGRATE_TO_GOOGLE="MIGRATE_TO_GOOGLE",e.COULD_NOT_CONNECT="COULD_NOT_CONNECT"})(y||(y={}));const S=({user:e})=>{const[t,S]=(0,r.useState)(y.INTRO),[b,O]=(0,r.useState)(),[C,M]=(0,r.useState)(),[T,A]=(0,r.useState)();(0,r.useEffect)(()=>{(0,v.getMigrationSettings)(e).then(e=>{var t,o;"ms_office_file"===(null===(t=e.effective_migration_mode)||void 0===t?void 0:t[".tag"])?O(h.CONVERT_TO_MS):"shortcut_to_gdrive"===(null===(o=e.effective_migration_mode)||void 0===o?void 0:o[".tag"])&&O(h.MIGRATE_TO_GOOGLE)}),(0,v.getMigrationDetails)(e).then(({user_details:e,team_details:t})=>{const o=null!=t?t:e;void 0!==o.pre_migration_gdd_count&&A(o.pre_migration_gdd_count),void 0!==o.scheduled_migration_time_ms&&M(new Date(o.scheduled_migration_time_ms))})},[]);const I=(0,r.useMemo)(()=>{var r,u;switch(t){case y.INTRO:return(0,n.IntroModal)({onNext:()=>S(y.WHATS_HAPPENING),onNotNow:()=>S(y.MIGRATE_NOT_NOW)});case y.WHATS_HAPPENING:return(0,s.WhatsHappeningToGoogleFilesModal)({onNext:()=>S(y.WHAT_TO_DO),onBack:()=>S(y.INTRO),scheduledMigrationTime:null!==(r=m.intl.formatDate(C,{month:"long",day:"numeric",year:"numeric"}))&&void 0!==r?r:""});case y.WHAT_TO_DO:return(0,a.WhatDoYouWantToDoModal)({disabled:void 0===b,isConvertToMS:b===h.CONVERT_TO_MS,isMigrateToGoogle:b===h.MIGRATE_TO_GOOGLE,onNext:()=>o.__awaiter(void 0,void 0,void 0,(function*(){if(b===h.MIGRATE_TO_GOOGLE){yield(0,v.setMigrationSettings)(e,{effective_migration_mode:{".tag":"shortcut_to_gdrive"}});const t=!0?e.email:void 0,o=yield(0,_.fetchUserHasGddMigrationCompatibleLink)(e,t);return S(o===_.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK?y.MIGRATE_TO_GOOGLE:y.LINK_GOOGLE)}if(b===h.CONVERT_TO_MS)return yield(0,v.setMigrationSettings)(e,{effective_migration_mode:{".tag":"ms_office_file"}}),S(y.CONVERT_TO_MS);f.Snackbar.warn(m.intl.formatMessage({id:"Q9RiB1",defaultMessage:"Please choose a migration type"}))})),onBack:()=>S(y.WHATS_HAPPENING),onCheckMigrateToGoogle:()=>O(h.MIGRATE_TO_GOOGLE),onCheckConvertToMS:()=>O(h.CONVERT_TO_MS)});case y.LINK_GOOGLE:return(0,i.LinkGoogleAccountModal)({onLinkAccount:()=>o.__awaiter(void 0,void 0,void 0,(function*(){if(!(yield(e=>o.__awaiter(void 0,void 0,void 0,(function*(){try{return(yield(0,_.ensureUserHasGddMigrationCompatibleLink)(e))==_.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK}catch(e){}return!1})))(e)))return S(y.COULD_NOT_CONNECT);S(y.MIGRATE_TO_GOOGLE)})),onBack:()=>S(y.WHAT_TO_DO)});case y.COULD_NOT_CONNECT:return(0,c.CouldNotConnectToGoogleModal)({onTryAgain:()=>S(y.LINK_GOOGLE)});case y.MIGRATE_NOT_NOW:return(0,l.RecommendMoveToGoogleModal)({onMoveFiles:()=>S(y.INTRO),onRemindMeLater:g.Modal.close,moveByDate:null!==(u=m.intl.formatDate(C,{month:"long",day:"numeric",year:"numeric"}))&&void 0!==u?u:"",numFiles:null!=T?T:0});case y.CONVERT_TO_MS:return(0,d.ConfirmConvertToMSModal)({onBack:()=>S(y.WHAT_TO_DO),onFinish:g.Modal.close});case y.MIGRATE_TO_GOOGLE:return(0,p.ConfirmMigrateToGoogleModal)({onBack:()=>S(y.WHAT_TO_DO),onFinish:g.Modal.close});default:(0,E.enforceExhaustive)(t)}},[e,t,S,b,O]);return r.default.createElement(u.ModalTemplate,Object.assign({open:!0},I,{onRequestClose:g.Modal.close}))};S.displayName="ConfigureMigrationController";t.showConfigureMigrationUiFlow=e=>{g.Modal.showInstance(r.default.createElement(S,{user:e}))}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/controllers/manual_conversion_controller",["require","exports","tslib","react","metaserver/static/js/api_v2/user_client","metaserver/static/js/cloud_docs/gdd_migration/auth","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/ts_utils","metaserver/static/js/core/i18n","metaserver/static/js/api_v2/error","js/filepath/filepath","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/manual_conversion_prompt","metaserver/static/js/components/ui/modal","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_){"use strict";var m;Object.defineProperty(t,"__esModule",{value:!0}),t.promptAndConvertToMsFile=t.promptAndConvertToWebShortcut=void 0,r=o.__importStar(r),(function(e){e.LINK_TO_INCOMPATIBLE_GOOGLE_ACCOUNT=c.intl.formatMessage({id:"u9TFTP",defaultMessage:"Please link to the Google account of the same email as your Dropbox account."}),e.FAIL_TO_LINK_GOOGLE_ACCOUNT=c.intl.formatMessage({id:"4L5zkJ",defaultMessage:"Failed to link Google account."}),e.pendingSaveShortcuts=function(e){return c.intl.formatMessage({id:"8NY+mp",defaultMessage:"Saving {numFiles, plural, one{shortcut} other{shortcuts}}..."},{numFiles:e})},e.pendingSaveFiles=function(e){return c.intl.formatMessage({id:"weKkwH",defaultMessage:"Saving {numFiles, plural, one{file} other{files}}..."},{numFiles:e})},e.successMessageMultipleShortcuts=function(e){return c.intl.formatMessage({id:"6LGshF",defaultMessage:"{numFiles} files saved as shortcuts."},{numFiles:e})},e.successMessageMultipleMsFiles=function(e){return c.intl.formatMessage({id:"ZXYeoK",defaultMessage:"{numFiles} files saved as Microsoft files."},{numFiles:e})},e.successMessageOneFile=function(e,t){return c.intl.formatMessage({id:"/p3tX1",defaultMessage:"{fileName} saved to <b>“{folderName}”</b> folder."},{fileName:e,folderName:t,b:e=>r.default.createElement("b",null,e)})},e.SERVER_ERROR=c.intl.formatMessage({id:"+rrsxb",defaultMessage:"Server error"}),e.srcFilesNotFound=function(e){return c.intl.formatMessage({id:"eRab3W",defaultMessage:"Source {numFiles, plural, one{file} other{files}} not found"},{numFiles:e})},e.srcFilesWrongType=function(e){return c.intl.formatMessage({id:"V0eQ4f",defaultMessage:"Source {numFiles, plural, one{file} other{files}} of the wrong type"},{numFiles:e})},e.GOOGLE_ACCOUNT_NOT_LINKED=c.intl.formatMessage({id:"Qs6YhO",defaultMessage:"Google account not linked"}),e.FOLDER_CREATION_FAILED=c.intl.formatMessage({id:"gBED0D",defaultMessage:"Folder creation failed"}),e.FIND_UNUSED_FILENAME_FAILED=c.intl.formatMessage({id:"UgrtDM",defaultMessage:"Find unused filename failed"}),e.UPLOAD_FAILED=c.intl.formatMessage({id:"MQocdR",defaultMessage:"Upload failed"}),e.GRANT_PERMISSIONS_FAILED=c.intl.formatMessage({id:"OltuRn",defaultMessage:"Grant permissions failed"}),e.GOOGLE_SERVER_ERROR=c.intl.formatMessage({id:"gTHqcG",defaultMessage:"Google server error"}),e.singleFileFailSave=function({fileName:e,rootCause:t}){return e?c.intl.formatMessage({id:"VemLR3",defaultMessage:"{fileName} couldn’t be saved ({rootCause})."},{fileName:e,rootCause:t}):c.intl.formatMessage({id:"Uni1RU",defaultMessage:"File couldn’t be saved ({rootCause})."},{rootCause:t})},e.multipleFilesPartialFailureShortcuts=function(e){return c.intl.formatMessage({id:"0u8Kpo",defaultMessage:"Some files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureShortcuts=function(e){return c.intl.formatMessage({id:"UA4umv",defaultMessage:"Files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFailSaveMsFile=function(e){return c.intl.formatMessage({id:"SNvXDY",defaultMessage:"Files couldn’t be saved as Microsoft files ({rootCause})."},{rootCause:e})},e.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS=c.intl.formatMessage({id:"AoDCl3",defaultMessage:"Failed to get Google shortcut settings. Please try again."})})(m||(m={}));const f=e=>"ns_path"in e?(0,d.filename)(e.ns_path):void 0,g=e=>o.__awaiter(void 0,void 0,void 0,(function*(){try{const t=new n.UserApiV2Client;return yield t.ns("cloud_docs").rpc("google_shortcut_settings/get",void 0,{subjectUserId:e.id})}catch(e){return a.Snackbar.failSticky(m.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS),null}})),v=({user:e,dontAskMeAgain:t,copyFilePermissions:r})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=(({dontAskMeAgain:e,copyFilePermissions:t})=>e?t?{".tag":"always"}:{".tag":"never"}:{".tag":"ask_each_time"})({dontAskMeAgain:t,copyFilePermissions:r}),s=new n.UserApiV2Client;try{yield s.ns("cloud_docs").rpc("google_shortcut_settings/set",{copy_permissions_to_google_shortcut:o},{subjectUserId:e.id})}catch(e){}})),E=({srcFileNames:e,targetDest:t,onUpdateCopyPermissionsSetting:o,onSubmit:n})=>{const[s,a]=(0,r.useState)(!1),i=(0,r.useMemo)(()=>(0,p.ManualConversionPromptModal)({srcFileNames:e,targetDest:t,dontAskMeAgain:s,onSetDontAskMeAgain:e=>a(e),onConvertAndCopy:()=>{u.Modal.close(),o({dontAskMeAgain:s,copyFilePermissions:!0}),n({copyFilePermissions:!0})},onConvertButDontCopy:()=>{u.Modal.close(),o({dontAskMeAgain:s,copyFilePermissions:!1}),n({copyFilePermissions:!1})}}),[e,t,o,n,s,a]);return r.default.createElement(_.ModalTemplate,Object.assign({open:!0},i,{onRequestClose:u.Modal.close}))};E.displayName="ManualConversionComponent";const h=({srcFileNames:e,targetDest:t,copyPermissionsSetting:o,onUpdateCopyPermissionsSetting:n,onSubmit:s})=>{switch(o[".tag"]){case"always":return void s({copyFilePermissions:!0});case"never":return void s({copyFilePermissions:!1});case"ask_each_time":case"other":break;default:(0,i.enforceExhaustive)(o)}u.Modal.showInstance(r.default.createElement(E,{srcFileNames:e,targetDest:t,onUpdateCopyPermissionsSetting:n,onSubmit:s}))};t.promptAndConvertToWebShortcut=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield g(t);o&&h({srcFileNames:e.map(e=>{var t;return null!==(t=f(e))&&void 0!==t?t:""}),targetDest:p.ManualConversionTargetDest.GOOGLE_DRIVE,copyPermissionsSetting:o.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:o})=>{v({user:t,dontAskMeAgain:e,copyFilePermissions:o})},onSubmit:({copyFilePermissions:o})=>{y({files:e,user:t,copyFilePermissions:o})}})}));const y=({files:e,user:t,copyFilePermissions:r})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield(0,s.ensureUserHasGddMigrationCompatibleLink)(t);switch(o){case s.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK:break;case s.GddMigrationCompatibleLinkStatus.HAS_INCOMPATIBLE_LINK:return void a.Snackbar.failSticky(m.LINK_TO_INCOMPATIBLE_GOOGLE_ACCOUNT);case s.GddMigrationCompatibleLinkStatus.NOT_LINKED:return void a.Snackbar.failSticky(m.FAIL_TO_LINK_GOOGLE_ACCOUNT);default:a.Snackbar.failSticky(m.FAIL_TO_LINK_GOOGLE_ACCOUNT),(0,i.enforceExhaustive)(o)}a.Snackbar.sync(m.pendingSaveShortcuts(e.length));const c={dest_service:{".tag":"gdrive"},src_files:e.map(e=>e.file_id),keep_original_file:!1,preserve_existing_shortcut:!0,copy_permissions:r};try{const o=new n.UserApiV2Client,r=yield o.ns("cloud_docs").rpc("convert_to_web_shortcut",c,{subjectUserId:t.id});((e,t)=>{e.length>1?a.Snackbar.completeSticky(m.successMessageMultipleShortcuts(e.length)):a.Snackbar.completeSticky(m.successMessageOneFile((0,d.filename)(t),(0,d.parent_dir)(t)))})(e,r.shortcuts[0].file_path)}catch(t){((e,t)=>{let o=!1,r=m.SERVER_ERROR;if(t instanceof l.AppError){const n=t.error;switch(n[".tag"]){case"src_file_not_found":r=m.srcFilesNotFound(e.length);break;case"src_file_wrong_type":r=m.srcFilesWrongType(e.length);break;case"missing_linked_service":r=m.GOOGLE_ACCOUNT_NOT_LINKED;break;case"external_api_error":switch(o=n.is_partial_failure,n.error_sub_type[".tag"]){case"create_folder":r=m.FOLDER_CREATION_FAILED;break;case"find_unused_filename":r=m.FIND_UNUSED_FILENAME_FAILED;break;case"upload":r=m.UPLOAD_FAILED;break;case"grant_role":r=m.GRANT_PERMISSIONS_FAILED;break;case"other":r=m.GOOGLE_SERVER_ERROR;break;case"create_file":case"delete_file":break;default:(0,i.enforceExhaustive)(n.error_sub_type)}break;case"other":break;default:(0,i.enforceExhaustive)(n)}}if(1===e.length){const t=f(e[0]);a.Snackbar.failSticky(m.singleFileFailSave({fileName:t,rootCause:r}))}else o?a.Snackbar.failSticky(m.multipleFilesPartialFailureShortcuts(r)):a.Snackbar.failSticky(m.multipleFilesFullFailureShortcuts(r))})(e,t)}}));t.promptAndConvertToMsFile=(e,t)=>o.__awaiter(void 0,void 0,void 0,(function*(){const o=yield g(t);o&&h({srcFileNames:e.map(e=>{var t;return null!==(t=f(e))&&void 0!==t?t:""}),targetDest:p.ManualConversionTargetDest.MICROSOFT_FILE,copyPermissionsSetting:o.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:o})=>{v({user:t,dontAskMeAgain:e,copyFilePermissions:o})},onSubmit:({copyFilePermissions:o})=>{S({files:e,user:t,copyFilePermissions:o})}})}));const S=({files:e,user:t,copyFilePermissions:r})=>o.__awaiter(void 0,void 0,void 0,(function*(){const o={src_files:e.map(e=>e.file_id),keep_original_file:!1,preserve_existing_ms_file:!0,copy_permissions:r};a.Snackbar.sync(m.pendingSaveFiles(e.length));const s=new n.UserApiV2Client;try{const r=yield s.ns("cloud_docs").rpc("convert_gdd_to_ms_office_file",o,{subjectUserId:t.id});((e,t)=>{e.length>1?a.Snackbar.completeSticky(m.successMessageMultipleMsFiles(e.length)):a.Snackbar.completeSticky(m.successMessageOneFile((0,d.filename)(t),(0,d.parent_dir)(t)))})(e,r.converted_files[0].dest_file_path)}catch(t){((e,t)=>{let o=m.SERVER_ERROR;if(t instanceof l.AppError){const r=t.error;switch(r[".tag"]){case"src_file_not_found":o=m.srcFilesNotFound(e.length);break;case"src_file_wrong_type":o=m.srcFilesWrongType(e.length);break;case"other":break;default:(0,i.enforceExhaustive)(r)}}if(1===e.length){const t=f(e[0]);a.Snackbar.failSticky(m.singleFileFailSave({fileName:t,rootCause:o}))}else a.Snackbar.failSticky(m.multipleFilesFailSaveMsFile(o))})(e,t)}}))})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_convert_to_ms_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmConvertToMSModal=void 0,r=o.__importDefault(r);t.ConfirmConvertToMSModal=({onFinish:e,onBack:t})=>({title:s.intl.formatMessage({id:"6TTebl",defaultMessage:"Convert Google files to Microsoft Office files"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"lBpsJD",defaultMessage:"4 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,s.intl.formatMessage({id:"o4sdZa",defaultMessage:"You’re all set."})),r.default.createElement("p",null,s.intl.formatMessage({id:"cjp04s",defaultMessage:"You’ll get an email when migration starts and when it’s finished."}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:t},a.Strings.BACK),r.default.createElement(n.Button,{variant:"primary",onClick:e},a.Strings.FINISH)),width:"small"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/could_not_connect_to_google_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouldNotConnectToGoogleModal=void 0,r=o.__importDefault(r);t.CouldNotConnectToGoogleModal=({onTryAgain:e})=>({title:s.intl.formatMessage({id:"mhpv2Q",defaultMessage:"Couldn’t connect to your Google account"}),bodyText:r.default.createElement(r.default.Fragment,null,s.intl.formatMessage({id:"IChG+T",defaultMessage:"You can try again, or go to “Learn more” to manually move your Google files to Google Drive and create shortcuts in Dropbox."})),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity"},a.Strings.LEARN_MORE),r.default.createElement(n.Button,{variant:"primary",onClick:e},s.intl.formatMessage({id:"WteAJ2",defaultMessage:"Try again"}))),width:"standard",withCloseButton:a.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/intro_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IntroModal=void 0,r=o.__importDefault(r);t.IntroModal=({onNext:e,onNotNow:t})=>({title:s.intl.formatMessage({id:"8xf9hC",defaultMessage:"Google Files are moving to Google Drive"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"MfPZDB",defaultMessage:"1 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,s.intl.formatMessage({id:"wtjl7Q",defaultMessage:"To improve performance and access to Google file features, your Google files will be moved from Dropbox to Google Drive."})),r.default.createElement("p",null,s.intl.formatMessage({id:"QjccmA",defaultMessage:"Shortcuts to all your files will be created in Dropbox. Once the files are moved, you can open any Google file from Dropbox by clicking on its shortcut."}))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:t},s.intl.formatMessage({id:"0TwJOv",defaultMessage:"Not now"})),r.default.createElement(n.Button,{variant:"primary",onClick:e},a.Strings.NEXT)),tertiaryActions:r.default.createElement(n.Button,{variant:"transparent"},a.Strings.LEARN_MORE),rightFrameImageSrc:(0,i.static_url)("/static/metaserver/static/images/cloud_docs/gdd_migration/migration_modal_intro-vflH_hlVK.png"),width:749})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/link_google_account_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkGoogleAccountModal=void 0,r=o.__importDefault(r);t.LinkGoogleAccountModal=({onLinkAccount:e,onBack:t})=>({title:s.intl.formatMessage({id:"2PB7hS",defaultMessage:"Link Google account"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"lBpsJD",defaultMessage:"4 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,s.intl.formatMessage({id:"/WNsVV",defaultMessage:"You’ll be asked to sign in and link your Google account to this Dropbox account. Select the Google profile for this Dropbox account, and we’ll take care of the rest."})),r.default.createElement("p",null,s.intl.formatMessage({id:"pYT44N",defaultMessage:"You’ll be notified when the Google file migration is complete."}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:t},a.Strings.BACK),r.default.createElement(n.Button,{variant:"primary",onClick:e},s.intl.formatMessage({id:"JhmneM",defaultMessage:"Link account"}))),width:"standard"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/manual_conversion_prompt",["require","exports","tslib","react","dig-components/buttons","dig-components/controls","dig-components/typography","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/cloud_docs/constants"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0}),t.ManualConversionPromptModal=t.ManualConversionTargetDest=void 0,r=o.__importDefault(r),(function(e){e[e.GOOGLE_DRIVE=0]="GOOGLE_DRIVE",e[e.MICROSOFT_FILE=1]="MICROSOFT_FILE"})(d=t.ManualConversionTargetDest||(t.ManualConversionTargetDest={}));const p=(e,t)=>{switch(t){case d.GOOGLE_DRIVE:return(e=>{const t=new Set;for(const o of e){const e=(0,l.getGoogleFileTypeByPath)(o);if(e){t.add(e);continue}const r=(0,l.getMicrosoftFileTypeByPath)(o);r&&t.add(l.MicrosoftToGoogleFileTypes[r])}if(1===t.size)for(const e of t)return l.GoogleFileLabels[e];return i.intl.formatMessage({id:"ZYjkCp",defaultMessage:"Google"})})(e);case d.MICROSOFT_FILE:return(e=>{const t=new Set;for(const o of e){const e=(0,l.getMicrosoftFileTypeByPath)(o);if(e){t.add(e);continue}const r=(0,l.getGoogleFileTypeByPath)(o);r&&t.add(l.GoogleToMicrosoftFileTypes[r])}if(1===t.size)for(const e of t)return l.MicrosoftFileLabels[e];return i.intl.formatMessage({id:"WbLFdE",defaultMessage:"Microsoft"})})(e)}},u=(e,t)=>{const o=p(e,t);switch(t){case d.GOOGLE_DRIVE:return i.intl.formatMessage({id:"feZj+P",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} shortcut will inherit the same sharing permissions as <b>{firstSrcFileName}</b>. Save as will replace the original file.} other{The new {fileTypeLabel} shortcuts will inherit the same sharing permissions as the source files. Save as will replace the original files.}}"},{fileTypeLabel:o,numFiles:e.length,firstSrcFileName:e[0],b:e=>r.default.createElement("strong",null,e)});case d.MICROSOFT_FILE:return i.intl.formatMessage({id:"nMmrLl",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} file will inherit the same sharing permissions as <b>{firstSrcFileName}</b>. Save as will replace the original file.} other{The new {fileTypeLabel} files will inherit the same sharing permissions as the source files. Save as will replace the original files.}}"},{fileTypeLabel:o,numFiles:e.length,firstSrcFileName:e[0],b:e=>r.default.createElement("strong",null,e)})}};t.ManualConversionPromptModal=({srcFileNames:e,targetDest:t,dontAskMeAgain:o,onSetDontAskMeAgain:l,onConvertAndCopy:d,onConvertButDontCopy:p})=>({title:i.intl.formatMessage({id:"taJUkh",defaultMessage:"Save with sharing permissions?"}),bodyText:r.default.createElement(r.default.Fragment,null,u(e,t)," ",r.default.createElement(n.Button,{variant:"transparent"},r.default.createElement(a.Text,{isBold:!0},c.Strings.LEARN_MORE))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(s.Checkbox,{id:"toggleDontAskMeAgain",checked:o,onChange:e=>l(e.currentTarget.checked),"aria-label":i.intl.formatMessage({id:"PJIYJF",defaultMessage:"Toggle don’t ask me again"})}),r.default.createElement(a.Label,{htmlFor:"toggleDontAskMeAgain"},r.default.createElement(a.Text,null,i.intl.formatMessage({id:"rI2pNz",defaultMessage:"Don’t ask me again"})))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:p},i.intl.formatMessage({id:"QzQNL5",defaultMessage:"Save without permissions"})),r.default.createElement(n.Button,{variant:"primary",onClick:d},c.Strings.SAVE)),width:"standard",withCloseButton:c.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template",["require","exports","tslib","react","dig-components/modal","dig-components/typography","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.css"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModalTemplate=void 0,r=o.__importDefault(r),a=o.__importDefault(a);t.ModalTemplate=({actions:e,ariaLabel:t,bodyText:o,infoTextAboveModalTitle:i,tertiaryActions:c,title:l,rightFrameImageSrc:d,onRequestClose:p,open:u,width:_,withCloseButton:m})=>r.default.createElement(n.Modal,{onRequestClose:p,open:null==u||u,width:_,isCentered:!0,shouldCloseOnOverlayClick:!1,withCloseButton:m,"aria-labelledby":t},r.default.createElement("div",{className:a.default.modalTemplateWrapper},r.default.createElement("div",{className:a.default.modalTemplateContainer},i&&r.default.createElement("div",{className:a.default.modalTemplatePaper},r.default.createElement(s.Text,{size:"small",color:"faint"},i)),r.default.createElement("div",{className:a.default.modalTemplateContent},r.default.createElement("div",{className:a.default.modalTemplateHeading},r.default.createElement(s.Title,null,l)),r.default.createElement("div",{className:a.default.modalTemplateText},o)),r.default.createElement("div",{className:a.default.modalTemplateActions},e&&r.default.createElement("div",{className:a.default.modalTemplateButtonGroup},e),c&&r.default.createElement("div",{className:a.default.modalTemplateTertiaryActionContainer},c))),d&&r.default.createElement("div",{className:a.default.modalTemplateImageFrame},r.default.createElement("img",{src:d})))),t.ModalTemplate.displayName="ModalTemplate"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modalTemplateImageFrame=t.modalTemplateTertiaryActionContainer=t.modalTemplateButtonGroup=t.modalTemplateActions=t.modalTemplateText=t.modalTemplateHeading=t.modalTemplateContent=t.modalTemplatePaper=t.modalTemplateContainer=t.modalTemplateWrapper=void 0,t.modalTemplateWrapper="_modalTemplateWrapper_1abca_1",t.modalTemplateContainer="_modalTemplateContainer_1abca_6",t.modalTemplatePaper="_modalTemplatePaper_1abca_15",t.modalTemplateContent="_modalTemplateContent_1abca_24",t.modalTemplateHeading="_modalTemplateHeading_1abca_34",t.modalTemplateText="_modalTemplateText_1abca_42",t.modalTemplateActions="_modalTemplateActions_1abca_46",t.modalTemplateButtonGroup="_modalTemplateButtonGroup_1abca_56",t.modalTemplateTertiaryActionContainer="_modalTemplateTertiaryActionContainer_1abca_65",t.modalTemplateImageFrame="_modalTemplateImageFrame_1abca_76";t.default={modalTemplateWrapper:"_modalTemplateWrapper_1abca_1",modalTemplateContainer:"_modalTemplateContainer_1abca_6",modalTemplatePaper:"_modalTemplatePaper_1abca_15",modalTemplateContent:"_modalTemplateContent_1abca_24",modalTemplateHeading:"_modalTemplateHeading_1abca_34",modalTemplateText:"_modalTemplateText_1abca_42",modalTemplateActions:"_modalTemplateActions_1abca_46",modalTemplateButtonGroup:"_modalTemplateButtonGroup_1abca_56",modalTemplateTertiaryActionContainer:"_modalTemplateTertiaryActionContainer_1abca_65",modalTemplateImageFrame:"_modalTemplateImageFrame_1abca_76"}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/recommend_move_to_google_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendMoveToGoogleModal=void 0,r=o.__importDefault(r);t.RecommendMoveToGoogleModal=({onRemindMeLater:e,onMoveFiles:t,moveByDate:o,numFiles:i})=>({title:s.intl.formatMessage({id:"X3l0jP",defaultMessage:"Google files moving to Google Drive"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,r.default.createElement("strong",null,s.intl.formatMessage({id:"VPIeVQ",defaultMessage:"We recommend moving all {numFiles} of your Google files to Google Drive. Shortcuts to the files will be added to Dropbox so you can open them at any time."},{numFiles:i}))),r.default.createElement("p",null,s.intl.formatMessage({id:"dbGYQX",defaultMessage:"Google files that haven’t been moved by {moveByDate} will be converted to Microsoft Office files and stored in Dropbox."},{moveByDate:o}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:e},a.Strings.REMIND_ME_LATER),r.default.createElement(n.Button,{variant:"primary",onClick:t},a.Strings.MOVE_FILES)),withCloseButton:a.Strings.CLOSE,width:"standard"})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/what_do_you_want_to_do_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,n,s,a,i,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WhatDoYouWantToDoModal=void 0,r=o.__importDefault(r);t.WhatDoYouWantToDoModal=({disabled:e,isConvertToMS:t,isMigrateToGoogle:o,onNext:l,onBack:d,onCheckMigrateToGoogle:p,onCheckConvertToMS:u})=>({title:a.intl.formatMessage({id:"hiZ+Ev",defaultMessage:"What do you want to do?"}),infoTextAboveModalTitle:a.intl.formatMessage({id:"7IR9Ol",defaultMessage:"3 of 4"}),bodyText:r.default.createElement("div",{role:"group"},r.default.createElement(s.RadioButtonGroup,{checked:o,disabled:e,id:"continue-google",labelText:a.intl.formatMessage({id:"mrNUok",defaultMessage:"Move Google files to Google Drive with shortcuts"}),onChange:p,helperText:a.intl.formatMessage({id:"0DqRnx",defaultMessage:"Sign in to your Google account so we can move files to Google Drive."})}),r.default.createElement(s.RadioButtonGroup,{checked:t,disabled:e,id:"continue-microsoft",labelText:a.intl.formatMessage({id:"iGoIY+",defaultMessage:"Convert Google files to Microsoft Office files"}),onChange:u,helperText:a.intl.formatMessage({id:"NAzO7r",defaultMessage:"No action is needed from you. We’ll take care of it."})})),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:d},i.Strings.BACK),r.default.createElement(n.Button,{variant:"primary",onClick:l},i.Strings.NEXT)),tertiaryActions:r.default.createElement(n.Button,{variant:"transparent"},i.Strings.LEARN_MORE),rightFrameImageSrc:(0,c.static_url)("/static/metaserver/static/images/cloud_docs/gdd_migration/migration_modal_what_to_do-vflOkSvSO.png"),width:749}),i.Strings})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/whats_happening_to_google_files_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/clean/static_urls"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WhatsHappeningToGoogleFilesModal=void 0,r=o.__importDefault(r);t.WhatsHappeningToGoogleFilesModal=({onNext:e,onBack:t,scheduledMigrationTime:o})=>({title:s.intl.formatMessage({id:"U5mUXh",defaultMessage:"What’s happening to Google files"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"MTMS+F",defaultMessage:"2 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,s.intl.formatMessage({id:"je6sXU",defaultMessage:"Starting {scheduledMigrationTime}, all your Google Docs, Sheets, and Slides will open in Google Workspace, instead of Dropbox."},{scheduledMigrationTime:o})),r.default.createElement("p",null,s.intl.formatMessage({id:"aWFn9/",defaultMessage:"To keep working in Google Workspace, link your Google account to Dropbox."})),r.default.createElement("p",null,s.intl.formatMessage({id:"dtkLn9",defaultMessage:"After {scheduledMigrationTime}, if your Dropbox account isn’t linked to your Google account your Google files will be converted to Microsoft Office files."},{scheduledMigrationTime:o}))),actions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:t},a.Strings.BACK),r.default.createElement(n.Button,{variant:"primary",onClick:e},a.Strings.NEXT)),tertiaryActions:r.default.createElement(n.Button,{variant:"transparent"},a.Strings.LEARN_MORE),rightFrameImageSrc:(0,i.static_url)("/static/metaserver/static/images/cloud_docs/gdd_migration/migration_modal_whats_happening-vflErcmxI.png"),width:749})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group",["require","exports","tslib","react","dig-components/controls","dig-components/typography","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.css"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButtonGroup=void 0,r=o.__importDefault(r),a=o.__importDefault(a);t.RadioButtonGroup=({checked:e,disabled:t,id:o,labelText:i,helperText:c,onChange:l})=>r.default.createElement("span",{className:a.default.radioButtonGroupRow},r.default.createElement(n.RadioButton,{id:o,checked:e,onChange:l,disabled:t}),r.default.createElement("span",{className:a.default.rowLabelContainer},r.default.createElement(s.Text,{tagName:"label",htmlFor:o},i),c&&r.default.createElement(s.Text,{color:"faint"},c))),t.RadioButtonGroup.displayName="RadioButtonGroup"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/radio_button_group.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rowLabelContainer=t.radioButtonGroupRow=void 0,t.radioButtonGroupRow="_radioButtonGroupRow_1qd9u_1",t.rowLabelContainer="_rowLabelContainer_1qd9u_11";t.default={radioButtonGroupRow:"_radioButtonGroupRow_1qd9u_1",rowLabelContainer:"_rowLabelContainer_1qd9u_11"}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/strings",["require","exports","metaserver/static/js/core/i18n"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0,(function(e){e.NEXT=o.intl.formatMessage({id:"yah+je",defaultMessage:"Next"}),e.BACK=o.intl.formatMessage({id:"k9vJ0G",defaultMessage:"Back"}),e.CANCEL=o.intl.formatMessage({id:"S53N5s",defaultMessage:"Cancel"}),e.CREATE=o.intl.formatMessage({id:"cVVoCl",defaultMessage:"Create"}),e.SAVE=o.intl.formatMessage({id:"HqImMi",defaultMessage:"Save"}),e.LEARN_MORE=o.intl.formatMessage({id:"sUsXMb",defaultMessage:"Learn more"}),e.REMIND_ME_LATER=o.intl.formatMessage({id:"zQjTBz",defaultMessage:"Remind me later"}),e.MOVE_FILES=o.intl.formatMessage({id:"qbOcoV",defaultMessage:"Move files"}),e.FINISH=o.intl.formatMessage({id:"n4dBJ7",defaultMessage:"Finish"}),e.CLOSE=o.intl.formatMessage({id:"/nCb7L",defaultMessage:"Close"}),e.DISMISS=o.intl.formatMessage({id:"h4rpeQ",defaultMessage:"Dismiss"}),e.CONFIGURE_NOW=o.intl.formatMessage({id:"vQKdKf",defaultMessage:"Configure now"}),e.SHOW_IN_GOOGLE_DRIVE=o.intl.formatMessage({id:"S0LHV5",defaultMessage:"Show in Google Drive"}),e.LINK_ACCOUNT=o.intl.formatMessage({id:"JhmneM",defaultMessage:"Link account"}),e.GET_MIGRATION_SETTINGS_ERROR=o.intl.formatMessage({id:"C40Kmf",defaultMessage:"Could not fetch migration settings"}),e.SET_MIGRATION_SETTINGS_ERROR=o.intl.formatMessage({id:"omeHSB",defaultMessage:"Could not update migration settings"}),e.EDIT_APP_PERMISSIONS=o.intl.formatMessage({id:"GYeDWi",defaultMessage:"Edit app permissions"}),e.MIGRATION_FOLDER=o.intl.formatMessage({id:"vp+jh3",defaultMessage:"Dropbox"})})(t.Strings||(t.Strings={}))})),define("metaserver/static/js/cloud_docs/create_google_shortcut_modal",["require","exports","tslib","react","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/modal_template","metaserver/static/js/cloud_docs/gdd_migration/ui/modals/new_gdss_web_file/create_gdss_shortcut_modal","metaserver/static/js/components/ui/modal","metaserver/static/js/core/i18n","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/clean/active_user","metaserver/static/js/profile_services/profile_services_constants","react","metaserver/static/js/file_imports/gdrive/file_picker","metaserver/static/js/file_imports/dropbox/iframe_types","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showCreateGoogleShortcutModal=void 0,r=o.__importStar(r),d=o.__importDefault(d);const f=i.intl.formatMessage({id:"o9Zw70",defaultMessage:"Untitled"}),g=({fileType:e,onCreate:t})=>{const[i,g]=(0,r.useState)(""),[{folderName:v},E]=(0,r.useState)({folderName:m.Strings.MIGRATION_FOLDER}),[h,y]=(0,r.useState)(),[S,b]=(0,r.useState)(!1);return(0,p.useEffect)(()=>{h&&S&&(b(!1),(0,u.openGdriveFilePicker)(h,void 0,[{viewId:_.FilePickerViewId.FOLDERS,includeFolders:!0,allowSelectFolders:!0}]).then(e=>{if(e.action!==_.FilePickerAction.PICKED)return;const{fileIds:t,filesInfo:o}=e,r=t[0];E({folderId:r,folderName:o[r].name})}))},[h,S]),r.default.createElement(n.ModalTemplate,Object.assign({open:!0},(0,s.CreateGdssShortcutModal)({folderName:v,fileType:e,shortcutName:i,onChangeShortcutName:g,onCancel:a.Modal.close,onChangeDriveFolder:()=>o.__awaiter(void 0,void 0,void 0,(function*(){if(!h){const e=(0,l.mustGetActiveUserId)(),t=new c.ProfileServicesLinkingHandler,{access_token:o}=yield t.auth_service_with_user_promise(d.default.GOOGLE,e,"folder picker","link_read_files");if(!o)return;y(o)}b(!0)})),onCreate:()=>{t(i.length?i:f),a.Modal.close()}}),{onRequestClose:a.Modal.close}))};g.displayName="CreateGoogleShortcutModal";t.showCreateGoogleShortcutModal=({fileType:e,onCreate:t})=>{a.Modal.showInstance(r.default.createElement(g,{fileType:e,onCreate:t}))}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/new_gdss_web_file/create_gdss_shortcut_modal",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group","metaserver/static/js/cloud_docs/constants"],(function(e,t,o,r,n,s,a,i,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateGdssShortcutModal=t.GoogleFileLabels=void 0,r=o.__importDefault(r),t.GoogleFileLabels={[d.GoogleFileTypes.GOOGLE_DSS_DOC]:i.intl.formatMessage({id:"mh13Sm",defaultMessage:"Google Doc"}),[d.GoogleFileTypes.GOOGLE_DSS_SHEET]:i.intl.formatMessage({id:"EA8pnR",defaultMessage:"Google Sheet"}),[d.GoogleFileTypes.GOOGLE_DSS_SLIDES]:i.intl.formatMessage({id:"gYrVaF",defaultMessage:"Google Slides"})};t.CreateGdssShortcutModal=({folderName:e,fileType:o,shortcutName:d,onChangeShortcutName:p,onCreate:u,onCancel:_,onChangeDriveFolder:m})=>({title:i.intl.formatMessage({id:"JSsQfA",defaultMessage:"Create {fileType} shortcut"},{fileType:t.GoogleFileLabels[o]}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,r.default.createElement(l.TextInputGroup,{ariaLabel:i.intl.formatMessage({id:"thfeo6",defaultMessage:"{fileType} shortcut name text input"},{fileType:t.GoogleFileLabels[o]}),id:"shortcut-name",isLabelBold:!0,labelSize:"large",label:i.intl.formatMessage({id:"+0ZE67",defaultMessage:"Shortcut name"}),placeholder:i.intl.formatMessage({id:"UfXcek",defaultMessage:"Add shortcut name"}),value:d,onChange:e=>p(e.currentTarget.value)})),r.default.createElement("p",null,i.intl.formatMessage({id:"F1r05z",defaultMessage:"Will be saved in the folder <button>{folderName}</button> in Google Drive."},{button:e=>r.default.createElement(n.Button,{onClick:m,variant:"transparent",withIconLeft:r.default.createElement(s.UIIcon,{src:a.FolderLine,role:"presentation"})},e),folderName:e}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:_},c.Strings.CANCEL),r.default.createElement(n.Button,{variant:"primary",onClick:u},c.Strings.CREATE)),width:"small",withCloseButton:c.Strings.CLOSE})})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group",["require","exports","tslib","react","dig-components/text_fields","dig-components/typography","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.css"],(function(e,t,o,r,n,s,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextInputGroup=void 0,r=o.__importDefault(r),i=o.__importDefault(i);t.TextInputGroup=({ariaLabel:e,id:t,isLabelBold:o,label:c,placeholder:l,labelSize:d,value:p,onChange:u})=>r.default.createElement("div",{className:i.default.textInputGroup},c&&r.default.createElement(s.Text,{size:d,tagName:"label",htmlFor:t,isBold:o},c),r.default.createElement("div",null,r.default.createElement(n.TextInput,{id:t,onChange:u,placeholder:l,"aria-label":null!=e?e:a.intl.formatMessage({id:"Z/QhF6",defaultMessage:"Text input"}),value:p}))),t.TextInputGroup.displayName="TextInputGroup"})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.css",["require","exports","css!metaserver/static/js/cloud_docs/gdd_migration/ui/shared_components/text_input_group.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textInputGroup=void 0,t.textInputGroup="_textInputGroup_10q85_1";t.default={textInputGroup:"_textInputGroup_10q85_1"}})),define("metaserver/static/js/cloud_docs/gdd_migration/ui/modals/confirm_migrate_to_google_modal",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/gdd_migration/ui/strings"],(function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmMigrateToGoogleModal=void 0,r=o.__importDefault(r);t.ConfirmMigrateToGoogleModal=({onFinish:e,onBack:t})=>({title:s.intl.formatMessage({id:"079cjB",defaultMessage:"Move Google files to Google Drive with shortcuts"}),infoTextAboveModalTitle:s.intl.formatMessage({id:"lBpsJD",defaultMessage:"4 of 4"}),bodyText:r.default.createElement(r.default.Fragment,null,r.default.createElement("p",null,s.intl.formatMessage({id:"o4sdZa",defaultMessage:"You’re all set."})),r.default.createElement("p",null,s.intl.formatMessage({id:"cjp04s",defaultMessage:"You’ll get an email when migration starts and when it’s finished."}))),tertiaryActions:r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,{variant:"opacity",onClick:t},a.Strings.BACK),r.default.createElement(n.Button,{variant:"primary",onClick:e},a.Strings.FINISH)),width:"small"})})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/cancel_import_job",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Cancel_ImportJob=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Cancel_ImportJob"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Cancel_ImportJob||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/fail_connect_external_account",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Fail_ConnectExternalAccount=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Fail_ConnectExternalAccount"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Fail_ConnectExternalAccount||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/partial_succeed_import_job",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).PartialSucceed_ImportJob=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.prototype.srcFilesTotal=0,e.prototype.srcFilesSucceeded=0,e.prototype.srcFilesFailed=0,e.prototype.num_4xxErrors=0,e.prototype.num_5xxErrors=0,e.prototype.numOtherErrors=0,e.prototype.allErrorCounts="",e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.PartialSucceed_ImportJob"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.PartialSucceed_ImportJob||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_delete_source",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_DeleteSource=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_DeleteSource"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_DeleteSource||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_folder_structure",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_FolderStructure=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_FolderStructure"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_FolderStructure||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_overquota_upgrade",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_OverquotaUpgrade=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_OverquotaUpgrade"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_OverquotaUpgrade||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_overwrite_files",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_OverwriteFiles=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_OverwriteFiles"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_OverwriteFiles||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_try_again",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_TryAgain=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_TryAgain"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_TryAgain||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/select_view_details",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Select_ViewDetails=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Select_ViewDetails"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Select_ViewDetails||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_external_api_error",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_ExternalApiError=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_ExternalApiError"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_ExternalApiError||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_failed_cancel",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_FailedCancel=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_FailedCancel"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_FailedCancel||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_import_already_running",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_ImportAlreadyRunning=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_ImportAlreadyRunning"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_ImportAlreadyRunning||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_import_options",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_ImportOptions=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_ImportOptions"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_ImportOptions||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_network_error",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_NetworkError=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_NetworkError"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_NetworkError||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_no_files",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_NoFiles=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_NoFiles"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_NoFiles||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_overquota_prompt",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_OverquotaPrompt=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_OverquotaPrompt"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_OverquotaPrompt||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_partial_upload",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_PartialUpload=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_PartialUpload"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_PartialUpload||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_unknown_error",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Shown_UnknownError=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Shown_UnknownError"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Shown_UnknownError||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/start_import_job",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Start_ImportJob=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Start_ImportJob"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Start_ImportJob||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/succeed_connect_external_account",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Succeed_ConnectExternalAccount=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Succeed_ConnectExternalAccount"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Succeed_ConnectExternalAccount||{}),a),s)})),define("metaserver/static/js/dropbox/proto/pap_events/file_imports/succeed_import_job",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(r=o.__importStar(r)).Reader,r.Writer,r.util;const n=r.roots.default||(r.roots.default={});var s,a;t.default=n,t.pap_events=n.pap_events=((s=n.pap_events||{}).file_imports=((a=s.file_imports||{}).Succeed_ImportJob=(function(e){function e(e){if(e)for(let t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.externalProvider=0,e.prototype.srcFilesTotal=0,e.prototype.srcFilesSucceeded=0,e.prototype.srcFilesFailed=0,e.prototype.num_4xxErrors=0,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.file_imports.Succeed_ImportJob"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="FILE_IMPORTS"]=0,t})(),e.ExternalProvider=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_EXTERNAL_PROVIDER"]=0,t[e[1]="GOOGLE_EXTERNAL_PROVIDER"]=1,t[e[2]="GOOGLE_DRIVE_EXTERNAL_PROVIDER"]=2,t[e[3]="GOOGLE_PHOTOS_EXTERNAL_PROVIDER"]=3,t[e[4]="ONE_DRIVE_EXTERNAL_PROVIDER"]=4,t[e[5]="ICLOUD_EXTERNAL_PROVIDER"]=5,t[e[6]="MICROSOFT_EXTERNAL_PROVIDER"]=6,t})(),e})(a.Succeed_ImportJob||{}),a),s)})),define("metaserver/static/js/file_imports/components/modals/external_provider_api_error_modal",["require","exports","tslib","react","dig-components/modal","dig-components/buttons","dig-components/typography","metaserver/static/js/core/i18n","metaserver/static/js/file_imports/ui/service_names","metaserver/static/js/components/ui/modal","metaserver/static/js/file_imports/dropbox/analytics","metaserver/static/js/file_imports/components/modals/modal_buttons"],(function(e,t,o,r,n,s,a,i,c,l,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showExternalProviderApiErrorModal=t.ExternalProviderApiErrorModal=void 0,r=o.__importStar(r);const u=e=>i.intl.formatMessage({id:"ibOvmo",defaultMessage:"Couldn’t get a response from {serviceProvider} servers"},{serviceProvider:(0,c.getLocalizedLoginServiceName)(e)}),_=e=>i.intl.formatMessage({id:"kL19SV",defaultMessage:"You can try again, or download your files and folders from {service} and drag them into Dropbox."},{service:(0,c.getLocalizedServiceName)(e)});t.ExternalProviderApiErrorModal=({open:e,onRequestClose:t,supportedService:o,tryAgain:i})=>((0,r.useEffect)(()=>{(0,d.logShownExternalApiError)(o.importType)},[o.importType]),r.default.createElement(n.Modal,{onRequestClose:t,open:e,isCentered:!0,withCloseButton:p.Buttons.CloseAriaLabel()},r.default.createElement(n.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(n.Modal.Title,null,u(o.importType))),r.default.createElement(n.Modal.Body,{hasVerticalSpacing:!1},r.default.createElement(a.Text,{tagName:"p"},_(o.importType))),r.default.createElement(n.Modal.Footer,null,r.default.createElement(s.Button,{variant:"opacity",onClick:t,autoFocus:!0},p.Buttons.GotIt()),r.default.createElement(s.Button,{variant:"primary",autoFocus:!0,onClick:()=>{t(),i(),(0,d.logSelectTryAgain)(o.importType)}},p.Buttons.TryAgain()))));t.showExternalProviderApiErrorModal=(e,o)=>{l.Modal.showInstance(r.default.createElement(t.ExternalProviderApiErrorModal,{supportedService:e,open:!0,onRequestClose:()=>l.Modal.close(),tryAgain:o}))}})),define("metaserver/static/js/file_imports/components/modals/modal_buttons",["require","exports","metaserver/static/js/core/i18n"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Buttons=void 0,t.Buttons={GotIt:()=>o.intl.formatMessage({id:"j8BdSl",defaultMessage:"Got it"}),TryAgain:()=>o.intl.formatMessage({id:"HImQBL",defaultMessage:"Try again"}),Cancel:()=>o.intl.formatMessage({id:"cp7jer",defaultMessage:"Cancel"}),CloseAriaLabel:()=>o.intl.formatMessage({id:"F4pNeQ",defaultMessage:"Close"}),ViewDetails:()=>o.intl.formatMessage({id:"YPmkDk",defaultMessage:"View details"}),HideDetails:()=>o.intl.formatMessage({id:"p8xGcP",defaultMessage:"Hide details"})}})),define("metaserver/static/js/file_imports/dropbox/analytics",["require","exports","metaserver/static/js/dropbox/proto/pap_events/file_imports/succeed_connect_external_account","metaserver/static/js/dropbox/proto/pap_events/file_imports/fail_connect_external_account","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_no_files","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_import_options","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_folder_structure","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_overwrite_files","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_delete_source","metaserver/static/js/dropbox/proto/pap_events/file_imports/start_import_job","metaserver/static/js/dropbox/proto/pap_events/file_imports/cancel_import_job","metaserver/static/js/dropbox/proto/pap_events/file_imports/succeed_import_job","metaserver/static/js/dropbox/proto/pap_events/file_imports/partial_succeed_import_job","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_unknown_error","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_network_error","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_import_already_running","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_overquota_prompt","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_overquota_upgrade","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_partial_upload","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_external_api_error","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_try_again","metaserver/static/js/dropbox/proto/pap_events/file_imports/shown_failed_cancel","metaserver/static/js/dropbox/proto/pap_events/file_imports/select_view_details","metaserver/static/js/pap/analytics_client","metaserver/static/js/clean/ts_utils"],(function(e,t,o,r,n,s,a,i,c,l,d,p,u,_,m,f,g,v,E,h,y,S,b,O,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logSelectViewDetails=t.logShownFailedCancel=t.logSelectTryAgain=t.logShownExternalApiError=t.logShownPartialUpload=t.logSelectOverquotaUpgrade=t.logShownOverquotaPrompt=t.logShownImportAlreadyRunning=t.logShownNetworkError=t.logShownUnknownError=t.logPartialSucceedImportJob=t.logSucceedImportJob=t.logCancelImportJob=t.logStartImportJob=t.logSelectDeleteSource=t.logSelectOverwriteFiles=t.logSelectFolderStructure=t.logShownImportOptions=t.logShownNoFiles=t.logFailConnectExternalAccount=t.logSucceedConnectExternalAccount=void 0;var M=o.pap_events.file_imports.Succeed_ConnectExternalAccount,T=r.pap_events.file_imports.Fail_ConnectExternalAccount,A=n.pap_events.file_imports.Shown_NoFiles,I=s.pap_events.file_imports.Shown_ImportOptions,R=a.pap_events.file_imports.Select_FolderStructure,k=i.pap_events.file_imports.Select_OverwriteFiles,w=c.pap_events.file_imports.Select_DeleteSource,P=l.pap_events.file_imports.Start_ImportJob,N=d.pap_events.file_imports.Cancel_ImportJob,D=p.pap_events.file_imports.Succeed_ImportJob,x=u.pap_events.file_imports.PartialSucceed_ImportJob,L=_.pap_events.file_imports.Shown_UnknownError,j=m.pap_events.file_imports.Shown_NetworkError,F=f.pap_events.file_imports.Shown_ImportAlreadyRunning,G=g.pap_events.file_imports.Shown_OverquotaPrompt,U=v.pap_events.file_imports.Select_OverquotaUpgrade,V=E.pap_events.file_imports.Shown_PartialUpload,B=h.pap_events.file_imports.Shown_ExternalApiError,W=y.pap_events.file_imports.Select_TryAgain,X=S.pap_events.file_imports.Shown_FailedCancel,H=b.pap_events.file_imports.Select_ViewDetails;var q=M.ExternalProvider;const K=e=>{switch(e[".tag"]){case"gdrive":return q.GOOGLE_EXTERNAL_PROVIDER;case"onedrive":return q.MICROSOFT_EXTERNAL_PROVIDER;case"other":break;default:(0,C.enforceExhaustive)(e)}return q.UNKNOWN_EXTERNAL_PROVIDER},z=e=>{switch(e[".tag"]){case"gdrive":return q.GOOGLE_DRIVE_EXTERNAL_PROVIDER;case"onedrive":return q.ONE_DRIVE_EXTERNAL_PROVIDER;case"other":break;default:(0,C.enforceExhaustive)(e)}return q.UNKNOWN_EXTERNAL_PROVIDER};t.logSucceedConnectExternalAccount=e=>{(0,O.logEvent)(M.create({actionSurface:"browse",eventClass:M.EventClass.FILE_IMPORTS,externalProvider:K(e)}))};t.logFailConnectExternalAccount=e=>{(0,O.logEvent)(T.create({actionSurface:"browse",eventClass:T.EventClass.FILE_IMPORTS,externalProvider:K(e)}))};t.logShownNoFiles=e=>{(0,O.logEvent)(A.create({actionSurface:"browse",eventClass:A.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownImportOptions=e=>{(0,O.logEvent)(I.create({actionSurface:"browse",eventClass:I.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectFolderStructure=e=>{(0,O.logEvent)(R.create({actionSurface:"browse",eventClass:R.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectOverwriteFiles=e=>{(0,O.logEvent)(k.create({actionSurface:"browse",eventClass:k.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectDeleteSource=e=>{(0,O.logEvent)(w.create({actionSurface:"browse",eventClass:w.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logStartImportJob=e=>{(0,O.logEvent)(P.create({actionSurface:"browse",eventClass:P.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logCancelImportJob=e=>{(0,O.logEvent)(N.create({actionSurface:"browse",eventClass:N.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSucceedImportJob=({importType:e,srcFilesTotal:t,srcFilesSucceeded:o,srcFilesFailed:r,num4xxErrors:n})=>{(0,O.logEvent)(D.create({actionSurface:"browse",eventClass:D.EventClass.FILE_IMPORTS,externalProvider:z(e),srcFilesTotal:t,srcFilesSucceeded:o,srcFilesFailed:r,num_4xxErrors:n}))};t.logPartialSucceedImportJob=({importType:e,srcFilesTotal:t,srcFilesSucceeded:o,srcFilesFailed:r,num4xxErrors:n,num5xxErrors:s,numOtherErrors:a,allErrorCounts:i})=>{(0,O.logEvent)(x.create({actionSurface:"browse",eventClass:x.EventClass.FILE_IMPORTS,externalProvider:z(e),srcFilesTotal:t,srcFilesSucceeded:o,srcFilesFailed:r,num_4xxErrors:n,num_5xxErrors:s,numOtherErrors:a,allErrorCounts:i}))};t.logShownUnknownError=e=>{(0,O.logEvent)(L.create({actionSurface:"browse",eventClass:L.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownNetworkError=e=>{(0,O.logEvent)(j.create({actionSurface:"browse",eventClass:j.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownImportAlreadyRunning=e=>{(0,O.logEvent)(F.create({actionSurface:"browse",eventClass:F.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownOverquotaPrompt=e=>{(0,O.logEvent)(G.create({actionSurface:"browse",eventClass:G.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectOverquotaUpgrade=e=>{(0,O.logEvent)(U.create({actionSurface:"browse",eventClass:U.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownPartialUpload=e=>{(0,O.logEvent)(V.create({actionSurface:"browse",eventClass:V.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownExternalApiError=e=>{(0,O.logEvent)(B.create({actionSurface:"browse",eventClass:B.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectTryAgain=e=>{(0,O.logEvent)(W.create({actionSurface:"browse",eventClass:W.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logShownFailedCancel=e=>{(0,O.logEvent)(X.create({actionSurface:"browse",eventClass:X.EventClass.FILE_IMPORTS,externalProvider:z(e)}))};t.logSelectViewDetails=e=>{(0,O.logEvent)(H.create({actionSurface:"browse",eventClass:H.EventClass.FILE_IMPORTS,externalProvider:z(e)}))}})),define("metaserver/static/js/file_imports/dropbox/exclog",["require","exports","metaserver/static/js/core/exception"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileImportsExclog=void 0;const r=(e,t,r)=>(0,o.reportStack)(t,{severity:e,tags:["FileImports"],exc_extra:r,silent:!1});t.FileImportsExclog={info:(e,t)=>r(o.SEVERITY.OPERATIONAL,e,t),warn:(e,t)=>r(o.SEVERITY.NONCRITICAL,e,t),error:(e,t)=>r(o.SEVERITY.CRITICAL,e,t),uncaught:(e,t)=>r(o.SEVERITY.UNCAUGHT,e,t)}})),define("metaserver/static/js/file_imports/dropbox/iframe_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToParentType=t.FilePickerViewId=t.FilePickerAction=t.MessageFromParentType=void 0,(function(e){e.OpenGdriveFilePicker="OpenGdriveFilePicker"})(t.MessageFromParentType||(t.MessageFromParentType={})),(function(e){e.PICKED="PICKED",e.CANCELED="CANCELED"})(t.FilePickerAction||(t.FilePickerAction={})),(function(e){e.DOCS="all",e.FOLDERS="folders"})(t.FilePickerViewId||(t.FilePickerViewId={})),(function(e){e.IframeLoaded="IframeLoaded",e.FilePickerResult="FilePickerResult",e.SignInWithDifferentAccount="SignInWithDifferentAccount",e.UnhandledError="UnhandledError",e.UnhandledRejection="UnhandledRejection"})(t.MessageToParentType||(t.MessageToParentType={}))})),define("metaserver/static/js/file_imports/dropbox/supported_services",["require","exports","tslib","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/clean/ts_utils"],(function(e,t,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSupportedService=t.SupportedServices=void 0,r=o.__importDefault(r),t.SupportedServices={GDrive:{displayName:"Google Drive",importType:{".tag":"gdrive"},signinServiceDisplayName:"Google",profileServicesConstant:r.default.GOOGLE,profileServicesApiServiceType:{".tag":"google"},defaultDestPath:"Google Drive",profileServicesAction:"link_read_files"},OneDrive:{displayName:"Microsoft OneDrive",importType:{".tag":"onedrive"},signinServiceDisplayName:"Microsoft",profileServicesConstant:r.default.OUTLOOK,profileServicesApiServiceType:{".tag":"outlook"},defaultDestPath:"Microsoft OneDrive",profileServicesAction:"access_files_and_wiki"}};t.getSupportedService=e=>{switch(e[".tag"]){case"gdrive":return t.SupportedServices.GDrive;case"onedrive":return t.SupportedServices.OneDrive;case"other":break;default:(0,n.enforceExhaustive)(e)}throw new Error(`Bad import type: ${JSON.stringify(e)}`)}})),define("metaserver/static/js/file_imports/gdrive/file_picker",["require","exports","tslib","metaserver/static/js/file_imports/dropbox/iframe_types","metaserver/static/js/file_imports/dropbox/exclog","metaserver/static/js/clean/ts_utils","metaserver/static/js/file_imports/gdrive/file_picker.module.css","metaserver/static/js/file_imports/components/modals/external_provider_api_error_modal","metaserver/static/js/file_imports/dropbox/supported_services","metaserver/static/js/file_imports/ui/sleep"],(function(e,t,o,r,n,s,a,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openGdriveFilePicker=void 0,a=o.__importDefault(a);let d,p=null,u=()=>{},_="",m=()=>{};const f=e=>{var t;p&&(u(e),null===(t=p.parentNode)||void 0===t||t.removeChild(p),window.removeEventListener("message",g),p=null,u=()=>{})},g=e=>o.__awaiter(void 0,void 0,void 0,(function*(){var a;if(!p||"https://file-imports.dropbox.com"!==e.origin||e.source!==p.contentWindow||!(null===(a=e.data)||void 0===a?void 0:a.hasOwnProperty("eventType")))return;const u=e.data;switch(u.eventType){case r.MessageToParentType.IframeLoaded:(null==p?void 0:p.contentWindow)&&p.contentWindow.postMessage({eventType:r.MessageFromParentType.OpenGdriveFilePicker,accessToken:_,views:d,hideSwitchAccountButton:!m},"https://file-imports.dropbox.com");break;case r.MessageToParentType.FilePickerResult:f(u.result);break;case r.MessageToParentType.SignInWithDifferentAccount:f({action:r.FilePickerAction.CANCELED}),null==m||m();break;case r.MessageToParentType.UnhandledError:n.FileImportsExclog.warn(`Unhandled error in file picker iframe: ${u.error}`),yield o.__awaiter(void 0,void 0,void 0,(function*(){yield(0,l.sleep)(500),f({action:r.FilePickerAction.CANCELED}),yield(0,l.sleep)(50)}));const e=()=>{(0,t.openGdriveFilePicker)(_,m)};(0,i.showExternalProviderApiErrorModal)(c.SupportedServices.GDrive,e);break;case r.MessageToParentType.UnhandledRejection:n.FileImportsExclog.warn(`Unhandled rejection in file picker iframe: ${u.error}`);break;default:(0,s.enforceExhaustive)(u)}}));t.openGdriveFilePicker=(e,t,o)=>new Promise(r=>{if(p)throw new Error("File picker already open");_=e,m=t,u=r,d=o,p=document.createElement("iframe"),p.setAttribute("allowTransparency","true"),p.setAttribute("sandbox","allow-scripts allow-same-origin allow-modals"),p.setAttribute("src","https://file-imports.dropbox.com"),p.setAttribute("frameBorder","0"),p.classList.add(a.default.overlay),document.body.appendChild(p),window.addEventListener("message",g)})})),define("metaserver/static/js/file_imports/gdrive/file_picker.module.css",["require","exports","css!metaserver/static/js/file_imports/gdrive/file_picker.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overlay=void 0,t.overlay="_overlay_g01kv_1";t.default={overlay:"_overlay_g01kv_1"}})),define("metaserver/static/js/file_imports/ui/service_names",["require","exports","metaserver/static/js/clean/ts_utils","metaserver/static/js/core/i18n"],(function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalizedLoginServiceName=t.getLocalizedServiceName=void 0;const n=()=>r.intl.formatMessage({id:"h2PZeS",defaultMessage:"Google"}),s=()=>r.intl.formatMessage({id:"MDiUcD",defaultMessage:"Google Drive"}),a=()=>r.intl.formatMessage({id:"Ur1/IM",defaultMessage:"Microsoft"}),i=()=>r.intl.formatMessage({id:"rfdy2l",defaultMessage:"OneDrive"}),c=()=>r.intl.formatMessage({id:"dObY3n",defaultMessage:"Unknown"});t.getLocalizedServiceName=e=>{switch(e[".tag"]){case"gdrive":return s();case"onedrive":return i();case"other":break;default:(0,o.enforceExhaustive)(e)}return c()};t.getLocalizedLoginServiceName=e=>{switch(e[".tag"]){case"gdrive":return n();case"onedrive":return a();case"other":break;default:(0,o.enforceExhaustive)(e)}return c()}})),define("metaserver/static/js/file_imports/ui/sleep",["require","exports","tslib"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=void 0;t.sleep=e=>o.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(t=>setTimeout(t,e))}))}));
//# sourceMappingURL=pkg-account_connected_apps.min.js-vflfv4W6Z.map