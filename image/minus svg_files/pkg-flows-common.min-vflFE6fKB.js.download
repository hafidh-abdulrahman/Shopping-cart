define("typescript/component_libraries/flows/src/components/approval-forms/approval_checkbox_in_share",["require","exports","tslib","react","react-intl","dig-components/tooltips","dig-components/form_row","dig-components/controls","dig-components/typography","dig-components/badges"],(function(e,a,t,o,r,l,p,s,n,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalCheckboxInShare=void 0,o=t.__importDefault(o);a.ApprovalCheckboxInShare=({checked:e,disabled:a=!1,onChange:t,onMount:d})=>{const u=(0,r.useIntl)();o.default.useEffect(()=>{null==d||d()},[d]);return o.default.createElement(({children:e})=>a?o.default.createElement(l.Tooltip,{maxWidth:300,title:u.formatMessage({id:"UjCEGG",defaultMessage:"Approval requests can't be sent to groups."})},e):e,null,o.default.createElement("div",{style:{marginTop:16}},o.default.createElement(p.FormRow,{variant:"control"},o.default.createElement(s.Checkbox,{id:"sendApproval",onChange:t,checked:e,disabled:a}),o.default.createElement(n.Text,{tagName:"label",variant:"label",htmlFor:"sendApproval",style:{marginLeft:8},color:a?"disabled":"standard"},u.formatMessage({id:"JMycGa",defaultMessage:"Request official sign-off from recipients on this file"})),o.default.createElement(i.AccessoryBadge,{style:{marginLeft:4}},u.formatMessage({id:"VgsgAq",defaultMessage:"New"})))))},a.ApprovalCheckboxInShare.displayName="ApprovalCheckboxInShare"})),define("typescript/component_libraries/flows/src/components/approval-forms/approval_feedback_modal",["require","exports","tslib","dig-components/buttons","dig-components/controls","dig-components/modal","dig-components/text_fields","dig-components/typography","react","react-intl","typescript/component_libraries/flows/src/components/approval-forms/index.module.css"],(function(e,a,t,o,r,l,p,s,n,i,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalFeedbackModal=void 0,n=t.__importStar(n),d=t.__importDefault(d);a.ApprovalFeedbackModal=({open:e,onRequestClose:a,onSubmit:t,onBackButtonClick:u,ioClient:c})=>{const{feedbackModalTitle:m,radioButtonTitle:v,radioButtonYesLabel:f,radioButtonNoLabel:_,textAreaYesTitle:g,textAreaNoTitle:h,backButtonLabel:b,submitFeedbackButtonLabel:A,textAreaPlaceholderTitle:M}=(function(){const e=(0,i.useIntl)();return{feedbackModalTitle:e.formatMessage({id:"0/HL+Q",defaultMessage:"What do you think of approval requests?"}),radioButtonTitle:e.formatMessage({id:"ftYhEs",defaultMessage:"Is this feature helpful?"}),radioButtonYesLabel:e.formatMessage({id:"mU1MrK",defaultMessage:"Yes"}),radioButtonNoLabel:e.formatMessage({id:"s6xbpD",defaultMessage:"No"}),textAreaYesTitle:e.formatMessage({id:"iX7U41",defaultMessage:"What suggestions do you have to make it better?"}),textAreaNoTitle:e.formatMessage({id:"ZVfnJI",defaultMessage:"What could make this feature more helpful to you?"}),textAreaPlaceholderTitle:e.formatMessage({id:"Ttsb+L",defaultMessage:"Let us know what you think here"}),backButtonLabel:e.formatMessage({id:"zEvexQ",defaultMessage:"Back"}),submitFeedbackButtonLabel:e.formatMessage({id:"F2GxG/",defaultMessage:"Submit"})}})(),[y,R]=(0,n.useState)(!0),[E,F]=(0,n.useState)("");return n.default.createElement(l.Modal,{open:e,isCentered:!0,withCloseButton:"Close",onRequestClose:a},n.default.createElement(l.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(l.Modal.Title,null,m)),n.default.createElement(l.Modal.Body,null,v,n.default.createElement("div",{className:d.default.feedbackMenuRadioButtons},n.default.createElement(r.RadioButton,{id:"approval-is-helpful",checked:y,onChange:()=>R(!0)}),n.default.createElement(s.Label,{htmlFor:"approval-is-helpful"},f),n.default.createElement(r.RadioButton,{id:"approval-is-not-helpful",checked:!y,onChange:()=>R(!1)}),n.default.createElement(s.Label,{htmlFor:"approval-is-not-helpful"},_)),y?g:h,n.default.createElement("div",{className:d.default.feedbackMenuTextArea},n.default.createElement(p.TextArea,{placeholder:M,maxLength:5e3,onChange:e=>{F(e.currentTarget.value)}})),n.default.createElement(s.Text,{size:"small",color:"faint"},E.length,"/5000")),n.default.createElement(l.Modal.Footer,null,u&&n.default.createElement(o.Button,{variant:"opacity",onClick:u},b),n.default.createElement(o.Button,{variant:"primary",onClick:()=>{t(),c.logApprovalsFeedback(y,E)}},A)))}})),define("typescript/component_libraries/flows/src/components/approval-forms/approval_io_client",["require","exports"],(function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0})})),define("typescript/component_libraries/flows/src/components/approval-forms/approval_request_modal",["require","exports","tslib","dig-components/buttons","dig-components/modal","dig-components/form_row","dig-components/text_fields","dig-components/typography","react","react-intl","typescript/component_libraries/flows/src/components/approval-forms/approval_type_radio_button_group","typescript/component_libraries/flows/src/components/approval-forms/approval_feedback_modal","typescript/component_libraries/flows/src/components/approval-forms/hooks","typescript/component_libraries/flows/src/components/contact-typeahead/index","dig-components/tooltips","dig-components/icons","dig-components/icons/src","typescript/component_libraries/flows/src/components/approval-forms/index.module.css","@dropbox/dig-content-icons"],(function(e,a,t,o,r,l,p,s,n,i,d,u,c,m,v,f,_,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalRequestModal=void 0,n=t.__importStar(n),g=t.__importDefault(g);a.ApprovalRequestModal=({file:e,ioClient:a,multiApprovers:t=!1,onRequestClose:b,onSubmit:A,onSubmitFailure:M,onSubmitSuccess:y,open:R,showFeedbackButton:E=!1})=>{const F=(0,i.useIntl)(),[C,T]=(0,n.useState)(!1),S=a.logger;n.default.useEffect(()=>{S.logShownRequestForm(e.id,"request_approval_modal")},[e.id]);const{canSubmit:B,detailsInputValue:x,handleDetailsChange:I,handleNeedsAllApproversChange:q,handleRecipientsChange:w,handleSubmit:k,needsAllApprovers:L,onQueryChange:N,recipientNumLimit:P,recipients:O,renderTypeaheadSuggestion:j,requestPending:G,suggestions:D}=(0,c.useApprovalRequest)({fileId:e.id,ioClient:a,multiApprovers:t,onCreate:A,onCreateFailure:M,onCreateSuccess:y,actionSurface:"request_approval_modal"}),{modalHeaderSubtitle:U,closeButtonLabel:z,feedbackButtonLabel:H,cancelButtonLabel:W,submitButtonLabel:V,modalBodyTitle:Q,detailsInputLabel:Y,detailsInputPlaceholder:K,approverInputPlaceholder:X,approverInputTooltipTitle:J,singleApproverInputLabel:Z,multiApproverInputLabel:$}=(function(e){const a=(0,i.useIntl)();return{feedbackButtonLabel:a.formatMessage({id:"ivQ2Ac",defaultMessage:"Share feedback"}),cancelButtonLabel:a.formatMessage({id:"wCMmYo",defaultMessage:"Cancel"}),submitButtonLabel:a.formatMessage({id:"c/mz8E",defaultMessage:"Send"}),closeButtonLabel:a.formatMessage({id:"OS5Xe5",defaultMessage:"Close"}),modalHeaderSubtitle:e.modifiedBy?a.formatMessage({id:"RzXKqn",defaultMessage:"Last edited by {modifiedBy} at {modifiedAt}"},{modifiedBy:e.modifiedBy,modifiedAt:e.modifiedAt}):a.formatMessage({id:"s0jdsx",defaultMessage:"Last edited by you at {modifiedAt}"},{modifiedAt:e.modifiedAt}),modalBodyTitle:a.formatMessage({id:"6ta9rl",defaultMessage:"Get approval"}),detailsInputLabel:a.formatMessage({id:"DjtbhT",defaultMessage:"Message"}),detailsInputPlaceholder:a.formatMessage({id:"A62fV9",defaultMessage:"Add a note about what you need approved."}),approverInputPlaceholder:a.formatMessage({id:"0rnwy6",defaultMessage:"Add an email or name"}),approverInputTooltipTitle:a.formatMessage({id:"+lp2vo",defaultMessage:"Approvers are sent an email with your message and a link to the file."}),singleApproverInputLabel:a.formatMessage({id:"zha+hc",defaultMessage:"Approver"}),multiApproverInputLabel:a.formatMessage({id:"gdOMIk",defaultMessage:"Approver(s)"})}})(e),ee=(0,n.useCallback)(()=>{T(!0)},[]),ae=(0,n.useCallback)(()=>{S.logRequestFormCancelClick(e.id,"request_approval_modal"),a.trackUserSurveyEvent("approval_request_abandoned"),b()},[e.id,a,S,b]);return n.default.createElement(n.default.Fragment,null,n.default.createElement(r.Modal,{open:R&&!C,isCentered:!0,withCloseButton:z,onRequestClose:ae,width:540},n.default.createElement("div",{className:g.default.approvalModalContentWrapper},n.default.createElement(r.Modal.Header,{hasBottomSpacing:"title-standard",className:g.default.approvalModalHeader},n.default.createElement(h.FileIcon,{extension:e.name.split(".").pop()||"",size:"small"}),n.default.createElement("div",{className:g.default.approvalModalTitlesWrapper},n.default.createElement("p",{className:g.default.approvalModalHeaderTitle},n.default.createElement(s.Text,{variant:"paragraph",size:"standard",isBold:!0},e.name)),null!==e.modifiedBy&&n.default.createElement("p",{className:g.default.approvalModalHeaderSubtitle},n.default.createElement(s.Text,{variant:"label",size:"small"},U)))),n.default.createElement(r.Modal.Body,{className:g.default.approvalModalBody},n.default.createElement(s.Title,{className:g.default.approvalModalBodyTitle},Q),n.default.createElement(l.FormRow,null,n.default.createElement(m.ContactTypeahead,{placeholder:X,recipients:O,onRecipientsChange:w,onTypeAheadSelection:a=>{S.logAddApprover(e.id,"request_approval_modal",a.dbx_account_id)},suggestions:D,onQueryChange:N,renderTypeaheadSuggestion:j,recipientNumLimit:P,label:t?$:Z,labelSubtext:n.default.createElement(v.Tooltip,{title:J,placement:"right"},n.default.createElement("div",{className:g.default.approvalModalApproverInputTooltip},n.default.createElement(f.UIIcon,{src:_.HelpLine}))),onFocus:()=>{S.logFocusApproverTypeahead(e.id,"request_approval_modal")},maxNumTooltip:F.formatMessage({id:"w7qLQr",defaultMessage:"You can only have {recipientNumLimit, plural, one {# approver} other {# approvers}} per request"},{recipientNumLimit:P})})),t&&O.length>1?n.default.createElement(d.ApprovalTypeRadioButtonGroup,{className:g.default.approvalModalRadioButtonGroup,needsAllApprovers:L,onChange:q}):null,n.default.createElement(l.FormRow,null,n.default.createElement(l.FormLabel,{htmlFor:"approval-request-modal__details-input"},n.default.createElement(s.Text,{isBold:!0,size:"small",tagName:"label"},Y)),n.default.createElement(p.TextArea,{className:g.default.approvalFormsTextArea,id:"approval-request-modal__details-input",placeholder:K,"aria-label":K,value:x,onChange:I}))),n.default.createElement(r.Modal.Footer,{className:g.default.approvalModalFooter},E&&n.default.createElement(o.Button,{variant:"transparent",onClick:ee},H),n.default.createElement(o.Button,{variant:"opacity",onClick:ae},W),n.default.createElement(o.Button,{disabled:!B,isLoading:G,variant:"primary",onClick:k},V)))),E&&n.default.createElement(u.ApprovalFeedbackModal,{open:R&&C,onRequestClose:()=>T(!1),onBackButtonClick:()=>T(!1),onSubmit:()=>T(!1),ioClient:a}))},a.ApprovalRequestModal.displayName="ApprovalRequestModal"})),define("typescript/component_libraries/flows/src/components/approval-forms/approval_type_radio_button_group",["require","exports","tslib","dig-components/controls","dig-components/form_row","dig-components/typography","react","react-intl","classnames","typescript/component_libraries/flows/src/components/approval-forms/index.module.css"],(function(e,a,t,o,r,l,p,s,n,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalTypeRadioButtonGroup=void 0,p=t.__importDefault(p),n=t.__importDefault(n),i=t.__importDefault(i);a.ApprovalTypeRadioButtonGroup=({className:e,needsAllApprovers:a,onChange:t})=>{const{needsAllApproversRadioButtonLabel:d,needsOneApproverRadioButtonLabel:u}=(function(){const e=(0,s.useIntl)();return{needsAllApproversRadioButtonLabel:e.formatMessage({id:"dCiUbC",defaultMessage:"Everyone needs to approve"}),needsOneApproverRadioButtonLabel:e.formatMessage({id:"IVLVww",defaultMessage:"Only one approval needed"})}})();return p.default.createElement(r.FormControlGroup,{className:(0,n.default)(i.default.approvalRadioButtonGroup,e)},p.default.createElement(r.FormRow,{variant:"control"},p.default.createElement(o.RadioButton,{id:"needs-all-approvers",checked:a,onChange:()=>t(!0)}),p.default.createElement(l.Text,{tagName:"label",htmlFor:"needs-all-approvers"},d)),p.default.createElement(r.FormRow,{variant:"control"},p.default.createElement(o.RadioButton,{id:"needs-one-approver",checked:!a,onChange:()=>t(!1)}),p.default.createElement(l.Text,{tagName:"label",htmlFor:"needs-one-approver"},u)))},a.ApprovalTypeRadioButtonGroup.displayName="ApprovalTypeRadioButtonGroup"})),define("typescript/component_libraries/flows/src/components/approval-forms/hooks",["require","exports","tslib","react","typescript/component_libraries/flows/src/components/contact-typeahead/index"],(function(e,a,t,o,r){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.useApprovalRequest=a.MAX_RECIPIENTS_MULTI=void 0,o=t.__importStar(o),a.MAX_RECIPIENTS_MULTI=20;a.useApprovalRequest=({fileId:e,ioClient:t,multiApprovers:l=!1,actionSurface:p,onCreate:s,onCreateFailure:n,onCreateSuccess:i,onEditSuccess:d,editArgs:u,threadId:c})=>{var m;const v=l?a.MAX_RECIPIENTS_MULTI:1,[f,_]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),[b,A]=(0,o.useState)([]),[M,y]=(0,o.useState)(!0),[R,E]=(0,o.useState)(null!==(m=null==u?void 0:u.content)&&void 0!==m?m:""),[F,C]=(0,o.useState)(!1),{suggestions:T,onQueryChange:S}=t.useSuggestions(b),B=t.logger,x=(0,o.useCallback)(e=>o.default.createElement(r.TypeaheadSuggestion,{suggestion:e,getInitials:t.getInitials}),[t.getInitials]),I=(0,o.useCallback)(e=>{_(!1),h(!1),E(e.currentTarget.value)},[]),q=b.length>0&&b.length<=v&&0===b.filter(e=>e.validationResult!==r.ValidationResult.OK).length,w=()=>{var a;_(!1),h(!1),C(!0);const o={actor:"requester",approval_type:"request",requester_email:null==u?void 0:u.approvalMetadata.requester_email,status:"pending",type:"approval",approvers:null!==(a=null==u?void 0:u.approvalMetadata.approvers)&&void 0!==a?a:b.map(({email:e,name:a})=>({email:e,display_name:a})),requires_all:u?u.approvalMetadata.requires_all:M};if(u)t.editApprovalRequest(e,u.commentId,R).then(()=>{null==d||d(u.commentId,c,{text:R,metadata:[o]}),B.logEditApprovalRequestSuccess(e,R.length,c)}).catch(()=>{_(!0),C(!1)});else{const a=b.map(({email:e})=>({email:e}));null==s||s(b.length),t.createApproval(e,R,a,M).then(a=>{null==i||i(b.length,{text:R,metadata:[o]}),B.logSubmitApprovalSuccess(e,p,R.length,JSON.stringify(b.map(({dbx_account_id:e})=>e)),M,b.length,a.comment_id),t.triggerSprigSurvey()}).catch(e=>{var a;null==n||n(b.length,w),_(!0),"user_not_found"===(null===(a=e.error)||void 0===a?void 0:a[".tag"])&&h(!0),C(!1)})}};return{canSubmit:!!u||q,detailsInputValue:R,handleDetailsChange:I,handleNeedsAllApproversChange:a=>{y(a),B.logApproverOptionsClick(e,a,p)},handleRecipientsChange:e=>{_(!1),h(!1),A(e)},handleSubmit:w,hasError:f,isUserNotFoundError:g,needsAllApprovers:M,onQueryChange:S,recipientNumLimit:v,recipients:b,renderTypeaheadSuggestion:x,requestPending:F,suggestions:T}}})),define("typescript/component_libraries/flows/src/components/approval-forms/index",["require","exports","tslib","typescript/component_libraries/flows/src/components/approval-forms/request_form","typescript/component_libraries/flows/src/components/approval-forms/respond_form","typescript/component_libraries/flows/src/components/approval-forms/approval_io_client","typescript/component_libraries/flows/src/components/approval-forms/reducer","typescript/component_libraries/flows/src/components/approval-forms/test_utils","typescript/component_libraries/flows/src/components/approval-forms/url_utils","typescript/component_libraries/flows/src/components/approval-forms/approval_request_modal","typescript/component_libraries/flows/src/components/approval-forms/approval_type_radio_button_group","typescript/component_libraries/flows/src/components/approval-forms/approval_checkbox_in_share","typescript/component_libraries/flows/src/components/approval-forms/gating_utils"],(function(e,a,t,o,r,l,p,s,n,i,d,u,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),t.__exportStar(o,a),t.__exportStar(r,a),t.__exportStar(l,a),t.__exportStar(p,a),t.__exportStar(s,a),t.__exportStar(n,a),t.__exportStar(i,a),t.__exportStar(d,a),t.__exportStar(u,a),t.__exportStar(c,a)})),define("typescript/component_libraries/flows/src/components/approval-forms/reducer",["require","exports"],(function(e,a){"use strict";var t;Object.defineProperty(a,"__esModule",{value:!0}),a.setApprovalForm=a.approvalReducer=a.Action=void 0,(function(e){e.SetApprovalForm="@@approval/setApprovalForm"})(t=a.Action||(a.Action={}));a.approvalReducer=(e={},{type:a,payload:o})=>{switch(a){case t.SetApprovalForm:return Object.assign(Object.assign({},e),o);default:return e}},a.setApprovalForm=function(e){return{type:t.SetApprovalForm,payload:e}}})),define("typescript/component_libraries/flows/src/components/approval-forms/request_form",["require","exports","tslib","react","dig-components/buttons","classnames","typescript/component_libraries/flows/src/components/spacer/index","react-intl","react-intl","dig-components/controls","typescript/component_libraries/flows/src/components/contact-typeahead/index","dig-components/form_row","dig-components/text_fields","dig-components/typography","dig-components/avatar","dig-components/tooltips","dig-components/badges","dig-components/icons","dig-components/icons/src","typescript/component_libraries/flows/src/components/approval-forms/hooks","typescript/component_libraries/flows/src/components/approval-forms/index.module.css"],(function(e,a,t,o,r,l,p,s,n,i,d,u,c,m,v,f,_,g,h,b,A){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalRequestForm=a.ApprovalRequestFormInternal=void 0,o=t.__importDefault(o),l=t.__importDefault(l),A=t.__importDefault(A);a.ApprovalRequestFormInternal=({onCancel:e,onRequestSuccess:a,onEditSuccess:t,ioClient:s,user:M,fileId:y,inlineWithComments:R,approvalVariant:E,editArgs:F,threadId:C})=>{var T;const{canSubmit:S,detailsInputValue:B,handleDetailsChange:x,handleNeedsAllApproversChange:I,handleRecipientsChange:q,handleSubmit:w,hasError:k,isUserNotFoundError:L,needsAllApprovers:N,onQueryChange:P,recipientNumLimit:O,recipients:j,renderTypeaheadSuggestion:G,requestPending:D,suggestions:U}=(0,b.useApprovalRequest)({fileId:y,ioClient:s,multiApprovers:"MULTI_APPROVER"===E,onCreateSuccess:(e,...t)=>null==a?void 0:a(...t),editArgs:F,threadId:C,onEditSuccess:t,actionSurface:"request_approval_form"}),z=o.default.useRef(null),{title:H,requestSubmitButtonLabel:W,cancelButtonLabel:V,detailsInputLabel:Q,detailsInputPlaceholder:Y,approverInputPlaceholder:K,approverInputLabel:X,multiApproverInputLabel:J,approverInputTooltipTitle:Z,userNotFoundError:$,genericError:ee,editSubmitButtonLabel:ae,addAnApproverTooltip:te,createNewRequestTooltip:oe,onlyOneApproverAllowedTooltip:re,onlyTwentyApproversAllowedTooltip:le,betaBadgeLabel:pe,radioButtonAllApprovers:se,radioButtonOneApprover:ne}=(function(){const e=(0,n.useIntl)();return{title:e.formatMessage({id:"hEJ2Yn",defaultMessage:"Get approval"}),requestSubmitButtonLabel:e.formatMessage({id:"6+7BLc",defaultMessage:"Send"}),cancelButtonLabel:e.formatMessage({id:"KQ8scR",defaultMessage:"Cancel"}),detailsInputLabel:e.formatMessage({id:"R+Was/",defaultMessage:"Message"}),detailsInputPlaceholder:e.formatMessage({id:"A62fV9",defaultMessage:"Add a note about what you need approved."}),approverInputPlaceholder:e.formatMessage({id:"0rnwy6",defaultMessage:"Add an email or name"}),approverInputLabel:e.formatMessage({id:"v53Uf+",defaultMessage:"Approver"}),multiApproverInputLabel:e.formatMessage({id:"/qlqYb",defaultMessage:"Approver(s)"}),approverInputTooltipTitle:e.formatMessage({id:"ss5f1a",defaultMessage:"Approvers are sent an email with your message and a link to the file."}),userNotFoundError:e.formatMessage({id:"UzX8SG",defaultMessage:"Couldn’t send approval request because 1 or more approvers don’t have a Dropbox account."}),genericError:e.formatMessage({id:"vK1TiB",defaultMessage:"Something went wrong. Please try again later."}),editSubmitButtonLabel:e.formatMessage({id:"WGyt7S",defaultMessage:"Save changes"}),addAnApproverTooltip:e.formatMessage({id:"CoADMJ",defaultMessage:"Add an approver to your request"}),createNewRequestTooltip:e.formatMessage({id:"2hpgtD",defaultMessage:"Create a new request to get approval from another person"}),onlyOneApproverAllowedTooltip:e.formatMessage({id:"6CxwHA",defaultMessage:"You can only have one approver per request"}),onlyTwentyApproversAllowedTooltip:e.formatMessage({id:"s3OEMQ",defaultMessage:"You can only have twenty approvers per request"}),betaBadgeLabel:e.formatMessage({id:"PbRgl7",defaultMessage:"Beta"}),radioButtonAllApprovers:e.formatMessage({id:"dCiUbC",defaultMessage:"Everyone needs to approve"}),radioButtonOneApprover:e.formatMessage({id:"IVLVww",defaultMessage:"Only one approval needed"})}})(),ie=s.logger;o.default.useEffect(()=>{ie.logShownRequestForm(y,"request_approval_form")},[y]);const de=e=>o.default.createElement(r.Button,{onClick:w,variant:"primary",disabled:e,size:"small",className:A.default.approvalFormFooterPrimaryAction,isLoading:D},F?ae:W);return o.default.createElement("div",{className:(0,l.default)(A.default.approvalForm,{[A.default.inlineWithComments]:R}),ref:z},o.default.createElement("div",{className:A.default.approvalFormTitle},o.default.createElement(v.Avatar,{src:M.photoUrl,backgroundColor:(0,v.avatarColorForUserIdentifier)(M.initials),hasNoOutline:!0,size:"small",style:{marginRight:"6px"}},M.initials),o.default.createElement(m.Text,{isBold:!0,tagName:"h1"},H),o.default.createElement(_.AccessoryBadge,null,pe)),o.default.createElement("div",{className:A.default.approvalFormBody},F?o.default.createElement(o.default.Fragment,null,o.default.createElement(u.FormLabel,{htmlFor:"approval-form__approver"},o.default.createElement(m.Text,{isBold:!0,size:"small",tagName:"label"},"MULTI_APPROVER"===E?J:X)),o.default.createElement(f.Tooltip,{title:oe,boundary:z,placement:"top-start",auto:!0},o.default.createElement(m.Text,{id:"approval-form__approver",size:"small",className:A.default.approvalFormApproverDisplayName},null===(T=F.approvalMetadata.approvers)||void 0===T?void 0:T.map(e=>`@${e.display_name?e.display_name:e.email} `)))):o.default.createElement(d.ContactTypeahead,{placeholder:K,recipients:j,onRecipientsChange:q,onTypeAheadSelection:e=>ie.logAddApprover(y,"request_approval_form",e.dbx_account_id),suggestions:U,onQueryChange:P,renderTypeaheadSuggestion:G,recipientNumLimit:O,label:"MULTI_APPROVER"===E?J:X,labelSubtext:o.default.createElement(f.Tooltip,{title:Z,placement:"top"},o.default.createElement("div",{className:A.default.approvalModalApproverInputTooltip},o.default.createElement(g.UIIcon,{src:h.HelpLine,size:"small"}))),maxNumTooltip:"MULTI_APPROVER"===E?le:re,onFocus:()=>ie.logFocusApproverTypeahead(y,"request_approval_form")}),o.default.createElement(p.Spacer,{multiplier:2}),o.default.createElement(u.FormLabel,{htmlFor:"approval-request-form__details-input"},o.default.createElement(m.Text,{isBold:!0,size:"small",tagName:"label"},Q)),o.default.createElement(c.TextArea,{className:A.default.approvalFormsTextArea,id:"approval-request-form__details-input",placeholder:Y,"aria-label":Y,value:B,onChange:x}),"MULTI_APPROVER"===E&&(j.length>1||(null==F?void 0:F.approvalMetadata.approvers)&&F.approvalMetadata.approvers.length>1)?o.default.createElement(u.FormControlGroup,{className:A.default.approvalFormRadioButtonGroup},o.default.createElement("div",{className:A.default.approvalFormRadioButtonRow},o.default.createElement(i.RadioButton,{checked:F?F.approvalMetadata.requires_all:N,disabled:!!F,"aria-label":se,onClick:()=>I(!0)}),o.default.createElement("div",{className:A.default.approvalFormRadioButtonText},o.default.createElement(m.Text,{size:"small"},se))),o.default.createElement("div",{className:A.default.approvalFormRadioButtonRow},o.default.createElement(i.RadioButton,{checked:F?!F.approvalMetadata.requires_all:!N,disabled:!!F,"aria-label":ne,onClick:()=>I(!1)}),o.default.createElement("div",{className:A.default.approvalFormRadioButtonText},o.default.createElement(m.Text,{size:"small"},ne)))):null,k&&(L?o.default.createElement(u.FormHelperText,{isInvalid:!0},$):o.default.createElement(u.FormHelperText,{isInvalid:!0},ee))),o.default.createElement("div",{className:A.default.approvalFormFooter},o.default.createElement(r.Button,{onClick:()=>{ie.logRequestFormCancelClick(y,"request_approval_form"),s.trackUserSurveyEvent("approval_request_abandoned"),e()},variant:"transparent",size:"small",disabled:D},V),S?de(!1):o.default.createElement(f.Tooltip,{title:te,placement:"top-start",auto:!0,boundary:z},o.default.createElement("span",{style:{display:"inline-block"},tabIndex:0},de(!0)))))},a.ApprovalRequestFormInternal.displayName="ApprovalRequestFormInternal";a.ApprovalRequestForm=e=>o.default.createElement(s.RawIntlProvider,{value:e.intl},o.default.createElement(a.ApprovalRequestFormInternal,Object.assign({},e))),a.ApprovalRequestForm.displayName="ApprovalRequestForm"})),define("typescript/component_libraries/flows/src/components/approval-forms/respond_form",["require","exports","tslib","react","dig-components/buttons","classnames","typescript/component_libraries/flows/src/components/spacer/index","react-intl","react-intl","dig-components/chips","dig-components/icons","dig-components/icons/src","dig-components/form_row","dig-components/text_fields","dig-components/typography","dig-components/avatar","dig-components/tooltips","dig-components/badges","typescript/component_libraries/flows/src/components/approval-forms/index.module.css"],(function(e,a,t,o,r,l,p,s,n,i,d,u,c,m,v,f,_,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalRespondForm=a.ApprovalRespondFormInternal=void 0,o=t.__importStar(o),l=t.__importDefault(l),h=t.__importDefault(h);a.ApprovalRespondFormInternal=({onCancel:e,onRespondSuccess:a,onEditSuccess:t,user:s,inlineWithComments:b,ioClient:A,fileId:M,threadId:y,editArgs:R})=>{var E;const[F,C]=(0,o.useState)(null!==(E=null==R?void 0:R.content)&&void 0!==E?E:""),[T,S]=(0,o.useState)("approved"==(null==R?void 0:R.approvalMetadata.status)||"rejected"!=(null==R?void 0:R.approvalMetadata.status)&&void 0),[B,x]=(0,o.useState)(!1),[I,q]=(0,o.useState)(!1),w=o.default.useRef(null),{title:k,submitButtonLabel:L,cancelButtonLabel:N,detailsInputLabel:P,detailsInputPlaceholder:O,approveChipLabel:j,rejectChipLabel:G,genericError:D,approveOrRequestFirstTooltip:U,addDetailsTooltip:z,betaBadgeLabel:H}=(function(){const e=(0,n.useIntl)();return{title:e.formatMessage({id:"TKvySt",defaultMessage:"Respond to request"}),submitButtonLabel:e.formatMessage({id:"mVrd/b",defaultMessage:"Submit"}),cancelButtonLabel:e.formatMessage({id:"KQ8scR",defaultMessage:"Cancel"}),detailsInputLabel:e.formatMessage({id:"rFAfdB",defaultMessage:"Details"}),detailsInputPlaceholder:e.formatMessage({id:"hzYIsD",defaultMessage:"Tell requester more about your decision"}),approveChipLabel:e.formatMessage({id:"TjnDNv",defaultMessage:"Approve"}),rejectChipLabel:e.formatMessage({id:"YEnec6",defaultMessage:"Request change"}),genericError:e.formatMessage({id:"vK1TiB",defaultMessage:"Something went wrong. Please try again later."}),approveOrRequestFirstTooltip:e.formatMessage({id:"2p63Fj",defaultMessage:"Approve or request change first"}),addDetailsTooltip:e.formatMessage({id:"wWiE03",defaultMessage:"Add details about your change request"}),betaBadgeLabel:e.formatMessage({id:"HA3jPv",defaultMessage:"Beta"})}})(),W=A.logger;o.default.useEffect(()=>{W.logShownRespondForm(M,y)},[M,y]);const V=()=>{x(!1),q(!0);const e={type:"approval",status:T?"approved":"rejected",requester_email:null==R?void 0:R.approvalMetadata.requester_email,approval_type:"response",actor:"approver",approvers:null==R?void 0:R.approvalMetadata.approvers,requires_all:null==R?void 0:R.approvalMetadata.requires_all};R?A.editApprovalResponse(M,R.commentId,T,F).then(()=>{W.logApprovalResponseResubmitSuccess(M,y,e.status,F.length),t&&t(R.commentId,y,{text:F,metadata:[e]})}).catch(()=>{x(!0),q(!1)}):A.respondToApprovalRequest(M,y,T,F).then(()=>{a&&a({text:F,metadata:[e]},y),W.logSubmitResponseSuccess(e.status,M,y,F.length)}).catch(()=>{x(!0),q(!1)})},Q=T||void 0!==T&&!!F,Y=e=>o.default.createElement(r.Button,{onClick:V,variant:"primary",size:"small",disabled:e,className:h.default.approvalFormFooterPrimaryAction,isLoading:I},L),K=e=>{W.logApproveChipClick(M,y,e),S(e)};return o.default.createElement("div",{className:(0,l.default)(h.default.approvalForm,{[h.default.inlineWithComments]:b}),ref:w},o.default.createElement("div",{className:h.default.approvalFormTitle},o.default.createElement(f.Avatar,{src:s.photoUrl,backgroundColor:(0,f.avatarColorForUserIdentifier)(s.initials),hasNoOutline:!0,size:"small",style:{marginRight:"6px"}},s.initials),o.default.createElement(v.Text,{isBold:!0,tagName:"h1"},k),o.default.createElement(g.AccessoryBadge,null,H)),o.default.createElement("div",{className:h.default.approvalFormBody},o.default.createElement("div",{className:h.default.approvalRespondFormActionChipsGroup},o.default.createElement(i.FilterChip,{className:T?h.default.approveActionSelected:void 0,isSelected:T,onClick:()=>K(!0),withIconLeft:o.default.createElement("div",{className:h.default.approvalRespondFormIconContainer},o.default.createElement(d.UIIcon,{size:"small",src:u.CheckmarkCircleLine})),size:"small"},j),o.default.createElement(p.Spacer,{multiplier:2}),o.default.createElement(i.FilterChip,{className:!1===T?h.default.rejectActionSelected:void 0,isSelected:!1===T,onClick:()=>K(!1),withIconLeft:o.default.createElement("div",{className:h.default.approvalRespondFormIconContainer},o.default.createElement(d.UIIcon,{size:"small",src:u.WarningLine})),size:"small"},G)),o.default.createElement(p.Spacer,{multiplier:2}),o.default.createElement(c.FormLabel,{htmlFor:"approval-respond-form__details-input"},o.default.createElement(v.Text,{isBold:!0,size:"small",tagName:"label"},P)),o.default.createElement(m.TextArea,{className:h.default.approvalFormsTextArea,id:"approval-respond-form__details-input",placeholder:O,"aria-label":O,value:F,onChange:e=>{C(e.currentTarget.value)}}),B&&o.default.createElement(c.FormHelperText,{isInvalid:!0},D)),o.default.createElement("div",{className:h.default.approvalFormFooter},o.default.createElement(r.Button,{onClick:()=>{e&&(W.logRespondFormCancelClick(M),e())},variant:"transparent",size:"small",disabled:I},N),Q?Y(!1):o.default.createElement(_.Tooltip,{title:null==T?U:T||F?null:z,placement:"top-start",auto:!0,boundary:w},o.default.createElement("span",{style:{display:"inline-block"},tabIndex:0},Y(!0)))))},a.ApprovalRespondFormInternal.displayName="ApprovalRespondFormInternal";a.ApprovalRespondForm=e=>o.default.createElement(s.RawIntlProvider,{value:e.intl},o.default.createElement(a.ApprovalRespondFormInternal,Object.assign({},e))),a.ApprovalRespondForm.displayName="ApprovalRespondForm"})),define("typescript/component_libraries/flows/src/components/approval-forms/test_utils",["require","exports"],(function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.approvalLogger=a.getMockApprovalIOClient=void 0;a.getMockApprovalIOClient=(e,t)=>({useSuggestions:a=>({suggestions:null!=e?e:[],onQueryChange:()=>{}}),getInitials:e=>"AB",createApproval:(e,a,t,o)=>new Promise(e=>setTimeout(()=>{e({})},1e3)),respondToApprovalRequest:(e,a,t,o)=>Promise.resolve({}),editApprovalResponse:(e,a,t,o)=>Promise.resolve({}),showApprovalDeleteCommentModal:(e,a,t)=>{},editApprovalRequest:(e,a,t)=>Promise.resolve({}),resubmitApprovalRequest:(e,a,t)=>Promise.resolve({}),showApprovalDeleteThreadModal:(e,a,t)=>{},triggerSprigSurvey:()=>{},trackUserSurveyEvent:e=>{},logApprovalsFeedback:(e,a)=>{},logger:a.approvalLogger,getUserExperiments:()=>({flows_approval_flow_variant:t?"M1":"OFF"})}),a.approvalLogger={logRequestApprovalClick:(e,a)=>{},logShownRequestForm:(e,a)=>{},logFocusApproverTypeahead:(e,a)=>{},logRequestFormCancelClick:(e,a)=>{},logAddApprover:(e,a,t)=>{},logSubmitApprovalRequest:()=>{},logSubmitApprovalFailure:()=>{},logSubmitApprovalSuccess:(e,a,t,o,r,l,p)=>{},logApproverOptionsClick:(e,a,t)=>{},logRespondClick:(e,a)=>{},logShownRespondForm:(e,a)=>{},logApproveChipClick:(e,a,t)=>{},logRespondFormCancelClick:e=>{},logSubmitResponseSuccess:(e,a,t,o)=>{},logResubmitRequestClick:(e,a)=>{},logResubmitRequestSuccess:(e,a,t)=>{},logShownRemoveApprovalModal:(e,a,t)=>{},logRemoveApprovalConfirmClick:(e,a,t)=>{},logRemoveApprovalCancelClick:(e,a,t)=>{},logEditApprovalResponseClick:(e,a)=>{},logEditApprovalRequestClick:(e,a)=>{},logApprovalResponseResubmitSuccess:(e,a,t,o)=>{},logEditApprovalRequestSuccess:(e,a,t)=>{},logShownApprovalPostPdfEditingToast:e=>{}}})),define("typescript/component_libraries/flows/src/components/approval-forms/index.module.css",["require","exports","css!typescript/component_libraries/flows/src/components/approval-forms/index.module.out.css"],(function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.approvalModalFooter=a.approvalModalApproverInputTooltip=a.approvalRadioButtonGroup=a.approvalModalRadioButtonGroup=a.approvalModalBodyTitle=a.approvalModalBody=a.approvalModalHeaderTitle=a.approvalModalHeaderSubtitle=a.approvalModalTitlesWrapper=a.approvalModalHeader=a.approvalModalContentWrapper=a.feedbackMenuTextArea=a.feedbackMenuRadioButtons=a.approvalFormRadioButtonText=a.approvalFormRadioButtonRow=a.approvalFormRadioButtonGroup=a.approvalFormApproverDisplayName=a.approvalRespondFormIconContainer=a.rejectActionSelected=a.approveActionSelected=a.approvalRespondFormActionChipsGroup=a.approvalFormsTextArea=a.approvalFormFooterPrimaryAction=a.inlineWithComments=a.approvalFormFooter=a.approvalFormBody=a.approvalFormTitle=a.approvalForm=void 0,a.approvalForm="_approval-form_vhsig_1",a.approvalFormTitle="_approval-form__title_vhsig_9",a.approvalFormBody="_approval-form__body_vhsig_20",a.approvalFormFooter="_approval-form__footer_vhsig_24",a.inlineWithComments="_inline-with-comments_vhsig_31",a.approvalFormFooterPrimaryAction="_approval-form__footer_primary-action_vhsig_40",a.approvalFormsTextArea="_approval-forms__text-area_vhsig_52",a.approvalRespondFormActionChipsGroup="_approval-respond-form__action-chips-group_vhsig_61",a.approveActionSelected="_approve-action-selected_vhsig_66",a.rejectActionSelected="_reject-action-selected_vhsig_72",a.approvalRespondFormIconContainer="_approval-respond-form__icon-container_vhsig_78",a.approvalFormApproverDisplayName="_approval-form__approver-display-name_vhsig_83",a.approvalFormRadioButtonGroup="_approval-form__radio-button-group_vhsig_87",a.approvalFormRadioButtonRow="_approval-form__radio-button-row_vhsig_92",a.approvalFormRadioButtonText="_approval-form__radio-button-text_vhsig_98",a.feedbackMenuRadioButtons="_feedback-menu__radio-buttons_vhsig_102",a.feedbackMenuTextArea="_feedback-menu__text_area_vhsig_109",a.approvalModalContentWrapper="_approval-modal__content-wrapper_vhsig_113",a.approvalModalHeader="_approval-modal__header_vhsig_117",a.approvalModalTitlesWrapper="_approval-modal__titles-wrapper_vhsig_122",a.approvalModalHeaderSubtitle="_approval-modal__header-subtitle_vhsig_129",a.approvalModalHeaderTitle="_approval-modal__header-title_vhsig_128",a.approvalModalBody="_approval-modal__body_vhsig_133",a.approvalModalBodyTitle="_approval-modal__body-title_vhsig_137",a.approvalModalRadioButtonGroup="_approval-modal__radio-button-group_vhsig_142",a.approvalRadioButtonGroup="_approval__radio-button-group_vhsig_148",a.approvalModalApproverInputTooltip="_approval-modal__approver-input-tooltip_vhsig_156",a.approvalModalFooter="_approval-modal__footer_vhsig_161";a.default={approvalForm:"_approval-form_vhsig_1",approvalFormTitle:"_approval-form__title_vhsig_9",approvalFormBody:"_approval-form__body_vhsig_20",approvalFormFooter:"_approval-form__footer_vhsig_24",inlineWithComments:"_inline-with-comments_vhsig_31",approvalFormFooterPrimaryAction:"_approval-form__footer_primary-action_vhsig_40",approvalFormsTextArea:"_approval-forms__text-area_vhsig_52",approvalRespondFormActionChipsGroup:"_approval-respond-form__action-chips-group_vhsig_61",approveActionSelected:"_approve-action-selected_vhsig_66",rejectActionSelected:"_reject-action-selected_vhsig_72",approvalRespondFormIconContainer:"_approval-respond-form__icon-container_vhsig_78",approvalFormApproverDisplayName:"_approval-form__approver-display-name_vhsig_83",approvalFormRadioButtonGroup:"_approval-form__radio-button-group_vhsig_87",approvalFormRadioButtonRow:"_approval-form__radio-button-row_vhsig_92",approvalFormRadioButtonText:"_approval-form__radio-button-text_vhsig_98",feedbackMenuRadioButtons:"_feedback-menu__radio-buttons_vhsig_102",feedbackMenuTextArea:"_feedback-menu__text_area_vhsig_109",approvalModalContentWrapper:"_approval-modal__content-wrapper_vhsig_113",approvalModalHeader:"_approval-modal__header_vhsig_117",approvalModalTitlesWrapper:"_approval-modal__titles-wrapper_vhsig_122",approvalModalHeaderSubtitle:"_approval-modal__header-subtitle_vhsig_129",approvalModalHeaderTitle:"_approval-modal__header-title_vhsig_128",approvalModalBody:"_approval-modal__body_vhsig_133",approvalModalBodyTitle:"_approval-modal__body-title_vhsig_137",approvalModalRadioButtonGroup:"_approval-modal__radio-button-group_vhsig_142",approvalRadioButtonGroup:"_approval__radio-button-group_vhsig_148",approvalModalApproverInputTooltip:"_approval-modal__approver-input-tooltip_vhsig_156",approvalModalFooter:"_approval-modal__footer_vhsig_161"}}));
//# sourceMappingURL=pkg-flows-common.min.js-vflGLYFe0.map