define(["require","exports","tslib","react","typescript/libraries/file-viewer/src/preview_error/preview_error","typescript/libraries/file-viewer/src/renderer","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/data/actions","lodash","typescript/libraries/file-viewer/src/core/utils/support","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/logging/actions","typescript/libraries/file-viewer/src/core/utils/paths","typescript/libraries/file-viewer/src/core/types/preview_type","typescript/libraries/file-viewer/src/core/utils/extension_constants","react-redux"],(function(e,i,r,s,l,t,n,o,c,v,a,p,u,d,w,f,_,y){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FileEntryView=void 0,s=r.__importStar(s);i.FileEntryView=e=>{var i,r,g,P,S,F,E,b,h,I,m,T,A;const{rootArchiveFileInformation:V,isArchiveFilePasswordProtected:D,rootFileId:R,entry:x,archiveFiles:N,fullFilePreviewUi:j,fullRivieraData:z,fileViewerId:C,currentPath:O,config:K,loggingSession:M}=e,U=(0,y.useDispatch)(),k=(0,n.getPreviewKeyForNestedArchiveFile)(R,(0,n.getSubpath)(O)),q=(0,c.getArchiveFilesPreviewMetadata)(N,k),B=(0,p.resolvePreviewType)(q),G=s.useRef(null),H=s.useRef(null),J=s.useRef(null),L=s.useRef(null),Q=s.useRef(null),W=s.useRef(null),X=s.useRef(null),Y=s.useRef(null);if(G.current!==x&&(G.current=x,U((0,v.initializeFilePreviewSession)({fileViewerId:M.file_viewer_session_id,fileId:M.file_id,sjId:M.sj_id,nsId:M.ns_id,deviceType:M.device_type,fileExtension:(0,w.getFileExtension)(x.name),sourceSession:{source_action:o.SourceAction.Click,source_context:o.SourceContext.ArchiveFile,page_start_ts:Date.now(),preview_type:B,was_flipped:!1}})),J.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewAttemptStarted,fileViewerId:C,previewSessionId:e}))),L.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewSupportConfirmed,fileViewerId:C,previewSessionId:e}))),Q.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewSupportDenied,fileViewerId:C,previewSessionId:e}))),W.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewDownloadAttempted,fileViewerId:C,previewSessionId:e}))),X.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewDownloadSucceeded,fileViewerId:C,previewSessionId:e}))),Y.current=(0,a.once)(e=>U((0,d.logSessionEvent)({event:o.SessionEventType.FilePreviewDownloadFailed,fileViewerId:C,previewSessionId:e}))),H.current=M.file_preview_session_id),null!==H.current&&H.current===M.file_preview_session_id)return null;if(H.current=null,null===(i=J.current)||void 0===i||i.call(J,M.file_preview_session_id),D)return null===(r=Q.current)||void 0===r||r.call(Q,M.file_preview_session_id),s.createElement(l.ArchiveFilePasswordProtected,{fileName:V.fileName});switch(B){case f.PreviewType.Audio:case f.PreviewType.Video:case f.PreviewType.Archive:case f.PreviewType.Error:null===(g=Q.current)||void 0===g||g.call(Q,M.file_preview_session_id);let e=B;if(B==f.PreviewType.Error){const i=(0,w.getFileExtension)(x.name);i&&(e=(0,_.resolvePreviewTypeFromExtension)(i))}switch(e){case f.PreviewType.Audio:case f.PreviewType.Video:case f.PreviewType.Archive:return s.createElement(l.ArchiveNestedFiletypeNotSupported,{fileName:x.name,fileSize:null!==(P=x.size)&&void 0!==P?P:0});default:return s.createElement(l.ArchiveFileUnavailable,{fileName:x.name,fileSize:null!==(S=x.size)&&void 0!==S?S:0})}}if(!(j&&(0,c.getFilePreviewUiData)(j,k)))return U((0,v.initializeNestedArchiveFilePreview)({fileViewerId:C,currentPath:O,previewKey:k,previewType:(0,p.resolvePreviewType)((0,c.getArchiveFilesPreviewMetadata)(N,k))})),null===(F=L.current)||void 0===F||F.call(L,M.file_preview_session_id),null===(E=W.current)||void 0===E||E.call(W,M.file_preview_session_id),U((0,v.fetchRivieraData)({fileViewerId:C,previewKey:k,config:K})),null;null===(b=L.current)||void 0===b||b.call(L,M.file_preview_session_id),null===(h=W.current)||void 0===h||h.call(W,M.file_preview_session_id);const Z=Object.assign(Object.assign({},e),{extractConfig:{canExtract:!1},fileConfig:Object.assign(Object.assign({},e.fileConfig),{enable_print:!1}),previewKey:k});if(B===f.PreviewType.SsrDoc){const e=(0,c.getRivieraDataFromSlice)(z,k);if(!e)return null;(null===(I=(0,u.filterDocPreviewRivieraData)(e))||void 0===I?void 0:I.error)?null===(m=Y.current)||void 0===m||m.call(Y,M.file_preview_session_id):null===(T=X.current)||void 0===T||T.call(X,M.file_preview_session_id)}else null===(A=X.current)||void 0===A||A.call(X,M.file_preview_session_id);return s.createElement(t.PreviewRenderer,Object.assign({},Z))},i.FileEntryView.displayName="FileEntryView"}));
//# sourceMappingURL=file_entry_view.min.js-vflrpsRPs.map