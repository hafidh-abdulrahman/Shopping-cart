define("metaserver/static/js/clean/ui/tree_view",["require","exports","tslib","classnames","immutable","react","react-dom","lodash","metaserver/static/js/icon/folder_icon","typescript/libraries/spectrum-content-icon-compatibility/src/index","metaserver/static/js/deprecated_ajax/ajax_as_promised_jquery","metaserver/static/js/clean/em_string","js/filepath/filepath","ts-key-enum","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/sprite","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","metaserver/static/js/clean/ui/tree_item","metaserver/static/js/clean/ui/tree"],(function(e,t,s,i,r,a,n,o,l,d,c,p,u,m,h,f,_,v,w,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserFolderTreeView=t.browseGetFolder=t.AdminFolderTreeView=t.PinnedFolderTreeView=t.FolderTreeView=t.RootIcon=t.TreeView=t.TreeItemView=t.INDENT_SIZE_PX_WITH_DIG_EXPAND_BUTTON=t.INDENT_SIZE_PX=t.MAX_LABEL_LENGTH=void 0,i=s.__importDefault(i),r=s.__importStar(r),a=s.__importDefault(a),n=s.__importStar(n),o=s.__importStar(o),c=s.__importStar(c),t.MAX_LABEL_LENGTH=20,t.INDENT_SIZE_PX=15,t.INDENT_SIZE_PX_WITH_DIG_EXPAND_BUTTON=24;class I extends a.default.Component{render(){return a.default.createElement("ul",{className:"tree-view__group",role:"group"},this.props.children)}}I.displayName="TreeGroupView";class y extends a.default.Component{constructor(){super(...arguments),this.handleClick=e=>{if(e.preventDefault(),e.stopPropagation(),this.props.item.disabled)return;const t=n.findDOMNode(this.refs.expandButton);t&&t.contains(e.target)||this.props.onClick&&this.props.onClick(this.props.item)},this.handleExpandClick=e=>{e.preventDefault(),this.props.onExpandButtonClick&&this.props.onExpandButtonClick(this.props.item,!this.props.isExpanded)}}renderExpandButton(){return a.default.createElement("div",{className:(0,i.default)("tree-view__expand-button",{"is-disabled":this.props.disabled}),onClick:this.handleExpandClick,ref:"expandButton",role:"button"},this.props.useDIGExpandButton?a.default.createElement(a.default.Fragment,null,!this.props.isExpanded&&a.default.createElement("div",{className:(0,i.default)("tree-view__expand-button-vertical",{"is-disabled":this.props.disabled})}),a.default.createElement("div",{className:(0,i.default)("tree-view__expand-button-horizontal",{"is-disabled":this.props.disabled})})):a.default.createElement(f.Sprite,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:this.props.isExpanded?_.intl.formatMessage({id:"nPGI06",defaultMessage:"Collapse"}):_.intl.formatMessage({id:"mGnlBs",defaultMessage:"Expand"})}))}renderIcon(){const{item:e}=this.props,{icon:t,disabled:s}=e;return a.default.createElement("div",{className:"tree-view__icon-wrapper"},a.default.createElement(d.IconContent,{className:"tree-view__item-icon",name:(0,l.convertLegacyFolderIconToSpectrum)(t,"small"),disabled:s||this.props.disabled,height:19,width:19}))}render(){const e=!this.props.canExpand,s=(0,i.default)({"tree-view__item":!0,"tree-view__item--leaf":e}),r=this.props.canExpand&&!this.props.showAsHeader;return a.default.createElement("li",{key:this.props.item.key,id:this.props.id,className:s,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled||this.props.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1,"aria-selected":!!this.props.isSelected||void 0,"aria-expanded":r?this.props.isExpanded:void 0},a.default.createElement("span",{className:(0,i.default)({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled||this.props.disabled}),style:{paddingLeft:this.props.showAsHeader||!this.props.level?0:this.props.level*(this.props.useDIGExpandButton?t.INDENT_SIZE_PX_WITH_DIG_EXPAND_BUTTON:t.INDENT_SIZE_PX)}},this.props.showAsHeader||e?void 0:this.renderExpandButton(),this.props.item.icon?this.renderIcon():void 0,this.props.item.label?a.default.createElement("span",{className:"tree-view__item-label"},p.Emstring.em_snippet(this.props.item.label,t.MAX_LABEL_LENGTH)):void 0),this.props.children)}}t.TreeItemView=y,y.defaultProps={isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:o.noop,onExpandButtonClick:o.noop,showAsHeader:!1,useDIGExpandButton:!1,disabled:!1},y.displayName="TreeItemView";class b extends a.default.Component{renderIcon(){return this.props.useDIGIcon?a.default.createElement("div",{className:"tree-view__icon-wrapper"},a.default.createElement(d.IconContent,{className:"tree-view__item-icon",name:(0,l.convertLegacyFolderIconToSpectrum)(this.props.item.icon,"small"),disabled:!0})):this.props.item.icon?a.default.createElement(f.Sprite,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null}render(){return a.default.createElement("div",{className:(0,i.default)("tree-view__item-row","tree-view__item-row--disabled")},this.renderIcon(),a.default.createElement("h3",{className:"tree-view__header",id:this.props.id},this.props.item.label))}}b.displayName="TreeHeaderView";class E extends a.default.Component{constructor(){super(...arguments),this.state={selectedItemKey:this.props.defaultSelectedPath?this.props.defaultSelectedPath:null,expandedItemKeys:r.Set([this.props.tree.rootItem.key]),showFocused:!1},this.selectItem=e=>{this.props.disabled||(this.setState({selectedItemKey:null!=e&&e.key?e.key:null}),this.props.onItemSelected(e))},this.handleExpandButtonClick=(e,t)=>{this.setState({expandedItemKeys:this.setItemExpanded(e.key,t)}),this.props.onItemExpanded(e,t)},this.handleKeyDown=e=>{switch(e.key){case m.Key.ArrowUp:this.advanceSelection(!0)&&e.preventDefault();break;case m.Key.ArrowDown:this.advanceSelection(!1)&&e.preventDefault();break;case m.Key.ArrowRight:if(null!=this.state.selectedItemKey){const t=this.props.tree.items.get(this.state.selectedItemKey);this.canItemExpand(t)&&(this.handleExpandButtonClick(t,!0),e.preventDefault())}break;case m.Key.ArrowLeft:if(this.state.selectedItemKey){const t=this.props.tree.items.get(this.state.selectedItemKey);this.canItemExpand(t)&&(this.handleExpandButtonClick(t,!1),e.preventDefault())}}},this.rootRef=a.default.createRef(),this.handleOnFocus=()=>this.setState({showFocused:!0}),this.handleOnBlur=()=>this.setState({showFocused:!1})}UNSAFE_componentWillReceiveProps(e){e.resetSelectedItem&&e.resetSelectedItem!==this.props.resetSelectedItem&&this.setState({selectedItemKey:null})}componentDidUpdate(e,t){if(this.state.selectedItemKey&&this.state.selectedItemKey!==t.selectedItemKey&&this.rootRef.current){const e=this.rootRef.current,t=e.querySelector('[aria-selected="true"]');t&&this.scrollElementIntoViewIfNeeded(t,e)}}scrollElementIntoViewIfNeeded(e,t){const s=t.getBoundingClientRect(),i=e.getBoundingClientRect();if(e.offsetTop-t.scrollTop<0)return void e.scrollIntoView(!0);const r=s.height,a=t.scrollTop+r,n=i.height;e.offsetTop+n>a&&n<r&&e.scrollIntoView(!1)}hasSelectableRootItem(){const{rootStyle:e}=this.props;return e===w.RootStyle.TreeItem||e===w.RootStyle.HeaderItem}getHTMLIdPrefix(){return this.HTMLIdPrefix||(this.HTMLIdPrefix=`tree-view-${Math.floor(16777215*Math.random()).toString(16)}`)}getLastLeafOf(e){const t=this.props.tree.getChildItems(e);return this.state.expandedItemKeys.contains(e.key)&&null!=t&&t.size>0?this.getLastLeafOf(t.last()):e}getPrevItem(e){if(!e)return null;const t=this.props.tree.getParentItem(e);if(!t)return null;const s=this.props.tree.getChildItems(t),i=s.indexOf(e);if(i>0)return this.getLastLeafOf(s.get(i-1));if(0===i){return t===this.props.tree.rootItem&&!this.hasSelectableRootItem()?null:t}return null}getNextItem(e,t=!0){if(!e)return null;const s=this.state.expandedItemKeys.contains(e.key)&&this.props.tree.isParent(e);if(t&&s)return this.props.tree.getChildItems(e).first();const i=this.props.tree.getParentItem(e);if(!i)return null;const r=this.props.tree.getChildItems(i),a=r.size-1,n=r.indexOf(e);return n===a?this.getNextItem(i,!1):0<=n&&n<a&&r.get(n+1)||null}advanceSelection(e=!1){if(!this.state.selectedItemKey){let e;if(this.hasSelectableRootItem())e=this.props.tree.rootItem;else{const t=this.props.tree.getChildItems(this.props.tree.rootItem);e=t?t.first():null}return this.selectItem(e),!0}const t=this.props.tree.items.get(this.state.selectedItemKey),s=e?this.getPrevItem(t):this.getNextItem(t);return!!s&&(this.selectItem(s),!0)}getValidHTMLIdForItem(e){return`${this.getHTMLIdPrefix()}${e.key}`.replace(/\s+/g,"_")}setItemExpanded(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)}canItemExpand(e){return e&&(e.canExpand||this.props.tree.isParent(e))}renderSingleItem(e,t,s,i={}){const r=Object.assign({id:this.getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this.canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},i),n=this.props.treeItemView;return a.default.createElement(n,Object.assign({},r),s)}renderItemAndDescendants(e,t){let s;const i=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded;return this.props.tree.isParent(e)&&i&&(s=this.renderChildrenOfItemAsGroup(e,t+1)),this.renderSingleItem(e,t,s,{useDIGExpandButton:this.props.useDIGExpandButton,disabled:this.props.disabled})}renderChildrenOfItemAsGroup(e,t){if(!e||!this.props.tree.isParent(e))return null;const s=this.props.tree.getChildItems(e).map(e=>this.renderItemAndDescendants(e,t));return a.default.createElement(I,null,s.toJS())}render(){let e,t,s;const{rootItem:r}=this.props.tree;if(this.props.rootStyle===w.RootStyle.TreeItem)t=a.default.createElement(I,null,this.renderItemAndDescendants(r,0));else if(this.props.rootStyle===w.RootStyle.HeaderItem)e=this.getValidHTMLIdForItem(r),t=a.default.createElement(I,null,this.renderSingleItem(r,0,null,{showAsHeader:!0,id:e,disabled:this.props.disabled}),this.renderChildrenOfItemAsGroup(r,0));else if(this.props.rootStyle===w.RootStyle.StaticHeader)e=this.getValidHTMLIdForItem(r),t=a.default.createElement(I,null,a.default.createElement(b,{item:r,id:e,useDIGIcon:this.props.useDIGExpandButton}),this.renderChildrenOfItemAsGroup(r,0));else{if(this.props.rootStyle!==w.RootStyle.None)throw new Error(`Unknown root style: ${this.props.rootStyle}`);t=this.renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}if(this.props.defaultSelectedPath?this.state.selectedItemKey&&this.state.selectedItemKey in this.props.tree.items:this.state.selectedItemKey){const e=this.props.tree.items.get(this.state.selectedItemKey);s=this.getValidHTMLIdForItem(e)}return a.default.createElement("div",{role:"tree",tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:(0,i.default)("tree-view","ax-focusable",{"is-focused":this.state.showFocused&&!this.props.disabled,"is-disabled":this.props.disabled}),"aria-labelledby":e||void 0,"aria-activedescendant":s,onKeyDown:this.handleKeyDown,ref:this.rootRef},t,this.props.children)}}var F;E.defaultProps={rootStyle:w.RootStyle.None,onItemSelected:e=>{},onItemExpanded:(e,t)=>{},treeItemView:y,defaultSelectedPath:"",useDIGExpandButton:!1,disabled:!1},E.displayName="TreeViewWithoutCSS",t.TreeView=(0,h.requireCssWithComponent)(E,["/static/metaserver/static/css/react/tree_view-vfl59yfhc.css","/static/metaserver/static/css/accessibility-vfliGZNRm.css"]),(function(e){e.BRIEFCASE="s_briefcase",e.HOUSE="s_house",e.DROPBOX="dropbox",e.TEAM="folder_team"})(F=t.RootIcon||(t.RootIcon={}));const S=e=>new w.FolderTreeItem({key:e.path,label:(0,u.filename)(e.path),canExpand:e.has_subdirs,icon:e.icon,disabled:e.read_only},e.contained_ns);class A extends a.default.Component{constructor(){super(...arguments),this._pendingAjaxRequest=null,this._pendingAjaxRequestAbortController=null,this.state={showLoadingScreen:!1,tree:g.Tree.createWithRootItem(new w.TreeItem({key:"/",icon:this.props.rootIcon,label:this.props.treeRootName}))},this.asyncFetchSubFoldersForItem=e=>{var t;const s=e===this.state.tree.rootItem;s&&this.setState({showLoadingScreen:!0}),this._pendingAjaxRequest&&(null===(t=this._pendingAjaxRequestAbortController)||void 0===t||t.abort()),this._pendingAjaxRequestAbortController=new AbortController,this._pendingAjaxRequest=this.props.mkAjaxRequest(e.key,this._pendingAjaxRequestAbortController.signal),Promise.resolve(this._pendingAjaxRequest).then(t=>{const s=this.parseFolderList(t),i=this.state.tree.setChildItems(e,s);this.setState({tree:i})}).catch(this.props.handleError).then(()=>{if(null==this._pendingAjaxRequest)return;this._pendingAjaxRequest=null,s&&(this.props.isLoadingAdditionalData||this.setState({showLoadingScreen:!1}));const e=n.findDOMNode(this.refs.treeView);e&&e.focus()})},this.handleItemSelected=e=>{null!==e&&(e instanceof w.FolderTreeItem?this.props.onFolderSelected(e.key,e.folderNsId,e.icon):this.props.onFolderSelected(e.key,void 0,e.icon))},this.handleExpandButtonClick=(e,t)=>{t&&!this.state.tree.isParent(e)&&this.asyncFetchSubFoldersForItem(e)},this.renderLoadingMessage=()=>a.default.createElement("span",{className:"tree-view__loading-label"},_.intl.formatMessage({id:"9fef95",defaultMessage:"Loading your foldersâ€¦"}))}componentDidMount(){this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)}UNSAFE_componentWillReceiveProps(e){e.isLoadingAdditionalData||e.isLoadingAdditionalData===this.props.isLoadingAdditionalData||this.setState({showLoadingScreen:!1})}componentWillUnmount(){var e;this._pendingAjaxRequest&&(null===(e=this._pendingAjaxRequestAbortController)||void 0===e||e.abort(),this._pendingAjaxRequest=null)}parseFolderList(e){return e.map(S)}render(){const e=this.props.isRootSelectable?w.RootStyle.HeaderItem:w.RootStyle.StaticHeader;return a.default.createElement(t.TreeView,{ref:"treeView",tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick,resetSelectedItem:this.props.resetSelectedItem,defaultSelectedPath:this.props.defaultSelectedPath,useDIGExpandButton:this.props.useDIGExpandButton,disabled:this.props.disabled},this.state.showLoadingScreen?this.renderLoadingMessage():void 0)}}A.defaultProps={onFolderSelected:(e,t,s)=>{},handleError(e){v.Notify.error(_.intl.formatMessage({id:"dFFA0Z",defaultMessage:"An error occurred while trying to load your folder."}))}},A.displayName="AbstractFolderTreeView";class D extends A{}t.FolderTreeView=D;class x extends A{parseFolderList(e){let t=e;this.props.folderToHide&&(t=e.filter(e=>e.path!==this.props.folderToHide));let s=-1;const i=t.map((e,t)=>{const i=e.path;return this.props.pinnedFolder&&i===this.props.pinnedFolder&&(s=t),S(e)});if(-1!==s){const e=i[s];i.splice(s,1),i.unshift(e)}return i}}function j(e,t,s){const i={folder:t};return c.WebRequestOref({url:"/browse_util/tree_view_folders",type:"POST",subject_user:e,data:i,dataType:"json",signal:s})}t.PinnedFolderTreeView=x,t.AdminFolderTreeView=function(e){const t=e.mkAjaxRequest||((t,s)=>(function(e,t,s,i){const r={ns_id:s,ns_path:t,hide_tmfs:!0};return c.WebRequestOref({url:"/browse_util/tree_view_team_folder_contents",type:"POST",subject_user:e,data:r,dataType:"json",signal:i})})(e.userId,t,e.rootNSID,s));return a.default.createElement(D,Object.assign({},e,{rootIcon:F.DROPBOX,mkAjaxRequest:t}))},t.browseGetFolder=j,t.UserFolderTreeView=function(e){const t=e.mkAjaxRequest||((t,s)=>j(e.user.id,t,s)),s=e.forceRootSelectable||"edit"===e.user.user_root_permissions,i=e.is_paired?e.user.is_team?F.BRIEFCASE:F.HOUSE:F.DROPBOX,r=Object.assign(Object.assign({},e),{mkAjaxRequest:t,isRootSelectable:s,rootIcon:i});if(e.user.is_cdm_member){const t=e.user.cdm_tmf_path;return a.default.createElement(x,Object.assign({},r,{pinnedFolder:t}))}return a.default.createElement(D,Object.assign({},r))}})),define("metaserver/static/js/file_store/actions",["require","exports","tslib","metaserver/static/js/file_store/types","metaserver/static/js/file_store/utils","lodash"],(function(e,t,s,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.putFiles=t.putFile=void 0,a=s.__importStar(a),t.putFile=function(e,t){return{type:i.FileNamespaceActions.PutFile,payload:{file:e,fileId:null!=t?t:(0,r.getFileStoreId)(e)}}},t.putFiles=function(e){const t=a.keyBy(e,r.getFileStoreId);return{type:i.FileNamespaceActions.PutFileMap,payload:t}}})),define("metaserver/static/js/file_store/reducer",["require","exports","metaserver/static/js/file_store/types"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileNamespaceReducer=t.defaultFileState=void 0,t.defaultFileState={},t.fileNamespaceReducer=function(e=t.defaultFileState,i){switch(i.type){case s.FileNamespaceActions.PutFile:return Object.assign(Object.assign({},e),{[i.payload.fileId]:i.payload.file});case s.FileNamespaceActions.PutFileMap:return Object.assign(Object.assign({},e),i.payload)}return e}})),define("metaserver/static/js/file_store/selectors",["require","exports","metaserver/static/js/file_store/reducer","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors"],(function(e,t,s,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFile=void 0,t.getFile=function(e,t){return t?(function(e){return(0,r.getStateAtNamespace)(e,i.FILE_NAMESPACE_KEY)||s.defaultFileState})(e)[t]:void 0}})),define("metaserver/static/js/file_store/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNamespaceActions=void 0,(function(e){e.PutFile="PUT_FILE",e.PutFileMap="PUT_FILE_MAP"})(t.FileNamespaceActions||(t.FileNamespaceActions={}))})),define("metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial.module.css",["require","exports","css!metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileIcon=t.appDownloadInterstialCopyNotification=t.appDownloadInterstitialContentThumbnail=t.appDownloadInterstitialContent=t.appDownloadInterstitialCta=t.appDownloadInterstitialCtas=t.appDownloadInterstitialClose=t.dropboxLogo=t.appDownloadInterstitialContainer=void 0,t.appDownloadInterstitialContainer="_app-download-interstitial-container_1bwad_1",t.dropboxLogo="_dropbox-logo_1bwad_18",t.appDownloadInterstitialClose="_app-download-interstitial-close_1bwad_33",t.appDownloadInterstitialCtas="_app-download-interstitial-ctas_1bwad_44",t.appDownloadInterstitialCta="_app-download-interstitial-cta_1bwad_44",t.appDownloadInterstitialContent="_app-download-interstitial-content_1bwad_64",t.appDownloadInterstitialContentThumbnail="_app-download-interstitial-content-thumbnail_1bwad_77",t.appDownloadInterstialCopyNotification="_app-download-interstial-copy-notification_1bwad_91",t.fileIcon="_file-icon_1bwad_96";t.default={appDownloadInterstitialContainer:"_app-download-interstitial-container_1bwad_1",dropboxLogo:"_dropbox-logo_1bwad_18",appDownloadInterstitialClose:"_app-download-interstitial-close_1bwad_33",appDownloadInterstitialCtas:"_app-download-interstitial-ctas_1bwad_44",appDownloadInterstitialCta:"_app-download-interstitial-cta_1bwad_44",appDownloadInterstitialContent:"_app-download-interstitial-content_1bwad_64",appDownloadInterstitialContentThumbnail:"_app-download-interstitial-content-thumbnail_1bwad_77",appDownloadInterstialCopyNotification:"_app-download-interstial-copy-notification_1bwad_91",fileIcon:"_file-icon_1bwad_96"}})),define("metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial",["require","exports","tslib","classnames","react","lodash","dig-components/logos","dig-components/typography","dig-components/buttons","dig-components/icons/src","dig-components/icons","dig-components/truncate","typescript/libraries/spectrum-content-icon-compatibility/src/index","typescript/libraries/spectrum-content-icon-compatibility/src/index","metaserver/static/js/open_in_app/types","metaserver/static/js/core/i18n","metaserver/static/js/components/ui/css","metaserver/static/js/open_in_app/actions","metaserver/static/js/clean/open_in_mobile_app","metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial.module.css","metaserver/static/js/metrics/index","metaserver/static/js/edison/edison"],(function(e,t,s,i,r,a,n,o,l,d,c,p,u,m,h,f,_,v,w,g,I,y){"use strict";function b({onClose:e}){return r.default.createElement("header",null,r.default.createElement("h1",{className:g.dropboxLogo},r.default.createElement(n.FssWordmark,null)),r.default.createElement(l.IconButton,{className:g.appDownloadInterstitialClose,variant:"transparent",size:"small","aria-label":f.intl.formatMessage({id:"5xXFHL",defaultMessage:"Close"}),onClick:e},r.default.createElement(c.UIIcon,{src:d.CloseLine})))}function E({appUrls:e,onContinue:t,onAppDownload:s}){const i=r.default.useCallback(()=>{null==s||s(),(0,v.openInApp)(e)},[e,s]);return r.default.createElement("div",{className:g.appDownloadInterstitialCtas},r.default.createElement(w.CopyUrlLabelText,{className:g.appDownloadInterstialCopyNotification}),r.default.createElement(l.Button,{className:g.appDownloadInterstitialCta,size:"large",variant:"primary",href:S(e),onClick:i},f.intl.formatMessage({id:"iFaoLl",defaultMessage:"Get the app"})),r.default.createElement(l.Button,{className:g.appDownloadInterstitialCta,size:"large",variant:"opacity",onClick:t},f.intl.formatMessage({id:"D55B6I",defaultMessage:"Or continue to website"})))}function F({fileOrFolderName:e,isFolder:t,ownerName:s,ownerTeamName:i}){return r.default.createElement("section",{className:g.appDownloadInterstitialContent},r.default.createElement("header",null,r.default.createElement(o.Title,null,f.intl.formatMessage({id:"F43usw",defaultMessage:"Get a better view with our mobile app"}))),r.default.createElement("div",{className:g.appDownloadInterstitialContentThumbnail},t?r.default.createElement(m.IconContent,{name:"folder_shared-large",className:g.fileIcon}):r.default.createElement(u.FileIcon,{path:e,variant:"large",className:g.fileIcon}),r.default.createElement("div",null,r.default.createElement(o.Text,{isBold:!0},r.default.createElement(p.Truncate,{location:.5},e))),r.default.createElement(o.Text,{color:"faint"},(n=i,(a=s)&&n?f.intl.formatMessage({id:"eqU+DV",defaultMessage:"{owner} ({team}) shared this with you."},{owner:a,team:n}):a&&!n?f.intl.formatMessage({id:"6skgcw",defaultMessage:"{owner} shared this with you."},{owner:a}):!a&&n?f.intl.formatMessage({id:"pT8Q4Y",defaultMessage:"{team} shared this with you."},{team:n}):f.intl.formatMessage({id:"RDRrX1",defaultMessage:"This file was shared with you."})))));var a,n}function S(e){if(e){if((0,h.areUrlsIOS)(e))return e.iOSAppStoreUrl;if((0,h.areUrlsAndroid)(e))return e.androidAppUrl}}Object.defineProperty(t,"__esModule",{value:!0}),t.logInterstitialEventToAmp=t.AppDownloadInterstitial=void 0,i=s.__importDefault(i),r=s.__importDefault(r),g=s.__importStar(g);const A=(0,_.requireCssWithComponent)(e=>{const{className:t,open_in_app_data:s,fileOrFolderName:n,isFolder:o,onClose:l,onContinue:d,onAppDownload:c,ownerName:p,ownerTeamName:u}=e,[m,h]=r.default.useState(()=>window.innerHeight);return r.default.useEffect(()=>{const e=(0,a.throttle)(()=>{h(window.innerHeight)});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),r.default.createElement("section",{className:(0,i.default)(g.appDownloadInterstitialContainer,t),style:{height:m}},r.default.createElement(b,{onClose:l}),r.default.createElement(F,{isFolder:o,fileOrFolderName:n,ownerName:p,ownerTeamName:u}),r.default.createElement(E,{onContinue:d,onAppDownload:c,appUrls:s}))},["/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"]);t.AppDownloadInterstitial=A;t.logInterstitialEventToAmp=(e,t)=>{(0,I.getMetricsReporter)().createStats({ns:"web_previews",name:e},{source:t,is_edison:y.Edison.initialized().toString()}).record(1)}})),define("metaserver/static/js/file_viewer/data/actions",["require","exports","tslib","metaserver/static/js/file_store/actions","metaserver/static/js/previews/data/actions","metaserver/static/js/file_store/utils","metaserver/static/js/file_viewer/data/types","metaserver/static/js/previews/data/util","metaserver/static/js/clean/downloads","metaserver/static/js/core/uri","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,s,i,r,a,n,o,l,d,c){"use strict";function p(e){return{type:n.Actions.OpenFile,payload:{fileId:e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.resetVoiceoverTrigger=t.triggerVoiceover=t.registerUser=t.download=t.openFile=t.closeFile=t.openFileById=t.dismissAppDownloadInterstitial=void 0,l=s.__importStar(l),t.dismissAppDownloadInterstitial=function(){return{type:n.Actions.DismissAppDownloadInterstitial}},t.openFileById=p,t.closeFile=function(){return{type:n.Actions.CloseFile}},t.openFile=function(e){return(t,n)=>s.__awaiter(this,void 0,void 0,(function*(){const s=(0,a.getFileStoreId)(e),l=(0,i.putFile)(e);t(l),!(0,o.previewDataPresentForFile)(n(),e)&&!(0,o.previewDataInFlight)(n(),e)&&(l.payload.file.preview?t((0,r.populateFilesPreviewData)([l.payload.file])):t((0,r.fetchPreviewData)([l.payload.file],void 0,void 0,c.fileViewerFeatureExperiments.imgSizeOptimization))),t(p(s))}))},t.download=function(e){const t=d.URI.parse(e.href);t.updateQuery({dl:"1"}),l.get({url:t.toString()})},t.registerUser=function(e){return(t,s)=>{t({type:n.Actions.RegisterUser,payload:{user:e}})}},t.triggerVoiceover=function(e){return t=>{t({type:n.Actions.TriggerVoiceover,payload:{triggered:!0,useCamera:e}})}},t.resetVoiceoverTrigger=function(){return e=>{e({type:n.Actions.ResetVoiceoverTrigger})}}})),define("metaserver/static/js/file_viewer/data/selectors",["require","exports","tslib","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors","metaserver/static/js/file_store/selectors","metaserver/static/js/previews/data/selectors","reselect","lodash"],(function(e,t,s,i,r,a,n,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviewApiDataForCurrentFile=t.getVoiceoverTriggerState=t.getCurrentFile=t.getCurrentFileId=t.getAppDownloadInterstitial=t.getFileViewerState=void 0,l=s.__importStar(l);t.getFileViewerState=e=>(0,r.getStateAtNamespace)(e,i.FILE_VIEWER_NAMESPACE_KEY);t.getAppDownloadInterstitial=e=>(0,t.getFileViewerState)(e).appDownloadInterstitialDismissed;t.getCurrentFileId=e=>(0,t.getFileViewerState)(e).currentFileId,t.getCurrentFile=(0,o.createSelector)(l.nthArg(0),t.getCurrentFileId,a.getFile);t.getVoiceoverTriggerState=e=>(0,t.getFileViewerState)(e).voiceoverTriggerState;t.getPreviewApiDataForCurrentFile=e=>{const s=(0,t.getCurrentFile)(e);return(0,n.getApiDataForFile)(e,s).data}})),define("metaserver/static/js/file_viewer/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Actions=void 0,(function(e){e.CloseFile="FileViewer/CloseFile",e.DismissAppDownloadInterstitial="FileViewer/DismissAppDownloadInterstitial",e.OpenFile="FileViewer/OpenFile",e.RegisterUser="FileViewer/RegisterUser",e.TriggerVoiceover="FileViewer/TriggerVoiceover",e.ResetVoiceoverTrigger="FileViewer/ResetVoiceoverTrigger"})(t.Actions||(t.Actions={}))})),define("metaserver/static/js/loggers/device_type",["require","exports","tslib","metaserver/static/js/core/browser_detection"],(function(e,t,s,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceType=t.DeviceType=void 0,i=s.__importStar(i),(function(e){e.desktop="desktop",e.mobile="mobile",e.tablet="tablet"})(r=t.DeviceType||(t.DeviceType={})),t.getDeviceType=function(){return i.is_supported_mobile_browser()?r.mobile:i.is_tablet()?r.tablet:r.desktop}})),define("metaserver/static/js/previews/api",["require","exports","metaserver/static/js/api_v2/user_client","metaserver/static/js/api_v2/noauth_client"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPreviewData=t.MAX_REQUEST_SIZE=void 0,t.MAX_REQUEST_SIZE=50,t.fetchPreviewData=function(e,t,r=!1){if(!t)return Promise.reject(new Error("user not logged in, no support for un-auth'd users yet"));const a={files:e.map(e=>({ns_id:e.ns_id,sj_id:e.sjid})),include_dimensions:r};return t?(new s.UserApiV2Client).ns("previews").rpc("get_preview_data_batch",a,{subjectUserId:t.id}):(new i.NoAuthApiV2Client).ns("previews").rpc("get_preview_data_batch",a,{})}})),define("metaserver/static/js/previews/data/actions",["require","exports","tslib","lodash","metaserver/static/js/previews/data/types","metaserver/static/js/redux/constants","metaserver/static/js/previews/data/util","metaserver/static/js/previews/api","metaserver/static/js/file_store/utils"],(function(e,t,s,i,r,a,n,o,l){"use strict";function d(e){return{type:r.ActionTypes.UpdatePreviewData,payload:e}}function c(e,t){const s=t.results.reduce((e,t)=>(e[(0,l.getFileRevisionId)({ns_id:t.file.ns_id,sjid:t.file.sj_id})]=t,e),{});return{type:r.ActionTypes.UpdatePreviewData,payload:e.reduce((e,t)=>{const i=s[t],r={data:null==i?void 0:i.preview,status:a.ApiClientStatus.Success};return e[t]=r,e},{})}}function p(e){return{type:r.ActionTypes.UpdatePreviewData,payload:(0,i.mapValues)(e,e=>({data:void 0,status:a.ApiClientStatus.Error}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.apiRequestErrorAction=t.apiRequestSuccessAction=t.apiRequestInFlightAction=t.updatePreviewData=t.buildPreviewData=t.fetchPreviewUrl=t.fetchPreviewData=t.populateFilesPreviewData=void 0,t.populateFilesPreviewData=function(e){const t={};return e.forEach(e=>{const s=(0,l.getFileRevisionId)(e),i=e.preview;i&&(t[s]={data:i,status:a.ApiClientStatus.Success})}),{type:r.ActionTypes.UpdatePreviewData,payload:t}},t.fetchPreviewData=function(e,i,r,d){return(u,m)=>s.__awaiter(this,void 0,void 0,(function*(){const h=(0,n.filterFilesMissingPreviewData)(m(),e,r);if(0===h.length)return;const f=(0,n.chunkFiles)(h,o.MAX_REQUEST_SIZE).map(e=>(function(e,i,r,n){return s.__awaiter(this,void 0,void 0,(function*(){const s=(function(e){return e.reduce((e,t)=>(e[(0,l.getFileRevisionId)(t)]={data:void 0,status:a.ApiClientStatus.Request},e),{})})(i);e((0,t.apiRequestInFlightAction)(s));try{const t=yield(0,o.fetchPreviewData)(i,r,n);return e(c(Object.keys(s),t))}catch(t){return e(p(s))}}))})(u,e,i,d));return Promise.all(f)}))},t.fetchPreviewUrl=function(e,t){return(0,o.fetchPreviewData)([e],t).then(e=>{if(e.results.length>0){const t=e.results[0].preview;if(t&&t.preview_url)return t.preview_url}})},t.buildPreviewData=function(e,t){return e.reduce((e,s)=>(e[(0,l.getFileRevisionId)(s)]={data:s.preview,status:t},e),{})},t.updatePreviewData=d,t.apiRequestInFlightAction=d,t.apiRequestSuccessAction=c,t.apiRequestErrorAction=p})),define("metaserver/static/js/previews/data/reducer",["require","exports","metaserver/static/js/previews/data/types"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=t.initialState=void 0,t.initialState={filePreviews:{}},t.reducer=function(e=t.initialState,i){switch(i.type){case s.ActionTypes.UpdatePreviewData:return Object.assign(Object.assign({},e),{filePreviews:Object.assign(Object.assign({},e.filePreviews),i.payload)});default:return e}}})),define("metaserver/static/js/previews/data/selectors",["require","exports","metaserver/static/js/redux/constants","metaserver/static/js/redux/selectors","metaserver/static/js/file_store/utils","metaserver/static/js/redux/namespaces"],(function(e,t,s,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApiDataForFiles=t.getApiDataForFile=void 0;const n={data:void 0,status:s.ApiClientStatus.Error};function o(e,t){const s=(function(e){return(0,i.getStateAtNamespace)(e,a.PREVIEW_NAMESPACE_KEY)})(e);if(!s||!t)return n;const o=(0,r.getFileRevisionId)(t),l=s.filePreviews[o];return l&&l.status?l:n}t.getApiDataForFile=o,t.getApiDataForFiles=function(e,t){return t.reduce((t,s)=>(t[(0,r.getFileRevisionId)(s)]=o(e,s),t),{})}})),define("metaserver/static/js/previews/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.UpdatePreviewData="FileViewer/Previews/UpdatePreviewData"})(t.ActionTypes||(t.ActionTypes={}))})),define("metaserver/static/js/previews/data/util",["require","exports","tslib","lodash","metaserver/static/js/previews/data/selectors","metaserver/static/js/file_store/utils","metaserver/static/js/redux/constants"],(function(e,t,s,i,r,a,n){"use strict";function o(e,t){const s=(0,r.getApiDataForFile)(e,t);return s?s.status:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.chunkFiles=t.previewDataStatus=t.previewDataInFlight=t.previewDataPresentForFile=t.filterFilesMissingPreviewData=void 0,i=s.__importStar(i),t.filterFilesMissingPreviewData=function(e,t,s=!1){if(s)return t;const o=(0,r.getApiDataForFiles)(e,t);return i.filter(t,e=>{const t=(0,a.getFileRevisionId)(e);return!e.is_dir&&(!o[t]||!o[t].data&&o[t].status===n.ApiClientStatus.Error)})},t.previewDataPresentForFile=function(e,t){const s=(0,r.getApiDataForFile)(e,t);return!(!s||!s.data||s.status===n.ApiClientStatus.Error)},t.previewDataInFlight=function(e,t){return o(e,t)===n.ApiClientStatus.Request},t.previewDataStatus=o,t.chunkFiles=function(e,t){if(e.length<=0)return[];if(e.length<t)return[e];const s=Array(Math.ceil(e.length/t));let i=0,r=0;for(;i<e.length;)s[r++]=e.slice(i,i+=t);return s}})),define("metaserver/static/js/previews/ui/sharing_plugin/copy_link_button",["require","exports","tslib","metaserver/static/js/sharing/ui_notifications_util","metaserver/static/js/sharing/clean/util/link_util/parser","metaserver/static/js/clean/clipboard_v3","dig-components/buttons","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar"],(function(e,t,s,i,r,a,n,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkButton=void 0,r=s.__importStar(r),o=s.__importDefault(o);t.CopyLinkButton=e=>{var t;const s=l.intl.formatMessage({id:"8QMEOE",defaultMessage:"Copy link"});return o.default.createElement(n.Button,{className:"copy-link-button",variant:null!==(t=e.variant)&&void 0!==t?t:"opacity",onClick:()=>{(0,a.copyToClipboard)(r.getCleanedSharingUrl(e.parsedLink),()=>{(()=>{var t;null===(t=d.Snackbar.manager)||void 0===t||t.reset(),(0,i.showCopyLinkSuccessSnackbar)(r.getCleanedSharingUrl(e.parsedLink),e.linkAccessLevel),e.logSuccess()})()},()=>{(()=>{var t;null===(t=d.Snackbar.manager)||void 0===t||t.reset(),(0,i.showCopyLinkErrorSnackbar)(r.getCleanedSharingUrl(e.parsedLink)),e.logFailure()})()})}},s)},t.CopyLinkButton.displayName="CopyLinkButton"})),define("metaserver/static/js/sharing/clean/util/link_util/parser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCleanedSharingUrl=t.parseLink=void 0;t.parseLink=e=>{const t=new URL(e),s=null!=t.searchParams.get("rlkey"),i=t.pathname.startsWith("/s/")||t.pathname.startsWith("/sh/");return{protocol:t.protocol,hostname:t.hostname,pathname:t.pathname,searchParams:t.searchParams,doesContainRlKey:s,doesContainShmodelLink:i}};t.getCleanedSharingUrl=e=>{const t=e.searchParams,s=new URLSearchParams;let i="";return t.get("dl")&&(i="?",s.append("dl",t.get("dl"))),t.get("rlkey")&&(i="?",s.append("rlkey",t.get("rlkey"))),i+=s.toString(),e.protocol+"//"+e.hostname+e.pathname+i}}));
//# sourceMappingURL=pkg-shared-file-and-folder.min.js-vflI17kQp.map