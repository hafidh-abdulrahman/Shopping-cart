define("js/pap-events/docsend_analytics_add_on_teams/dismiss_docsend_analytics_add_on_teams_modal_page",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAP_Dismiss_DocsendAnalyticsAddOnTeamsModalPage=void 0,t.PAP_Dismiss_DocsendAnalyticsAddOnTeamsModalPage=function(e){return{class:"docsend_analytics_add_on_teams",action:"dismiss",object:"docsend_analytics_add_on_teams_modal_page",properties:e}}})),define("js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_back_button",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAP_Select_DocsendAnalyticsAddOnTeamsModalBackButton=void 0,t.PAP_Select_DocsendAnalyticsAddOnTeamsModalBackButton=function(e){return{class:"docsend_analytics_add_on_teams",action:"select",object:"docsend_analytics_add_on_teams_modal_back_button",properties:e}}})),define("js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_close_button",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAP_Select_DocsendAnalyticsAddOnTeamsModalCloseButton=void 0,t.PAP_Select_DocsendAnalyticsAddOnTeamsModalCloseButton=function(e){return{class:"docsend_analytics_add_on_teams",action:"select",object:"docsend_analytics_add_on_teams_modal_close_button",properties:e}}})),define("js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_sign_up_button",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAP_Select_DocsendAnalyticsAddOnTeamsModalSignUpButton=void 0,t.PAP_Select_DocsendAnalyticsAddOnTeamsModalSignUpButton=function(e){return{class:"docsend_analytics_add_on_teams",action:"select",object:"docsend_analytics_add_on_teams_modal_sign_up_button",properties:e}}})),define("js/pap-events/docsend_analytics_add_on_teams/shown_docsend_analytics_add_on_teams_modal_page",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAP_Shown_DocsendAnalyticsAddOnTeamsModalPage=void 0,t.PAP_Shown_DocsendAnalyticsAddOnTeamsModalPage=function(e){return{class:"docsend_analytics_add_on_teams",action:"shown",object:"docsend_analytics_add_on_teams_modal_page",properties:e}}})),define("metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal",["require","exports","tslib","react","dig-components/modal","metaserver/static/js/components/ui/modal","metaserver/static/js/docsend_analytics_add_on/data/use_account_status","metaserver/static/js/docsend_analytics_add_on/data/use_analytics_link","metaserver/static/js/docsend_analytics_add_on/components/terms_of_service","metaserver/static/js/docsend_analytics_add_on/components/link_management","metaserver/static/js/docsend_analytics_add_on/components/spinner_utils","metaserver/static/js/docsend_analytics_add_on/components/upgrade_banner","metaserver/static/js/docsend_analytics_add_on/components/summary_analytics","metaserver/static/js/docsend_analytics_add_on/components/visit_analytics","metaserver/static/js/ux_analytics/utils","metaserver/static/js/core/i18n","dig-components/typography","js/filepath/filepath","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","metaserver/static/js/docsend_analytics_add_on/components/delete_link_confirmation_modal","dig-components/badges","metaserver/static/js/user_survey/user_survey"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_,m,f,p,v,y,g,E,A,b,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDocSendAnalyticsModal=t.DocSendAnalyticsModal=void 0,s=a.__importDefault(s),g=a.__importDefault(g);const S=({accountStatus:e,link:t,fileId:a,filePath:n,user:i,fileExt:l,accountStatusError:o,didDeleteLink:c,onShowDeleteLinkModal:p,onUpdatedLink:v,hasNewerFileVersion:y,fileTimestampMicro:E,stormcrowVariant:A,entryPoint:b,isNewLink:S})=>{const[N,M]=s.default.useState(!1),[h,k]=s.default.useState(e.daysRemaining),[O,C]=s.default.useState(y),[w,P]=s.default.useState(E),I=s.default.useRef(null),L=s.default.useCallback((e,t,a)=>{C(t),P(a),v(e),M(!0),k(30)},[v]);s.default.useEffect(()=>{I.current&&((0,f.dispatchModalOpened)(),T.UserSurvey.trackEvent("viewed_docsend_analytics_add_on_modal","docsend_analytics_add_on_modal"))},[I]);const x=e.isProvisioned||t||N||c,D=!o&&!x,R=!t||c||!e.hasAddOnAccess&&!N,j=(e.isProvisioned||N)&&!e.hasActivePlan;return s.default.createElement("div",{className:g.default.modalContent,ref:I},j&&s.default.createElement(u.UpgradeBanner,{daysRemaining:h,stormcrowVariant:A,fileId:a,filePath:n,user:i,fileExt:l,entryPoint:b,link:t}),x?s.default.createElement(d.LinkManagement,{link:t,onUpdatedLink:v,fileId:a,user:i,fileExt:l,didDeleteLink:c,onShowDeleteLinkModal:p,hasNewerFileVersion:O,fileTimestampMicro:w,entryPoint:b}):D?s.default.createElement(r.TermsOfService,{onAcceptedTOS:L,user:i,fileId:a,fileExt:l,entryPoint:b}):null,D?s.default.createElement(r.OnboardingImage,null):s.default.createElement(s.default.Fragment,null,s.default.createElement(_.SummaryAnalytics,{fileId:a,fileExt:l,user:i,link:t,disabled:R,entryPoint:b,skip:S}),s.default.createElement(m.VisitAnalytics,{fileId:a,fileExt:l,user:i,link:t,disabled:R,entryPoint:b,skip:S})))};t.DocSendAnalyticsModal=({fileName:e,fileId:t,filePath:a,user:i,stormcrowVariant:r,entryPoint:d})=>{var u;const _=(0,y.file_extension)(e),[m,T]=s.default.useState(!0),{isAccountStatusLoading:N,accountStatus:M,accountStatusError:h}=(0,l.useAccountStatus)({user:i,entryPoint:d}),{isAnalyticsLinkLoading:k,linkData:O,linkDataError:C}=(0,o.useAnalyticsLink)({user:i,skip:N||!!h||!M.isProvisioned,fileId:t,fileExt:_,entryPoint:d}),[w,P]=s.default.useState(!1),[I,L]=s.default.useState(!1),[x,D]=s.default.useState(null==O?void 0:O.link),R=s.default.useCallback(e=>{D(e),L(!1)},[]);s.default.useEffect(()=>{(null==O?void 0:O.link)&&D(O.link)},[O]);const j=s.default.useCallback(e=>{e&&L(!0),P(!1)},[]),V=s.default.useCallback(()=>{P(!0)},[]),U=s.default.useCallback(()=>{T(!1),(0,f.dispatchModalClosed)()},[]),F=N||k;return s.default.useEffect(()=>{(h||C)&&(0,E.showSnackbar)("fail",p.intl.formatMessage({id:"CXl2Hh",defaultMessage:"There was a problem completing this request"}))},[h,C]),w&&x?s.default.createElement(A.DeleteLinkModal,{link:x,fileExt:_,fileName:e,fileId:t,user:i,onCloseDeleteLinkModal:j,entryPoint:d}):s.default.createElement(n.Modal,{open:m,isCentered:!0,withCloseButton:"Close",className:"uxa-modal",id:"docsend_analytics_add_on_modal",width:700,onRequestClose:U,"aria-labelledby":"ds-analytics-modal-title"},s.default.createElement(n.Modal.Header,{hasBottomSpacing:"title-standard"},s.default.createElement(n.Modal.Title,{id:"ds-analytics-modal-title",className:g.default.dsAnalyticsHeader},s.default.createElement("div",null,p.intl.formatMessage({id:"m/4By6",defaultMessage:"Analytics for "}),s.default.createElement(v.Text,{className:g.default.dsAnalyticsHeaderFilename},e)),s.default.createElement(b.AccessoryBadge,{"data-testid":"beta-badge"},p.intl.formatMessage({id:"QT7EnD",defaultMessage:"Beta"})))),s.default.createElement(n.Modal.Body,{hasVerticalSpacing:!0},F?s.default.createElement(c.CenteredSpinner,null):s.default.createElement(S,{accountStatus:M,link:x,hasNewerFileVersion:null==O?void 0:O.hasNewerFileVersion,fileTimestampMicro:null==O?void 0:O.fileTimestampMicro,user:i,fileId:t,filePath:a,fileExt:(0,y.file_extension)(e),accountStatusError:h,didDeleteLink:I,onShowDeleteLinkModal:V,onUpdatedLink:R,stormcrowVariant:r,entryPoint:d,isNewLink:null===(u=null==O?void 0:O.isNewLink)||void 0===u||u})))},t.DocSendAnalyticsModal.displayName="DocSendAnalyticsModal";t.showDocSendAnalyticsModal=e=>{i.Modal.showInstance(s.default.createElement(t.DocSendAnalyticsModal,Object.assign({},e)))}})),define("metaserver/static/js/docsend_analytics_add_on/components/delete_link_confirmation_modal",["require","exports","tslib","react","dig-components/modal","dig-components/typography","dig-components/buttons","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/ux_analytics/utils","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","metaserver/static/js/core/i18n","metaserver/static/js/docsend_analytics_add_on/data/apiUtils","metaserver/static/js/clean/analytics","metaserver/static/js/docsend_analytics_add_on/helpers/utils"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteLinkModal=void 0,s=a.__importDefault(s);t.DeleteLinkModal=({fileName:e,fileId:t,fileExt:f,link:p,user:v,onCloseDeleteLinkModal:y,entryPoint:g})=>{const[E,A]=s.default.useState(!1),b=s.default.useMemo(()=>new o.DefaultUserApiV2Client(v),[v]),T=s.default.useCallback(()=>{(0,r.dispatchModalClosed)(),y(!1);const e=(0,m.getLinkIdFromLink)(p);_.ProEventsLogger.log("docsend_analytics_add_on_delete_link_cancel",{fileExt:f,entryPoint:g,linkId:e})},[y]),S=s.default.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){A(!0),(0,d.showSnackbar)("sync",c.intl.formatMessage({id:"3/ldox",defaultMessage:"Deleting link to {fileName}."},{fileName:e}),0),(yield(0,u.deleteLink)(b,t,p,f,g))?((0,d.showSnackbar)("complete",c.intl.formatMessage({id:"3qNu/U",defaultMessage:"Deleted link to {fileName}."},{fileName:e})),(0,r.dispatchModalClosed)(),y(!0)):(0,d.showSnackbar)("fail",c.intl.formatMessage({id:"aIZcFS",defaultMessage:"There was a problem deleting this link."})),A(!1)})),[b,e,p,t,y]);return s.default.useEffect(()=>{(0,r.dispatchModalOpened)()},[]),s.default.createElement(n.Modal,{open:!0,isCentered:!0,className:"uxa-modal",id:"docsend_analytics_add_on_delete_link_modal","aria-labelledby":"ds-analytics-delete-link-modal-title","data-testid":"delete-link-modal"},s.default.createElement(n.Modal.Header,{hasBottomSpacing:"title-standard"},s.default.createElement(n.Modal.Title,{id:"ds-analytics-delete-link-modal-title"},c.intl.formatMessage({id:"Q9LBuK",defaultMessage:'Delete link to "{fileName}"'},{fileName:e}))),s.default.createElement(n.Modal.Body,{hasVerticalSpacing:!0},s.default.createElement(i.Text,null,c.intl.formatMessage({id:"ZWg0m3",defaultMessage:"By deleting this link you will lose access to all past analytics. A new link can be created to track future analytics."}))),s.default.createElement(n.Modal.Footer,null,s.default.createElement(l.Button,{"data-testid":"cancel-button",variant:"opacity",onClick:T,autoFocus:!0},c.intl.formatMessage({id:"q/OeYK",defaultMessage:"Cancel"})),s.default.createElement(l.Button,{"data-testid":"delete-link-button",variant:"primary",onClick:S,disabled:E,autoFocus:!0},c.intl.formatMessage({id:"zpwh5R",defaultMessage:"Delete"}))))},t.DeleteLinkModal.displayName="DeleteLinkModal"})),define("metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css",["require","exports","css!metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teamsSurveySelectTriggerText=t.teamsSurveySelectTrigger=t.teamsSurveySelectMenu=t.teamsSurveyEmptyFormError=t.teamsSurveyCheckboxLabel=t.teamsSurveyCheckboxRow=t.teamsSurveyQuestionLabel=t.teamsSurveySubtext=t.teamsSurveySlideContent=t.teamsCloseButton=t.onboardingImage=t.documentVersionContainer=t.disabledText=t.email=t.emailBox=t.nameCell=t.visitCount=t.visitCountSection=t.visitAnalyticsTableHeader=t.visitAnalyticsTable=t.visitAnalyticsSection=t.chartLabel=t.chartBar=t.topPagesChart=t.summaryDataLabel=t.summaryAnalyticsDataImage=t.summaryAnalyticsData=t.summaryAnalyticsSection=t.linkArea=t.linkDetails=t.linkOptions=t.linkPermission=t.linkSection=t.tosError=t.tosCheckboxSection=t.tosTitle=t.tosHeading=t.tosSection=t.modalContent=t.spinnerText=t.spinnerWithText=t.spinnerContainer=t.divider=t.dsAnalyticsHeaderFilename=t.dsAnalyticsHeader=void 0,t.dsAnalyticsHeader="_ds-analytics-header_1pfff_2",t.dsAnalyticsHeaderFilename="_ds-analytics-header-filename_1pfff_10",t.divider="_divider_1pfff_16",t.spinnerContainer="_spinner-container_1pfff_25",t.spinnerWithText="_spinner-with-text_1pfff_33",t.spinnerText="_spinner-text_1pfff_39",t.modalContent="_modal-content_1pfff_44",t.tosSection="_tos-section_1pfff_50",t.tosHeading="_tos-heading_1pfff_56",t.tosTitle="_tos-title_1pfff_62",t.tosCheckboxSection="_tos-checkbox-section_1pfff_68",t.tosError="_tos-error_1pfff_74",t.linkSection="_link-section_1pfff_78",t.linkPermission="_link-permission_1pfff_84",t.linkOptions="_link-options_1pfff_88",t.linkDetails="_link-details_1pfff_94",t.linkArea="_link-area_1pfff_101",t.summaryAnalyticsSection="_summary-analytics-section_1pfff_106",t.summaryAnalyticsData="_summary-analytics-data_1pfff_113",t.summaryAnalyticsDataImage="_summary-analytics-data-image_1pfff_120",t.summaryDataLabel="_summary-data-label_1pfff_134",t.topPagesChart="_top-pages-chart_1pfff_138",t.chartBar="_chart-bar_1pfff_149",t.chartLabel="_chart-label_1pfff_161",t.visitAnalyticsSection="_visit-analytics-section_1pfff_165",t.visitAnalyticsTable="_visit-analytics-table_1pfff_172",t.visitAnalyticsTableHeader="_visit-analytics-table-header_1pfff_179",t.visitCountSection="_visit-count-section_1pfff_185",t.visitCount="_visit-count_1pfff_185",t.nameCell="_name-cell_1pfff_195",t.emailBox="_email-box_1pfff_202",t.email="_email_1pfff_202",t.disabledText="_disabled-text_1pfff_214",t.documentVersionContainer="_document-version-container_1pfff_218",t.onboardingImage="_onboarding-image_1pfff_225",t.teamsCloseButton="_teams-close-button_1pfff_238",t.teamsSurveySlideContent="_teams-survey-slide-content_1pfff_242",t.teamsSurveySubtext="_teams-survey-subtext_1pfff_246",t.teamsSurveyQuestionLabel="_teams-survey-question-label_1pfff_250",t.teamsSurveyCheckboxRow="_teams-survey-checkbox-row_1pfff_255",t.teamsSurveyCheckboxLabel="_teams-survey-checkbox-label_1pfff_261",t.teamsSurveyEmptyFormError="_teams-survey-empty-form-error_1pfff_265",t.teamsSurveySelectMenu="_teams-survey-select-menu_1pfff_269",t.teamsSurveySelectTrigger="_teams-survey-select-trigger_1pfff_274",t.teamsSurveySelectTriggerText="_teams-survey-select-trigger-text_1pfff_278";t.default={dsAnalyticsHeader:"_ds-analytics-header_1pfff_2",dsAnalyticsHeaderFilename:"_ds-analytics-header-filename_1pfff_10",divider:"_divider_1pfff_16",spinnerContainer:"_spinner-container_1pfff_25",spinnerWithText:"_spinner-with-text_1pfff_33",spinnerText:"_spinner-text_1pfff_39",modalContent:"_modal-content_1pfff_44",tosSection:"_tos-section_1pfff_50",tosHeading:"_tos-heading_1pfff_56",tosTitle:"_tos-title_1pfff_62",tosCheckboxSection:"_tos-checkbox-section_1pfff_68",tosError:"_tos-error_1pfff_74",linkSection:"_link-section_1pfff_78",linkPermission:"_link-permission_1pfff_84",linkOptions:"_link-options_1pfff_88",linkDetails:"_link-details_1pfff_94",linkArea:"_link-area_1pfff_101",summaryAnalyticsSection:"_summary-analytics-section_1pfff_106",summaryAnalyticsData:"_summary-analytics-data_1pfff_113",summaryAnalyticsDataImage:"_summary-analytics-data-image_1pfff_120",summaryDataLabel:"_summary-data-label_1pfff_134",topPagesChart:"_top-pages-chart_1pfff_138",chartBar:"_chart-bar_1pfff_149",chartLabel:"_chart-label_1pfff_161",visitAnalyticsSection:"_visit-analytics-section_1pfff_165",visitAnalyticsTable:"_visit-analytics-table_1pfff_172",visitAnalyticsTableHeader:"_visit-analytics-table-header_1pfff_179",visitCountSection:"_visit-count-section_1pfff_185",visitCount:"_visit-count_1pfff_185",nameCell:"_name-cell_1pfff_195",emailBox:"_email-box_1pfff_202",email:"_email_1pfff_202",disabledText:"_disabled-text_1pfff_214",documentVersionContainer:"_document-version-container_1pfff_218",onboardingImage:"_onboarding-image_1pfff_225",teamsCloseButton:"_teams-close-button_1pfff_238",teamsSurveySlideContent:"_teams-survey-slide-content_1pfff_242",teamsSurveySubtext:"_teams-survey-subtext_1pfff_246",teamsSurveyQuestionLabel:"_teams-survey-question-label_1pfff_250",teamsSurveyCheckboxRow:"_teams-survey-checkbox-row_1pfff_255",teamsSurveyCheckboxLabel:"_teams-survey-checkbox-label_1pfff_261",teamsSurveyEmptyFormError:"_teams-survey-empty-form-error_1pfff_265",teamsSurveySelectMenu:"_teams-survey-select-menu_1pfff_269",teamsSurveySelectTrigger:"_teams-survey-select-trigger_1pfff_274",teamsSurveySelectTriggerText:"_teams-survey-select-trigger-text_1pfff_278"}})),define("metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/teams_analytics_survey_modal",["require","exports","tslib","react","dig-components/carousel","dig-components/modal","metaserver/static/js/components/ui/modal","dig-components/typography","metaserver/static/js/ux_analytics/utils","metaserver/static/js/clean/static_urls","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/modal_page_views_tracker","metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/survey_form","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/docsend_analytics_add_on_teams/send_docsend_analytics_add_on_teams_interest_survey","js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_sign_up_button","js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_close_button","js/pap-events/docsend_analytics_add_on_teams/select_docsend_analytics_add_on_teams_modal_back_button","metaserver/static/js/docsend_analytics_add_on/helpers/docsend_analytics_teams_survey_tracker","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_,m,f,p,v,y,g,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showTeamsAnalyticsSurveyModal=t.TeamsAnalyticsSurveyModal=void 0,s=a.__importDefault(s),c=a.__importDefault(c);const A=f.pap_events.docsend_analytics_add_on_teams.Send_DocsendAnalyticsAddOnTeamsInterestSurvey,b=({closeModal:e,goToNext:t})=>{const a=s.default.useCallback(()=>{(0,m.logEvent)((0,p.PAP_Select_DocsendAnalyticsAddOnTeamsModalSignUpButton)()),t()},[t]),i=s.default.useCallback(()=>{(0,m.logEvent)((0,v.PAP_Select_DocsendAnalyticsAddOnTeamsModalCloseButton)()),e()},[e]);return s.default.createElement(s.default.Fragment,null,s.default.createElement(n.CarouselSlideColumnContent,null,s.default.createElement(n.CarouselHeading,null,"Analytics for teams is coming soon"),s.default.createElement(n.CarouselText,null,s.default.createElement(o.Text,{tagName:"p"},"Track activity for the files you share using Dropbox including:"),s.default.createElement("ul",null,s.default.createElement("li",null,"Who visited the file and when"),s.default.createElement("li",null,"How many times it was downloaded"),s.default.createElement("li",null,"Page-by-page engagement")),s.default.createElement(o.Text,{isBold:!0},"Sign up to be notified when we launch analytics for teams."))),s.default.createElement(n.CarouselSlideActions,null,s.default.createElement(n.CarouselButton,{onClick:a,variant:"primary",size:"standard","data-uxa-log":"docsend_analytics_add_on_teams_modal_sign_up_button",autoFocus:!0},"Sign up to be notified"),s.default.createElement(n.CarouselButton,{onClick:i,variant:"transparent",size:"standard",className:c.default.teamsCloseButton,"data-uxa-log":"docsend_analytics_add_on_teams_modal_close_button"},"Close")))},T=({user:e,closeModal:t,goToPrevious:i})=>{const[l,r]=s.default.useState(),[d,u]=s.default.useState(),[f,p]=s.default.useState(),[b,T]=s.default.useState(!1),[S,N]=s.default.useState(!1),[M,h]=s.default.useState(!1),k=s.default.useMemo(()=>new g.DocsendAnalyticsTeamsSurveyTracker(e.id),[e]);s.default.useEffect(()=>{k.isSurveySubmitted().then(e=>{N(e)}).catch(e=>{})},[k]),s.default.useEffect(()=>{if(M){h(!(l||d||f||b))}},[l,d,f,b,M,h]);const O=s.default.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){const e=!(l||d||f||b);if(h(e),!e){(0,m.logEvent)(A.create({personalizationTeamRoleName:l,featureImportance:d,documentAnalyticsUsageArray:JSON.stringify(f),consentToNotifyAboutAnalytics:b}));const e=k.trackSurveySubmitted(),a=b?k.trackConsentToNotify():Promise.resolve();t();try{yield Promise.all([e,a]),(0,E.showSnackbar)("generic","Success! Thank you for your interest.")}catch(e){(0,E.showSnackbar)("fail","There was a problem completing this request.")}}})),[l,d,f,b,k,h,t]),C=s.default.useCallback(()=>{(0,m.logEvent)((0,y.PAP_Select_DocsendAnalyticsAddOnTeamsModalBackButton)()),i()},[i]),w=s.default.useCallback(()=>{(0,m.logEvent)((0,v.PAP_Select_DocsendAnalyticsAddOnTeamsModalCloseButton)()),t()},[t]);return s.default.createElement(s.default.Fragment,null,s.default.createElement(n.CarouselSlideColumnContent,{className:c.default.teamsSurveySlideContent},s.default.createElement(n.CarouselHeading,null,"Thanks for your interest"),s.default.createElement(n.CarouselText,null,!S&&s.default.createElement(s.default.Fragment,null,s.default.createElement(o.Text,{tagName:"p",className:c.default.teamsSurveySubtext},"Tell us more about yourself so we can build the best analytics feature possible."),s.default.createElement(_.SurveyForm,{onRoleChange:r,onImportanceChange:u,onUsageChange:p,onNotifyChange:T}),M&&s.default.createElement(o.Text,{tagName:"p",color:"error",className:c.default.teamsSurveyEmptyFormError},"Please fill out the form and try again")),S&&s.default.createElement(o.Text,{tagName:"p",className:c.default.teamsSurveySubtext},"We'll notify you when we launch analytics for teams."))),s.default.createElement(n.CarouselSlideActions,null,s.default.createElement(n.CarouselButton,{onClick:C,variant:"opacity",size:"standard","data-uxa-log":"docsend_analytics_add_on_teams_modal_back_button"},"Back"),!S&&s.default.createElement(n.CarouselButton,{onClick:O,variant:"primary",size:"standard"},"Submit"),s.default.createElement(n.CarouselButton,{onClick:w,variant:"transparent",size:"standard",className:c.default.teamsCloseButton,"data-uxa-log":"docsend_analytics_add_on_teams_modal_close_button"},"Close")))},S=()=>s.default.createElement("img",{src:(0,d.static_url)("/static/metaserver/static/images/docsend_addon/abstract_ui-vflEMii5w.png"),alt:"",width:302,height:269});t.TeamsAnalyticsSurveyModal=({user:e,stormcrowVariant:t,entryPoint:a})=>{const[o,d]=s.default.useState(!0),[c,_]=s.default.useState(0),m=s.default.useCallback(()=>{d(!1),(0,r.dispatchModalClosed)()},[]),f=s.default.useCallback(()=>{l.Modal.close()},[]);(0,u.useModalPageViewsTracker)(a,c);const p=s.default.useRef(null),v=s.default.useRef(null),y=(0,n.useFocusSlideOnTransition)([p,v]),g=s.default.useCallback(e=>{y(e),_(e)},[y]);return s.default.createElement(i.Modal,{open:o,isCentered:!0,className:"uxa-modal",id:"teams_analytics_survey_modal",width:700,onRequestClose:m,onAfterClose:f,onAfterOpen:r.dispatchModalOpened},s.default.createElement(n.Carousel,{width:700,height:590,totalSlides:2,onSlideTransitioned:g,transitionDuration:"0ms",showPager:!0},({goToPrevious:t,goToNext:a})=>s.default.createElement(n.CarouselContainer,null,s.default.createElement(n.CarouselSlide,{primaryColor:"var(--color__accent__cloud)",ref:p},s.default.createElement(n.CarouselSlideColumn,null,s.default.createElement(b,{closeModal:m,goToNext:a})),s.default.createElement(n.CarouselSlideColumn,null,s.default.createElement(S,null))),s.default.createElement(n.CarouselSlide,{primaryColor:"var(--color__accent__cloud)",ref:v},s.default.createElement(n.CarouselSlideColumn,null,s.default.createElement(T,{closeModal:m,goToPrevious:t,user:e})),s.default.createElement(n.CarouselSlideColumn,null,s.default.createElement(S,null))))))},t.TeamsAnalyticsSurveyModal.displayName="TeamsAnalyticsSurveyModal";t.showTeamsAnalyticsSurveyModal=e=>{l.Modal.showInstance(s.default.createElement(t.TeamsAnalyticsSurveyModal,Object.assign({},e)))}})),define("metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/modal_page_views_tracker",["require","exports","tslib","react","metaserver/static/js/pap/analytics_client","js/pap-events/docsend_analytics_add_on_teams/shown_docsend_analytics_add_on_teams_modal_page","js/pap-events/docsend_analytics_add_on_teams/dismiss_docsend_analytics_add_on_teams_modal_page"],(function(e,t,a,s,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useModalPageViewsTracker=void 0,s=a.__importDefault(s);t.useModalPageViewsTracker=(e,t)=>{const a=t+1;s.default.useEffect(()=>{const t=Date.now();return(0,n.logEvent)((0,i.PAP_Shown_DocsendAnalyticsAddOnTeamsModalPage)({entryPoint:e,pageNumber:a.toString()})),()=>{(0,n.logEvent)((0,l.PAP_Dismiss_DocsendAnalyticsAddOnTeamsModalPage)({entryPoint:e,pageNumber:a.toString(),totalTimeMs:Date.now()-t}))}},[e,a])}})),define("metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/survey_form",["require","exports","tslib","react","dig-components/form_row","dig-components/text_fields","dig-components/controls","dig-components/typography","metaserver/static/js/dropbox/proto/pap_events/docsend_analytics_add_on_teams/send_docsend_analytics_add_on_teams_interest_survey","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/usage_select"],(function(e,t,a,s,n,i,l,o,r,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyForm=void 0,s=a.__importDefault(s),d=a.__importDefault(d);var u=r.pap_events.docsend_analytics_add_on_teams.Send_DocsendAnalyticsAddOnTeamsInterestSurvey.PersonalizationTeamRoleName,_=r.pap_events.docsend_analytics_add_on_teams.Send_DocsendAnalyticsAddOnTeamsInterestSurvey.FeatureImportance;const m=[{value:u.SUPPORT_PERSONALIZATION_TEAM_ROLE_NAME,label:"Administration / Support"},{value:u.ART_PERSONALIZATION_TEAM_ROLE_NAME,label:"Art, Design or Creative"},{value:u.SOFTWARE_PERSONALIZATION_TEAM_ROLE_NAME,label:"Computer Engineering (e.g. software)"},{value:u.HARDWARE_PERSONALIZATION_TEAM_ROLE_NAME,label:"Mechanical / Electrical / Civil Engineering"},{value:u.MANAGEMENT_PERSONALIZATION_TEAM_ROLE_NAME,label:"Executive / Upper Management"},{value:u.ACCOUNTING_PERSONALIZATION_TEAM_ROLE_NAME,label:"Finance or Accounting"},{value:u.HEALTHCARE_PERSONALIZATION_TEAM_ROLE_NAME,label:"Human Resources"},{value:u.IT_PERSONALIZATION_TEAM_ROLE_NAME,label:"IT / Information Networking / Information Security"},{value:u.LEGAL_PERSONALIZATION_TEAM_ROLE_NAME,label:"Legal"},{value:u.MARKETING_PERSONALIZATION_TEAM_ROLE_NAME,label:"Marketing"},{value:u.MEDIA_PERSONALIZATION_TEAM_ROLE_NAME,label:"Public Relations / Communications"},{value:u.PROJECT_PERSONALIZATION_TEAM_ROLE_NAME,label:"Project or Program Management"},{value:u.EDUCATION_PERSONALIZATION_TEAM_ROLE_NAME,label:"Research"},{value:u.SALES_PERSONALIZATION_TEAM_ROLE_NAME,label:"Sales / Business Development"},{value:u.FREELANCE_PERSONALIZATION_TEAM_ROLE_NAME,label:"Sole Proprietor / Self-Employed / Freelancer"},{value:u.OTHER_PERSONALIZATION_TEAM_ROLE_NAME,label:"Other"},{value:u.UNKNOWN_PERSONALIZATION_TEAM_ROLE_NAME,label:"Prefer not to say"}],f=[{value:_.NOT_AT_ALL_IMPORTANT_FEATURE_IMPORTANCE,label:"Not at all important"},{value:_.NOT_TOO_IMPORTANT_FEATURE_IMPORTANCE,label:"Not too important"},{value:_.NEUTRAL_FEATURE_IMPORTANCE,label:"Neutral"},{value:_.SOMEWHAT_IMPORTANT_FEATURE_IMPORTANCE,label:"Somewhat important"},{value:_.VERY_IMPORTANT_FEATURE_IMPORTANCE,label:"Very important"}];t.SurveyForm=({onRoleChange:e,onImportanceChange:t,onUsageChange:a,onNotifyChange:r})=>s.default.createElement(s.default.Fragment,null,s.default.createElement(n.FormRow,null,s.default.createElement(n.FormLabel,{htmlFor:"role",className:d.default.teamsSurveyQuestionLabel},"Which of the following describes your role in your company?"),s.default.createElement(i.Select,{id:"role",onChange:t=>{e(Number(t))},placeholder:"Select an option"},m.map(({value:e,label:t})=>s.default.createElement(i.Select.Option,{key:e,value:e.toString()},t)))),s.default.createElement(n.FormRow,null,s.default.createElement(n.FormLabel,{htmlFor:"importance",className:d.default.teamsSurveyQuestionLabel},"How important is this feature to you?"),s.default.createElement(i.Select,{id:"importance",onChange:e=>{t(Number(e))},placeholder:"Select an option"},f.map(({value:e,label:t})=>s.default.createElement(i.Select.Option,{key:e,value:e.toString()},t)))),s.default.createElement(n.FormRow,null,s.default.createElement(n.FormLabel,{htmlFor:"usage",className:d.default.teamsSurveyQuestionLabel},"How would you use analytics in Dropbox?"),s.default.createElement(c.UsageSelect,{triggerId:"usage",onChange:e=>{a(e)}})),s.default.createElement("div",{className:d.default.teamsSurveyCheckboxRow},s.default.createElement(l.Checkbox,{id:"notify",onChange:e=>{r(e.currentTarget.checked)}}),s.default.createElement(o.Label,{htmlFor:"notify",className:d.default.teamsSurveyCheckboxLabel},"Notify me when this feature launches")))})),define("metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/usage_select",["require","exports","tslib","react","dig-components/controls","dig-components/menu","dig-components/buttons","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css"],(function(e,t,a,s,n,i,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UsageSelect=void 0,s=a.__importDefault(s),o=a.__importDefault(o);const r=[{value:"confirm_receipt",label:"To confirm receipt of a file"},{value:"understand_popular_file_pages",label:"To understand which pages or files are most popular"},{value:"understand_file_interactions",label:"To understand how others are interacting with my file"},{value:"determine_follow_up_actions",label:"To determine what follow-up actions to take"},{value:"other",label:"Other"},{value:"none",label:"None of the above - I would not use this feature"}];t.UsageSelect=({triggerId:e,onChange:t})=>{const[a,d]=s.default.useState([]),c=a.map(e=>{var t;return null===(t=r.find(t=>t.value===e))||void 0===t?void 0:t.label});return s.default.createElement(i.Menu.Wrapper,{closeOnSelection:!1,onSelection:e=>{const s=-1===a.indexOf(e)?a.concat(e):a.filter(t=>t!==e);d(s),t(s)},isBlock:!0,className:o.default.teamsSurveySelectMenu},({getContentProps:t,getTriggerProps:d})=>s.default.createElement(s.default.Fragment,null,s.default.createElement(l.Button,Object.assign({},d(),{variant:"outline",withDropdownIcon:!0,className:o.default.teamsSurveySelectTrigger,id:e}),s.default.createElement("span",{className:o.default.teamsSurveySelectTriggerText},0===a.length?"Please select all that apply":c.join(", "))),s.default.createElement(i.Menu.Content,Object.assign({},t()),r.map(({label:e,value:t})=>s.default.createElement(i.Menu.ActionItem,{key:t,value:t,role:"menuitemcheckbox","aria-checked":-1!==a.indexOf(t),withLeftAccessory:s.default.createElement(n.Checkbox,{checked:-1!==a.indexOf(t),readOnly:!0,tabIndex:-1})},e)))))}})),define("metaserver/static/js/dropbox/proto/pap_events/docsend_analytics_add_on_teams/send_docsend_analytics_add_on_teams_interest_survey",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(s=a.__importStar(s)).Reader,s.Writer,s.util;const n=s.roots.default||(s.roots.default={});var i,l;t.default=n,t.pap_events=n.pap_events=((i=n.pap_events||{}).docsend_analytics_add_on_teams=((l=i.docsend_analytics_add_on_teams||{}).Send_DocsendAnalyticsAddOnTeamsInterestSurvey=(function(e){function e(e){if(e)for(let t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.answeredSurveyQuestionsCount=0,e.prototype.consentToNotifyAboutAnalytics=!1,e.prototype.personalizationTeamRoleName=0,e.prototype.featureImportance=0,e.prototype.documentAnalyticsUsageArray="",e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.docsend_analytics_add_on_teams.Send_DocsendAnalyticsAddOnTeamsInterestSurvey"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="DOCSEND_ANALYTICS_ADD_ON_TEAMS"]=0,t})(),e.FeatureImportance=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_FEATURE_IMPORTANCE"]=0,t[e[1]="NOT_AT_ALL_IMPORTANT_FEATURE_IMPORTANCE"]=1,t[e[2]="NOT_TOO_IMPORTANT_FEATURE_IMPORTANCE"]=2,t[e[3]="NEUTRAL_FEATURE_IMPORTANCE"]=3,t[e[4]="SOMEWHAT_IMPORTANT_FEATURE_IMPORTANCE"]=4,t[e[5]="VERY_IMPORTANT_FEATURE_IMPORTANCE"]=5,t})(),e.PersonalizationTeamRoleName=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_PERSONALIZATION_TEAM_ROLE_NAME"]=0,t[e[1]="ACCOUNTING_PERSONALIZATION_TEAM_ROLE_NAME"]=1,t[e[2]="ART_PERSONALIZATION_TEAM_ROLE_NAME"]=2,t[e[3]="SOFTWARE_PERSONALIZATION_TEAM_ROLE_NAME"]=3,t[e[4]="EDUCATION_PERSONALIZATION_TEAM_ROLE_NAME"]=4,t[e[5]="MANAGEMENT_PERSONALIZATION_TEAM_ROLE_NAME"]=5,t[e[6]="FREELANCE_PERSONALIZATION_TEAM_ROLE_NAME"]=6,t[e[7]="HEALTHCARE_PERSONALIZATION_TEAM_ROLE_NAME"]=7,t[e[8]="IT_PERSONALIZATION_TEAM_ROLE_NAME"]=8,t[e[9]="LEGAL_PERSONALIZATION_TEAM_ROLE_NAME"]=9,t[e[10]="MARKETING_PERSONALIZATION_TEAM_ROLE_NAME"]=10,t[e[11]="HARDWARE_PERSONALIZATION_TEAM_ROLE_NAME"]=11,t[e[12]="MEDIA_PERSONALIZATION_TEAM_ROLE_NAME"]=12,t[e[13]="SUPPORT_PERSONALIZATION_TEAM_ROLE_NAME"]=13,t[e[14]="PROJECT_PERSONALIZATION_TEAM_ROLE_NAME"]=14,t[e[15]="SALES_PERSONALIZATION_TEAM_ROLE_NAME"]=15,t[e[16]="OTHER_PERSONALIZATION_TEAM_ROLE_NAME"]=16,t})(),e})(l.Send_DocsendAnalyticsAddOnTeamsInterestSurvey||{}),l),i)})),define("metaserver/static/js/docsend_analytics_add_on/components/link_management",["require","exports","tslib","react","dig-components/typography","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/api_v2/default_user_client","dig-components/text_fields","metaserver/static/js/docsend_analytics_add_on/data/apiUtils","metaserver/static/js/core/i18n","metaserver/static/js/docsend_analytics_add_on/components/spinner_utils","metaserver/static/js/clean/analytics","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/helpers/utils"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_,m,f,p,v){"use strict";var y;Object.defineProperty(t,"__esModule",{value:!0}),t.LinkManagement=t.LinkCreationError=void 0,s=a.__importDefault(s),p=a.__importDefault(p),(function(e){e.UNABLE_TO_CREATE_LINK="UNABLE_TO_CREATE_LINK"})(y=t.LinkCreationError||(t.LinkCreationError={}));const g=({apiV2Client:e,fileId:t,fileExt:r,link:d,hasNewerFileVersion:m,fileTimestampMicro:v,entryPoint:y})=>{const[g,E]=s.default.useState(!1),[A,b]=s.default.useState(!m),[T,S]=s.default.useState(!1),[N,M]=s.default.useState(v?v/1e3:void 0),h=s.default.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){E(!0);const a=yield(0,c.updateDocument)(e,t,r,y,d);a?(M((a.file_hlc_unix_micros||0)/1e3),S(!0),b(!0)):(0,f.showSnackbar)("fail",u.intl.formatMessage({id:"DQ80ri",defaultMessage:"There was a problem updating this link"})),E(!1)})),[]);if(g)return s.default.createElement("div",{className:p.default.documentVersionContainer,"data-testid":"loading-latest-version"},s.default.createElement(_.SpinnerWithText,{text:u.intl.formatMessage({id:"FJY4Sn",defaultMessage:"Loading latest version..."})}));if(!A)return s.default.createElement("div",{className:p.default.documentVersionContainer,"data-testid":"update-document-banner"},s.default.createElement(l.UIIcon,{src:o.WarningLine,size:"small"}),s.default.createElement(n.Text,null,u.intl.formatMessage({id:"gpZE8T",defaultMessage:"There is a new version of this file. Update it so viewers can see your latest changes."})),s.default.createElement(i.Button,{variant:"transparent",onClick:h,"data-testid":"update-button"},u.intl.formatMessage({id:"OwaQ5z",defaultMessage:"Update"})));if(!N||!T)return null;const k=new Date(N),O=k.toLocaleDateString(),C=k.toLocaleTimeString();return s.default.createElement("div",{className:p.default.documentVersionContainer,"data-testid":"latest-version-banner"},s.default.createElement(l.UIIcon,{src:o.CheckmarkCircleLine,size:"small",color:"var(--color__faint__text)"}),s.default.createElement(n.Text,{color:"faint"},u.intl.formatMessage({id:"gSpGZq",defaultMessage:"Latest version. Last updated on {date} at {time}."},{date:O,time:C})))};t.LinkManagement=({onUpdatedLink:e,link:t,fileId:l,user:o,fileExt:E,didDeleteLink:A,onShowDeleteLinkModal:b,hasNewerFileVersion:T,fileTimestampMicro:S,entryPoint:N})=>{const M=s.default.useMemo(()=>new r.DefaultUserApiV2Client(o),[o]),[h,k]=s.default.useState(!1),[O,C]=s.default.useState(void 0),w=s.default.useRef(null),P=s.default.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){k(!0);const t=yield(0,c.getOrCreateLink)(M,l,E,N);t?(C(void 0),e(t.link)):(C(y.UNABLE_TO_CREATE_LINK),(0,f.showSnackbar)("fail",u.intl.formatMessage({id:"Uwmac/",defaultMessage:"There was a problem creating or getting this link"}))),k(!1)})),[M,l,e,E]),I=s.default.useCallback(()=>{var e;const a=(0,v.getLinkIdFromLink)(t);navigator.clipboard.writeText(null===(e=w.current)||void 0===e?void 0:e.textContent).then(()=>{m.ProEventsLogger.log("docsend_analytics_add_on_copy_link_success",{fileExt:E,linkId:a,entryPoint:N}),(0,f.showSnackbar)("complete",u.intl.formatMessage({id:"hdfAQY",defaultMessage:"Link copied. Allows viewing."}))}).catch(()=>{m.ProEventsLogger.log("docsend_analytics_add_on_copy_link_failure",{fileExt:E,linkId:a,entryPoint:N}),(0,f.showSnackbar)("fail",u.intl.formatMessage({id:"g71D9h",defaultMessage:"There was a problem copying this link"}))})},[E]),L=s.default.useCallback(()=>{const e=(0,v.getLinkIdFromLink)(t);m.ProEventsLogger.log("docsend_analytics_add_on_manually_copy_link_success",{fileExt:E,linkId:e,entryPoint:N}),(0,f.showSnackbar)("complete",u.intl.formatMessage({id:"hdfAQY",defaultMessage:"Link copied. Allows viewing."}))},[E]),x=s.default.useCallback(()=>{b()},[b]);return s.default.useEffect(()=>{t?k(!1):(P(),k(!0))},[t,P]),h?s.default.createElement("div",{className:p.default.linkSection,"data-testid":"link-section"},s.default.createElement(_.SpinnerWithText,{text:u.intl.formatMessage({id:"R6/Bzs",defaultMessage:"Creating link..."})})):O||A?s.default.createElement("div",{className:p.default.linkSection,"data-testid":"link-section"},s.default.createElement("div",{className:p.default.linkDetails},s.default.createElement(i.Button,{variant:"primary",onClick:P,"data-testid":"create-link-button",autoFocus:!0},u.intl.formatMessage({id:"JalrqG",defaultMessage:"Create shareable link"})))):s.default.createElement("div",{className:p.default.linkSection,"data-testid":"link-section"},s.default.createElement(n.Text,null,u.intl.formatMessage({id:"fZek45",defaultMessage:"Copy and share this link to get page-by-page viewer insights for your document."})," "),s.default.createElement(g,{hasNewerFileVersion:T,fileTimestampMicro:S,apiV2Client:M,fileId:l,fileExt:E,link:t,entryPoint:N}),s.default.createElement("div",{className:p.default.linkDetails,"data-testid":"link-details-section"},s.default.createElement(d.TextArea,{"aria-labelledby":u.intl.formatMessage({id:"FGPqKs",defaultMessage:"Link textbox"}),ref:w,onCopy:L,className:p.default.linkArea,readOnly:!0,value:t,"data-testid":"link-text-area"}),s.default.createElement(i.Button,{variant:"primary",size:"large",onClick:I,"data-testid":"copy-link-button",autoFocus:!0},u.intl.formatMessage({id:"fMWfC+",defaultMessage:"Copy link"}))),s.default.createElement("div",{className:p.default.linkOptions},s.default.createElement(n.Text,null," ",u.intl.formatMessage({id:"ohyMJi",defaultMessage:"Anyone with this link "})," ",s.default.createElement(n.Text,{className:p.default.linkPermission}," ",u.intl.formatMessage({id:"X8/J/n",defaultMessage:"can view "}))," ",u.intl.formatMessage({id:"VIfxi5",defaultMessage:"this document"})," "),s.default.createElement(i.Button,{"data-testid":"delete-link-button",variant:"transparent",onClick:x},u.intl.formatMessage({id:"peEHe5",defaultMessage:"Delete link"}))))}})),define("metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils",["require","exports","tslib","react","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/core/i18n"],(function(e,t,a,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showSnackbar=void 0,s=a.__importDefault(s);t.showSnackbar=(e,t,a=5e3)=>{n.Snackbar.update(s.default.createElement(n.Snackbar,{id:"docsend-analytics-add-on-snackbar",title:t,closeButtonText:i.intl.formatMessage({id:"UuZQQK",defaultMessage:"Close"}),variant:e,timeoutDelayMs:a,"data-testid":"snackbar"}))}})),define("metaserver/static/js/docsend_analytics_add_on/components/spinner_utils",["require","exports","tslib","react","dig-components/progress_indicators","dig-components/typography","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css"],(function(e,t,a,s,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpinnerWithText=t.CenteredSpinner=void 0,s=a.__importDefault(s),l=a.__importDefault(l);t.CenteredSpinner=()=>s.default.createElement("div",{className:l.default.spinnerContainer,"data-testid":"centered-spinner"},s.default.createElement(n.Spinner,null));t.SpinnerWithText=({text:e})=>s.default.createElement("div",{className:l.default.spinnerWithText,"data-testid":"spinner-with-text"},s.default.createElement(n.Spinner,{"aria-valuetext":e,size:"xsmall"}),s.default.createElement(i.Text,{className:l.default.spinnerText},e))})),define("metaserver/static/js/docsend_analytics_add_on/components/summary_analytics",["require","exports","tslib","react","dig-components/typography","dig-components/buttons","metaserver/static/js/core/i18n","metaserver/static/js/docsend_analytics_add_on/data/use_summary_analytics","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/components/spinner_utils","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","metaserver/static/js/docsend_analytics_add_on/helpers/utils","dig-components/tooltips"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryAnalytics=void 0,s=a.__importDefault(s),r=a.__importDefault(r);const m=({label:e,value:t,disabled:a})=>s.default.createElement("div",null,s.default.createElement(n.Text,{className:a?r.default.disabledText:r.default.summaryDataLabel,variant:"label",size:"small"},e),s.default.createElement(n.Text,{className:a?r.default.disabledText:"",variant:"label",size:"xlarge",isBold:!0,"data-testid":"summary-data-value"},t)),f=({pageViews:e,pageAvgViewTime:t,disabled:a})=>(void 0===e&&(e={}),void 0===t&&(t={}),s.default.createElement("div",null,s.default.createElement(n.Text,{className:a?r.default.disabledText:r.default.summaryDataLabel,variant:"label",size:"small"},l.intl.formatMessage({id:"0upQrV",defaultMessage:"Top pages (latest file version)"})),s.default.createElement(p,{pageViews:e,pageAvgViewTime:t,disabled:a}))),p=({pageViews:e,pageAvgViewTime:t,disabled:a})=>{if(a||0===Object.keys(e).length)return s.default.createElement(n.Text,{className:a?r.default.disabledText:"",variant:"label",size:"xlarge",isBold:!0},l.intl.formatMessage({id:"/Eqf0q",defaultMessage:"N/A"}));{const a=Object.keys(t).sort((e,a)=>t[a]-t[e]);a.length>3&&(a.length=3);const o=a.reduce((a,s)=>[...a,{pageNum:s,views:e[s],avgViewTime:t[s]}],[]),d=[];return o.forEach(e=>{const t=y(e,o),a=e.pageNum,c=(0,u.convertToHumanReadableTime)(e.avgViewTime),m=s.default.createElement(s.default.Fragment,null,s.default.createElement(n.Text,{variant:"label",tagName:"p",inverse:!0},l.intl.formatMessage({id:"owVLCX",defaultMessage:"Avg. visit time: {avgViewTime}"},{avgViewTime:c})),s.default.createElement(n.Text,{variant:"label",tagName:"p",inverse:!0},l.intl.formatMessage({id:"BXZjTy",defaultMessage:"Views: {views}"},{views:e.views}))),f=s.default.createRef();d.push(s.default.createElement(s.default.Fragment,null,s.default.createElement(_.Tooltip,{title:m,triggerRef:f,placement:"bottom"},s.default.createElement(i.Button,{variant:"primary",style:{height:`${t}px`},className:r.default.chartBar})),s.default.createElement(n.Text,{className:r.default.chartLabel,variant:"label",size:"xsmall",ref:f},l.intl.formatMessage({id:"4OIiar",defaultMessage:"p. {pageNum}"},{pageNum:a}))))}),s.default.createElement("div",{className:r.default.topPagesChart,"data-testid":"top-pages-chart"},d)}},v={numVisitors:0,avgViewTimeMs:0,numDownloads:0,pageViews:{},pageAvgViewTime:{}};t.SummaryAnalytics=({fileId:e,fileExt:t,link:a,user:n,disabled:i,entryPoint:_,skip:p})=>{const y=p||i,{isSummaryAnalyticsLoading:g,summaryData:E,summaryDataError:A}=(0,o.useSummaryAnalytics)({user:n,fileId:e,link:a,skip:y,fileExt:t,entryPoint:_});if(s.default.useEffect(()=>{A&&(0,c.showSnackbar)("fail",l.intl.formatMessage({id:"ixxWOz",defaultMessage:"There was a problem getting summmary analytics."}))},[A]),g)return s.default.createElement("div",{className:r.default.summaryAnalyticsSection},s.default.createElement("div",{className:r.default.divider}),s.default.createElement(d.CenteredSpinner,null));const b=i||!!A,T=y||b?v:E;return s.default.createElement("div",{className:r.default.summaryAnalyticsSection},s.default.createElement("div",{className:r.default.divider}),s.default.createElement("div",{className:(0,u.isImage)(t)?r.default.summaryAnalyticsDataImage:r.default.summaryAnalyticsData,"data-testid":"summary-analytics-data"},s.default.createElement(m,{label:l.intl.formatMessage({id:"Ju+Xsr",defaultMessage:"Viewers"}),value:null==T?void 0:T.numVisitors,disabled:b}),s.default.createElement(m,{label:l.intl.formatMessage({id:"apw/4g",defaultMessage:"Avg. visit time"}),value:(0,u.convertToHumanReadableTime)(null==T?void 0:T.avgViewTimeMs),disabled:b}),s.default.createElement(m,{label:l.intl.formatMessage({id:"31KJBU",defaultMessage:"Downloads"}),value:null==T?void 0:T.numDownloads,disabled:b}),!(0,u.isImage)(t)&&s.default.createElement(f,{pageViews:null==T?void 0:T.pageViews,pageAvgViewTime:null==T?void 0:T.pageAvgViewTime,disabled:b})))};const y=(e,t)=>{const a=Math.floor(24*e.avgViewTime/t[0].avgViewTime);return Math.max(a,6)}})),define("metaserver/static/js/docsend_analytics_add_on/components/terms_of_service",["require","exports","tslib","react","dig-components/typography","dig-components/controls","dig-components/buttons","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/docsend_analytics_add_on/data/apiUtils","metaserver/static/js/core/i18n","metaserver/static/js/docsend_analytics_add_on/components/spinner_utils","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","dig-components/typography","metaserver/static/js/clean/static_urls","metaserver/static/js/clean/analytics"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_,m,f,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermsOfService=t.ProvisionAccountError=t.OnboardingImage=void 0,s=a.__importDefault(s),u=a.__importDefault(u),t.OnboardingImage=s.default.memo(()=>s.default.createElement("div",{className:u.default.onboardingImage,"data-testid":"onboarding-image"},s.default.createElement("img",{src:(0,f.static_url)("/static/metaserver/static/images/docsend_addon/abstract_ui-vflEMii5w.png"),alt:"",width:320,height:286}))),t.OnboardingImage.displayName="OnboardingImage",(function(e){e.UNABLE_TO_PROVISION_ACCOUNT="UNABLE_TO_PROVISION_ACCOUNT",e.UNABLE_TO_CREATE_LINK="UNABLE_TO_CREATE_LINK"})(t.ProvisionAccountError||(t.ProvisionAccountError={}));t.TermsOfService=({onAcceptedTOS:e,fileId:t,fileExt:f,user:v,entryPoint:y})=>{const[g,E]=s.default.useState(!1),[A,b]=s.default.useState(!1),T=s.default.useMemo(()=>new o.DefaultUserApiV2Client(v),[v]),[S,N]=s.default.useState(!1),M=s.default.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){if(!g)return b(!0),void p.ProEventsLogger.log("docsend_analytics_add_on_failed_to_accept_tos",{fileExt:f,entryPoint:y});if(N(!0),yield(0,r.provisionAccount)(T,y)){const a=yield(0,r.getOrCreateLink)(T,t,f,y);a||(0,_.showSnackbar)("fail",d.intl.formatMessage({id:"LGBKXL",defaultMessage:"There was a problem creating this link."})),e(null==a?void 0:a.link,null==a?void 0:a.file_has_newer_version,null==a?void 0:a.file_hlc_unix_micros)}else(0,_.showSnackbar)("fail",d.intl.formatMessage({id:"y6HA13",defaultMessage:"There was a problem provisioning your account."}));N(!1)})),[T,t,e,y,f,b,g]),h=s.default.useCallback(()=>{E(e=>!e),b(!1)},[]);return s.default.createElement("div",{className:u.default.tosSection,"data-testid":"terms-of-service-section"},S?s.default.createElement(c.SpinnerWithText,{text:d.intl.formatMessage({id:"R6/Bzs",defaultMessage:"Creating link..."})}):s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:u.default.divider}),s.default.createElement("div",{className:u.default.tosHeading},s.default.createElement(n.Title,{className:u.default.tosTitle}," ",d.intl.formatMessage({id:"xt9dt6",defaultMessage:"Try analytics in Dropbox"})," "),s.default.createElement(n.Text,null,d.intl.formatMessage({id:"vH5eUV",defaultMessage:"Get page-by-page viewer insights for the documents you share using Dropbox."}))),s.default.createElement("div",null,s.default.createElement("div",{className:u.default.tosCheckboxSection},s.default.createElement(i.Checkbox,{checked:g,onChange:h,"data-testid":"terms-of-service-checkbox",autoFocus:!0}),s.default.createElement(n.Text,null,d.intl.formatMessage({id:"yAx7CP",defaultMessage:"I agree to <link1>DocSend Terms</link1> and <link2>Privacy Policy</link2>. We’ll create a DocSend account with your Dropbox email address. If you have an existing DocSend account, we will create a separate account to power the analytics feature. This new account will be linked across platforms."},{link1:e=>s.default.createElement(m.Link,{rel:"noreferrer",target:"_blank",hasNoUnderline:!0,href:"https://www.docsend.com/terms-of-service/",key:"terms"},e),link2:e=>s.default.createElement(m.Link,{rel:"noreferrer",target:"_blank",hasNoUnderline:!0,href:"https://www.docsend.com/privacy-policy/",key:"privacy-policy"},e)}))),A&&s.default.createElement(n.Text,{tagName:"p",className:u.default.tosError,color:"error","data-testid":"tos-error"},d.intl.formatMessage({id:"q02yFP",defaultMessage:"Please agree to the terms of service."}))),s.default.createElement("div",null,s.default.createElement(l.Button,{variant:"primary",size:"large",onClick:M,"data-testid":"terms-of-service-button"},d.intl.formatMessage({id:"bElaaI",defaultMessage:"Get 30 days free access"})))))}})),define("metaserver/static/js/docsend_analytics_add_on/components/upgrade_banner",["require","exports","tslib","react","dig-components/banner","metaserver/static/js/core/i18n","dig-components/buttons","metaserver/static/js/clean/dropbox_form","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/clean/analytics","dig-components/typography","metaserver/static/js/docsend_analytics_add_on/helpers/utils"],(function(e,t,a,s,n,i,l,o,r,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpgradeBanner=void 0,s=a.__importDefault(s);t.UpgradeBanner=({daysRemaining:e,stormcrowVariant:t,fileId:a,filePath:_,user:m,fileExt:f,entryPoint:p,link:v})=>{const[y,g]=s.default.useState(!0),E=s.default.useCallback(()=>{g(!1)},[g]),A=`https://${document.location.host.replace(/^www./g,"")}${(0,r.get_browse_root)(m)}${_}?analytics_file_id=${a}&plan_upgraded=true`,b=(0,u.getUpgradeURL)(null!=t?t:"",A),T=s.default.useCallback(()=>(d.ProEventsLogger.log("docsend_analytics_add_on_upgrade_button_click",{daysRemaining:e,stormcrowVariant:t,fileExt:f,entryPoint:p,linkId:(0,u.getLinkIdFromLink)(v)}),!1),[e,t,f,p,v]);return void 0!==e&&y?e>5?s.default.createElement(n.Banner,{type:"attention",withLeftIcon:!1,withCloseButton:"Close",onRequestClose:E,"data-testid":"upgrade-banner-attention"},s.default.createElement(n.Banner.Message,null,i.intl.formatMessage({id:"XFu8X8",defaultMessage:"You have {daysRemaining, number} days to access analytics. Add analytics to your Dropbox plan now."},{daysRemaining:e})),s.default.createElement(n.Banner.Actions,null,s.default.createElement(o.DropboxForm,{action:b,method:"post",handleSubmit:T},s.default.createElement(l.Button,{variant:"transparent","data-testid":"upgrade-button"},i.intl.formatMessage({id:"sOfbLs",defaultMessage:"Upgrade"}))))):e>0?s.default.createElement(n.Banner,{type:"warning",withLeftIcon:!1,withCloseButton:"Close",onRequestClose:E,"data-testid":"upgrade-banner-warning"},s.default.createElement(n.Banner.Message,null,i.intl.formatMessage({id:"8egoWm",defaultMessage:"You will lose access to analytics in {daysRemaining, plural, one {# day} other {# days}}. Add it to your Dropbox plan now."},{daysRemaining:e})),s.default.createElement(n.Banner.Actions,null,s.default.createElement(o.DropboxForm,{action:b,method:"post",handleSubmit:T},s.default.createElement(l.Button,{variant:"transparent"},i.intl.formatMessage({id:"sOfbLs",defaultMessage:"Upgrade"}))))):s.default.createElement(n.Banner,{variant:"rich",type:"alert",withLeftPictogram:null,"data-testid":"upgrade-banner-alert"},s.default.createElement(n.Banner.Message,null,s.default.createElement(c.Title,{size:"small"},i.intl.formatMessage({id:"rfgp7o",defaultMessage:"Your access to analytics has ended"})),s.default.createElement(c.Text,null,i.intl.formatMessage({id:"/M90bu",defaultMessage:"Add analytics to your Dropbox plan now to continue getting real-time document analytics and more."}))),s.default.createElement(n.Banner.Actions,null,s.default.createElement(o.DropboxForm,{action:b,method:"post",handleSubmit:T},s.default.createElement(l.Button,{variant:"outline"},i.intl.formatMessage({id:"XKOnEF",defaultMessage:"Upgrade now"}))))):null}})),define("metaserver/static/js/docsend_analytics_add_on/components/visit_analytics",["require","exports","tslib","react","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal.module.css","dig-components/table","metaserver/static/js/core/i18n","dig-components/typography","dig-components/avatar","metaserver/static/js/docsend_analytics_add_on/data/use_visit_analytics","metaserver/static/js/docsend_analytics_add_on/components/spinner_utils","metaserver/static/js/docsend_analytics_add_on/components/snackbar_utils","metaserver/static/js/docsend_analytics_add_on/helpers/utils"],(function(e,t,a,s,n,i,l,o,r,d,c,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisitAnalytics=void 0,s=a.__importDefault(s),n=a.__importDefault(n);const m=({email:e,initials:t,disabled:a})=>{const i=`${n.default.email} ${n.default.disabledText}`;return s.default.createElement("div",{className:n.default.nameCell},s.default.createElement("div",null,s.default.createElement(r.Avatar,{size:"standard",backgroundColor:(0,r.avatarColorForUserIdentifier)(t),isInactive:a},a?"":t)),s.default.createElement("div",{className:n.default.emailBox},s.default.createElement(o.Text,{"data-testid":"email-text",className:a?i:n.default.email},e)))},f=({visit:e,index:t,disabled:a,hidePercentViewed:r})=>{let d="";if(e.occurredAt){const t=new Date(e.occurredAt);d=isNaN(t.getTime())?e.occurredAt:t.toLocaleDateString()}const c=g(e.numPagesViewed,e.totalPages);return s.default.createElement(i.Table.Row,{key:t,"data-testid":`row-${t}`},s.default.createElement(i.Table.Cell,null,s.default.createElement(m,{email:e.email,initials:E(e.email),disabled:a})),s.default.createElement(i.Table.Cell,null,s.default.createElement(o.Text,{"data-testid":"date-text",className:a?n.default.disabledText:""},d)),s.default.createElement(i.Table.Cell,null,s.default.createElement(o.Text,{"data-testid":"time-spent-text",className:a?n.default.disabledText:""},(0,_.convertToHumanReadableTime)(e.timeSpentMs))),!r&&s.default.createElement(i.Table.Cell,null,s.default.createElement(o.Text,{"data-testid":"percent-viewed-text",className:a?n.default.disabledText:""},l.intl.formatMessage({id:"ZLFg36",defaultMessage:"{percentViewed}%"},{percentViewed:c}))))},p=()=>{const e={timeSpentMs:0,occurredAt:l.intl.formatMessage({id:"/Eqf0q",defaultMessage:"N/A"}),email:l.intl.formatMessage({id:"GrD0Fp",defaultMessage:"Email address"}),numPagesViewed:0,totalPages:0,downloaded:!1,documentVersion:0};return s.default.createElement("div",{className:n.default.visitAnalyticsSection,"data-testid":"disabled-visit-analytics"},s.default.createElement("div",{className:n.default.divider}),s.default.createElement(v,{numVisits:0,disabled:!0}),s.default.createElement("div",{className:n.default.visitAnalyticsTable},s.default.createElement(i.Table,{spacing:"large"},s.default.createElement(y,{disabled:!0}),s.default.createElement(i.Table.Body,null,s.default.createElement(f,{key:0,visit:e,index:0,disabled:!0})))))},v=({numVisits:e,disabled:t})=>s.default.createElement("div",{className:n.default.visitCountSection,"data-testid":"visit-count-section"},s.default.createElement(o.Text,{className:`${n.default.visitCount} ${t?n.default.disabledText:""}`}," ",l.intl.formatMessage({id:"aNjPN4",defaultMessage:"{numVisits, plural, one {# visit} other {# visits}}"},{numVisits:e}))),y=({disabled:e,changeSortDirection:t,sortState:a,hidePercentViewed:o})=>{const r=s.default.useCallback((e,t)=>t.columnName===e?t.sortDirection:"none",[]);return s.default.createElement(i.Table.Header,{className:n.default.visitAnalyticsTableHeader},s.default.createElement(i.Table.Row,null,s.default.createElement(i.Table.HeaderCell,Object.assign({"data-testid":"email-header",className:e?n.default.disabledText:""},t&&a?{sortDirection:r(d.Column.EMAIL,a),onSort:()=>t(d.Column.EMAIL)}:{}),l.intl.formatMessage({id:"BLNJWZ",defaultMessage:"Email"})),s.default.createElement(i.Table.HeaderCell,Object.assign({"data-testid":"date-header",className:e?n.default.disabledText:""},t&&a?{sortDirection:r(d.Column.DATE,a),onSort:()=>t(d.Column.DATE)}:{}),l.intl.formatMessage({id:"U0C7zN",defaultMessage:"Date"})),s.default.createElement(i.Table.HeaderCell,Object.assign({"data-testid":"view-time-header",className:e?n.default.disabledText:""},t&&a?{sortDirection:r(d.Column.VIEW_TIME,a),onSort:()=>t(d.Column.VIEW_TIME)}:{}),l.intl.formatMessage({id:"bGYbSG",defaultMessage:"Visit time"})),!o&&s.default.createElement(i.Table.HeaderCell,Object.assign({"data-testid":"percent-viewed-header",className:e?n.default.disabledText:""},t&&a?{sortDirection:r(d.Column.PERCENT_VIEWED,a),onSort:()=>t(d.Column.PERCENT_VIEWED)}:{}),l.intl.formatMessage({id:"xFgp/b",defaultMessage:"Percent viewed"}))))};t.VisitAnalytics=({fileId:e,fileExt:t,link:a,user:o,disabled:r,entryPoint:m,skip:g})=>{var E,A;const b=g||r,{isVisitAnalyticsLoading:T,visitData:S,visitDataError:N,sortVisitData:M}=(0,d.useVisitAnalytics)({user:o,fileId:e,link:a,fileExt:t,skip:b,entryPoint:m}),[h,k]=s.default.useState({columnName:d.Column.NONE,sortDirection:"none"});s.default.useEffect(()=>{if(N){let e=l.intl.formatMessage({id:"niUAOO",defaultMessage:"There was a problem getting visit analytics."});N===d.VisitDataError.GET_MORE_VISIT_DATA_FAILED&&(e=l.intl.formatMessage({id:"ViJ/ns",defaultMessage:"There was a problem getting more visit analytics."})),(0,u.showSnackbar)("fail",e)}},[N]);const O=s.default.useCallback(e=>{switch(h.columnName!==e&&(h.columnName=e,h.sortDirection="none"),h.sortDirection){case"asc":h.sortDirection="desc";break;case"desc":case"none":h.sortDirection="asc"}M&&(M(h.columnName,h.sortDirection),k({columnName:h.columnName,sortDirection:h.sortDirection}))},[M]);if(r||N&&N!==d.VisitDataError.GET_MORE_VISIT_DATA_FAILED)return s.default.createElement(p,null);if(T)return s.default.createElement("div",{className:n.default.visitAnalyticsSection},s.default.createElement("div",{className:n.default.divider}),s.default.createElement(c.CenteredSpinner,null));const C=(null===(E=null==S?void 0:S.visits)||void 0===E?void 0:E.length)||0;return s.default.createElement("div",{className:n.default.visitAnalyticsSection},s.default.createElement("div",{className:n.default.divider}),s.default.createElement(v,{numVisits:C}),C>0&&(null===(A=null==S?void 0:S.visits)||void 0===A?void 0:A.length)?s.default.createElement("div",{className:n.default.visitAnalyticsTable},s.default.createElement(i.Table,{spacing:"large","data-testid":"visit-analytics-table"},s.default.createElement(y,{changeSortDirection:O,sortState:h,hidePercentViewed:(0,_.isImage)(t)}),s.default.createElement(i.Table.Body,null,S.visits.map((e,a)=>s.default.createElement(f,{key:a,visit:e,index:a,hidePercentViewed:(0,_.isImage)(t)}))))):null)};const g=(e,t)=>e&&t?Math.ceil(e/t*100):0,E=e=>e?e.charAt(0).toUpperCase():""})),define("metaserver/static/js/docsend_analytics_add_on/data/apiUtils",["require","exports","tslib","metaserver/static/js/docsend_analytics_add_on/helpers/utils","metaserver/static/js/clean/analytics"],(function(e,t,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateDocument=t.getVisitAnalytics=t.getAnalyticsForDocumentVersion=t.getSummaryAnalytics=t.deleteLink=t.getLink=t.getOrCreateLink=t.getPlanStatus=t.provisionAccount=t.SERVER_RESPONSE_TIME_HEADER=t.REQUEST_ID_HEADER=void 0;t.REQUEST_ID_HEADER="x-dropbox-request-id",t.SERVER_RESPONSE_TIME_HEADER="x-server-response-time";t.provisionAccount=(e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:a,headers:s}=yield e.ns("docsend_addon").rpcWithResponseHeaders("account/provision_account",void 0,{});return"PROVISIONED"===a.provision_status?(n.ProEventsLogger.log("docsend_analytics_add_on_provision_account_success",Object.assign({provisionStatus:a.provision_status,entryPoint:t},i(s))),!0):(n.ProEventsLogger.log("docsend_analytics_add_on_provision_account_failure",Object.assign({provisionStatus:a.provision_status,entryPoint:t},i(s))),!1)}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_provision_account_failure",Object.assign(Object.assign({},l(e)),{entryPoint:t}))}return!1}));t.getPlanStatus=(e,t)=>a.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:a,headers:s}=yield e.ns("docsend_addon").rpcWithResponseHeaders("account/get_plan_status",void 0,{});return n.ProEventsLogger.log("docsend_analytics_add_on_get_plan_status_success",Object.assign({hasActivePlan:a.has_active_plan,hasAddOnAccess:a.has_addon_access,daysRemaining:a.trial_days_left,provisionStatus:a.provision_status,accessDeniedReason:a.addon_access_denied_reason,entryPoint:t},i(s))),a}catch(e){return void n.ProEventsLogger.log("docsend_analytics_add_on_get_plan_status_failure",Object.assign(Object.assign({},l(e)),{entryPoint:t}))}}));t.getOrCreateLink=(e,t,o,r)=>a.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:a,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/get_or_create_link",{file_id:t},{});return n.ProEventsLogger.log("docsend_analytics_add_on_get_or_create_link_success",Object.assign({fileExt:o,linkId:(0,s.getLinkIdFromLink)(a.link),fileHasNewerVersion:a.file_has_newer_version,fileHlcMicroseconds:a.file_hlc_unix_micros,entryPoint:r},i(l))),a}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_get_or_create_link_failure",Object.assign(Object.assign({},l(e)),{fileExt:o,entryPoint:r}))}}));t.getLink=(e,t,o,r,d)=>a.__awaiter(void 0,void 0,void 0,(function*(){try{const{result:a,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/get_link",{file_id:t},d);return n.ProEventsLogger.log("docsend_analytics_add_on_get_link_success",Object.assign({fileExt:o,linkId:(0,s.getLinkIdFromLink)(a.link),fileHasNewerVersion:a.file_has_newer_version,fileHlcMicroseconds:a.file_hlc_unix_micros,entryPoint:r},i(l))),a}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_get_link_failure",Object.assign(Object.assign({},l(e)),{fileExt:o,entryPoint:r}))}}));t.deleteLink=(e,t,o,r,d)=>a.__awaiter(void 0,void 0,void 0,(function*(){const a=(0,s.getLinkIdFromLink)(o);try{const{headers:s}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/delete_link",{file_id:t,link:o},{});return n.ProEventsLogger.log("docsend_analytics_add_on_delete_link_success",Object.assign(Object.assign({linkId:a,fileExt:r},i(s)),{entryPoint:d})),!0}catch(e){return n.ProEventsLogger.log("docsend_analytics_add_on_delete_link_failure",Object.assign(Object.assign({},l(e)),{linkId:a,fileExt:r,entryPoint:d})),!1}}));t.getSummaryAnalytics=(e,t,o,r,d)=>a.__awaiter(void 0,void 0,void 0,(function*(){const a=(0,s.getLinkIdFromLink)(o);try{const{result:s,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_summary_analytics",{file_id:t,link:o},{});return n.ProEventsLogger.log("docsend_analytics_add_on_get_summary_analytics_success",Object.assign({linkId:a,fileExt:r,numVisitors:s.num_visitors,numVisits:s.num_visits,numDownloads:s.num_downloads,avgViewTimeMs:s.average_view_time_ms,entryPoint:d},i(l))),s}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_get_summary_analytics_failure",Object.assign(Object.assign({},l(e)),{linkId:a,fileExt:r,entryPoint:d}))}}));t.getAnalyticsForDocumentVersion=(e,t,o,r,d,c)=>a.__awaiter(void 0,void 0,void 0,(function*(){const a=(0,s.getLinkIdFromLink)(o);try{const{result:s,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_analytics_for_document_version",{file_id:t,link:o,docsend_version:c},{});return n.ProEventsLogger.log("docsend_analytics_add_on_get_analytics_for_document_version_success",Object.assign({linkId:a,fileExt:r,documentVersion:c,pageViews:s.top_viewed_pages,entryPoint:d},i(l))),s}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_get_analytics_for_document_version_failure",Object.assign(Object.assign({},l(e)),{linkId:a,fileExt:r,documentVersion:c,entryPoint:d}))}}));t.getVisitAnalytics=(e,t,o,r,d=50,c,u,_)=>a.__awaiter(void 0,void 0,void 0,(function*(){var a;const m=(0,s.getLinkIdFromLink)(o);try{const{result:s,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("analytics/get_visits_analytics",{file_id:t,link:o,cursor:_,page_size:d},{});return n.ProEventsLogger.log("docsend_analytics_add_on_get_visit_analytics_success",Object.assign({linkId:m,fileExt:r,pageSize:d,pageNumber:c,currCursor:_,nextCursor:s.cursor,pageCount:null===(a=s.visits)||void 0===a?void 0:a.length,totalCount:s.total_count,entryPoint:u},i(l))),s}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_get_visit_analytics_failure",Object.assign(Object.assign({},l(e)),{linkId:m,fileExt:r,pageSize:d,currCursor:_,pageNumber:c,entryPoint:u}))}}));t.updateDocument=(e,t,o,r,d)=>a.__awaiter(void 0,void 0,void 0,(function*(){const a=(0,s.getLinkIdFromLink)(d);try{const{result:s,headers:l}=yield e.ns("docsend_addon").rpcWithResponseHeaders("link/update_document",{file_id:t},{});return n.ProEventsLogger.log("docsend_analytics_add_on_update_document_success",Object.assign({fileExt:o,fileHlcMicroseconds:s.file_hlc_unix_micros,linkId:a,entryPoint:r},i(l))),s}catch(e){n.ProEventsLogger.log("docsend_analytics_add_on_update_document_failure",Object.assign(Object.assign({},l(e)),{fileExt:o,linkId:a,entryPoint:r}))}}));const i=e=>{const a=parseInt(e[t.SERVER_RESPONSE_TIME_HEADER],10),s=isNaN(a)?void 0:a;return{requestId:e[t.REQUEST_ID_HEADER],serverTimeMs:s}},l=e=>{var a,s;if(!e)return{};let n="";return e.headers&&e.headers&&t.REQUEST_ID_HEADER in e.headers&&(n=e.headers[t.REQUEST_ID_HEADER]),{error:null===(a=null==e?void 0:e.raw)||void 0===a?void 0:a.responseBody,requestId:n,statusCode:null===(s=null==e?void 0:e.raw)||void 0===s?void 0:s.status}}})),define("metaserver/static/js/docsend_analytics_add_on/data/use_account_status",["require","exports","tslib","react","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/docsend_analytics_add_on/data/apiUtils"],(function(e,t,a,s,n,i){"use strict";var l,o;Object.defineProperty(t,"__esModule",{value:!0}),t.useAccountStatus=t.AccountStatus=t.AccountStatusError=void 0,s=a.__importStar(s),(function(e){e.UNKNOWN="UNKNOWN",e.UNABLE_TO_GET_PLAN_STATUS="UNABLE_TO_GET_PLAN_STATUS"})(l=t.AccountStatusError||(t.AccountStatusError={})),(function(e){e.PROVISIONED="PROVISIONED",e.NONE="NONE"})(o=t.AccountStatus||(t.AccountStatus={}));t.useAccountStatus=({user:e,entryPoint:t})=>{const[r,d]=s.useState(!0),[c,u]=s.useState({}),[_,m]=s.useState(void 0),f=s.useMemo(()=>new n.DefaultUserApiV2Client(e),[e]),p=s.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){const e=yield(0,i.getPlanStatus)(f,t);if(e){const t={hasActivePlan:e.has_active_plan,hasAddOnAccess:e.has_addon_access,daysRemaining:e.trial_days_left,isProvisioned:e.provision_status===o.PROVISIONED};u(t)}else m(l.UNABLE_TO_GET_PLAN_STATUS);d(!1)})),[f]);return s.useEffect(()=>{p()},[p]),{isAccountStatusLoading:r,accountStatus:c,accountStatusError:_}}})),define("metaserver/static/js/docsend_analytics_add_on/data/use_analytics_link",["require","exports","tslib","react","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/docsend_analytics_add_on/data/apiUtils"],(function(e,t,a,s,n,i){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0}),t.useAnalyticsLink=t.LinkDataError=void 0,s=a.__importStar(s),(function(e){e.UNKNOWN="UNKNOWN"})(l=t.LinkDataError||(t.LinkDataError={}));t.useAnalyticsLink=({skip:e,fileId:t,fileExt:o,user:r,entryPoint:d})=>{const[c,u]=s.useState(!0),[_,m]=s.useState({}),[f,p]=s.useState(void 0),v=s.useMemo(()=>new n.DefaultUserApiV2Client(r),[r]),y=s.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){const e=yield(0,i.getOrCreateLink)(v,t,o,d);e?m({link:null==e?void 0:e.link,hasNewerFileVersion:e.file_has_newer_version,fileTimestampMicro:e.file_hlc_unix_micros,isNewLink:e.is_new_link}):p(l.UNKNOWN),u(!1)})),[v,t]);return s.useEffect(()=>{e||y()},[y,e]),e?{}:{isAnalyticsLinkLoading:c,linkData:_,linkDataError:f}}})),define("metaserver/static/js/docsend_analytics_add_on/data/use_visit_analytics",["require","exports","tslib","react","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/docsend_analytics_add_on/data/apiUtils","metaserver/static/js/clean/analytics","metaserver/static/js/docsend_analytics_add_on/helpers/utils","metaserver/static/js/user_survey/user_survey"],(function(e,t,a,s,n,i,l,o,r){"use strict";var d,c;Object.defineProperty(t,"__esModule",{value:!0}),t.convertToVisitData=t.useVisitAnalytics=t.Column=t.VisitDataError=void 0,s=a.__importStar(s),(function(e){e.UNKNOWN="UNKNOWN",e.LINK_NOT_FOUND="LINK_NOT_FOUND",e.GET_MORE_VISIT_DATA_FAILED="GET_MORE_VISIT_DATA_FAILED"})(d=t.VisitDataError||(t.VisitDataError={})),(function(e){e.EMAIL="email",e.DATE="date",e.VIEW_TIME="view_time",e.PERCENT_VIEWED="percent_viewed",e.NONE="none"})(c=t.Column||(t.Column={}));t.useVisitAnalytics=({fileId:e,fileExt:y,link:g,cursor:E,pageSize:A,user:b,skip:T,entryPoint:S})=>{const[N,M]=s.useState(!0),[h,k]=s.useState({}),[O,C]=s.useState(void 0),w=s.useMemo(()=>new n.DefaultUserApiV2Client(b),[b]),P=s.useCallback((e,t)=>{var a;switch(e){case c.EMAIL:k(m(h,t));break;case c.DATE:k(f(h,t));break;case c.VIEW_TIME:k(p(h,t));break;case c.PERCENT_VIEWED:k(v(h,t))}l.ProEventsLogger.log(`docsend_analytics_add_on_sort_visit_table_by_${e}_${t}`,{fileExt:y,entryPoint:S,linkId:(0,o.getLinkIdFromLink)(g),pageSize:h.pageSize,pageCount:null===(a=h.visits)||void 0===a?void 0:a.length,totalCount:h.totalCount})},[h]),I=s.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){if(g){const a=yield(0,i.getVisitAnalytics)(w,e,g,y,A,1,S,E);if(a){const s=(0,t.convertToVisitData)(a);k(s),s.totalCount&&r.UserSurvey.trackEvent("viewed_analytics_on_file_shared_with_docsend_analytics_add_on","docsend_analytics_add_on_modal"),u(s)&&_(w,Object.assign({},s),e,g,y,k,C,S,A,a.cursor)}else C(d.UNKNOWN)}else l.ProEventsLogger.log("docsend_analytics_add_on_use_visit_analytics_failure",{error:d.LINK_NOT_FOUND,fileExt:y,entryPoint:S}),C(d.LINK_NOT_FOUND);M(!1)})),[w,e,g,E,A]);return s.useEffect(()=>{T||I()},[I,T]),T?{}:{isVisitAnalyticsLoading:N,visitData:h,visitDataError:O,sortVisitData:P}};const u=e=>!!(e.totalCount&&e.visits&&e.visits.length<e.totalCount),_=(e,s,n,l,o,r,c,u,_,m)=>a.__awaiter(void 0,void 0,void 0,(function*(){const a=s;let f=m;if(!a.totalCount||!a.visits)return;let p=1,v=a.totalCount-a.visits.length;for(;v>0;){p++;const s=yield(0,i.getVisitAnalytics)(e,n,l,o,_,p,u,f);if(!s){c(d.GET_MORE_VISIT_DATA_FAILED);break}{const e=(0,t.convertToVisitData)(s);if(!e.visits)break;a.visits=[...a.visits,...e.visits],a.cursor=e.cursor,f=a.cursor,v-=e.visits.length}}r(a)})),m=(e,t)=>{if(!e.visits)return e;switch(t){case"asc":return e.visits.sort((e,t)=>e.email.localeCompare(t.email)),Object.assign({},e);case"desc":return e.visits.sort((e,t)=>t.email.localeCompare(e.email)),Object.assign({},e)}return e},f=(e,t)=>{if(!e.visits)return e;switch(t){case"asc":return e.visits.sort((e,t)=>new Date(e.occurredAt).getTime()-new Date(t.occurredAt).getTime()),Object.assign({},e);case"desc":return e.visits.sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()),Object.assign({},e)}return e},p=(e,t)=>{if(!e.visits)return e;switch(t){case"asc":return e.visits.sort((e,t)=>e.timeSpentMs-t.timeSpentMs),Object.assign({},e);case"desc":return e.visits.sort((e,t)=>t.timeSpentMs-e.timeSpentMs),Object.assign({},e)}return e},v=(e,t)=>{if(!e.visits)return e;switch(t){case"asc":return e.visits.sort((e,t)=>y(e.numPagesViewed,e.totalPages)-y(t.numPagesViewed,t.totalPages)),Object.assign({},e);case"desc":return e.visits.sort((e,t)=>y(t.numPagesViewed,t.totalPages)-y(e.numPagesViewed,e.totalPages)),Object.assign({},e)}return e},y=(e,t)=>e&&t?Math.ceil(e/t*100):0;t.convertToVisitData=e=>{return e?{cursor:e.cursor,pageSize:e.page_size,totalCount:e.total_count,visits:(t=e.visits,t?t.map(e=>({timeSpentMs:e.time_spent_ms,occurredAt:e.occurred_at,email:e.email,visitorName:e.visitor_name,numPagesViewed:e.num_pages_viewed,totalPages:e.total_pages,downloaded:e.downloaded,documentVersion:e.document_version})):[])}:{};var t}})),define("metaserver/static/js/docsend_analytics_add_on/data/use_summary_analytics",["require","exports","tslib","react","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/docsend_analytics_add_on/data/apiUtils","metaserver/static/js/clean/analytics"],(function(e,t,a,s,n,i,l){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.useSummaryAnalytics=t.SummaryDataError=void 0,s=a.__importStar(s),(function(e){e.UNKNOWN="UNKNOWN",e.LINK_NOT_FOUND="LINK_NOT_FOUND"})(o=t.SummaryDataError||(t.SummaryDataError={}));t.useSummaryAnalytics=({fileId:e,fileExt:t,link:d,user:c,skip:u,entryPoint:_})=>{const[m,f]=s.useState(!0),[p,v]=s.useState({}),[y,g]=s.useState(void 0),E=s.useMemo(()=>new n.DefaultUserApiV2Client(c),[c]),A=s.useCallback(()=>a.__awaiter(void 0,void 0,void 0,(function*(){if(d){const[a,s]=yield Promise.all([(0,i.getSummaryAnalytics)(E,e,d,t,_),(0,i.getAnalyticsForDocumentVersion)(E,e,d,t,_)]);if(void 0===a||void 0===s)g(o.UNKNOWN);else{const e=r(a,s);v(e)}}else l.ProEventsLogger.log("docsend_analytics_add_on_use_summary_analytics_failure",{error:o.LINK_NOT_FOUND,fileExt:t,entryPoint:_}),g(o.LINK_NOT_FOUND);f(!1)})),[E,e,d]);return s.useEffect(()=>{u||A()},[A,u]),u?{}:{isSummaryAnalyticsLoading:m,summaryData:p,summaryDataError:y}};const r=(e,t)=>e&&t?{numVisitors:e.num_visitors,avgViewTimeMs:e.average_view_time_ms,numDownloads:e.num_downloads,pageViews:t.top_viewed_pages,pageAvgViewTime:t.top_viewed_pages_average_time_ms}:{}})),define("metaserver/static/js/docsend_analytics_add_on/helpers/utils",["require","exports","metaserver/static/js/core/browser_detection","metaserver/static/js/core/i18n","metaserver/static/js/cloud_docs/constants"],(function(e,t,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocsendAnalyticsAddOnConfig=t.isImage=t.convertToHumanReadableTime=t.getLinkIdFromLink=t.getUpgradeURL=void 0;t.getUpgradeURL=function(e,t){const a=`https://docsend.com/account/auth/dropbox?signup_source=docsend_analytics_add_on_${e}&next_url=${encodeURIComponent(t)}`;return`/docsend/redirect?cont=${encodeURIComponent(a)}`};t.getLinkIdFromLink=e=>{if(!e)return"";const t=e.split("/");return t.length?t[t.length-1]:""};t.convertToHumanReadableTime=(e=0)=>{let t=Math.floor(e/1e3)%60;const a=Math.floor(e/1e3/60)%60,n=Math.floor(e/1e3/60/60);e<1e3&&e>0&&(t=1);let i="";return n>0&&(i+=s.intl.formatMessage({id:"BpGKhY",defaultMessage:"{hours}h"},{hours:n}),i+=" "),a>0&&(i+=s.intl.formatMessage({id:"mefQKO",defaultMessage:"{minutes}m"},{minutes:a}),i+=" "),(0===n&&t>0||0===e)&&(i+=s.intl.formatMessage({id:"/FkI8S",defaultMessage:"{seconds}s"},{seconds:t})),i.trim()};const i=["bmp","jpg","jpeg","png","svg","tiff","webp","gif","heic"];t.isImage=e=>i.includes(e);const l=(e,t)=>{if(t)return["V1","V2","V3"].includes(e)?"ANALYTICS":["TEAMS_V1"].includes(e)?"SURVEY":void 0};t.getDocsendAnalyticsAddOnConfig=(e,t)=>{const s=(null==t?void 0:t.toUpperCase())||"OFF",i=s.toLowerCase(),o=!(0,a.is_supported_mobile_browser)()&&e.is_email_verified;return{variantForLogging:i,fileBrowser:{deeplinkEnabled:["V1","V2","V3"].includes(s)&&o},workflowMenu:{logExposure:["V1","V2","V3","CONTROL","TEAMS_V1","TEAMS_CONTROL"].includes(s)&&o,showMenuItem:["V1","V2","V3","TEAMS_V1"].includes(s)&&o},splitShare:{logExposure:["CONTROL","TEAMS_CONTROL"].includes(s)&&o,showMenuItem:["V1","V2","V3","TEAMS_V1"].includes(s)&&o,removeDocsendAppAction:["V1","V3","TEAMS_V1"].includes(s),moveDocsendEntryPoint:["V2"].includes(s)&&o},coreSharingModal:{showFooterWhenViewAccess:["TEAMS_V1"].includes(s)&&o,showFooterWhenEditAccess:["TEAMS_V1"].includes(s)&&o,fetchAnalyticsLink:!1},docsendModalVariant:l(s,o),isSupportedFile:(e,t)=>!!["TEAMS_V1","TEAMS_CONTROL"].includes(s)||(0,n.isDocsendSupportedFile)(e,t)}}})),define("metaserver/static/js/docsend_analytics_add_on/helpers/modals",["require","exports","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal","metaserver/static/js/docsend_analytics_add_on/components/teams_painted_door_test/teams_analytics_survey_modal","metaserver/static/js/docsend_analytics_add_on/helpers/utils"],(function(e,t,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDocsendModal=void 0;t.showDocsendModal=e=>{const{docsendModalVariant:t}=(0,n.getDocsendAnalyticsAddOnConfig)(e.user,e.stormcrowVariant);switch(t){case"ANALYTICS":(0,a.showDocSendAnalyticsModal)(e);break;case"SURVEY":(0,s.showTeamsAnalyticsSurveyModal)(e)}}})),define("metaserver/static/js/docsend_analytics_add_on/helpers/docsend_analytics_teams_survey_tracker",["require","exports","tslib","metaserver/static/js/growth/user_action/tracker"],(function(e,t,a,s){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DocsendAnalyticsTeamsSurveyTracker=t.DocsendAnalyticsTeamsSurveyProjectTag=t.DocsendAnalyticsTeamsSurveyActions=void 0,(function(e){e.SURVEY_SUBMITTED="survey_submitted",e.CONSENT_TO_NOTIFY="consent_to_notify"})(n=t.DocsendAnalyticsTeamsSurveyActions||(t.DocsendAnalyticsTeamsSurveyActions={})),t.DocsendAnalyticsTeamsSurveyProjectTag="docsend_analytics_teams_survey";class i extends s.GrowthUserActionTracker{constructor(){super(...arguments),this.project=t.DocsendAnalyticsTeamsSurveyProjectTag}trackSurveySubmitted(){return this.track(n.SURVEY_SUBMITTED)}trackConsentToNotify(){return this.track(n.CONSENT_TO_NOTIFY)}isSurveySubmitted(){return a.__awaiter(this,void 0,void 0,(function*(){return(yield this.client.rpc("performed_user_action",{project:this.project,action:n.SURVEY_SUBMITTED},{subjectUserId:this.userId})).has_performed}))}hasConsentToNotify(){return a.__awaiter(this,void 0,void 0,(function*(){return(yield this.client.rpc("performed_user_action",{project:this.project,action:n.CONSENT_TO_NOTIFY},{subjectUserId:this.userId})).has_performed}))}}t.DocsendAnalyticsTeamsSurveyTracker=i}));
//# sourceMappingURL=pkg-analytics-add-on.min.js-vflwZulnS.map