var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,i)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&__createBinding(t,e,s);return __setModuleDefault(t,e),t};define("metaserver/static/js/file_transfers/async/browse_entry_point_onboarding_modal_async",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowBrowseEntryPointOnboardingModal=void 0;t.asyncShowBrowseEntryPointOnboardingModal=t=>{new Promise((t,s)=>{e(["metaserver/static/js/file_transfers/containers/browse_entry_point_onboarding_modal"],t,s)}).then(__importStar).then(({showBrowseEntryPointOnboardingModal:e})=>e(t))}})),define("metaserver/static/js/file_viewer/open_button/utils",["require","exports","tslib","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/file_store/utils","metaserver/static/js/clean/open_with","metaserver/static/js/extensions/connect_flow","metaserver/static/js/extensions/utils","metaserver/static/js/file_viewer/constants","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/file_viewer/open_button/open_with_helpers","metaserver/static/js/file_viewer/unity/unity_utils","metaserver/static/js/core/i18n","metaserver/static/js/core/browser_detection","metaserver/static/js/clean/downloads","metaserver/static/js/core/uri"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f){"use strict";function h(e,t,s,i){let o;if(i.provider===n.OpenWithCloudDocProvider.GoogleDSS)o={type:c.OpenButtonAction.OPEN_WITH_CLOUD_DOC,userAction:l.UserAction.OpenWithCloudDocEditor};else{if(i.provider!==n.OpenWithCloudDocProvider.OfficeOnline)return null;o={type:c.OpenButtonAction.OPEN_WITH,userAction:l.UserAction.OpenInOfficeOnline}}return Object.assign({handler:()=>i.handler(e,t,s),spriteName:i.spriteName||null,iconUrl:i.iconUrl,text:i.text},o)}function g(e){const{file:t,user:s,isOpenWithDisabled:i}=e,o=[],a={gdd:!e.isCloudEditorDisabled,wopi:E({file:t,isOpenWithDisabled:i,user:s})},r=e.actionSource,l=(0,n.getOpenWithCloudEditorInfo)(t,s,a,r);for(const e of l){const n=h(t,s,r,e);n&&o.push(n)}return o}function v(e){const t=f.URI.parse(e.href);t.updateQuery({dl:"1"}),m.get({url:t.toString()})}function E({file:e,isOpenWithDisabled:t,user:s}){return!t&&d.OpenWithHelpers.canOpenWith(e,s)}function S(e,t){const s=(e?e.open_application_name:void 0)||p.intl.formatMessage({id:"Uyxn/h",defaultMessage:"Desktop"});return t?s:p.intl.formatMessage({id:"KtD8FA",defaultMessage:"Open in {app_name}"},{app_name:s})}function y(e){const t=(null!==e?e.file_browser_display_name:void 0)||p.intl.formatMessage({id:"Bbnzjx",defaultMessage:"File Browser"});return p.intl.formatMessage({id:"suwlZc",defaultMessage:"Show in {file_browser}"},{file_browser:t})}function A({file:e,isFolder:t,user:s}){return()=>{u.UnityHelpers.openFile(e.ns_id,e.ns_path,s.id,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowCoachmark=t.download=t.getOpenOptionsSharedFile=t.convertOpenWithCloudEditorInfo=t.getOpenOptions=void 0,o=s.__importDefault(o),m=s.__importStar(m),t.getOpenOptions=function(e){const{file:t}=e,o=s.__rest(e,["file"]);return(0,i.isBrowseFile)(t)?(function({file:e,isUnityDisabled:t,isOpenWithDisabled:s,isCloudEditorDisabled:i,unityInfo:o,extraOptions:d,user:m,sharingServiceInfo:f,refreshSharingServiceInfo:g,showOpenWithShare:O,onPresentInZoom:I,isCloudBasedDoc:x,actionSource:b,landingPagesEnabled:M,isInActionBar:T,previewActionHandler:w,openDesktopActionHandler:C,openInNewTabActionHandler:N,goToFolderActionHandler:P,replayActionHandler:j}){const D=[];if(j){const e=p.intl.formatMessage({id:"AQCWZx",defaultMessage:"Get feedback"});D.push({handler:j,spriteName:null,text:e,type:c.OpenButtonAction.OPEN_IN_REPLAY,userAction:l.UserAction.OpenInReplay})}w&&D.push({handler:w,spriteName:null,text:p.intl.formatMessage({id:"wHolW4",defaultMessage:"Preview (Dropbox)"}),type:c.OpenButtonAction.PREVIEW_FILE,userAction:l.UserAction.PreviewFile});if(C){const e=_.mac?p.intl.formatMessage({id:"3KanyU",defaultMessage:"Finder"}):p.intl.formatMessage({id:"kJ3mnY",defaultMessage:"File Explorer"});D.push({handler:C,spriteName:null,text:e,type:c.OpenButtonAction.OPEN_IN_DESKTOP,userAction:l.UserAction.OpenInDesktop})}N&&D.push({handler:N,spriteName:null,text:p.intl.formatMessage({id:"HE6Ges",defaultMessage:"Open in new tab"}),type:c.OpenButtonAction.OPEN_IN_NEW_TAB,userAction:l.UserAction.OpenInNewTab});P&&D.push({handler:P,spriteName:null,text:p.intl.formatMessage({id:"mppZEu",defaultMessage:"Go to folder"}),type:c.OpenButtonAction.GO_TO_FOLDER,userAction:l.UserAction.GoToFolder});if(!o)return D;!x&&(function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&u.UnityHelpers.isUnityFileSupported(t)})({isUnityDisabled:t,unityInfo:o})&&D.push({handler:A({file:e,user:m,isFolder:!1}),spriteName:"ow_desktop",text:S(o,T),type:c.OpenButtonAction.UNITY_FILE,userAction:l.UserAction.OpenInUnity});const F=E({file:e,isOpenWithDisabled:s,user:m}),U={gdd:!i,wopi:F},L=(0,n.getOpenWithCloudEditorInfo)(e,m,U,b);for(const t of L){const s=h(e,m,b,t);s&&D.push(s)}!T&&(function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&u.UnityHelpers.isUnityFolderSupported(t)})({isUnityDisabled:t,unityInfo:o})&&D.push({handler:A({file:e,user:m,isFolder:!0}),spriteName:"ow_folder",text:y(o),type:c.OpenButtonAction.UNITY_FOLDER,userAction:l.UserAction.OpenInUnityFolder});d&&d.forEach(e=>{e&&D.push(e)});T||D.length||x||D.push({handler:()=>v(e),spriteName:null,text:p.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),type:c.OpenButtonAction.DOWNLOAD,userAction:l.UserAction.Download});let B=!1,R=!1;O&&f&&(B=(0,r.isSlackAvailable)(f),R=(0,r.isZoomAvailable)(f));B&&f&&g&&D.push({handler:()=>(0,a.shareInSlackFlow)(m,f,g,e,"open_with_button",void 0!==M?M:null),spriteName:null,text:p.intl.formatMessage({id:"Qws4v2",defaultMessage:"Slack"}),type:c.OpenButtonAction.SHARE_TO_SLACK,userAction:l.UserAction.ShareToSlack});R&&f&&I&&g&&D.push({handler:()=>(0,a.presentInZoomFlow)(m,f,g,I,"open_with_button",void 0!==M?M:null),spriteName:null,text:p.intl.formatMessage({id:"mzy+1c",defaultMessage:"Zoom"}),type:c.OpenButtonAction.PRESENT_IN_ZOOM,userAction:l.UserAction.PresentInZoom});return D})(Object.assign({file:t},o)):(0,i.isSharedFile)(t)?g(Object.assign({file:t},o)):[]},t.convertOpenWithCloudEditorInfo=h,t.getOpenOptionsSharedFile=g,t.download=v,t.shouldShowCoachmark=function(e,t){const s=e.map(e=>e.type).includes(c.OpenButtonAction.UNITY_FILE),n=t&&o.default.is_adobe_app(t.open_application_identifier),i=e.map(e=>e.type).includes(c.OpenButtonAction.OPEN_WITH);return s&&n||i}})),define("metaserver/static/js/app_actions/developers_site/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeveloperState=void 0,(function(e){e[e.UNVERIFIED=0]="UNVERIFIED",e[e.IN_DEVELOPMENT=1]="IN_DEVELOPMENT",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"})(t.DeveloperState||(t.DeveloperState={}))})),define("metaserver/static/js/app_actions/redirect",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","lodash","metaserver/static/js/core/i18n","js/browser/cookies","metaserver/static/js/core/notify","metaserver/static/js/core/uri","metaserver/static/js/api_v2/transport/fetch","metaserver/static/js/components/ui/modal","metaserver/static/js/extensions/auth_modal","js/filepath/filepath","metaserver/static/js/extensions/cloud_docs_compat","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/open_with_utils"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f){"use strict";function h(e,t,n){return s.__awaiter(this,void 0,void 0,(function*(){const s=new c.FetchAsyncTransport,i=new l.URI({scheme:"https",authority:"www.dropbox.com",path:"/2/app_actions/"+t}),o={};o["X-Dropbox-Path-Root"]=e.root_ns_id.toString(),o["X-Dropbox-Uid"]=e.id.toString();const r=a.Cookies.read("__Host-js_csrf");if(!r)throw new Error("No CSRF cookie");return o["X-CSRF-Token"]=r,s.executeRpc(i,o,JSON.stringify(n),"application/json")}))}function g(e,t,n){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield h(e,t,n),i={request_id:s.headers["x-dropbox-request-id"],redirect_url:s.result.redirect_url};return"link_state"in s.result&&(i.link_state=s.result.link_state),i}))}function v(e,t,n,i,o){return s.__awaiter(this,void 0,void 0,(function*(){yield y(e,t,n,i[0],()=>g(e,"redirect",{action_id:t,file_ids:i}),o)}))}function E(e,t){if(1!==e.length)throw new Error(`Expected single file: ${t}`);return e[0]}function S(e,t,n,i,o){return s.__awaiter(this,void 0,void 0,(function*(){return yield y(e,t,n,i,()=>g(e,"authorize",{action_id:t,file_id:i}),o)}))}function y(e,t,a,l,c,d){return s.__awaiter(this,void 0,void 0,(function*(){const u=`action_redirect_${Math.random().toString(16).substring(2)}`,p=window.open("",u,d);p&&(p.document.open("text/html","replace"),p.document.write(`<html><head><title>${i.escape(a)}</title></head></html>`),p.document.close());let _=!1;const m=new Promise(s=>{n.SilentBackgroundRequest({url:"/aa/loading",subject_user:e.id,data:{file_id:l,action_id:t},success:e=>{!_&&p?(p.document.open("text/html","replace"),p.document.write(e),p.document.close(),p.document.title=a,s()):s()},error:()=>{s()}})});const[,f]=yield Promise.all([m,(function(){return s.__awaiter(this,void 0,void 0,(function*(){try{return yield c()}catch(e){return void(_=!0)}}))})()]),h=f&&f.redirect_url||"/aa/error";if(p)p.location.replace(h);else{if(!window.open(h,"_blank",d)){const e=a;r.Notify.error(o.intl.formatMessage({id:"TFhSer",defaultMessage:"Failed to open {app_name}"},{app_name:e}))}}return f}))}Object.defineProperty(t,"__esModule",{value:!0}),t.showLoadingPageAndDoRedirect=t.authAction=t.redirectToActionOrShowAuth=t.redirectToAction=t.authorizeNoRedirect=t.fetchUrl=t.fetch=void 0,n=s.__importStar(n),i=s.__importStar(i),p=s.__importStar(p),t.fetch=h,t.fetchUrl=g,t.authorizeNoRedirect=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=yield h(e,"authorize_no_redirect",{action_id:t});return s&&s.result&&s.result.link_state}catch(e){return null}}))},t.redirectToAction=v,t.redirectToActionOrShowAuth=function(e,t,n,i,o,a,r){return s.__awaiter(this,void 0,void 0,(function*(){if("redirect"===n.handler[".tag"]){const i=n.handler.window_params;let o=void 0;if("popup"===i[".tag"]){const{width:e,height:t}=i;o=`width=${e},height=${t}`}if("sfa_unlinked"===n.link_state[".tag"]&&!n.id.startsWith("fp_action_id:")){const i=E(t,"first party actions do not support multiple files yet."),r=p.filename(i.ns_path);(0,u.showAuthModal)(n.id,n.description,n.icon.url,i.file_id,r,()=>{d.Modal.close(),(function(e,t,n,i,o,a){s.__awaiter(this,void 0,void 0,(function*(){const s=yield S(e,t,n,i,o);a&&s&&s.link_state&&a(t,s.link_state)}))})(e,n.id,n.description,i.file_id,o,a)})}else{const s=t.map(e=>e.file_id);v(e,n.id,n.description,s,o)}}else if("cloud_editor"===n.handler[".tag"]){const s=E(t,"cloud docs actions do not support multiple files yet."),i=o?(0,m.getActionSourceFromSurface)(o.surface):void 0,a=(0,_.cloudEditorNameToParams)(n.handler.editor_name);(0,f.openWithCloudEditor)((0,f.fileToOpenWithParams)(s),e.id,a,!1,i)}else{if("profile_service"!==n.handler[".tag"])throw new Error(`Unexpected handler "${n.handler[".tag"]}"`);if(r){const s=E(t,"profile service actions do not support multiple files yet.");r(e,s,n)}}}))},t.authAction=S,t.showLoadingPageAndDoRedirect=y})),define("metaserver/static/js/app_directory/client",["require","exports","tslib","metaserver/static/js/api_v2/user_client"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPageInfos=void 0,t.getPageInfos=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=(new n.UserApiV2Client).ns("app_directory").rpc("list_page_info",{app_identifiers:e},{subjectUserId:t});return(yield s).page_infos}))}})),define("metaserver/static/js/extensions/auth_body_v2",["require","exports","tslib","react","react-intl","metaserver/static/js/components/ui/css","spectrum/button/index","metaserver/static/js/core/i18n","metaserver/static/js/app_actions/telemetry_client","js/filepath/filepath","metaserver/static/js/extensions/status_page"],(function(e,t,s,n,i,o,a,r,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsAuthBodyV2=void 0,n=s.__importDefault(n);class u extends n.default.Component{constructor(e){super(e),this.clickAuthorize=()=>{this.currentSession.event("auth_accept",{action_id:this.props.actionId}),this.props.doAuth()},this.learnMoreOnClick=()=>{this.currentSession.event("learn_more",{action_id:this.props.actionId}),this.props.onLearnMore&&this.props.onLearnMore()},this.telemetryClient=(0,l.createTelemetryClient)({component:"auth_v2"})}componentDidMount(){this.currentSession.event("auth_start",{action_id:this.props.actionId})}renderText(){const e=0!==this.props.fileId.length?(0,i.defineMessage)({id:"VDSuu6",defaultMessage:"<b>{app_name}</b> needs access to this file"}):(0,i.defineMessage)({id:"mZo8K4",defaultMessage:"<b>{app_name}</b> needs access to files you select"}),t=0!==this.props.fileId.length?(0,i.defineMessage)({id:"hE6l1Q",defaultMessage:"Changes to this file using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."}):(0,i.defineMessage)({id:"HsAedA",defaultMessage:"Changes to selected files using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."});return n.default.createElement("div",null,n.default.createElement("div",{className:"auth-text-header-v2"},r.intl.formatMessage(e,{app_name:this.props.appName,b:e=>n.default.createElement("b",null,e)})),n.default.createElement("div",{className:"auth-text-v2"},r.intl.formatMessage(t,{app_name:this.props.appName}),n.default.createElement("a",{className:"learn-more-link",href:"/help/security/third-party-apps",target:"_blank",rel:"noopener noreferrer",onClick:this.learnMoreOnClick},r.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}))))}renderButtons(){return n.default.createElement("div",null,n.default.createElement(a.Button,{variant:"primary",className:"auth-button-v2",onClick:this.clickAuthorize},r.intl.formatMessage({id:"LGeX5c",defaultMessage:"Allow"})))}renderAuthorization(){const{appName:e,iconUrl:t}=this.props;return n.default.createElement("div",{id:"auth",className:"auth-connect-frame-v2"},n.default.createElement("div",null,n.default.createElement("img",{className:"app-icon-v2",src:t,alt:e})),n.default.createElement("div",null,this.renderText()),n.default.createElement("div",{id:"buttons"},this.renderButtons()))}render(){const{fileName:e}=this.props;return this.currentSession=this.telemetryClient.session({ext:(0,l.getPiiSafeExtension)("."+(0,c.file_extension)(e))}),this.props.showLoadingUI?n.default.createElement(d.AppActionsLoadingPage,{fileName:e}):this.renderAuthorization()}}u.displayName="AuthBodyV2Component",t.ExtensionsAuthBodyV2=(0,o.requireCssWithComponent)(u,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/foundation-vflZkvt4R.css","/static/metaserver/static/css/app_actions/index-vfljPaJWn.css"])})),define("metaserver/static/js/extensions/auth_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/modal","metaserver/static/js/extensions/auth_body_v2","metaserver/static/js/clean/ux_analytics_modal_tracking"],(function(e,t,s,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showAuthModal=t.AuthModal=void 0,n=s.__importDefault(n);t.AuthModal=e=>n.default.createElement(i.Modal,{className:"extensions-auth-modal-v2",ariaLabel:"Access Modal",displayCloseButton:!0,clickOutToClose:!1,style:"clean",onDismiss:e.doCancel},n.default.createElement(a.UXAnalyticsModalTracking,{id:"EXTENSIONS_AUTH_MODAL_V2"}),n.default.createElement(o.ExtensionsAuthBodyV2,Object.assign({},e))),t.showAuthModal=function(e,s,o,a,r,l){i.Modal.showInstance(n.default.createElement(t.AuthModal,{actionId:e,appName:s,iconUrl:o,fileId:a,fileName:r,doAuth:l,doCancel:i.Modal.close}))}})),define("metaserver/static/js/extensions/cloud_docs_compat",["require","exports","metaserver/static/js/cloud_docs/constants"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWopiAction=t.cloudEditorNameToParams=void 0,t.cloudEditorNameToParams=function(e){return"gdoc"===e?s.GoogleFileTypes.GOOGLE_DSS_DOC:"gsheet"===e?s.GoogleFileTypes.GOOGLE_DSS_SHEET:"gslides"===e?s.GoogleFileTypes.GOOGLE_DSS_SLIDES:"word"===e?s.MicrosoftEditors.WORD:"excel"===e?s.MicrosoftEditors.EXCEL:"powerpoint"===e?s.MicrosoftEditors.POWERPOINT:"preview"},t.isWopiAction=function(e){return["fp_action_id:word_online","fp_action_id:excel_online","fp_action_id:powerpoint_online"].indexOf(e.id)>=0}})),define("metaserver/static/js/extensions/education/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipState=void 0,(function(e){e[e.NO_TOOLTIP=0]="NO_TOOLTIP",e[e.BIG_ONBOARDING_TOOLTIP=1]="BIG_ONBOARDING_TOOLTIP",e[e.SMALL_TOOLTIP=2]="SMALL_TOOLTIP"})(t.TooltipState||(t.TooltipState={}))})),define("metaserver/static/js/extensions/extensions_mini_directory_modal",["require","exports","tslib","react","metaserver/static/js/core/i18n","spectrum/modal/index","metaserver/static/js/clean/static_urls","dig-components/buttons","metaserver/static/js/clean/ux_analytics_modal_tracking","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","react-modal","lodash","metaserver/static/js/extensions/common","metaserver/static/js/extensions/data/helpers","metaserver/static/js/extensions/data/selectors","metaserver/static/js/app_actions/redirect","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/extensions/cloud_docs_compat","dig-components/typography","dig-components/text_fields","dig-components/icons","dig-components/icons/src","metaserver/static/js/app_directory/client","dig-components/progress_indicators","classnames","lodash","metaserver/static/js/app_actions/developers_site/types"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f,h,g,v,E,S,y,A,O,I,x,b,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showExtensionsMiniDirectoryModal=t.ExtensionsMiniDirectoryModal=t.AppDirectoryEntryPoint=void 0,n=s.__importDefault(n),u=s.__importDefault(u),p=s.__importStar(p),O=s.__importStar(O),x=s.__importDefault(x);const T=e=>"api_app"===e[".tag"]?`${e[".tag"]}/${e.api_app}`:"first_party_app"===e[".tag"]?`${e[".tag"]}/${e.first_party_app}`:`${e[".tag"]}`;function w(){return n.default.createElement("div",{className:"extensions-mini-directory-modal__directory-entry-point"},n.default.createElement(E.Link,{href:"/apps",hasNoUnderline:!0,variant:"monochromatic",className:"extensions-mini-directory-modal__directory-entry-point-text-border"},n.default.createElement(E.Text,{isBold:!0},i.intl.formatMessage({id:"LbLi52",defaultMessage:"View all apps"}))))}t.AppDirectoryEntryPoint=w;class C extends n.default.Component{constructor(e){super(e),this.hasUsedSearchBar=!1,this.onScroll=(0,b.throttle)(e=>{e>0&&!this.state.showTopBorder&&this.setState({showTopBorder:!0}),0===e&&this.state.showTopBorder&&this.setState({showTopBorder:!1})},20),this.createClickHandler=e=>()=>{d.Modal.close();const{user:t,file:s,featureFlags:n,currentSession:i,telemetryContext:o,updateLinkState:a,onProfileServiceAuth:r}=this.props;if((0,h.redirectToActionOrShowAuth)(t,[s],e,n,o,a,r),"redirect"===e.handler[".tag"])(0,_.logEvent)(i,"select_action",(0,_.getAppActionExtras)(e));else if("cloud_editor"===e.handler[".tag"]){const t=(0,v.isWopiAction)(e)?g.OpenButtonAction.OPEN_WITH:g.OpenButtonAction.OPEN_WITH_CLOUD_DOC;(0,_.logEvent)(this.props.currentSession,"select_legacy_action",{type:t})}},this.handleQueryChange=e=>{const t=e.currentTarget.value;this.setState({searchKey:t}),this.hasUsedSearchBar||((0,_.logEvent)(this.props.currentSession,"start_searching",{}),this.hasUsedSearchBar=!0)},this.filterActions=()=>{const{appActions:e,categoryIdToInfos:t}=this.props,s=this.state.searchKey.trim().toLowerCase(),n=e.map(e=>e.category).map(e=>t[e]).filter(e=>-1!==e.display_name.toLowerCase().indexOf(s)).map(e=>e.id);return e.filter(e=>{const t=this.getAppDirectoryPageInfo(e);return((e,t)=>t||e.app_directory_id&&"first_party_app"===e.app_directory_id[".tag"]||e.developer_state===M.DeveloperState.IN_DEVELOPMENT)(e,t)&&(-1!==e.description.toLowerCase().indexOf(s)||(e=>!(!e||!e.short_description)&&-1!==e.short_description.toLowerCase().indexOf(s))(t)||n.includes(e.category))})},this.clearSearch=()=>{this.setState({searchKey:""})},this.renderExtensionItem=e=>{const t=e.icon,s=t.is_static?(0,a.static_url)("/static/metaserver/static/images/generic_app_icon-vflIPYT1H.png"):t.url,o=(0,_.isLinked)(e),l=o?"primary":"opacity",c=o?(0,f.isShareAction)(e)?i.intl.formatMessage({id:"NoV3Co",defaultMessage:"Share"}):i.intl.formatMessage({id:"CNPdm5",defaultMessage:"Open"}):i.intl.formatMessage({id:"vV9l+M",defaultMessage:"Connect"});return n.default.createElement("div",{className:"extension-section",key:e.description},n.default.createElement("img",{src:s,className:"extensions-icon",alt:""}),this.renderActionInfo(e),n.default.createElement("div",{className:"extensions-mini-directory-modal__redirect_button_wrapper"},n.default.createElement(r.Button,{variant:l,onClick:this.createClickHandler(e),className:"extensions-mini-directory-modal__redirect_button"},c)))},this.getAppDirectoryPageInfo=e=>{const t=e.app_directory_id&&T(e.app_directory_id);return t?this.state.appDirectoryPageInfo.get(t):void 0},this.renderActionInfo=e=>{const t=this.getAppDirectoryPageInfo(e),s=t&&t.short_description,i=t&&t.page_url,o=n.default.createElement(n.default.Fragment,null,n.default.createElement(E.Text,{tagName:"div",isBold:!0},e.description),n.default.createElement(E.Text,{color:"faint",className:"extensions-short-description",size:"small"},s));return i?n.default.createElement("div",{className:"extensions-description"},n.default.createElement(E.Link,{href:i,target:"_blank",rel:"noreferrer",variant:"monochromatic",hasNoUnderline:!0,className:"extensions-description__link"},o)):n.default.createElement("div",{className:"extensions-description"},o)},this.renderEmptySearch=()=>{const e=this.state.searchKey,t=e?`/apps/search?query=${e}`:"/apps",s=e?i.intl.formatMessage({id:"4fGTX4",defaultMessage:"Search “{search_key}” in App Center"},{search_key:e}):i.intl.formatMessage({id:"C5jY7c",defaultMessage:"Search in App Center"});return n.default.createElement("div",{className:"extensions-mini-directory-modal__empty-search-app-center"},n.default.createElement(E.Text,null,i.intl.formatMessage({id:"niuDq6",defaultMessage:"Looking for something?"})),n.default.createElement(E.Link,{href:t,variant:"monochromatic"},n.default.createElement(E.Text,null,s)))},this.state={searchKey:"",appDirectoryPageInfo:new Map,loading:!0}}componentDidMount(){const e=this.props.appActions.map(e=>e.app_directory_id).filter(e=>void 0!==e);this.fetchAppDirectoryPageInfoMap(e).then(e=>this.setState({appDirectoryPageInfo:e,loading:!1}))}fetchAppDirectoryPageInfoMap(e){return s.__awaiter(this,void 0,void 0,(function*(){return(yield O.getPageInfos(e,this.props.user.id)).reduce((function(e,t){for(const s of t.app_identifiers)e.set(T(s),t);return e}),new Map)}))}render(){const{onRequestClose:e,modalTitle:t}=this.props,s=this.filterActions().sort(m.actionCompareFn);return n.default.createElement(o.Modal,{ariaLabel:i.intl.formatMessage({id:"wjwJvt",defaultMessage:"App actions"}),className:"extensions-mini-directory-modal",displayCloseButton:!0,open:!0,overlayClassName:"file-viewer-modal-overlay",overlayFixed:!1,onRequestClose:()=>e()},this.state.loading?n.default.createElement("div",{className:"extensions-mini-directory-modal__body-loading"}," ",n.default.createElement(I.Spinner,{"aria-valuetext":"Loading Apps"})," "):n.default.createElement("div",{className:"extensions-mini-directory-modal__body-wrapper"},n.default.createElement("div",{className:(0,x.default)({"extensions-mini-directory-modal__header-border":this.state.showTopBorder})},n.default.createElement("div",{className:"extensions-mini-directory-modal__title"},n.default.createElement(E.Title,null,t)),n.default.createElement("div",{className:"extensions-mini-directory-modal__search-bar"},n.default.createElement(S.TextInput,{"aria-label":"Search Apps",withLeftAccessory:n.default.createElement(y.UIIcon,{src:A.SearchLine}),withRightAccessory:this.state.searchKey&&n.default.createElement(r.IconButton,{size:"small",variant:"transparent",onClick:this.clearSearch},n.default.createElement(y.UIIcon,{src:A.FailFill})),placeholder:i.intl.formatMessage({id:"+enW1p",defaultMessage:"Search by action or app name"}),value:this.state.searchKey,onChange:this.handleQueryChange}))),n.default.createElement("div",{className:"extensions-container",onScroll:({currentTarget:{scrollTop:e}})=>this.onScroll(e)},s.length>0?s.map(e=>this.renderExtensionItem(e)):this.renderEmptySearch()),n.default.createElement(w,null)),n.default.createElement(l.UXAnalyticsModalTracking,{id:"extensions-mini-directory-modal"}))}}C.displayName="ExtensionsMiniDirectoryModalComponent",t.ExtensionsMiniDirectoryModal=(0,c.requireCssWithComponent)(C,["/static/typescript/component_libraries/deep-integrations/src/index.web-vflTFI7Au.css","/static/metaserver/static/css/app_actions/index-vfljPaJWn.css"]);const N=p.once(()=>{u.default.setAppElement(document.body)});t.showExtensionsMiniDirectoryModal=(e,s,i,o,a,r,l,c,u,p)=>{N(),d.Modal.showInstance(n.default.createElement(t.ExtensionsMiniDirectoryModal,{modalTitle:e,user:s,file:i,onRequestClose:d.Modal.close,appActions:o,categoryIdToInfos:a,featureFlags:r,updateLinkState:l,telemetryContext:c,currentSession:u,onProfileServiceAuth:p}));const{connected_apps:m,unconnected_apps:f}=(0,_.partitionActionsByLinkStatus)(o);(0,_.logEvent)(u,"view_scaling_modal",{connected_apps:m,unconnected_apps:f})}})),define("metaserver/static/js/extensions/extensions_utils",["require","exports","metaserver/static/js/file_viewer/open_button/utils","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/cloud_docs/event_logging"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCategoryIdToInfos=t.getOpenOptionsForFile=void 0;const o=Object.freeze({local_path:null,resolved_local_path:null,is_locally_available:!1,can_open_directly:!1,open_application_identifier:null,open_application_name:null,path_is_dir:!1,is_infinite_placeholder:!1,error_message:null});t.getOpenOptionsForFile=function(e){const t=(0,i.getActionSourceFromSurface)(e.surface),a=e.sharingServiceInfo||{};let{isCloudEditorDisabled:r}=e,l=r;return r||(r=!!e.cloudDocsInfo&&!e.cloudDocsInfo.openWithGddSupported,l=!!e.isOpenWithDisabled),(0,s.getOpenOptions)({file:e.file,isOpenWithDisabled:!!l,unityInfo:e.unityInfo||o,extraOptions:e.extraOptions,user:e.user,sharingServiceInfo:a,refreshSharingServiceInfo:e.refreshSharingServiceInfo,showOpenWithShare:!1,onPresentInZoom:e.onPresentInZoom,isCloudBasedDoc:(0,n.isCloudBasedDoc)(e.file),actionSource:t,isCloudEditorDisabled:r,landingPagesEnabled:e.landingPagesEnabled,isInActionBar:e.isInActionBar,previewActionHandler:e.previewActionHandler,openDesktopActionHandler:e.openDesktopActionHandler,goToFolderActionHandler:e.goToFolderActionHandler,replayActionHandler:e.replayActionHandler,openInNewTabActionHandler:e.openInNewTabActionHandler})},t.getCategoryIdToInfos=function(e){const t={};return e.forEach(e=>{t[e.id]=e}),t}})),define("metaserver/static/js/extensions/split_share_button_component",["require","exports","tslib","classnames","lodash","react","dig-components/icons/src","react-redux","dig-components/menu","dig-components/buttons","dig-components/icons","spectrum/tooltip/index","metaserver/static/js/cloud_docs/constants","js/filepath/filepath","metaserver/static/js/integrations/data/selectors","metaserver/static/js/extensions/apis","metaserver/static/js/extensions/education/types","metaserver/static/js/app_actions/redirect","metaserver/static/js/app_actions/telemetry_client","metaserver/static/js/components/ui/css","metaserver/static/js/extensions/common","metaserver/static/js/extensions/connect_flow","metaserver/static/js/extensions/data/action_creators","metaserver/static/js/extensions/data/helpers","metaserver/static/js/extensions/data/selectors","metaserver/static/js/extensions/data/store","metaserver/static/js/extensions/data/types","metaserver/static/js/extensions/extensions_mini_directory_modal","metaserver/static/js/extensions/extensions_utils","metaserver/static/js/extensions/file","metaserver/static/js/extensions/tooltips","metaserver/static/js/extensions/utils","metaserver/static/js/extensions/constants","metaserver/static/js/file_viewer/constants","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/clean/static_urls","metaserver/static/js/user_education/react/user_education_effect","metaserver/static/js/core/i18n","metaserver/static/js/clean/web_user_action_events","metaserver/static/js/commerce/lib/logging/commerce_web_entry_points","metaserver/static/js/commerce/lib/util","metaserver/static/js/file_transfers/lib/utils","metaserver/static/js/file_transfers/async/browse_entry_point_onboarding_modal_async","metaserver/static/js/file_transfers/containers/transfer_modal/transfer_modal_async","metaserver/static/js/commerce/components/sell_a_copy_modal_async","metaserver/static/js/core/browser","metaserver/static/js/core/uri","metaserver/static/js/onboarding_checklist/async_share_button_tooltip","metaserver/static/js/flows/conversions/convert_and_share_submenu","metaserver/static/js/clean/analytics","metaserver/static/js/core/browser_detection","dig-components/badges","metaserver/static/js/dropbox/proto/pap_events/organize/finish_browse_time_to_success","metaserver/static/js/browse_tts/browse_tts","metaserver/static/js/browse/constants","metaserver/static/js/clean/web_user_action_logger","dig-components/tooltips","metaserver/static/js/docsend_analytics_add_on/helpers/utils","metaserver/static/js/campaigns/campaigns_element_id_enum","metaserver/static/js/docsend_analytics_add_on/helpers/modals","metaserver/static/js/collections/components/share_with_collection/share_with_collection","metaserver/static/js/collections/components/share_with_collection/share_with_collection_tooltip"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f,h,g,v,E,S,y,A,O,I,x,b,M,T,w,C,N,P,j,D,F,U,L,B,R,k,W,V,H,q,G,z,X,K,Y,Z,$,Q,J,ee,te,se,ne,ie,oe,ae,re){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplitShareButton=t.__dontUse=t.SplitShareButtonComponent=void 0,n=s.__importDefault(n),o=s.__importStar(o),G=s.__importStar(G);var le=Q.pap_events.organize.Finish_BrowseTimeToSuccess.BrowseTtsEventName;(0,x.getStore)();const ce=o.default.forwardRef((e,t)=>{var{openOption:n,description:i,rightAccessory:a,experimentInfo:r,actionSurface:c,fileExt:d,campaignAnchorName:u,onImpression:p}=e,_=s.__rest(e,["openOption","description","rightAccessory","experimentInfo","actionSurface","fileExt","campaignAnchorName","onImpression"]);let m;return m=n.iconElement?n.iconElement:n.iconUrl?o.default.createElement("img",{alt:"",src:n.iconUrl,width:24,height:24}):null,o.default.useEffect(()=>{"docsend_analytics_add_on"===(null==r?void 0:r.experimentName)&&Y.ProEventsLogger.log(`docsend_analytics_add_on_${r.variant}`,{entryPoint:"split_share_menu",actionSurface:c,fileExt:d}),null==p||p()},[]),o.default.createElement(l.Menu.ActionItem,Object.assign({value:n,withLeftAccessory:m,withSubtitle:i,withRightAccessory:a,"data-testid":n?`split-share-menu-action-${n.userAction}`:"","data-campaigns-element-id":u,ref:t},_),n.text)});ce.displayName="MenuContentItem";class de extends o.default.Component{constructor(t){super(t),this.updateClientPortalMenuItem=()=>{new Promise((t,s)=>{e(["metaserver/static/js/business_space/browse/browse_exports"],t,s)}).then(s.__importStar).then(({ClientPortalMenuItem:e,isClientPortalMenuItemEnabled:t})=>{const s=t();this.setState({shouldShowClientPortalMenuItem:s,clientPortalMenuItem:o.default.createElement(e,{user:this.props.user,splitShareButtonFile:1===this.props.files.length&&"inline_action_bar"===this.props.actionSurface&&this.props.files[0].is_dir?this.props.files[0]:void 0})})})},this.preloadCampaignMenuItemAssets=()=>{new Promise((t,s)=>{e(["metaserver/static/js/campaigns/campaign_formats/menu/campaign_menu_item"],t,s)}).then(s.__importStar)},this.handleClickShare=e=>{e.preventDefault(),this.props.onShowShare(),this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?B.ActionSourceValue.OVERFLOW_MENU:B.ActionSourceValue.SPLIT_SHARE),this.currentSession&&this.currentSession.event("click_share",{trigger_type:this.props.triggerType}),e.stopPropagation()},this.handleSelectAction=e=>{e.handler()},this.logSelectActionOverflowMenu=(e,t)=>{var s,n;this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?B.ActionSourceValue.OVERFLOW_MENU:B.ActionSourceValue.SPLIT_SHARE,e),null===(n=(s=this.props).previewsLogUserAction)||void 0===n||n.call(s,e,this.props.renderMenuOnly?B.ActionSourceValue.OVERFLOW_MENU:B.ActionSourceValue.SPLIT_SHARE),(0,S.logEvent)(this.currentSession,"select_action",{type:t,trigger_type:this.props.triggerType})},this.handlePreventMouseDown=e=>{e.preventDefault(),this.state.tooltipState===h.TooltipState.BIG_ONBOARDING_TOOLTIP&&(this.markSplitShareTooltipViewed(),this.setState({tooltipState:h.TooltipState.NO_TOOLTIP})),e.stopPropagation()},this.handlePopoverHover=()=>{this.currentSession&&this.currentSession.event("popover_trigger_hover",{trigger_type:this.props.triggerType})},this.handleShareHover=()=>{this.currentSession&&this.currentSession.event("share_hover",{trigger_type:this.props.triggerType})},this.handlePopoverToggle=({isOpen:e})=>{const{onDropdownOpen:t,onDropdownClose:s,triggerType:n}=this.props;e&&t?t():!e&&s&&s(),this.currentSession&&this.currentSession.event(e?"open_popover":"close_popover",{trigger_type:n})},this.handlePresentInZoom=(e,t)=>{const{refreshSharingServiceInfo:s,sharingServiceInfo:n,onPresentInZoom:i,landingPageEnabled:o}=this.props;n&&s&&i&&(0,y.presentInZoomFlow)(e,n,s,i,"split_share_button",o,t)},this.handleShareInSlack=(e,t,s)=>{const{refreshSharingServiceInfo:n,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&n&&(te.WebUserActionLog.log(t.id,B.WebUserActionLogEvent.SLACK_SHARE,{}),(0,y.shareInSlackFlow)(t,i,n,e,"split_share_button",o,s))},this.handleShareToTrello=(e,t,s)=>{const{refreshSharingServiceInfo:n,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&n&&(0,y.shareInTrelloFlow)(t,i,n,e,"split_share_button",o,s)},this.handleUploadToCanvas=(e,t,s)=>{const{refreshSharingServiceInfo:n,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&n&&(0,y.shareInCanvasFlow)(t,i,n,e,"split_share_button",o,s)},this.handleUpdateLinkState=(e,t)=>{const{updateLinkState:s}=this.props;s({actionId:e,linkState:t})},this.handleAppAction=(e,t,s)=>{const{context:n,featureFlags:i}=this.props,o=e.map(e=>e);(0,g.redirectToActionOrShowAuth)(t,o,s,i,n,this.handleUpdateLinkState,this.handleShareAction),(0,S.logEvent)(this.currentSession,"select_action",(0,S.getAppActionExtras)(s))},this.handleShareAction=(e,t,s)=>{(0,J.logBrowseTTS)(le.SHARE_WITH_EXTERNAL_APP_BROWSE_TTS_EVENT_NAME);const n=s.handler.service_type[".tag"],i={".tag":"profile_linked"},o=()=>{this.handleUpdateLinkState(s.id,i),(0,g.authorizeNoRedirect)(e,s.id)};switch(n){case"slack_dropbox":return this.handleShareInSlack(t,e,o);case"zoom":return this.handlePresentInZoom(e,o);case"trello":return this.handleShareToTrello(t,e,o);case"canvas":return this.handleUploadToCanvas(t,e,o)}},this.getAppActionIconUrl=e=>{const{icon:t}=e;return t&&t.url&&!t.is_static?t.url:(0,F.static_url)("/static/metaserver/static/images/generic_app_icon-vflIPYT1H.png")},this.getAppActionOpenOptionActions=({handler:e})=>{if("profile_service"!==e[".tag"])return{type:D.OpenButtonAction.APP_ACTION,userAction:j.UserAction.ShareToAction};switch(e.service_type[".tag"]){case"slack_dropbox":return{type:D.OpenButtonAction.SHARE_TO_SLACK,userAction:j.UserAction.ShareToSlack};case"zoom":return{type:D.OpenButtonAction.PRESENT_IN_ZOOM,userAction:j.UserAction.PresentInZoom};case"trello":return{type:D.OpenButtonAction.SHARE_TO_TRELLO,userAction:j.UserAction.ShareToTrello};default:return{type:D.OpenButtonAction.APP_ACTION,userAction:j.UserAction.ShareToAction}}},this.handleHellosignDeepIntegrationLaunch=(t,n,i,o)=>new Promise((t,s)=>{e(["metaserver/static/js/integrations/hellosign_deep_integration/launcher"],t,s)}).then(s.__importStar).then(({getLauncher:e})=>{const s=e();return s.init({entryPoint:o||"share_menu",file:t,user:n,source:i}),s}).then(e=>(e.launch(),e)),this.getHellosignOpenOption=(e,t)=>{const s=L.intl.formatMessage({id:"KPapIP",defaultMessage:"Send for signature"});return{handler:(s,n)=>{this.handleHellosignDeepIntegrationLaunch(e,t,s,n),this.logSelectActionOverflowMenu(j.UserAction.SendForSignatureAction,D.OpenButtonAction.PREPARE_FOR_SIGNATURE)},iconElement:o.default.createElement(d.UIIcon,{src:a.SendLine}),spriteName:null,text:s,type:D.OpenButtonAction.PREPARE_FOR_SIGNATURE,userAction:j.UserAction.SendForSignatureAction}},this.handleShareWithAnalytics=(e,t,s,n)=>{Y.ProEventsLogger.log(`docsend_analytics_add_on_${s}_click`,{entryPoint:"split_share_menu",actionSource:this.props.actionSurface,fileExt:n}),(0,oe.showDocsendModal)({fileId:e.file_id,fileName:(0,_.filename)(e.fq_path),filePath:(0,_.parent_dir)(e.fq_path),user:t,stormcrowVariant:s,entryPoint:`split_share_menu${this.props.actionSurface?`_${this.props.actionSurface}`:""}`})},this.getAppActionOpenOption=(e,t,s,n={})=>{const{type:i,userAction:o}=this.getAppActionOpenOptionActions(s);return Object.assign({handler:()=>{this.handleAppAction(e,t,s),this.logSelectActionOverflowMenu(o,i)},spriteName:null,text:s.description,type:i,userAction:o,iconUrl:this.getAppActionIconUrl(s)},n)},this.getMoreAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),(0,S.logEvent)(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(j.UserAction.OpenMoreApps,D.OpenButtonAction.OPEN_MORE_APPS)},text:L.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:D.OpenButtonAction.OPEN_MORE_APPS,userAction:j.UserAction.OpenMoreApps,spriteName:null,iconElement:o.default.createElement(d.UIIcon,{src:a.AddCircleLine})}),this.getAddAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),(0,S.logEvent)(this.currentSession,"select_add_apps",{}),this.logSelectActionOverflowMenu(j.UserAction.OpenAddApps,D.OpenButtonAction.OPEN_ADD_APPS)},text:L.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}),type:D.OpenButtonAction.OPEN_ADD_APPS,userAction:j.UserAction.OpenAddApps,spriteName:null,iconElement:o.default.createElement(d.UIIcon,{src:a.AddCircleLine})}),this.getAppCenterLinkOpenOption=()=>({handler:()=>{(0,S.logEvent)(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(j.UserAction.OpenMoreApps,D.OpenButtonAction.OPEN_MORE_APPS),G.open_tab(new z.URI({path:"/apps"}))},text:L.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:D.OpenButtonAction.OPEN_MORE_APPS,userAction:j.UserAction.OpenMoreApps,spriteName:null,iconElement:o.default.createElement(d.UIIcon,{src:a.AddCircleLine})}),this.handleMoreApps=(e,t)=>{const{appActions:s,featureFlags:n,context:i,categoryInfo:o}=this.props,a=(0,T.getCategoryIdToInfos)(o);(0,M.showExtensionsMiniDirectoryModal)(L.intl.formatMessage({id:"A7cFjC",defaultMessage:"Share with these apps"}),t,e,s.filter(e=>e.app_id!==P.TRANSFER_FP_APP_ID).sort(O.actionCompareFn),a,n,this.handleUpdateLinkState,i,this.currentSession,this.handleShareAction)},this.computeReferrer=e=>{const t=this.props.renderMenuOnly?B.ActionSourceValue.OVERFLOW_MENU:B.ActionSourceValue.SPLIT_SHARE;return(0,N.computeSplitShareMenuReferrer)(e,t,this.props.retrievalSource,this.props.actionSurface)},this.handleAddToTransfer=(e,t,s)=>{const{fileTransfersModalExp:n}=this.props.featureFlags;"ON"===n?(0,H.asyncTransferModal)(s,e,t):(0,V.asyncShowBrowseEntryPointOnboardingModal)({primaryActionOnClick:()=>(0,W.redirectToCreateTransferWithFiles)(e,t),userId:s.id})},this.handleSellWithShop=(e,t,s,n)=>{(0,R.logSellWithShopMenuItemClick)(e,t),s?(0,q.asyncSellACopyModal)(n,e):(0,k.redirectToSellWithShop)(e,t)},this.shouldShowReplayOpenOption=e=>{const t=(0,_.file_extension)((0,_.filename)(e.fq_path)),s=ee.ExtensionCategories[t];return"VIDEO"===s||"AUDIO"===s||"IMAGE"===s},this.getReplayOpenOption=e=>({handler:()=>{const t=`https://replay.dropbox.com/project/creating/${e}?creationSource=dropbox_share_action`;window.open(t),this.logSelectActionOverflowMenu(j.UserAction.OpenInReplay,D.OpenButtonAction.OPEN_IN_REPLAY)},spriteName:null,text:L.intl.formatMessage({id:"lOEIzZ",defaultMessage:"Get feedback"}),type:D.OpenButtonAction.OPEN_IN_REPLAY,userAction:j.UserAction.OpenInReplay,iconElement:o.default.createElement(d.UIIcon,{src:a.DropboxReplayLine})}),this.getShareWithEmailOpenOption=()=>{const{onShowShare:e}=this.props;return{handler:()=>{e(),this.logSelectActionOverflowMenu(j.UserAction.InviteViaEmail,D.OpenButtonAction.INVITE_VIA_EMAIL)},spriteName:null,text:L.intl.formatMessage({id:"8U/qbn",defaultMessage:"Share with Dropbox"}),type:D.OpenButtonAction.INVITE_VIA_EMAIL,userAction:j.UserAction.InviteViaEmail,iconElement:o.default.createElement(d.UIIcon,{className:"test-id-share-dig-icon",src:a.ShareArrowLine})}},this.getConvertAndShareSubmenu=()=>{const{files:e,user:t}=this.props;if(1!==e.length)return null;const s=e[0];return o.default.createElement(K.ConvertAndShareSubmenu,{file:s,user:t})},this.getShareWithCollectionOptions=e=>({handler:()=>{e(),this.logSelectActionOverflowMenu(j.UserAction.ShareWithCollection,D.OpenButtonAction.SHARE_WITH_COLLECTION)},spriteName:null,text:L.intl.formatMessage({id:"wBdEdI",defaultMessage:"Send as a collection"}),type:D.OpenButtonAction.SHARE_WITH_COLLECTION,userAction:j.UserAction.ShareWithCollection,iconElement:o.default.createElement(d.UIIcon,{src:a.CollectionLine})}),this.getTransferOpenOptions=e=>({handler:()=>{e(),this.logSelectActionOverflowMenu(j.UserAction.Transfer,D.OpenButtonAction.TRANSFER)},spriteName:null,text:L.intl.formatMessage({id:"3MahuB",defaultMessage:"Send a copy"}),type:D.OpenButtonAction.TRANSFER,userAction:j.UserAction.Transfer,iconElement:o.default.createElement(d.UIIcon,{src:a.DropboxTransferLine})}),this.getShopOpenOptions=(e,t,s,n)=>({handler:()=>{this.handleSellWithShop(e,t,s,n),this.logSelectActionOverflowMenu(j.UserAction.SellWithShop,D.OpenButtonAction.SELL_WITH_SHOP)},spriteName:null,text:L.intl.formatMessage({id:"7UOMXW",defaultMessage:"Sell a copy"}),type:D.OpenButtonAction.SELL_WITH_SHOP,userAction:j.UserAction.SellWithShop,iconElement:o.default.createElement(d.UIIcon,{src:a.TagLine})}),this.getPopoverTriggerRenderer=(e,t,s)=>i=>{const{isVisible:r,variant:l}=this.props,p=Object.assign({className:(0,n.default)("extensions-split-share-menu__trigger",{"extensions-split-share-menu__trigger--collapsed":e}),tabIndex:r?void 0:-1,onMouseEnter:this.handlePopoverHover,"aria-label":L.intl.formatMessage({id:"5MpLpV",defaultMessage:"Expand share menu"})},i);return e?o.default.createElement(u.Tooltip,{positionOffset:8,positioning:"left",tooltipContent:L.intl.formatMessage({id:"TFeNOo",defaultMessage:"Share"})},o.default.createElement(c.IconButton,Object.assign({variant:"primary"===l?"filled":l},p),o.default.createElement(d.UIIcon,{src:a.ShareArrowLine,"aria-label":s}))):t?o.default.createElement(c.Button,Object.assign({},p,{withIconLeft:o.default.createElement(d.UIIcon,{src:a.ShareArrowLine,className:"extensions-split-share--icon"}),variant:l,withDropdownIcon:!0}),L.intl.formatMessage({id:"DHK0zq",defaultMessage:"Share all selected"})):o.default.createElement(c.Button,Object.assign({},p,{variant:l,withDropdownIcon:!0,_hasSquaredSize:!0}))},this.renderPopoverItems=()=>{const{user:e,files:t,appActions:s,nonHellosignAppActions:n,featureFlags:{docsendAnalyticsAddOn:r,hellosignDeepIntegration:c,dndSplitShare:u,fileTransfersAppAction:m,flowsConvertAndShareUi:f,replayDropboxShareActionExp:h,commerceSellerFeaturesEnabled:g,commerceSellACopyExperiment:v,shareWithCollection:E},isSendForSignatureEnabled:S}=this.props,y=1===t.length,A=t[0],I=t.map(e=>e),x=this.computeReferrer(I),b="DEEP_INTEGRATION"===c&&!(0,Z.is_supported_mobile_browser)(),M=y&&(0,p.isHellosignFileByExtension)((0,w.getFileExt)(Object.assign(Object.assign({},A),{bytes:0})));let T=null,C=s;if(b&&M&&S){C=n;const t=this.getHellosignOpenOption(A,e);T=o.default.createElement(ce,{openOption:t})}const N=(0,_.file_extension)((0,_.filename)(A.fq_path)),F=(0,ne.getDocsendAnalyticsAddOnConfig)(e,r),U=y&&F.isSupportedFile(A.bytes,N);let B=null;if("ON"===u&&!F.splitShare.removeDocsendAppAction){const s=C.find(e=>e.app_id===j.DOCSEND_PROD_APP_ID);if(s){C=C.filter(e=>e.app_id!==j.DOCSEND_PROD_APP_ID);const n=this.getAppActionOpenOption(t,e,s,{text:F.splitShare.moveDocsendEntryPoint?L.intl.formatMessage({id:"oziSoO",defaultMessage:"Send with DocSend"}):L.intl.formatMessage({id:"r4C3UE",defaultMessage:"Send and track"})});let i=void 0;F.splitShare.logExposure&&U&&(i={experimentName:"docsend_analytics_add_on",variant:F.variantForLogging}),B=o.default.createElement(ce,{"data-testid":s.app_id,key:n.text,openOption:n,experimentInfo:i,actionSurface:this.props.actionSurface,fileExt:N})}}F.splitShare.removeDocsendAppAction&&(C=C.filter(e=>e.app_id!==j.DOCSEND_PROD_APP_ID));let V=null;if(F.splitShare.showMenuItem&&U){const t={handler:()=>{this.handleShareWithAnalytics(A,e,F.variantForLogging,N)},spriteName:null,text:L.intl.formatMessage({id:"yP4n16",defaultMessage:"Send and track"}),type:D.OpenButtonAction.SHARE_WITH_ANALYTICS,userAction:j.UserAction.ShareWithAnalytics,iconElement:o.default.createElement(d.UIIcon,{src:a.AnalyticsLine})};V=o.default.createElement(se.Tooltip,{title:L.intl.formatMessage({id:"iZTVjV",defaultMessage:"Get viewer insights for the files you share using Dropbox"}),placement:"left"},o.default.createElement(ce,{"data-testid":"analytics-add-on-menu-item",key:t.text,openOption:t,experimentInfo:{experimentName:"docsend_analytics_add_on",variant:F.variantForLogging},actionSurface:this.props.actionSurface,rightAccessory:o.default.createElement($.AccessoryBadge,null,L.intl.formatMessage({id:"QT7EnD",defaultMessage:"Beta"})),fileExt:N}))}const H=C.find(e=>e.app_id===P.TRANSFER_FP_APP_ID),q=(0,W.shouldShowTransferInSplitShare)(!!H||"ON"===m,I),G="V1"===E&&(0,ae.shouldShowShareWithCollection)(I),z=o.default.createRef(),X=()=>{(0,ae.handleShareWithCollection)(I)},K=()=>this.handleAddToTransfer(I,x,e),Y=(0,k.shouldShowShopInSplitShare)("ON"===g,I),Q="ON"===v,{installedActions:J,unpromotedActions:ee}=(0,O.partitionActions)(C),te=Boolean(y),oe=Boolean(this.state.shouldShowClientPortalMenuItem),le=te||Boolean(q)||Boolean(B)||Boolean(T)||Boolean(Y)||Boolean(oe)||Boolean(G),de=F.splitShare.moveDocsendEntryPoint,ue=(!(0,i.isEmpty)(ee)||!(0,i.isEmpty)(J)||!le||de&&B)&&o.default.createElement(l.Menu.Segment,null,de?B:null,J.map(s=>{const n=this.getAppActionOpenOption(t,e,s);return o.default.createElement(ce,{"data-testId":s.app_id,key:n.text,openOption:n})}),!(0,i.isEmpty)(ee)&&y?o.default.createElement(ce,{openOption:(0,i.isEmpty)(J)?this.getAddAppsOpenOption(A,e):this.getMoreAppsOpenOption(A,e)}):!le&&(0,i.isEmpty)(J)&&o.default.createElement(ce,{openOption:this.getAppCenterLinkOpenOption()})),pe="ON"===f?this.getConvertAndShareSubmenu():null;return o.default.createElement(o.Fragment,null,le&&o.default.createElement(l.Menu.Segment,null,te&&o.default.createElement(ce,{campaignAnchorName:ie.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SHARE_WITH_DROPBOX_BUTTON,openOption:this.getShareWithEmailOpenOption()}),V,"ON"===h&&y&&this.shouldShowReplayOpenOption(A)&&o.default.createElement(ce,{openOption:this.getReplayOpenOption(A.file_id),rightAccessory:o.default.createElement($.AccessoryBadge,null,L.intl.formatMessage({id:"LlL5Qr",defaultMessage:"New"}))}),q&&K&&o.default.createElement(ce,{campaignAnchorName:ie.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SEND_A_COPY_BUTTON,openOption:this.getTransferOpenOptions(K)}),T,de?null:B,Y&&o.default.createElement(ce,{openOption:this.getShopOpenOptions(I,x,Q,e),rightAccessory:o.default.createElement($.AccessoryBadge,null,L.intl.formatMessage({id:"WDJQFS",defaultMessage:"New"})),onImpression:()=>(0,R.logSellWithShopMenuItemShown)(I,x)}),oe&&this.state.clientPortalMenuItem,pe,G&&o.default.createElement(o.default.Fragment,null,o.default.createElement(ce,{ref:z,openOption:(()=>this.getShareWithCollectionOptions(X))()}),o.default.createElement(re.ShareWithCollectionTooltip,{triggerRef:z,handler:X}))),ue)},this.markSplitShareTooltipViewed=()=>{(0,f.markTooltipViewed)(this.props.user.id,"split_share_edu")},this.state={tooltipState:h.TooltipState.NO_TOOLTIP,shouldShowClientPortalMenuItem:!1},this.telemetryClient=(0,v.createTelemetryClient)(Object.assign({component:"split-share-btn"},t.context)),this.onboardingChecklistShareButtonTooltipTriggerRef=o.default.createRef()}componentDidMount(){this.props.showEduTooltip&&this.setEduTooltip(),this.updateClientPortalMenuItem(),this.preloadCampaignMenuItemAssets()}componentDidUpdate(e){(0,i.isEqual)(this.props.files,e.files)||this.updateClientPortalMenuItem()}setEduTooltip(){return s.__awaiter(this,void 0,void 0,(function*(){const e=yield(0,f.getTooltipHistory)(this.props.user.id,["open_with_edu","split_share_edu"]),t=this.props.files[0];"split_share_edu"===(0,C.allowedTooltips)(this.props.appActions.length>0,t.fq_path?"."+(0,_.file_extension)((0,_.filename)(t.fq_path)):"",this.props.featureFlags).find(t=>void 0!==e[t]&&!e[t])&&this.setState({tooltipState:h.TooltipState.BIG_ONBOARDING_TOOLTIP})}))}render(){const{files:e,context:t,isVisible:s,shareButtonLabel:r,triggerType:u,isCollapsed:m,shouldUsePortalPopover:f,appActions:h,featureFlags:g,showLeftDigIcon:E,variant:S,renderMenuOnly:y,expActionBarRedesignEnabled:A}=this.props,O=1===e.length,I=e[0];t?this.currentSession=this.telemetryClient.session({ext:(0,v.getPiiSafeExtension)(I?"."+(0,_.file_extension)((0,_.filename)(I.fq_path)):"")}):delete this.currentSession;const x={"aria-label":r,className:(0,n.default)("extensions-split-share__share-button",{"primary-action-menu__button":u===b.TriggerType.SidebarPrimaryButton}),onClick:this.handleClickShare,tabIndex:s?void 0:-1,onMouseEnter:this.handleShareHover},M=o.default.createElement(c.Button,Object.assign({},x,{withIconLeft:E&&o.default.createElement(d.UIIcon,{src:a.ShareArrowLine,className:"extensions-split-share--icon"}),variant:S}),o.default.createElement(U.UserEducationEffect,{containerName:"SplitShareButton",name:"ShareButtonLabel",useSpan:!0},r)),T=this.getPopoverTriggerRenderer(m,!O,r),C=this.props.sharingServiceInfo&&(0,N.isSlackAvailable)(this.props.sharingServiceInfo)&&(0,N.isZoomAvailable)(this.props.sharingServiceInfo),P=O&&"DEEP_INTEGRATION"===g.hellosignDeepIntegration&&(0,p.isHellosignFileByExtension)((0,w.getFileExt)(Object.assign(Object.assign({},I),{bytes:0})))&&!(0,Z.is_supported_mobile_browser)();return y?this.renderPopoverItems():o.default.createElement("div",{className:(0,n.default)("extensions-split-share-btn",{"extensions-split-share-btn--invisible":!s,"slack-zoom-available":C&&!m,"slack-zoom-available-collapsed":C&&m,"hellosign-available":P,"share-fake-split-button":!(0,i.isEmpty)(h)}),ref:this.onboardingChecklistShareButtonTooltipTriggerRef},!m&&O&&M,o.default.createElement(X.AsyncOnboardingChecklistShareButtonTooltip,{triggerRef:this.onboardingChecklistShareButtonTooltipTriggerRef}),o.default.createElement(l.Menu.Wrapper,{className:(0,n.default)("extensions-split-share__popover",{"hellosign-available-dropdown":P,"extensions-split-share__unportaled-menu":!f,"down-arrow-share-button-prompt-select":!0}),onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,onSelection:this.handleSelectAction,onToggle:this.handlePopoverToggle,closeOnSelection:!0,isPortaled:f,"data-campaigns-element-id":ie.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SHARE_DROPDOWN_BUTTON},({getContentProps:e,getTriggerProps:t})=>o.default.createElement(o.default.Fragment,null,T(t()),o.default.createElement(l.Menu.Content,Object.assign({placement:"bottom-end",className:A?"rc-action-bar-submenu-content":""},e()),this.renderPopoverItems()))))}}t.SplitShareButtonComponent=de,de.defaultProps={isVisible:!0,shareButtonLabel:L.intl.formatMessage({id:"TFeNOo",defaultMessage:"Share"}),triggerType:b.TriggerType.PrimaryButton,variant:"opacity"},de.displayName="SplitShareButtonComponent";const ue={refreshSharingServiceInfo:A.refreshSharingServiceInfoAdapter,updateLinkState:A.updateLinkState},pe=(0,r.connect)((e,t)=>{const s=t.files.map(e=>Object.assign(Object.assign({},e),{bytes:0}));return{appActions:(0,I.getShareActionsForFiles)(e,s),nonHellosignAppActions:(0,I.getNonHellosignActionsForFiles)(e,s,j.HELLOSIGN_PROD_APP_ID),categoryInfo:(0,I.getCategoryInfos)(e),featureFlags:(0,I.getFeatureFlags)(e),sharingServiceInfo:(0,I.getSharingServiceInfoAdapter)(e),landingPageEnabled:(0,m.isConnectServiceLandingPagesEnabled)(e),isSendForSignatureEnabled:(0,m.isSendForSignatureEnabled)(e)}},ue)(de);t.__dontUse=pe,t.SplitShareButton=(0,E.requireCssWithComponent)(pe,["/static/metaserver/static/css/extensions/index-vflrFmD9k.css","/static/metaserver/static/css/app_actions/index-vfljPaJWn.css"])})),define("metaserver/static/js/extensions/status_page",["require","exports","tslib","react","metaserver/static/js/components/ui/css","spectrum/button/index","metaserver/static/js/clean/ui/image","metaserver/static/js/clean/static_urls","metaserver/static/js/core/i18n","metaserver/static/js/modules/constants/payments","metaserver/static/js/account/email","metaserver/static/js/account/email_verify_reasons","typescript/dropbox/proto/js_init_data/extensions/extensions_pb","js/proto_utils/unpack"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.DocuSignInvalidFilePage=t.FileTooLargePage=t.UnverifiedEmailPage=t.NoWritePermissionPage=t.DocuSignPermissionDeniedPage=t.AppActionsOverQuotaPage=t.AppActionsErrorPage=t.AppActionsLoadingPage=void 0,n=s.__importDefault(n),c=s.__importStar(c),p=s.__importStar(p);const m=e=>{const t=(0,r.static_url)(`/static/metaserver/static/images/illustration_catalog/${e.illustrationName}.png`),s=(0,r.static_url)(`/static/metaserver/static/images/illustration_catalog/${e.illustrationName}@2x.png`);return n.default.createElement("div",{className:"app-actions-status-page"},n.default.createElement(a.Image,{className:"app-actions-status-image",src:t,srcHiRes:s}),n.default.createElement("div",{className:"app-actions-status-content"},e.children))},f=e=>n.default.createElement(m,{illustrationName:e.illustrationName},n.default.createElement("div",{className:"app-actions-status-text"},n.default.createElement("div",{className:"app-actions-status-text__header"},e.headerText)),n.default.createElement("div",{className:"app-actions-status-detail"},e.detailText),n.default.createElement(o.Button,{className:"app-actions-status-button",onClick:e.buttonOnClick,href:e.buttonHref,variant:"primary"},e.buttonTitle));function h(){window.close()}t.AppActionsLoadingPage=(0,i.requireCssWithComponent)(e=>n.default.createElement("div",{className:"app-actions-status-page"},n.default.createElement(a.Image,{className:"app-actions-status-image",src:(0,r.static_url)("/static/metaserver/static/images/dbx_cloud_doc_loading-vfl9ZK2NS.gif")}),n.default.createElement("div",{className:"app-actions-status-detail"},e.fileName)),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/components/loading_indicator-vflIkyDZA.css"]),t.AppActionsErrorPage=(0,i.requireCssWithComponent)(e=>n.default.createElement(f,{illustrationName:"sickbox-illo_m1",headerText:l.intl.formatMessage({id:"G79Iwz",defaultMessage:"Oops... something went wrong"}),detailText:l.intl.formatMessage({id:"ZvMuf8",defaultMessage:"Oh no, it looks like we failed to load your file. Please return to Dropbox and try once more."}),buttonOnClick:h,buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"})}),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]),t.AppActionsOverQuotaPage=(0,i.requireCssWithComponent)(e=>{let t=c.OUT_OF_SPACE_URL+"?oqa=wb_oq_aa",s=l.intl.formatMessage({id:"iIucBq",defaultMessage:"Get more space"});return e.isTeam&&(t="/help/business/space-limit-full",s=l.intl.formatMessage({id:"K2PjtT",defaultMessage:"Learn more about Dropbox space"})),n.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"0eDgXK",defaultMessage:"Your Dropbox is full"}),detailText:l.intl.formatMessage({id:"nyrsTE",defaultMessage:"Uh oh, in order to perform this action, you need to add more storage to your Dropbox."}),buttonTitle:s,buttonHref:t})},["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]),t.DocuSignPermissionDeniedPage=(0,i.requireCssWithComponent)(e=>n.default.createElement(f,{illustrationName:"account_requires_access",headerText:l.intl.formatMessage({id:"lZ3sPD",defaultMessage:"Your DocuSign account has restricted access"}),detailText:l.intl.formatMessage({id:"lF/7ht",defaultMessage:"It looks like your DocuSign account does not have permission to send envelopes. Please contact your DocuSign admin."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]),t.NoWritePermissionPage=(0,i.requireCssWithComponent)(e=>n.default.createElement(f,{illustrationName:"403_error-illo",headerText:l.intl.formatMessage({id:"G79Iwz",defaultMessage:"Oops... something went wrong"}),detailText:l.intl.formatMessage({id:"NiMCaD",defaultMessage:"You do not have access to update files in this folder."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]),t.UnverifiedEmailPage=(0,i.requireCssWithComponent)(e=>n.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"Bf160P",defaultMessage:"Verify Your Email"}),detailText:l.intl.formatMessage({id:"Vg1D7j",defaultMessage:"In order to perform this action, Dropbox needs to verify your email address to share links."}),buttonTitle:l.intl.formatMessage({id:"DUVaTi",defaultMessage:"Verify Email"}),buttonOnClick:()=>{return t=e.role,void d.EmailVerification.getForRole(t).show_verify_modal(void 0,u.EmailVerificationReasons.GENERIC);var t}}),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/account/emails-vflCpG_Hm.css","/static/metaserver/static/css/maestro_layout-vfleK4Iu-.css","/static/metaserver/static/css/upsell/prompt_pagelet-vflfA3YoB.css","/static/metaserver/static/css/notify-vfl4oJv2S.css"]),t.FileTooLargePage=(0,i.requireCssWithComponent)(({maxFileSize:e})=>{const t=Number(e),s=(i=t,isFinite(i)&&i>0?l.intl.formatMessage({id:"fQlkHi",defaultMessage:"The file you selected is larger than the supported {supported_value}MB. Please try again with a smaller file."},{supported_value:t.toString(10)}):l.intl.formatMessage({id:"WMJEtg",defaultMessage:"The file you selected is larger than supported. Please try again with a smaller file."}));var i;return n.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"4pvYSI",defaultMessage:"Can’t open file"}),detailText:s,buttonTitle:l.intl.formatMessage({id:"QeGZf9",defaultMessage:"Return to Dropbox"}),buttonOnClick:h})},["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]),t.DocuSignInvalidFilePage=(0,i.requireCssWithComponent)(e=>n.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"4pvYSI",defaultMessage:"Can’t open file"}),detailText:l.intl.formatMessage({id:"+3VSGf",defaultMessage:"The file you selected cannot be validated in DocuSign. Please try again with a valid file."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css"]);t.RootComponent=e=>{const s=(0,_.unmarshalProto)(e.encodedProto,p.StatusPageProps);switch(s.pageType){case p.StatusPageProps_PageType.DEFAULT:return n.default.createElement(t.AppActionsErrorPage,null);case p.StatusPageProps_PageType.QUOTA:return n.default.createElement(t.AppActionsOverQuotaPage,{isTeam:s.isTeam});case p.StatusPageProps_PageType.DOCUSIGN:return n.default.createElement(t.DocuSignPermissionDeniedPage,null);case p.StatusPageProps_PageType.ACCESS:return n.default.createElement(t.NoWritePermissionPage,null);case p.StatusPageProps_PageType.UNVERIFIED_EMAIL:return n.default.createElement(t.UnverifiedEmailPage,{role:s.role});case p.StatusPageProps_PageType.FILE_TOO_LARGE:return n.default.createElement(t.FileTooLargePage,{maxFileSize:Number(s.maxFileSize)});case p.StatusPageProps_PageType.DOCUSIGN_INVALID_FILE:return n.default.createElement(t.DocuSignInvalidFilePage,null)}}})),define("metaserver/static/js/file_viewer/unity/unity_utils",["require","exports","tslib","metaserver/static/js/unity/check_file_cache","metaserver/static/js/unity/features"],(function(e,t,s,n,i){"use strict";function o(e,t){i.UnityFeatures.file_browser_display_name((function(s){e.file_browser_display_name=s,t(e)}),()=>t(e))}function a(e){return null!=e&&(!!e.is_locally_available||!!e.is_infinite_placeholder)&&t.UnityHelpers.clientSupportsOpenInFileBrowser()}function r(e){return null!=e&&!!e.is_locally_available&&!1!==e.can_open_directly}Object.defineProperty(t,"__esModule",{value:!0}),t.UnityHelpers=t.isUnityFileSupported=t.isUnityFolderSupported=void 0,n=s.__importDefault(n),t.isUnityFolderSupported=a,t.isUnityFileSupported=r,t.UnityHelpers={isUnityEnabled:function(){return i.UnityFeatures.isUnitySupported()},isFileInUnityCache:function(e,t){return!!n.default.is_cached_and_locally_available(e,t)},clientSupportsOpenInFileBrowser:function(){return i.UnityFeatures.client_supports_open_in_file_browser()},getFileInfoFromUnityCache:function(e,t){return n.default.get(e,t)},fetchUnityFileInfo:function(e,t,s,n,a){i.UnityFeatures.check_file(e,t,s,e=>{e.is_locally_available?o(e,n):n(e)},a)},getUnityFileInfo:function(e,s,n,i,a){if(t.UnityHelpers.isFileInUnityCache(e,s)){const n=t.UnityHelpers.getFileInfoFromUnityCache(e,s);n.is_locally_available&&null==n.file_browser_display_name?o(n,i):i(n)}else t.UnityHelpers.fetchUnityFileInfo(e,s,n,i,a)},openFile:function(e,t,s,n){i.UnityFeatures.open_file(e,t,s,i.UnityFeatures.standard_open_file_handler,()=>i.UnityFeatures.standard_open_file_handler(!1),n)},isUnityFolderSupported:a,isUnityFileSupported:r}})),define("metaserver/static/js/extensions/shared_file_popover_content_component",["require","exports","tslib","react","metaserver/static/js/extensions/common","metaserver/static/js/extensions/cloud_docs_compat","metaserver/static/js/components/ui/css","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/extensions/unity_and_cloud_editors","metaserver/static/js/file_viewer/constants","metaserver/static/js/cloud_docs/types"],(function(e,t,s,n,i,o,a,r,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedFilePopoverContent=t.SharedFilePopoverContentComponent=void 0,n=s.__importDefault(n);class p extends n.default.Component{constructor(e){super(e),this.createActionClickHandler=e=>()=>{if("cloud_editor"===e.handler[".tag"]){const t=(0,o.isWopiAction)(e)?r.OpenButtonAction.OPEN_WITH:r.OpenButtonAction.OPEN_WITH_CLOUD_DOC;(0,i.logEvent)(this.props.currentSession,"select_legacy_action",{type:t});const s=u.UserActionSourceType.WEB_PREVIEW,n=(0,o.cloudEditorNameToParams)(e.handler.editor_name);(0,l.openWithCloudEditor)((0,l.fileToOpenWithParams)(this.props.file),this.props.user.id,n,!1,s)}}}render(){if(0===this.props.openOptions.length&&0===this.props.cloudEditorAppActions.length)return null;const e=this.props.cloudEditorAppActions.map(e=>({appAction:e,handler:this.createActionClickHandler(e),userAction:d.UserAction.OpenWithAppAction,actionName:e.description}));return n.default.createElement(c.UnityAndCloudEditors,{unityOptions:[],legacyCloudEditorOptions:this.props.openOptions,cloudEditorAppActions:e,bylines:{},wrapValuesForActionBar:!!this.props.isInActionBar})}}t.SharedFilePopoverContentComponent=p,p.displayName="SharedFilePopoverContentComponent",t.SharedFilePopoverContent=(0,a.requireCssWithComponent)(p,["/static/metaserver/static/css/app_actions/index-vfljPaJWn.css"])})),define("metaserver/static/js/extensions/extensions_popover_content_component_v2",["require","exports","tslib","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/file_store/utils","metaserver/static/js/app_actions/redirect","metaserver/static/js/components/ui/css","metaserver/static/js/extensions/cloud_docs_compat","metaserver/static/js/extensions/common","metaserver/static/js/extensions/data/helpers","metaserver/static/js/extensions/extensions_mini_directory_modal","metaserver/static/js/extensions/menu_survey","metaserver/static/js/extensions/unity_and_cloud_editors","metaserver/static/js/extensions/utils","metaserver/static/js/file_viewer/constants","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/file_viewer/unity/with_unity","metaserver/static/js/clean/static_urls","metaserver/static/js/core/i18n","react","metaserver/static/js/file_viewer/file_conversion/file_conversion_options"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f,h,g,v,E,S,y,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsPopoverV2NoUnity=t.ExtensionsPopoverV2WithUnity=void 0,y=s.__importDefault(y);class O extends y.default.Component{constructor(e){super(e),this.createAppActionClickHandler=e=>()=>{var t,s;const{file:n,user:i,featureFlags:o,telemetryContext:a,updateLinkState:l}=this.props;if((0,r.redirectToActionOrShowAuth)(i,[n],e,o,a,l),"redirect"===e.handler[".tag"]){const t=(0,d.getAppActionExtras)(e);(0,d.logEvent)(this.props.currentSession,"select_action",Object.assign({menu_version:2},t))}else if("cloud_editor"===e.handler[".tag"]){const t=(0,c.isWopiAction)(e)?g.OpenButtonAction.OPEN_WITH:g.OpenButtonAction.OPEN_WITH_CLOUD_DOC;(0,d.logEvent)(this.props.currentSession,"select_legacy_action",{type:t})}null===(s=(t=this.props).onExtensionClick)||void 0===s||s.call(t)},this.wrapperForAction=e=>({appAction:e,handler:this.createAppActionClickHandler(e),userAction:h.UserAction.OpenWithAppAction,actionName:e.description}),this.renderActionRow=e=>{const t=e.icon;let s;s=t.is_static?(0,E.static_url)("/static/metaserver/static/images/generic_app_icon-vflIPYT1H.png"):t.url;const n=e.description,i=this.props.isInActionBar?(0,f.toActionBarValue)(this.wrapperForAction(e)):this.wrapperForAction(e);return y.default.createElement(o.Menu.ActionItem,{key:e.id,value:i,withLeftAccessory:y.default.createElement("img",{alt:"",src:s,width:24,height:24})},n)},this.renderUnpromotedActions=(e,t)=>{const{user:s,file:a,categoryIdToInfos:r,featureFlags:l,currentSession:c,telemetryContext:u,updateLinkState:_,isInActionBar:m}=this.props,h=e.length>0,g={handler:()=>{const n=[...e,...t];(0,p.showExtensionsMiniDirectoryModal)(S.intl.formatMessage({id:"KVD2SP",defaultMessage:"Open or edit with these apps"}),s,a,n,r,l,_,u,c),(0,d.logEvent)(c,h?"select_show_more":"select_add_app",{surface:u&&u.surface})}},v=m?(0,f.toActionBarValue)(g):g;return y.default.createElement(o.Menu.ActionItem,{key:S.intl.formatMessage({id:"R/67N/",defaultMessage:"Show more"}),value:v,withLeftAccessory:h&&!m?null:y.default.createElement(n.UIIcon,{src:i.AddCircleLine})},h?S.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}):S.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}))}}render(){const{user:e,appActions:t,openOptions:s,bylines:n,currentSession:i,isInActionBar:a}=this.props,r=(0,d.getOpenOptionsWithLogging)(s,i),{unityOptions:l,cloudEditorOptions:c,previewOption:p,openInReplayOption:f,openInDesktopOption:h,goToFolderOption:g,openInNewTabOption:v}=(0,u.partitionOptions)(r),{cloudEditors:E,installedActions:S,unpromotedActions:O}=(0,u.partitionActions)(t),I=S.length>0,x=O.length>0;return y.default.createElement(y.default.Fragment,null,y.default.createElement(A.FileConversionOptions,{openOptions:r,currentSession:i,wrapValuesForActionBar:!!a}),y.default.createElement(m.UnityAndCloudEditors,{isInActionBar:a,unityOptions:l,legacyCloudEditorOptions:c,cloudEditorAppActions:E.map(e=>this.wrapperForAction(e)),bylines:n,currentSession:i,previewOption:p,openInReplayOption:f,openInNewTabOption:v,openInDesktopOption:h,goToFolderOption:g,wrapValuesForActionBar:!!a}),a&&(I||x)&&y.default.createElement(o.Menu.Segment,null,S.map(e=>this.renderActionRow(e)),this.renderUnpromotedActions(S,O)),!a&&I&&y.default.createElement(o.Menu.Segment,{key:"installed-actions"},S.map(e=>this.renderActionRow(e))),!a&&x&&y.default.createElement(o.Menu.Segment,null,this.renderUnpromotedActions(S,O)),y.default.createElement(_.OpenMenuSurvey,{userId:e.id,session:i}))}}O.displayName="ExtensionsPopoverV2Component";t.ExtensionsPopoverV2WithUnity=e=>(0,a.isBrowseFile)(e.file)?y.default.createElement(v.WithUnity,{file:e.file,user:e.user,render:t=>y.default.createElement(O,Object.assign({},e,{unityInfo:t}))}):null,t.ExtensionsPopoverV2NoUnity=(0,l.requireCssWithComponent)(O,["/static/metaserver/static/css/app_actions/index-vfljPaJWn.css","/static/metaserver/static/css/extensions/index-vflrFmD9k.css"])})),define("metaserver/static/js/extensions/unity_and_cloud_editors",["require","exports","tslib","react","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/extensions/byline","metaserver/static/js/components/ui/css","metaserver/static/js/extensions/utils","metaserver/static/js/extensions/cloud_docs_compat","metaserver/static/js/extensions/common","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/clean/ui/sprite","metaserver/static/js/core/browser_detection"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityAndCloudEditors=void 0,n=s.__importDefault(n);class f extends n.default.Component{render(){const{unityOptions:e,legacyCloudEditorOptions:t,cloudEditorAppActions:s,bylines:l,currentSession:f,previewOption:h,openInReplayOption:g,openInDesktopOption:v,isInActionBar:E,goToFolderOption:S,wrapValuesForActionBar:y,openInNewTabOption:A}=this.props,O=e=>y?(0,c.toActionBarValue)(e):e,I=t.map(e=>{const{type:t}=e,s=t===p.OpenButtonAction.OPEN_WITH_CLOUD_DOC?"cloud_doc":"wopi";return n.default.createElement(a.Menu.ActionItem,{key:e.text,value:O(e),withLeftAccessory:e.spriteName?n.default.createElement(_.Sprite,{group:"web",name:e.spriteName,alt:""}):n.default.createElement("img",{alt:"",src:e.iconUrl,width:24,height:24})},n.default.createElement(r.ExtensionsBylineTooltip,{isInActionBar:E,bylines:l[s],onDidShow:(0,u.handleShowByline)(s,f),key:e.text},n.default.createElement("span",null,e.text)))}),x=e.map(e=>n.default.createElement(a.Menu.ActionItem,{key:e.text,value:O(e),withLeftAccessory:(function(e){return"ow_desktop"===e.spriteName&&e.type===p.OpenButtonAction.UNITY_FILE?-1!==e.text.indexOf("Dropbox")?n.default.createElement(i.UIIcon,{src:o.DropboxLine}):n.default.createElement(i.UIIcon,{src:o.OpenLine}):n.default.createElement(_.Sprite,{group:"web",name:e.spriteName||"",alt:""})})(e)},e.text));let b=!1;const M=s.map(e=>{b||(b=(0,d.isWopiAction)(e.appAction));const t=e.appAction.handler.editor_name;return n.default.createElement(a.Menu.ActionItem,{key:e.appAction.description,value:O(e),withLeftAccessory:n.default.createElement("img",{alt:"",src:e.appAction.icon.url,width:24,height:24})},n.default.createElement(r.ExtensionsBylineTooltip,{isInActionBar:E,bylines:l[t],onDidShow:(0,u.handleShowByline)(t,f),key:e.appAction.description},n.default.createElement("span",null,e.appAction.description)))}),T=h&&n.default.createElement(a.Menu.ActionItem,{key:h.text,value:O(h),withLeftAccessory:n.default.createElement(i.UIIcon,{src:o.ShowLine})},h.text),w=g&&n.default.createElement(a.Menu.ActionItem,{key:g.text,value:O(g),withLeftAccessory:n.default.createElement(i.UIIcon,{src:o.DropboxReplayLine})},g.text),C=v&&n.default.createElement(a.Menu.ActionItem,{key:v.text,value:O(v),withLeftAccessory:n.default.createElement(i.UIIcon,{src:m.mac?o.FinderLine:o.FileExplorerLine})},v.text),N=A&&n.default.createElement(a.Menu.ActionItem,{key:A.text,value:O(A),withLeftAccessory:n.default.createElement(i.UIIcon,{src:o.GlobeLine})},A.text),P=S&&n.default.createElement(a.Menu.ActionItem,{key:S.text,value:O(S),withLeftAccessory:n.default.createElement(i.UIIcon,{src:o.FolderShowLine})},S.text),j=x.length>0||I.length>0||M.length>0||!!N||!!T||!!w||!!C||!!P;return b?j&&n.default.createElement(a.Menu.Segment,{key:"open-options"},N,P,M,x,I,T,w,C):j&&n.default.createElement(a.Menu.Segment,{key:"open-options"},N,P,x,I,M,T,w,C)}}f.displayName="UnityAndCloudEditorsComponent",t.UnityAndCloudEditors=(0,l.requireCssWithComponent)(f,["/static/metaserver/static/css/app_actions/index-vfljPaJWn.css","/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css"])})),define("metaserver/static/js/extensions/menu_survey",["require","exports","tslib","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","dig-components/tooltips","dig-components/typography","metaserver/static/js/components/ui/css","metaserver/static/js/extensions/common","metaserver/static/js/extensions/data/action_creators","metaserver/static/js/extensions/data/selectors","metaserver/static/js/core/i18n"],(function(e,t,s,n,i,o,a,r,l,c,d,u,p,_,m,f){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenMenuSurvey=t.MenuSurvey=t.MenuSurveyElement=void 0,n=s.__importStar(n),(function(e){e.Positive="positive",e.Negative="negative"})(h||(h={}));t.MenuSurveyElement=({surveyComplete:e,onClickSurvey:t,onMouseEnterSurvey:s})=>n.default.createElement(l.Menu.Segment,null,n.default.createElement(l.Menu.Row,null,n.default.createElement("div",{className:"menu-survey__wrapper"},n.default.createElement(d.Text,{size:"small",color:"faint",className:"menu-survey__text"},e?f.intl.formatMessage({id:"iqApHe",defaultMessage:"Thanks for your feedback"}):f.intl.formatMessage({id:"PunJ70",defaultMessage:"Is this menu helpful?"})),e?null:[n.default.createElement(c.Tooltip,{title:f.intl.formatMessage({id:"ReNt2T",defaultMessage:"Helpful"}),placement:"top",key:h.Positive},n.default.createElement(o.IconButton,{variant:"transparent",onClick:()=>t(h.Positive),onMouseEnter:()=>s(h.Positive)},n.default.createElement(a.UIIcon,{src:r.ThumbsUpLine,size:"small","aria-label":"Thumbs Up"}))),n.default.createElement(c.Tooltip,{title:f.intl.formatMessage({id:"he/OAb",defaultMessage:"Not helpful"}),placement:"top",key:h.Negative},n.default.createElement(o.IconButton,{variant:"transparent",onClick:()=>t(h.Negative),onMouseEnter:()=>s(h.Negative)},n.default.createElement(a.UIIcon,{src:r.ThumbsDownLine,size:"small","aria-label":"Thumbs Down"})))])));const g=(0,u.requireCssWithComponent)(t.MenuSurveyElement,["/static/metaserver/static/css/app_actions/index-vfljPaJWn.css","/static/metaserver/static/css/extensions/index-vflrFmD9k.css"]);t.MenuSurvey=({userId:e,session:t,menuSurveyEnabled:s,setMenuSurveyViewed:i})=>{const[o,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{s&&(0,p.logEvent)(t,"view_feedback",{})},[s]);return o||s?n.default.createElement(g,{surveyComplete:o,onClickSurvey:s=>{a(!0),i(e),(0,p.logEvent)(t,"click_feedback",{action_type:s}),setTimeout(()=>a(!1),3e3)},onMouseEnterSurvey:e=>{(0,p.logEvent)(t,"hover_feedback",{action_type:e})}}):null};const v={setMenuSurveyViewed:_.setOpenMenuSurveyViewed},E=(0,i.connect)(e=>({menuSurveyEnabled:(0,m.getOpenMenuSurveyEnabled)(e)}),v);t.OpenMenuSurvey=E(t.MenuSurvey)})),define("metaserver/static/js/extensions/byline",["require","exports","tslib","react","dig-components/tooltips"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsBylineTooltip=void 0,n=s.__importDefault(n);class o extends n.default.Component{constructor(e){super(e),this.handleMouseOver=()=>{clearTimeout(this.timer),this.timer=setTimeout(()=>{this.props.bylines&&(this.setState({show:!0}),this.props.onDidShow())},this.props.delay)},this.handleMouseOut=()=>{this.setState({show:!1}),clearTimeout(this.timer)},this.triggerRef=n.default.createRef(),this.state={show:!1}}componentWillUnmount(){clearTimeout(this.timer)}render(){const{children:e,bylines:t,isInActionBar:s}=this.props,o=n.default.Children.only(e);return t?n.default.createElement(n.default.Fragment,null,n.default.createElement(i.Tooltip.Control,{triggerRef:this.triggerRef,open:this.state.show,placement:s?"right":"left"},(e=>{if(e)return e.length>1?n.default.createElement("ul",{className:"extensions-byline-list"},e.map(e=>n.default.createElement("li",{key:e,className:"extensions-byline-list-item"},e))):n.default.createElement("div",{className:"extensions-byline"},e[0])})(t)),n.default.cloneElement(o,{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,ref:this.triggerRef})):o}}t.ExtensionsBylineTooltip=o,o.defaultProps={delay:500},o.displayName="ExtensionsBylineTooltip"})),define("metaserver/static/js/extensions/client",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/extensions/feature_flags","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/extensions/apis"],(function(e,t,s,n,i,o,a,r){"use strict";function l(e){return"app_id"in e}var c;function d(){return u()}function u(e=c.DISABLED){return{displayState:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionsClient=t.Client=t.newExtensionsConfig=t.actionCompareFn=t.emptyExtensionsConfig=t.DisplayState=t.isAppId=void 0,t.isAppId=l,(function(e){e[e.LOADING=0]="LOADING",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(c=t.DisplayState||(t.DisplayState={})),t.emptyExtensionsConfig=d,t.actionCompareFn=function(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0},t.newExtensionsConfig=u;class p{constructor(e){this.loaded=!1,this.state={actions:[],actionMapping:[],categoryInfos:[],bylines:{},featureFlags:{},sharingServiceInfo:{},cloudDocsInfo:{openWithGddSupported:!1},actionIdToAppAction:{},appActionsEnabled:!1,categoryMapsByExt:{},openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1},this.client=e}getActionsForFile(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return(yield this.getActionsForFileBatch([e],t))[e.file_id]||d()}))}getActionsForFileBatch(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield this.loadState(t);return this.getExtensionsConfigsForFiles(s,e)}))}getFeatureFlags(){return this.state.featureFlags}updateLinkStateForAction(e,t){const s=this.state.actions;for(const n of s)n.id===e&&(n.link_state=t);this.state=Object.assign(Object.assign({},this.state),{actions:s})}loadState(e){return s.__awaiter(this,void 0,void 0,(function*(){if(!this.loaded){this.stateRequest||(this.stateRequest=this.fetchActions(e));const t=this.stateRequest;try{this.state=yield this.stateRequest}catch(e){this.stateRequest===t&&(this.stateRequest=void 0)}}return this.state}))}getExtensionsConfigsForFiles(e,t){const s={};return t.forEach(t=>{s[t.file_id]=u(e.appActionsEnabled&&!t.is_dir?c.ENABLED:c.DISABLED)}),s}fetchActions(e){return s.__awaiter(this,void 0,void 0,(function*(){try{const t=this.client.ns("app_actions").rpc("get_actions_for_user",{include_cloud_editors:!0,include_unlinked_ga_extensions:!0},{subjectUserId:e.id}),[s,n,o]=yield Promise.all([t,this.refreshSharingServiceInfo(e.id),this.getCloudDocsInfo(e)]),a=(function(e){const t={};e.actions.forEach(e=>{!t[e.id]&&e.app_id&&(t[e.id]=e)});const s={};e.action_mapping.forEach(e=>{const n=e.matcher;if("extension"!==n[".tag"])return;const i=n.extension,o=new Map;e.action_ids.forEach(e=>{const s=t[e];let n=o.get(s.category);n?n.push(s.id):(n=[s.id],o.set(s.category,n))}),s[i]=o});const n={};e.bylines.forEach(e=>{let t=e.extension_id[".tag"];l(e.extension_id)&&(t=e.extension_id.app_id),n[t]=e.byline});const o=(0,i.parseFeatureFlags)(e.stormcrow_assignments);return{actionIdToAppAction:t,bylines:n,categoryMapsByExt:s,featureFlags:o}})(s);return this.loaded=!0,{actions:s.actions,actionMapping:s.action_mapping,categoryInfos:s.category_infos,bylines:a.bylines,featureFlags:a.featureFlags,sharingServiceInfo:n,cloudDocsInfo:o,appActionsEnabled:!0,actionIdToAppAction:a.actionIdToAppAction,categoryMapsByExt:a.categoryMapsByExt,openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1}}catch(e){if(e.error&&"feature_gated"===e.error[".tag"])return this.loaded=!0,this.state;throw e}}))}fetchMenuSurveyEnabledState(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=yield(0,r.getTooltipHistory)(e,["realign_open_menu_survey","realign_share_menu_survey"]);return{openMenuSurveyEnabled:!t.realign_open_menu_survey,shareMenuSurveyEnabled:!t.realign_share_menu_survey}}))}setOpenMenuSurveyViewed(e){return s.__awaiter(this,void 0,void 0,(function*(){return(0,r.markTooltipViewed)(e,"realign_open_menu_survey")}))}setShareMenuSurveyViewed(e){return s.__awaiter(this,void 0,void 0,(function*(){return(0,r.markTooltipViewed)(e,"realign_share_menu_survey")}))}getCloudDocsInfo(e){return s.__awaiter(this,void 0,void 0,(function*(){const t={openWithGddSupported:!1};if(e.is_team)try{const s=yield(0,o.getTeamSettings)(e.id);t.openWithGddSupported=s.settings[a.CloudDocProviderIntegration.GDD_INTEGRATION][".tag"]===a.IntegrationCreateAndEdit[".tag"]}catch(e){t.openWithGddSupported=!1}else t.openWithGddSupported=!0;return t}))}getSharingServiceInfo(){return Object.assign({},this.state.sharingServiceInfo)}getActions(){return this.state.actions}getActionMapping(){return this.state.actionMapping}getBylines(){return this.state.bylines}getCategoryInfos(){return this.state.categoryInfos}getCloudDocsInfoState(){return this.state.cloudDocsInfo}refreshSharingServiceInfo(e){return s.__awaiter(this,void 0,void 0,(function*(){if(void 0!==this.sharingServiceReq)return this.sharingServiceReq;try{const t=yield this.client.ns("profile_services").rpc("list_services",void 0,{subjectUserId:e}),s={};return t.services.forEach(e=>{const t=e.service_type[".tag"];s[t]=e}),this.state=Object.assign(Object.assign({},this.state),{sharingServiceInfo:s}),s}catch(e){return this.sharingServiceReq=void 0,{}}}))}}let _;t.Client=p,t.getExtensionsClient=function(){return _||(_=new p(new n.UserApiV2Client)),_}})),define("metaserver/static/js/extensions/file",["require","exports","js/filepath/filepath"],(function(e,t,s){"use strict";function n(e){return void 0!==e.ext}function i(e){return void 0!==e.fq_path}function o(e){return void 0!==e.filename}Object.defineProperty(t,"__esModule",{value:!0}),t.isCloudDoc=t.isInVaultFolder=t.getFileExt=t.hasFilename=t.hasFqPath=t.hasExt=void 0,t.hasExt=n,t.hasFqPath=i,t.hasFilename=o,t.getFileExt=function(e){return n(e)?e.ext:i(e)?"."+(0,s.file_extension)((0,s.filename)(e.fq_path)):o(e)?"."+(0,s.file_extension)(e.filename):void 0},t.isInVaultFolder=function(e){return!!e.is_in_vault_folder},t.isCloudDoc=function(e){return!!e.is_cloud_doc}})),define("metaserver/static/js/extensions/feature_flags",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFeatureFlags=void 0;const s={testFlag:"test_gated_feature",appDirectory:"app_directory",hellosignDeepIntegration:"hellosign_deep_integration_sidebar",spacesPaperSwsFssDropdown:"spaces_paper_sws_fss_dropdown",dndSplitShare:"dnd_phase1_exp6_split_share",fileTransfersAppAction:"file_transfers_app_action",docsendAnalyticsAddOn:"docsend_analytics_add_on",flowsConvertAndShareUi:"flows_convert_and_share_ui",fileTransfersModalExp:"file_transfers_transfer_modal_exp",replayDropboxShareActionExp:"replay_dropbox_share_action_exp",commerceSellerFeaturesEnabled:"commerce_seller_features_enabled",commerceSellACopyExperiment:"commerce_sell_a_copy_experiment",shareWithCollection:"share_with_collection"};t.parseFeatureFlags=function(e){const t={};return(function(){const e=[];for(const t in s)if(s.hasOwnProperty(t)){const n=t;e.push([n,s[n]])}return e})().forEach(([s,n])=>{const i=e[n];void 0!==i&&(t[s]=i)}),t}})),define("metaserver/static/js/extensions/tooltips",["require","exports","metaserver/static/js/core/i18n"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EduTooltipExperiment=t.allowedTooltips=t.tooltipFromName=void 0,t.tooltipFromName=function(e){switch(e){case"open_with_edu":case"split_share_edu":case"edit_experiment_image":case"edit_experiment_pdf":case"upload_intercept_image":case"upload_intercept_pdf":case"desktop_notification":case"realign_open_menu_survey":case"realign_share_menu_survey":case"other":return{".tag":e}}};const n={open_with_edu:({hasExtensions:e})=>e,split_share_edu:()=>!1,upload_intercept_image:()=>!1,upload_intercept_pdf:()=>!1,edit_experiment_pdf:()=>!1,edit_experiment_image:()=>!1,desktop_notification:()=>!1,realign_open_menu_survey:({hasExtensions:e})=>e,realign_share_menu_survey:({hasExtensions:e})=>e,other:()=>!1},i=["open_with_edu","desktop_notification","realign_open_menu_survey","realign_share_menu_survey"];t.allowedTooltips=function(e,t,s){return i.filter(i=>n[i]({hasExtensions:e,fileExt:t,featureFlags:s}))},(function(e){e.TOOLTIP_CONFIGS={open_with_edu:{tooltipTitle:s.intl.formatMessage({id:"VopzGG",defaultMessage:"Do more with your files"}),tooltipMessage:s.intl.formatMessage({id:"1vlc0Q",defaultMessage:"Work on this file in other apps. Updates you make will automatically save back to Dropbox."})}},e.EDU_SPLIT_SHARE_MAP={CONTROL:{tooltipTitle:s.intl.formatMessage({id:"v7foBc",defaultMessage:"Extend the power of Dropbox"}),tooltipMessage:s.intl.formatMessage({id:"VKi3Pj",defaultMessage:"Now you can send files to Slack or present in Zoom without leaving Dropbox."})}}})(t.EduTooltipExperiment||(t.EduTooltipExperiment={}))})),define("metaserver/static/js/extensions/data/action_creators",["require","exports","tslib","metaserver/static/js/extensions/client","metaserver/static/js/extensions/data/types","metaserver/static/js/integrations/data/actions"],(function(e,t,s,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setShareMenuSurveyEnabledState=t.setOpenMenuSurveyEnabledState=t.setCloudDocsInfoState=t.updateExtensionsState=t.refreshSharingServiceInfoAdapter=t.refreshSharingServiceInfo=t.setShareMenuSurveyViewed=t.setOpenMenuSurveyViewed=t.updateLinkState=t.setExtensionsFeatureFlags=t.initializeExtensionsStore=void 0;t.initializeExtensionsStore=({files:e,user:o})=>function(a){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield(0,n.getExtensionsClient)().getActionsForFileBatch(e,o),r=(0,n.getExtensionsClient)().getFeatureFlags();a((0,t.setExtensionsFeatureFlags)({featureFlags:r}));const l=(0,n.getExtensionsClient)().getSharingServiceInfo();a({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:l}}),a({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:s}});const c=(0,n.getExtensionsClient)().getActions(),d=(0,n.getExtensionsClient)().getActionMapping(),u=(0,n.getExtensionsClient)().getBylines(),p=(0,n.getExtensionsClient)().getCategoryInfos(),_=(0,n.getExtensionsClient)().getCloudDocsInfoState();a((0,t.updateExtensionsState)({actions:c,actionMapping:d,bylines:u,categoryInfos:p})),a((0,t.setCloudDocsInfoState)({cloudDocsInfo:_}))}))};t.setExtensionsFeatureFlags=({featureFlags:e})=>({type:i.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS,payload:{featureFlags:e}});t.updateLinkState=({actionId:e,linkState:s})=>function(i){const o=(0,n.getExtensionsClient)();o.updateLinkStateForAction(e,s);const a=o.getActions(),r=o.getActionMapping(),l=o.getBylines(),c=o.getCategoryInfos();i((0,t.updateExtensionsState)({actions:a,actionMapping:r,bylines:l,categoryInfos:c}))};t.setOpenMenuSurveyViewed=e=>function(s){(0,n.getExtensionsClient)().setOpenMenuSurveyViewed(e),s((0,t.setOpenMenuSurveyEnabledState)({openMenuSurveyEnabled:!1}))};t.setShareMenuSurveyViewed=e=>function(s){(0,n.getExtensionsClient)().setShareMenuSurveyViewed(e),s((0,t.setShareMenuSurveyEnabledState)({shareMenuSurveyEnabled:!1}))};t.refreshSharingServiceInfo=({user:e,onRefresh:t})=>function(o){return s.__awaiter(this,void 0,void 0,(function*(){const s=(0,n.getExtensionsClient)();yield s.refreshSharingServiceInfo(e.id);const a=yield(0,n.getExtensionsClient)().getSharingServiceInfo();t&&t(a),o({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:a}})}))},t.refreshSharingServiceInfoAdapter=function({onRefresh:e}){return function(t,s,n){const a=e&&(t=>{"fulfilled"===t.state?e((0,i.convertToSharingServiceInfo)(t.value)):e()});(0,o.fetchListServices)(a)(t,s,n)}};t.updateExtensionsState=({actions:e,actionMapping:t,bylines:s,categoryInfos:n})=>({type:i.ActionTypes.UPDATE_EXTENSIONS_STATE,payload:{actions:e,actionMapping:t,bylines:s,categoryInfos:n}});t.setCloudDocsInfoState=({cloudDocsInfo:e})=>({type:i.ActionTypes.SET_CLOUD_DOCS_INFO_STATE,payload:{cloudDocsInfo:e}});t.setOpenMenuSurveyEnabledState=({openMenuSurveyEnabled:e})=>({type:i.ActionTypes.SET_OPEN_MENU_SURVEY_ENABLED_STATE,payload:{openMenuSurveyEnabled:e}});t.setShareMenuSurveyEnabledState=({shareMenuSurveyEnabled:e})=>({type:i.ActionTypes.SET_SHARE_MENU_SURVEY_ENABLED_STATE,payload:{shareMenuSurveyEnabled:e}})})),define("metaserver/static/js/extensions/data/reducer",["require","exports","metaserver/static/js/extensions/data/types"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extensionsReducer=t.defaultExtensionsState=void 0,t.defaultExtensionsState={actionMapping:[],actions:[],categoryInfos:[],bylines:{},featureFlags:{},fileExtensionsConfigs:{},sharingServiceInfo:{},cloudDocsInfo:{openWithGddSupported:!1},openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1};t.extensionsReducer=function(e=t.defaultExtensionsState,n){switch(n.type){case s.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES:return((e,t)=>{const{fileExtensionsConfigs:s}=t.payload;return Object.assign(Object.assign({},e),{fileExtensionsConfigs:Object.assign(Object.assign({},e.fileExtensionsConfigs),s)})})(e,n);case s.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS:return((e,t)=>{const{featureFlags:s}=t.payload;return Object.assign(Object.assign({},e),{featureFlags:s})})(e,n);case s.ActionTypes.SET_SHARING_SERVICE_INFO_STATE:return((e,t)=>{const{sharingServiceInfo:s}=t.payload;return Object.assign(Object.assign({},e),{sharingServiceInfo:s})})(e,n);case s.ActionTypes.UPDATE_EXTENSIONS_STATE:return((e,t)=>Object.assign(Object.assign({},e),t.payload))(e,n);case s.ActionTypes.SET_CLOUD_DOCS_INFO_STATE:return((e,t)=>{const{cloudDocsInfo:s}=t.payload;return Object.assign(Object.assign({},e),{cloudDocsInfo:s})})(e,n);case s.ActionTypes.SET_OPEN_MENU_SURVEY_ENABLED_STATE:return((e,t)=>{const{openMenuSurveyEnabled:s}=t.payload;return Object.assign(Object.assign({},e),{openMenuSurveyEnabled:s})})(e,n);case s.ActionTypes.SET_SHARE_MENU_SURVEY_ENABLED_STATE:return((e,t)=>{const{shareMenuSurveyEnabled:s}=t.payload;return Object.assign(Object.assign({},e),{shareMenuSurveyEnabled:s})})(e,n)}return e}})),define("metaserver/static/js/extensions/data/selectors",["require","exports","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors","metaserver/static/js/extensions/data/reducer","metaserver/static/js/extensions/client","metaserver/static/js/integrations/data/selectors","metaserver/static/js/extensions/data/types","metaserver/static/js/extensions/file"],(function(e,t,s,n,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShareAction=t.getNonHellosignActionsForFiles=t.getOpenActionsForFile=t.getShareActionsForFiles=t.getFirstPartyActionIds=t.getActionsForFiles=t.getShareMenuSurveyEnabled=t.getOpenMenuSurveyEnabled=t.getCategoryInfos=t.getBylines=t.getActions=t.getCloudDocInfo=t.getSharingServiceInfoAdapter=t.sharingServiceInfo=t.extensionsEnabledForFile=t.getFeatureFlags=t.fileExtensionsConfigs=t.getExtensionsState=void 0;t.getExtensionsState=e=>(0,n.getStateAtNamespace)(e,s.EXTENSIONS_NAMESPACE_KEY)||i.defaultExtensionsState;t.fileExtensionsConfigs=e=>(0,t.getExtensionsState)(e).fileExtensionsConfigs;t.getFeatureFlags=e=>(0,t.getExtensionsState)(e).featureFlags,t.extensionsEnabledForFile=function(e,s){return(function(e,s){return(0,t.getExtensionsState)(e).fileExtensionsConfigs[s]||(0,o.emptyExtensionsConfig)()})(e,s.file_id).displayState!==o.DisplayState.DISABLED};t.sharingServiceInfo=e=>(0,t.getExtensionsState)(e).sharingServiceInfo;t.getSharingServiceInfoAdapter=e=>{const t=(0,a.getListServicesInfo)(e).latestListServicesResult;return t&&(0,r.convertToSharingServiceInfo)(t)};t.getCloudDocInfo=e=>(0,t.getExtensionsState)(e).cloudDocsInfo;t.getActions=e=>(0,t.getExtensionsState)(e).actions;t.getBylines=e=>(0,t.getExtensionsState)(e).bylines;t.getCategoryInfos=e=>(0,t.getExtensionsState)(e).categoryInfos;t.getOpenMenuSurveyEnabled=e=>(0,t.getExtensionsState)(e).openMenuSurveyEnabled;function c(e,t){return!(e.length>1&&!t.multiselect_enabled)&&e.every(e=>(function(e,t){return void 0===t.filters||t.filters.every(t=>"matcher_any"===t[".tag"]&&!!t.matcher_any.some(t=>{if("extension"===t[".tag"]){const s=(0,l.getFileExt)(e);return t.extension===s}return"max_size_bytes"===t[".tag"]?e.bytes<=t.max_size_bytes:"is_file"===t[".tag"]?e.is_dir!==t.is_file:"is_cloud_doc"!==t[".tag"]||(0,l.isCloudDoc)(e)===t.is_cloud_doc}))})(e,t))}function d(e){var t;const s=e.is_dir,n=(0,l.isInVaultFolder)(e),i=null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node;return!(s||n||i)}function u(e){const t=e.per_node_metadata;return!((0,l.isInVaultFolder)(e)||(null==t?void 0:t.link_node)||(null==t?void 0:t.suppress_ns_partition)||(null==t?void 0:t.suppress_shared_link))}function p(e,s){return(function(e,t){return e.every(d)?t.filter(t=>c(e,t)):[]})(s,(0,t.getActions)(e))}function _(e,t){return t.every(u)?p(e,t).filter(e=>m(e)):[]}function m(e){return"share_menu"===e.menu_alignment[".tag"]}t.getShareMenuSurveyEnabled=e=>(0,t.getExtensionsState)(e).shareMenuSurveyEnabled,t.getActionsForFiles=p,t.getFirstPartyActionIds=function(e,t){return p(e,[t]).map(e=>e.id).filter(e=>e.startsWith("fp_action_id:"))},t.getShareActionsForFiles=_,t.getOpenActionsForFile=function(e,t){return p(e,[t]).filter(e=>!m(e))},t.getNonHellosignActionsForFiles=function(e,t,s){return _(e,t).filter(e=>e.app_id!==s)},t.isShareAction=m})),define("metaserver/static/js/extensions/data/store",["require","exports","tslib","lodash","metaserver/static/js/extensions/data/action_creators","metaserver/static/js/redux/store","metaserver/static/js/redux/namespaces","metaserver/static/js/extensions/data/reducer","metaserver/static/js/integrations/data/store"],(function(e,t,s,n,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeStore=t.getStore=void 0,n=s.__importStar(n),t.getStore=n.once(()=>((0,l.registerReducersForIntegration)(),(0,o.getStoreAndRegisterReducers)({[a.EXTENSIONS_NAMESPACE_KEY]:r.extensionsReducer}))),t.initializeStore=function(e,s){const n=(0,t.getStore)();return(0,l.initStoreForIntegration)(e.id),s&&n.dispatch((0,i.initializeExtensionsStore)({user:e,files:s})),n}})),define("metaserver/static/js/extensions/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSharingServiceInfo=t.TriggerType=t.ActionTypes=void 0,(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES",e.SET_EXTENSIONS_FEATURE_FLAGS="EXTENSIONS/SET_EXTENSIONS_FEATURE_FLAGS",e.UPDATE_LINK_STATE="EXTENSIONS/UPDATE_LINK_STATE",e.SET_SHARING_SERVICE_INFO_STATE="EXTENSIONS/SET_SHARING_SERVICE_INFO_STATE",e.UPDATE_EXTENSIONS_STATE="EXTENSIONS/UPDATE_EXTENSIONS_STATE",e.SET_CLOUD_DOCS_INFO_STATE="EXTENSIONS/SET_CLOUD_DOCS_INFO_STATE",e.SET_OPEN_MENU_SURVEY_ENABLED_STATE="EXTENSIONS/SET_OPEN_MENU_SURVEY_ENABLED_STATE",e.SET_SHARE_MENU_SURVEY_ENABLED_STATE="EXTENSIONS/SET_SHARE_MENU_SURVEY_ENABLED_STATE"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.PrimaryButton="primary_button",e.SecondaryButton="secondary_button",e.SidebarPrimaryButton="sidebar_primary_button",e.CollapsedButton="collapsed_button",e.OpacityButton="opacity_button"})(t.TriggerType||(t.TriggerType={})),t.convertToSharingServiceInfo=function(e){try{const t={};return e.services.forEach(e=>{const s=e.service_type[".tag"];t[s]=e}),t}catch(e){}return{}}})),define("metaserver/static/js/extensions/apis",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/extensions/tooltips"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.markAppSurveyShown=t.hasUserSeenSurveyForApp=t.markTooltipViewed=t.getTooltipHistory=void 0,t.getTooltipHistory=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=new n.UserApiV2Client;try{const n=t.map(e=>(0,i.tooltipFromName)(e)),o=yield s.ns("extensions").rpc("get_extensions_tooltip_history_v2",{tooltips:n},{subjectUserId:e}),a={};return o.view_states.forEach(e=>{a[e.tooltip[".tag"]]=e.viewed}),a}catch(e){const s={};return t.forEach(e=>{s[e]=!0}),s}}))},t.markTooltipViewed=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=new n.UserApiV2Client,o=(0,i.tooltipFromName)(t);yield s.ns("extensions").rpc("mark_extensions_tooltip_viewed",{tooltip:o},{subjectUserId:e})}))},t.hasUserSeenSurveyForApp=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=new n.UserApiV2Client;return(yield s.ns("extensions").rpc("get_extension_survey_history",{app_id:t},{subjectUserId:e})).survey_shown}))},t.markAppSurveyShown=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=new n.UserApiV2Client;yield s.ns("extensions").rpc("mark_extension_survey_shown",{app_id:t},{subjectUserId:e})}))}})),define("metaserver/static/js/capture/api",["require","exports","tslib","dropbox-internal-sdk","metaserver/static/js/core/sdk_helpers"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCaptureFileAssociation=t.fetchCaptureAccess=void 0;t.fetchCaptureAccess=e=>s.__awaiter(void 0,void 0,void 0,(function*(){const t=(0,i.getCookieAuthSDKAuth)(()=>e.id),s=new n.Dropbox({auth:t});try{const{result:{capture_access_policy:e}}=yield s.captureGetTeamSettings({});return 1===e}catch(e){return!1}}));t.fetchCaptureFileAssociation=(e,t)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=(0,i.getCookieAuthSDKAuth)(()=>e.id),o=new n.Dropbox({auth:s});try{const{result:{short_label:e}}=yield o.captureGetFileAssociation({file_id:t.file_id});return{fileId:t.file_id,shortLabel:e}}catch(e){return}}))})),define("metaserver/static/js/capture/redux/actions",["require","exports","metaserver/static/js/capture/redux/types"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCaptureFileVoiceover=t.setUploadResult=t.setCaptureAccess=t.openRecorder=t.closeRecorder=void 0,t.closeRecorder=function(){return e=>{e({type:s.Actions.CloseRecorder})}},t.openRecorder=function(e,t=!1){return n=>{n({payload:{source:e,useCamera:t},type:s.Actions.OpenRecorder})}},t.setCaptureAccess=function(e){return t=>{t({type:s.Actions.SetCaptureAccess,payload:e})}},t.setUploadResult=function(e){return t=>{t({type:s.Actions.UploadResult,payload:e})}},t.setCaptureFileVoiceover=function(e){return t=>{t({type:s.Actions.SetCaptureFileVoiceover,payload:e})}}})),define("metaserver/static/js/capture/redux/selectors",["require","exports","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCaptureFileVoiceover=t.getUploadResult=t.getRecorderState=t.getCaptureAccess=t.getCaptureState=void 0;t.getCaptureState=e=>(0,n.getStateAtNamespace)(e,s.CAPTURE_NAMESPACE_KEY);t.getCaptureAccess=e=>(0,t.getCaptureState)(e).canAccessCapture;t.getRecorderState=e=>(0,t.getCaptureState)(e).recorderState;t.getUploadResult=e=>(0,t.getCaptureState)(e).uploadResult;t.getCaptureFileVoiceover=e=>(0,t.getCaptureState)(e).fileCaptureVoiceover})),define("metaserver/static/js/capture/preview_voiceover_recorder",["require","exports","tslib","react","react-redux","metaserver/static/js/capture/redux/selectors","metaserver/static/js/capture/redux/actions","metaserver/static/js/capture/voice_over_onboarding_modal","metaserver/static/js/user_metadata/api"],(function(e,t,s,n,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewVoiceoverRecorder=void 0;const c=(n=s.__importStar(n)).default.lazy(()=>new Promise((t,s)=>{e(["metaserver/static/js/capture/async_recorder"],t,s)}).then(s.__importStar)),d="capture_sdk_fss_preview_voiceover";t.PreviewVoiceoverRecorder=({fileId:t,logEvent:u,triggerResetHandler:p,user:_,voiceoverState:m})=>{const[f,h]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!0),[E,S]=(0,n.useState)(!1),y=(0,i.useDispatch)(),A=(0,i.useSelector)(o.getRecorderState),O=(0,i.useSelector)(o.getUploadResult);(0,n.useEffect)(()=>{s.__awaiter(void 0,void 0,void 0,(function*(){const e=(yield(0,l.getUserMetadata)(["CAPTURE_VOICE_OVERS_ONBOARDING_SEEN"],_.id)).CAPTURE_VOICE_OVERS_ONBOARDING_SEEN;h(!e),v(!1)}))},[_]),(0,n.useEffect)(()=>{s.__awaiter(void 0,void 0,void 0,(function*(){if(O&&O.source===d){if(!O.capture_link)return void u("upload_result_no_capture_link",d);const i=O.capture_link.split("/").pop();try{const o=yield(n=_.id,s.__awaiter(void 0,void 0,void 0,(function*(){const[{getCookieAuthSDKAuth:t},{Dropbox:i}]=yield Promise.all([new Promise((t,s)=>{e(["metaserver/static/js/core/sdk_helpers"],t,s)}).then(s.__importStar),new Promise((t,s)=>{e(["dropbox-internal-sdk"],t,s)}).then(s.__importStar)]);return new i({auth:t(()=>n)})})));yield o.captureCreateFileAssociation({file_id:t,short_label:i})}catch(e){u("failed_to_create_file_association",d)}}var n}))},[t,u,O,_]),(0,n.useEffect)(()=>{if(g)return;const e=E||A.active;m.triggered&&!e&&(f&&!E?(S(!0),h(!1)):y((0,a.openRecorder)(d,m.useCamera)))},[y,g,f,A,E,m]);const I=(0,n.useCallback)(()=>{S(!1),(0,l.setUserMetadata)({CAPTURE_VOICE_OVERS_ONBOARDING_SEEN:!0},_.id),y((0,a.openRecorder)(d,m.useCamera))},[y,_,m]);return A.active&&A.source===d?n.default.createElement(n.Suspense,{fallback:null},n.default.createElement(c,{onLaunch:p,skipOnboarding:!0,source:d,user:_})):E?n.default.createElement(r.VoiceOverOnboardingModal,{open:E,onClose:I,onConfirm:I}):null}})),define("metaserver/static/js/capture/voice_over_onboarding_modal",["require","exports","tslib","dig-components/buttons","dig-components/modal","dig-components/typography","react","metaserver/static/js/capture/voice_over_onboarding_modal.module.css","metaserver/static/js/core/i18n","metaserver/static/js/clean/static_urls"],(function(e,t,s,n,i,o,a,r,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceOverOnboardingModal=void 0,a=s.__importStar(a),r=s.__importDefault(r);const d=(0,c.static_url)("/static/metaserver/static/js/capture/assets/onboarding-step-one-vfl5fe8mh.png"),u=(0,c.static_url)("/static/metaserver/static/js/capture/assets/onboarding-step-two-vflBfe66Z.png"),p=(0,c.static_url)("/static/metaserver/static/js/capture/assets/onboarding-step-three-vfllwz-QB.png");t.VoiceOverOnboardingModal=({open:e,onClose:t,onConfirm:s})=>((0,a.useEffect)(()=>{const s=s=>{e&&"Escape"===s.key&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t,e]),a.default.createElement(i.Modal,{"aria-labelledby":"sdk-onboarding-modal-title","data-testid":"onboarding-modal",open:e,width:"large"},a.default.createElement(i.Modal.Header,{className:r.default.header,hasBottomSpacing:"title-standard"},a.default.createElement(i.Modal.Title,{id:"sdk-onboarding-modal-title"},l.intl.formatMessage({id:"eGA16j",defaultMessage:"Attach video commentary to your file"}))),a.default.createElement(i.Modal.Body,null,a.default.createElement("div",{className:r.default.body},a.default.createElement("div",{className:r.default.onboardingStep},a.default.createElement("img",{alt:"",src:d}),a.default.createElement(o.Text,null,l.intl.formatMessage({id:"2zWVty",defaultMessage:"Give permission to record."}))),a.default.createElement("div",{className:r.default.onboardingStep},a.default.createElement("img",{src:u,alt:""}),a.default.createElement(o.Text,null,l.intl.formatMessage({id:"xNlZVn",defaultMessage:"Record and save your video with voice-over."}))),a.default.createElement("div",{className:r.default.onboardingStep},a.default.createElement("img",{src:p,alt:""}),a.default.createElement(o.Text,null,l.intl.formatMessage({id:"ksLqpv",defaultMessage:"Watch the video directly from your file."}))))),a.default.createElement(i.Modal.Footer,{className:r.default.footer},a.default.createElement(n.Button,{onClick:t,variant:"transparent"},l.intl.formatMessage({id:"4zRKFO",defaultMessage:"Close"})),a.default.createElement(n.Button,{onClick:s,variant:"primary"},l.intl.formatMessage({id:"PPtpAY",defaultMessage:"Start"})))))})),define("metaserver/static/js/capture/voice_over_onboarding_modal.module.css",["require","exports","css!metaserver/static/js/capture/voice_over_onboarding_modal.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.footer=t.onboardingStep=t.body=t.header=void 0,t.header="_header_5tvyi_1",t.body="_body_5tvyi_5",t.onboardingStep="_onboardingStep_5tvyi_10",t.footer="_footer_5tvyi_21";t.default={header:"_header_5tvyi_1",body:"_body_5tvyi_5",onboardingStep:"_onboardingStep_5tvyi_10",footer:"_footer_5tvyi_21"}}));
//# sourceMappingURL=pkg-fvsdk-other.min.js-vfltKx6Jw.map