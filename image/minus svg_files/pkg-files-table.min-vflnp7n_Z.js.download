define("typescript/component_libraries/files_components/src/files-table/files-table",["require","exports","tslib","react","dig-components/controls","dig-components/table","dig-components/typography","typescript/component_libraries/files_components/src/common/file","typescript/component_libraries/files_components/src/icons/file_icon","dig-components/combinations","@tanstack/react-table","dig-components/typography","dig-components/hooks","typescript/component_libraries/files_components/src/files-table/files-table-star","typescript/component_libraries/files_components/src/files-table/index.module.css","typescript/component_libraries/dig-experimental/src/focus_group/index","typescript/component_libraries/files_components/src/files-table/files-table-file-row","classnames"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesTable=t.FileNameCell=void 0,i=n.__importStar(i),h=n.__importDefault(h),f=n.__importDefault(f);t.FileNameCell=({file:e,labelID:t,subTitle:n=""})=>{var o,s;const d=(0,a.isOpenable)(e)&&e.url&&!e.isDisabled?i.createElement("div",{className:"files-table-click-handler","data-testid":"file-link-div",onClick:(0,_.onClickOpenHandler)(e),onAuxClick:(0,_.onClickOpenHandler)(e),role:"link",onKeyPress:(0,_.onKeyPressOpenHandler)(e)},i.createElement(u.Link,{id:t,"data-testid":"filename-link",href:e.url,hasNoUnderline:!0,variant:"monochromatic"},e.title),i.createElement("div",null,null===(o=e.renderSubTitle)||void 0===o?void 0:o.call(e))):i.createElement(r.Text,{id:t,"data-testid":"files-filename",color:e.isDisabled?"disabled":"standard"},e.title,i.createElement("div",null,null===(s=e.renderSubTitle)||void 0===s?void 0:s.call(e)));return i.createElement(c.LabelGroup,{withLeftAccessory:i.createElement(l.FileIcon,{file:e}),withText:d,withSubtext:n})},t.FileNameCell.displayName="FileNameCell";t.FilesTable=({items:e,hasRowSelection:n=!1,hasSharing:r=!1,hasStarring:l=!1,viewExtensions:c=!1,viewHeaders:u=!1,addSelectedRow:v,removeSelectedRow:E})=>{const[S]=i.useState(new Set),T=S.size,I=(0,m.useUniqueId)({prefix:""});let R=[{id:"filename",cell:e=>i.createElement("div",{className:h.default.fileDataContainer+" fileDataContainer"},e.row.original?i.createElement(t.FileNameCell,{file:e.row.original,labelID:(0,_.getLabelIDFromRowIndex)(e.row.index,I)}):null,(0,a.isStarrableFile)(e.row.original)&&l&&!(0,a.isCollection)(e.row.original)?i.createElement(g.StarIcon,{file:e.row.original,label:(0,_.getLabelIDFromRowIndex)(e.row.index,I)}):null),header:()=>i.createElement("span",null,"Name")}];c&&(R=[...R,{accessorFn:e=>{if(!(0,a.isCollection)(e))return e.extension},id:"extension",cell:e=>e.getValue()||"",header:()=>i.createElement("span",null,"Extension")}]);const y=i.useCallback(e=>{var t;const n=null===(t=e.original)||void 0===t?void 0:t.uniqueKey;return!(!n||!S.has(n))},[S]);n&&(R=[{id:"select",header:({table:e})=>i.createElement(o.Checkbox,Object.assign({},{checked:e.getIsAllRowsSelected(),isIndeterminate:e.getIsSomeRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()})),cell:({row:e})=>{var t,n;const s=y(e),r=null===(t=e.original)||void 0===t?void 0:t.uniqueKey;return i.createElement(o.Checkbox,Object.assign({},{checked:s,disabled:null===(n=e.original)||void 0===n?!0:!n.isCheckable,onChange:()=>{var t,n;e.original&&r&&(s?(S.delete(r),null==E||E(null===(t=e.original)||void 0===t?void 0:t.uniqueKey)):(S.add(r),null==v||v(null===(n=e.original)||void 0===n?void 0:n.uniqueKey)))}}))}},...R]);const b=i.useMemo(()=>(0,p.createFocusGroup)({trackTabIndexOnFocus:!0,addTabIndextoChildrenOnFocus:!0}),[]);i.useEffect(()=>(b.activate(),()=>{b.deactivate()}),[b]);const A=i.useRef(null),C=h.default.tableRow;i.useEffect(()=>{var e;return A.current?b.setMembers(Array.from((null===(e=null==A?void 0:A.current)||void 0===e?void 0:e.querySelectorAll("."+C))||[])):b.setMembers([]),()=>{}},[b,C,e]);const w=e,[P,F]=i.useState({}),[D,N]=i.useState({}),[M,O]=i.useState(),L=(0,d.useReactTable)({data:w,columns:R,getCoreRowModel:(0,d.getCoreRowModel)()});i.useEffect(()=>{const e=new Set;L.getRowModel().rows.forEach(t=>{var n,i;(null===(n=t.original)||void 0===n?void 0:n.uniqueKey)&&e.add(null===(i=t.original)||void 0===i?void 0:i.uniqueKey)}),S.forEach(t=>{e.has(t)||(S.delete(t),null==E||E(t))})},[y,L,E,S]),i.useEffect(()=>{const e=L.getRowModel().rows.map(e=>i.createElement(_.FilesTableFileRow,{row:e,key:e.id,setHoveredRow:F,setFocusedRow:N,rowLabel:(0,_.getLabelIDFromRowIndex)(e.index,I),isSelected:e.id===D,hasSharing:r,isChecked:y(e)}));O(e)},[D,r,P,I,L,O,e,T,y]);const j={};return j[h.default.filesTable]=!0,j[h.default.filesTableSelected]=T>0,i.createElement(s.Table,{isSelectable:!0,className:(0,f.default)(j),ref:A},u&&i.createElement(s.Table.Header,null,L.getHeaderGroups().map(e=>i.createElement(s.Table.Row,{key:e.id},e.headers.map(e=>i.createElement(s.Table.HeaderCell,{key:e.id},e.isPlaceholder?null:(0,d.flexRender)(e.column.columnDef.header,e.getContext())))))),i.createElement(s.Table.Body,null,M))},t.FilesTable.displayName="FilesTable"})),define("typescript/component_libraries/files_components/src/files-table/files-table-file-row",["require","exports","tslib","react","dig-components/table","typescript/component_libraries/files_components/src/common/file","@tanstack/react-table","typescript/component_libraries/files_components/src/files-table/index.module.css","classnames","classnames","dig-components/buttons","typescript/component_libraries/files_components/src/files-table/files-table-row-actions"],(function(e,t,n,i,o,s,r,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesTableFileRow=t.onKeyPressOpenHandler=t.onClickOpenHandler=t.getLabelIDFromRowIndex=void 0,i=n.__importStar(i),a=n.__importDefault(a),l=n.__importDefault(l),c=n.__importDefault(c),t.getLabelIDFromRowIndex=function(e,t){return`files-table-label-${e}-${t}`};t.onClickOpenHandler=e=>t=>{if(t.preventDefault(),t.stopPropagation(),(0,s.isOpenable)(e)&&e.url&&!e.isDisabled){const n=1===t.button;e.performOpenAction(t.metaKey||t.ctrlKey||t.shiftKey,{href:e.url,middleClick:n})}};t.onKeyPressOpenHandler=e=>t=>{(0,s.isOpenable)(e)&&e.url&&!e.isDisabled&&"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performOpenAction(t.metaKey||t.ctrlKey||t.shiftKey,{href:e.url,middleClick:!1}))};t.FilesTableFileRow=({row:e,setHoveredRow:n,setFocusedRow:m,rowLabel:g,isSelected:h=!1,hasSharing:p=!1,isChecked:_=!1})=>{var f;const[v,E]=i.useState(),S=e=>!(!v||!0!==v[e]);let T=e.original?(0,t.onClickOpenHandler)(e.original):void 0;if((0,s.isCollection)(e.original)){const t=e.original.uniqueKey;T=()=>{v&&v[t]?E(Object.assign(Object.assign({},v),{[t]:!1})):E(Object.assign(Object.assign({},v),{[t]:!0}))}}const[I,R]=(0,s.isCollection)(e.original)?[e.original.showMoreLabel,e.original.hideMoreLabel]:"";let y=null;if((0,s.isCollection)(e.original)){let t=I;S(e.original.uniqueKey)&&(t=R),y=i.createElement(d.Button,{className:"show-hide-more",variant:"transparent",hasNoUnderline:!0,withDropdownIcon:!0,size:"small"},t)}const b=(0,s.isCollection)(e.original)&&S(e.original.uniqueKey)?e.original.renderCollection(e.original.attachmentIds):null,A=i.useMemo(()=>{var t,n;return null===(n=null===(t=e.original)||void 0===t?void 0:t.renderInlineActionMenu)||void 0===n?void 0:n.call(t)},[e.original]),C=(0,s.isCollection)(e.original)?i.createElement(i.Fragment,null,y,b):null,w=(0,c.default)(a.default.tableRow,{[a.default.selectedTableRow]:_,"selected-table-row":_});return i.createElement(i.Fragment,null,i.createElement(o.Table.Row,{isSelected:h,"data-testid":"files-table-row",className:(0,l.default)(w),onDoubleClick:e.original&&(0,t.onClickOpenHandler)(e.original),"aria-labelledby":g,isSelectable:!(null===(f=e.original)||void 0===f?void 0:f.isDisabled),onMouseDown:e=>{e.preventDefault()},onMouseEnter:()=>{n(e.id)},onMouseLeave:()=>{n(!1),m(!1)},onFocus:()=>{n(e.id),m(e.id)},onBlur:e=>{const t=e.relatedTarget||document.activeElement;e.currentTarget.contains(t)||(n(!1),m(!1))}},e.getVisibleCells().map(t=>{const n={};return n[a.default.filesTableSelectionCell]="select"===t.column.id,n[a.default.filenameCell]="filename"===t.column.id,n[a.default.filesTableCell]="select"!==t.column.id,n["files-table-file-collection-cell"]=(0,s.isCollection)(e.original),i.createElement(o.Table.Cell,{className:(0,l.default)(n),key:t.id,onClick:"filename"===t.column.id?T:void 0},(0,r.flexRender)(t.column.columnDef.cell,t.getContext()),"filename"===t.column.id?C:null)}),e.original?i.createElement(u.RowActionBar,{file:e.original,hasSharing:p}):null,A?i.createElement(o.Table.Cell,{width:32,className:a.default.filesTableActions},A):null))},t.FilesTableFileRow.displayName="FilesTableFileRow"})),define("typescript/component_libraries/files_components/src/files-table/files-table-row-actions",["require","exports","tslib","react","dig-components/buttons","dig-components/tooltips","react-intl","classnames","typescript/component_libraries/files_components/src/common/file","dig-components/hooks","dig-components/buttons","dig-components/icons/src","dig-components/icons","dig-components/table","typescript/component_libraries/files_components/src/files-table/index.module.css"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowActionBar=void 0,i=n.__importStar(i),a=n.__importDefault(a),h=n.__importDefault(h);t.RowActionBar=({file:e,hasSharing:t})=>{const n=i.useRef(null),p=(0,r.useIntl)(),_=(0,c.useUniqueId)({prefix:"files_table__action-item-"}),f=p.formatMessage({id:"At94iP",defaultMessage:"Share"}),v=p.formatMessage({id:"7aNEFN",defaultMessage:"Copy Link"}),E=t&&(0,l.isShareableFile)(e)&&(0,l.isCopylinkableFile)(e),S=t&&(0,l.isShareableFile)(e),T=E&&S,I=E&&(0,l.isShareableFile)(e)?i.createElement(o.Button,{variant:"opacity",withIconLeft:i.createElement(m.UIIcon,{src:u.LinkLine}),onClick:t=>{var i;t.stopPropagation(),null===(i=e.performCopyLinkAction)||void 0===i||i.call(e,n)},ref:n},v):null,R={onClick:(0,l.isShareableFile)(e)?t=>{t.stopPropagation(),e.performShareAction()}:void 0,onKeyPress:(0,l.isShareableFile)(e)?t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performShareAction())}:void 0},y=S?T?i.createElement(s.Tooltip,{title:f,placement:"top",id:_},i.createElement(d.IconButton,Object.assign({className:"files-table-share-button","data-testid":"file-share-button--icon",variant:"transparent","aria-labelledby":_},R),i.createElement(m.UIIcon,{src:u.ShareArrowLine}))):i.createElement(o.Button,Object.assign({className:"files-table-share-button","data-testid":"file-share-button--text",variant:"opacity"},R,{"aria-labelledby":_}),f):null,b=(0,a.default)({[h.default.rowActionMultiple]:T});return I||y?i.createElement(g.Table.Cell,{className:b},I,y):null},t.RowActionBar.displayName="RowActionBar"})),define("typescript/component_libraries/files_components/src/files-table/files-table-star",["require","exports","tslib","react","typescript/component_libraries/files_components/src/buttons/star_button"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarIcon=void 0,i=n.__importStar(i);t.StarIcon=({file:e,label:t})=>{const n=s(e),a=r(e);return i.createElement(o.StarButton,{isStarred:!!e.isStarred,isDisabled:!e.isStarrable,tabIndex:0,onClick:n,onKeyPress:a,ariaLabelledBy:t})},t.StarIcon.displayName="StarIcon";const s=e=>i.useCallback(t=>{t.preventDefault(),t.stopPropagation(),e.performStarAction(!e.isStarred)},[e]),r=e=>i.useCallback(t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.performStarAction(!e.isStarred))},[e])})),define("typescript/component_libraries/files_components/src/files-table/index.module.css",["require","exports","css!typescript/component_libraries/files_components/src/files-table/index.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filenameCell=t.fileDataContainer=t.filesTableSelected=t.filesTableActions=t.filesTableCell=t.rowActionMultiple=t.filesTableSelectionCell=t.selectedTableRow=t.tableRow=t.filesTable=void 0,t.filesTable="_filesTable_bgpef_1",t.tableRow="_tableRow_bgpef_5",t.selectedTableRow="_selectedTableRow_bgpef_15",t.filesTableSelectionCell="_filesTableSelectionCell_bgpef_23",t.rowActionMultiple="_rowActionMultiple_bgpef_41",t.filesTableCell="_filesTableCell_bgpef_56",t.filesTableActions="_filesTableActions_bgpef_60",t.filesTableSelected="_filesTableSelected_bgpef_79",t.fileDataContainer="_fileDataContainer_bgpef_83",t.filenameCell="_filenameCell_bgpef_104";t.default={filesTable:"_filesTable_bgpef_1",tableRow:"_tableRow_bgpef_5",selectedTableRow:"_selectedTableRow_bgpef_15",filesTableSelectionCell:"_filesTableSelectionCell_bgpef_23",rowActionMultiple:"_rowActionMultiple_bgpef_41",filesTableCell:"_filesTableCell_bgpef_56",filesTableActions:"_filesTableActions_bgpef_60",filesTableSelected:"_filesTableSelected_bgpef_79",fileDataContainer:"_fileDataContainer_bgpef_83",filenameCell:"_filenameCell_bgpef_104"}})),define("metaserver/static/js/home/starred/starred_item_list",["require","exports","tslib","react","react-dom","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/starred_empty_state","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/home/starred/starred_table","metaserver/static/js/home/starred/starred_files_table","metaserver/static/js/files_page/actionBar/lazy_files_page_action_bar","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/starred/redux/store","metaserver/static/js/starred/redux/slice","metaserver/static/js/home/starred/starred_uri_interface","metaserver/static/js/home/constants","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/home/store","metaserver/static/js/starred/id_type_pair"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemList=void 0,i=n.__importDefault(i),o=n.__importDefault(o);class S extends i.default.PureComponent{constructor(e){super(e),this.addSelectedRow=e=>{this.setState({selectedRows:[...this.state.selectedRows,e]})},this.removeSelectedRow=e=>{const t=[...this.state.selectedRows].filter(t=>{const n=(0,E.idTypePairToString)({type:t.idType,id:t.resourceId});return!(e===n)});this.setState({selectedRows:t})},this.toggleShowAll=()=>n.__awaiter(this,void 0,void 0,(function*(){const e=!this.state.showAll;a.homeActivityLogger.logClickShowAll("starred",e),this.setState({showAll:e});const t=o.default.findDOMNode(this.refs.lastUnhiddenStar);if(t){const e=t.querySelector("a");e&&e.focus()}})),this._LazyFilesActionBar=(0,u.LazyFilesActionBar)(e=>this.setState({actionBarHeight:e})),this.state={showAll:e.showAll,actionBarHeight:0,selectedRows:[]}}render(){var e;const{itemModels:t,useFilesActionTable:n,useStarredActionBar:o,hasRowSelection:u}=this.props,{showAll:E,actionBarHeight:T}=this.state,I=Math.max(t.length-s.INITIAL_STARRED_ITEMS_LIMIT,0),R=I&&!E?t.slice(0,s.INITIAL_STARRED_ITEMS_LIMIT):t,y=o?{height:`calc(100% - ${T}px)`,overflow:"auto"}:{};let b=i.default.createElement(r.StarredEmptyState,null);R.length&&(b=n?i.default.createElement(d.StarredFilesTable,{items:R,addSelectedRow:this.addSelectedRow,removeSelectedRow:this.removeSelectedRow,hasRowSelection:u}):i.default.createElement(c.StarredTable,{items:R,withSelection:!1}));let A=[],C=[];this.state.selectedRows.forEach(e=>{if(C=[...C,e.resourceId],!e||!e.details)return;if(!("fqPath"in e.details))return;const t={file_id:e.details.fqPath,fq_path:e.details.fqPath,is_dir:(0,p.isFolder)(e)};A=[...A,t]});let w=!1,P=!1,F=!1,D=!1;"ON"===m.RECENTS_TABLE_REDESIGN&&(w=!0,P=!0,F=!0,D=!0);let N=this.state.selectedRows[0];this.state.selectedRows.length>1&&(N=void 0);const M=(0,g.getStoreForStarred)(),O={onNetworkRequest:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DELETE_STARRED_ITEM,A.length)},onSuccessResult:()=>{M.dispatch(h.StarredActions.deleteStarredItems({ids:C})),this.setState({selectedRows:[]}),a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DELETE_STARRED_ITEM_SUCCEEDED,A.length)},onError:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DELETE_STARRED_ITEM_FAILED,A.length)},onRequestClose:()=>{}},L={onNetworkRequest:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.MOVE_STARRED_ITEMS,A.length)},onSuccess:(e,t,n)=>{M.dispatch((0,h.getAllStarred)()),a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.MOVE_STARRED_ITEMS_SUCCEEDED,A.length)},onError:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.MOVE_STARRED_ITEMS_FAILED,A.length)}},j={isPaper:!1,onShare:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.CLICK_STAR_HEADER_SHARE,A.length)},origin:f.SHARE_ACTION_ORIGIN_TYPE.STARRED,url:null==N?void 0:N.url,isFolder:null!==(e=N&&(0,p.isFolder)(N))&&void 0!==e&&e},x=N?(e=>{var t;const n=e.details.fqPath;if(n&&e.title)return{currentName:null!==(t=e.title)&&void 0!==t?t:"",fq_path:null!=n?n:"",user:(0,v.getUser)()}})(N):void 0,H={onNetworkRequest:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.RENAME_STARRED_ITEM,A.length)},onSuccess:()=>{M.dispatch((0,h.getAllStarred)()),a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.RENAME_STARRED_ITEM_SUCCEEDED,A.length)},onError:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.RENAME_STARRED_ITEM_FAILED,A.length)}},V=!!x&&!!N,k=N?{href:N.url,source:"starred",isFswm:!1}:void 0,U={onAttempt:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DOWNLOAD_STARRED_ITEM,A.length)},onSuccess:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DOWNLOAD_STARRED_ITEM_SUCCEEDED,A.length)},onError:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.DOWNLOAD_STARRED_ITEM_FAILED,A.length)}},q=!!k;return i.default.createElement("div",{className:"starred",id:S.displayName},o&&i.default.createElement(this._LazyFilesActionBar,{isEnabled:!0,uploadActionEnabled:!0,activeFiles:A,showGoToFolder:w,showDelete:P,deleteCallbacks:O,showMove:F,moveCallbacks:L,source:"starred",showShare:D&&!!N,shareArgs:j,expActionBarRedesignEnabled:!0,showRename:V,renameArgs:x,renameCallbacks:H,showDownload:q,downloadArgs:k,downloadCallbacks:U,showCopyLink:!!N,onCopyLink:()=>{a.homeActivityLogger.logSelectedFilesStarredEvent(_.LoggingTypes.STARRED_COPY_LINK,A.length)},createActionProps:{showSharedFolderCreate:!0,showAutomatedFolderCreate:!0,showCaptureCreate:!0,showPaperCreate:!0,showBinderCreate:!0},actionScreen:"starred_screen"}),i.default.createElement("div",{className:"starred-container",style:y},b,!this.props.showAll&&I?i.default.createElement(l.ShowHideLink,{onClick:this.toggleShowAll,isExpanded:E,hiddenItemCount:I,canLoadMore:!1}):null))}}t.StarredItemList=S,S.displayName="StarredItemList"})),define("metaserver/static/js/home/starred/starred_view",["require","exports","tslib","react","react-redux","metaserver/static/js/files_page/data/store","metaserver/static/js/files_page/data/action_creators","metaserver/static/js/home/constants","metaserver/static/js/home/starred/starred_item_list","metaserver/static/js/home/starred/starred_layout","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/timing_component","metaserver/static/js/starred/redux/store"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredView=t.StarViewWithFilesPage=void 0,i=n.__importDefault(i);class g extends i.default.PureComponent{constructor(e){super(e),this.state={showAll:!1}}render(){const{canRenderItems:e,isHiddenByUser:n,useFilesActionTable:o}=this.props;return i.default.createElement(t.StarViewWithFilesPage,null,i.default.createElement(i.default.Fragment,null,e?i.default.createElement(c.StarredLayout,Object.assign({isHiddenByUser:n,showHeader:!0,starredComponent:l.StarredItemList,useStarredActionBar:!1,useFilesActionTable:o},this.state)):null))}}g.displayName="StarredView";t.StarViewWithFilesPage=({children:e})=>{const t=i.default.useMemo(()=>{(0,m.getStoreForStarred)();const e=(0,s.getStoreForFilesPage)();return e.dispatch((0,r.appInit)({user:(0,d.getUser)()})),e},[]);return i.default.createElement(o.Provider,{store:t},e)},t.StarViewWithFilesPage.displayName="StarViewWithFilesPage",t.StarredView=(0,u.timingComponent)(g,a.HomeSections.STARRED)})),define("metaserver/static/js/home/starred/starred_layout",["require","exports","tslib","react","react-redux","metaserver/static/js/home/actions","metaserver/static/js/home/constants","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/core/i18n","metaserver/static/js/starred/redux/selectors","metaserver/static/js/starred/redux/slice","metaserver/static/js/starred/redux/types","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/home/starred/constants"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLayout=t.STARRED_HEADER_TITLE=void 0,i=n.__importStar(i),t.STARRED_HEADER_TITLE=d.intl.formatMessage({id:"Nd85dl",defaultMessage:"Starred"});t.StarredLayout=({isHiddenByUser:e,starredComponent:n,showHeader:d,showAll:_,useStarredActionBar:f,useFilesActionTable:v})=>{const E=(0,i.useCallback)(()=>{const t=e;s.HomeActions.setSectionVisibility((0,l.getUserId)(),{".tag":"starred"},t),c.homeActivityLogger.logShowHideSection(r.HomeSections.STARRED,!t)},[e]),S=(0,o.useDispatch)();(0,i.useEffect)(()=>{S((0,m.getAllStarred)());const e=()=>{"visible"===document.visibilityState&&S((0,m.getAllStarred)())};return document.addEventListener("visibilitychange",e,!1),function(){document.removeEventListener("visibilitychange",e)}},[]);const T=(0,o.useSelector)(u.getStarredItems),I=(0,o.useSelector)(u.getHasMore),R=(0,o.useSelector)(u.getMetadataLoadingState);(0,i.useEffect)(()=>{if(R===g.StarredLoadingStateEnum.LOAD_SUCCESS){if(h.homeTimingLogger.logTTData(r.HomeSections.STARRED)){const e=T.length>p.INITIAL_STARRED_ITEMS_LIMIT;c.homeActivityLogger.logStarredShown(T.length,e,I),h.homeTimingLogger.logTTI(r.HomeSections.STARRED)}}},[I,T.length,R]);const y=n;return i.default.createElement("section",{className:"home-access-section"},d&&i.default.createElement(a.SectionHeader,{title:t.STARRED_HEADER_TITLE,ueName:"starred",isHidden:e,onToggleHidden:E,ariaControls:y.displayName}),!e&&i.default.createElement(y,{itemModels:T,hasMore:I,showAll:_,useStarredActionBar:f,useFilesActionTable:v}))},t.StarredLayout.displayName="StarredLayout"})),define("metaserver/static/js/home/starred/starred_empty_state",["require","exports","tslib","react","metaserver/static/js/components/ui/section/section_empty_text","metaserver/static/js/core/i18n"],(function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredEmptyState=void 0,i=n.__importDefault(i),t.StarredEmptyState=function(){return i.default.createElement(o.SectionEmptyText,{message:s.intl.formatMessage({id:"bFX0L5",defaultMessage:"When you star items, they’ll show up here for easy access."}),learnMoreLink:"/help/desktop-web/star-doc-file-folder"})}})),define("metaserver/static/js/home/starred/starred_files_table",["require","exports","tslib","react","metaserver/static/js/home/starred/starred_to_ikea","typescript/component_libraries/files_components/src/files-table/files-table","metaserver/static/js/starred/id_type_pair"],(function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredFilesTable=void 0,i=n.__importStar(i);const a={hasSharing:!0,hasStarring:!0,viewExtensions:!1,viewHeaders:!1};t.StarredFilesTable=({items:e,addSelectedRow:t,removeSelectedRow:n,hasRowSelection:l})=>{const c=i.useMemo(()=>e.map(o.starredToIkea),[e]);return i.createElement(s.FilesTable,Object.assign({items:c},a,{addSelectedRow:n=>{const i=(t=>e.filter(e=>t===(0,r.idTypePairToString)({type:e.idType,id:e.resourceId}))[0])(n);i&&(null==t||t(i))},removeSelectedRow:e=>{null==n||n(e)},hasRowSelection:null!=l&&l}))},t.StarredFilesTable.displayName="StarredFilesTable"})),define("typescript/component_libraries/files_components/src/table/plugins/starring",["require","exports","tslib","react","react-redux","typescript/component_libraries/files_components/src/buttons/star_button","typescript/component_libraries/files_components/src/table/columns/file_name_column"],(function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UseStarring=void 0,i=n.__importStar(i);t.UseStarring=({columns:e})=>{e.push(a)},t.UseStarring.pluginName="UseStarring";const a=e=>e.map(e=>{if(e.id!==r.FileNameColumn.id)return e;const t=e.Cell;return t&&"function"==typeof t?Object.assign(Object.assign({},e),{Cell:e=>{const n=e.row.original,o=l(n),a=c(n);return i.createElement(i.Fragment,null,t(e),i.createElement(s.StarButton,{isStarred:!!n.isStarred,isDisabled:!n.isStarrable,tabIndex:0,onClick:o,onKeyPress:a,ariaLabelledBy:(0,r.getLabelIDFromRowIndex)(e.row.index)}))}}):e}),l=e=>{const t=(0,o.useDispatch)();return i.useCallback(n=>{n.preventDefault(),n.stopPropagation(),e.performStarAction(!e.isStarred,t)},[e])},c=e=>{const t=(0,o.useDispatch)();return i.useCallback(n=>{"Enter"===n.key&&(n.preventDefault(),n.stopPropagation(),e.performStarAction(!e.isStarred,t))},[e])}})),define("metaserver/static/js/home/starred/starred_table",["require","exports","tslib","react","typescript/component_libraries/dig-experimental/src/managed_table/index","typescript/component_libraries/files_components/src/table/columns/file_name_column","typescript/component_libraries/files_components/src/table/plugins/starring","metaserver/static/js/components/ui/css","metaserver/static/js/home/starred/starred_to_ikea"],(function(e,t,n,i,o,s,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredTable=void 0,i=n.__importStar(i);const c=(0,o.createManagedTable)(r.UseStarring,o.useHoverActions,o.useLinkBehavior,o.useKeyboarding),d=e=>{var{data:t,columns:s}=e,a=n.__rest(e,["data","columns"]);const l=(0,o.useManagedTable)({columns:s,data:t},r.UseStarring,o.useHoverActions,o.useLinkBehavior,o.useKeyboarding,o.useFlexLayout,o.useRowSelect);return i.createElement(o.UnmanagedTable,Object.assign({instance:l},a))},u=[s.FileNameColumn],m=[o.rowSelectionColumn,s.FileNameColumn],g=({items:e,withSelection:t=!1})=>{const n=i.useMemo(()=>e.map(l.starredToIkea),[e]);return t?i.createElement(d,{isSelectable:!0,showHeader:!1,columns:m,data:n}):i.createElement(c,{isSelectable:!0,showHeader:!1,columns:u,data:n})};g.displayName="StarredTableNoCss",t.StarredTable=(0,a.requireCssWithComponent)(g,["/static/typescript/component_libraries/dig-experimental/src/index.web-vfl_m6TBk.css"])})),define("metaserver/static/js/home/starred/starred_to_ikea",["require","exports","tslib","react","classnames","dig-components/hooks","metaserver/static/js/home/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/home/store","metaserver/static/js/core/i18n","dig-components/buttons","metaserver/static/js/home/post_tti/api","metaserver/static/js/clean/navigation","js/filepath/filepath","metaserver/static/js/home/util/paper_utils","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/starred/starred_uri_interface","metaserver/static/js/edison/ui/router_utils","metaserver/static/js/clean/history_singleton","metaserver/static/js/starred/redux/slice","typescript/component_libraries/files_components/src/table/columns/file_name_column","metaserver/static/js/starred/redux/store","metaserver/static/js/files_page/actionBar/lazy_files_page_action_bar","metaserver/static/js/sharing/views/copy_link_mini_modal/copy_link_mini_modal","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/util/file_utils","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/home/constants"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f,v,E,S,T,I,R,y,b,A,C,w,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredToIkea=void 0,i=n.__importStar(i),o=n.__importDefault(o);t.starredToIkea=(e,t)=>{var n,o;const s=Object.assign(Object.assign({},e),{index:t}),r=null===(n=e.details)||void 0===n?void 0:n.fqPath,c=(0,I.getStoreForStarred)(),d=()=>{if(e&&e.idType===A.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&e.title&&r)return(0,C.getFileFromPartial)({file_id:e.resourceId,ext:"."+(0,g.file_extension)(e.title),ns_id:void 0,ns_path:void 0,fq_path:r})},u=(()=>{var t;return!!e.isMounted&&(null===(t=e.perNodeMetadata)||void 0===t?!0:!t.suppress_share)})();return{uniqueKey:(0,a.idTypePairToString)({type:e.idType,id:e.resourceId}),title:e.title,extension:(0,g.file_extension)(r||""),isFolder:(0,f.isFolder)(e),isStarred:!0,isStarrable:!0,isShareable:u,isCheckable:e.isMounted,url:(0,f.href_for_file)((0,l.getUser)(),e),performOpenAction:(e,t)=>O(s,e,t),performStarAction:e=>M(s,e),performShareAction:()=>D(s),icon:e.icon,ariaLabelledBy:(0,T.getLabelIDFromRowIndex)(t),renderHoverActions:()=>i.createElement(F,{item:s,index:t}),renderInlineActionMenu:"ON"===b.RECENTS_TABLE_REDESIGN?()=>{var t,n,o,a;const u={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM,...L(s))},onSuccessResult:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM_SUCCEEDED,...L(s)),c.dispatch(S.StarredActions.deleteStarredItem({id:e.resourceId}))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DELETE_STARRED_ITEM_FAILED,...L(s))},onRequestClose:()=>{}},m={href:e.url,source:"starred",isFswm:!1};let g=void 0;m&&(g={onAttempt:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM,...L(s))},onSuccess:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM_SUCCEEDED,...L(s))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.DOWNLOAD_STARRED_ITEM_FAILED,...L(s))}});const h=(()=>{var t;if(!r||!e.title)return;return{currentName:null!==(t=e.title)&&void 0!==t?t:"",fq_path:null!=r?r:"",user:(0,l.getUser)()}})(),p={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM,...L(s))},onSuccess:e=>{c.dispatch((0,S.getAllStarred)()),_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM_SUCCEEDED,...L(s))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.RENAME_STARRED_ITEM_FAILED,...L(s))}},v=!!h,E={onNetworkRequest:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS,...L(s))},onSuccess:(e,t,n)=>{c.dispatch((0,S.getAllStarred)()),_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS_SUCCEEDED,...L(s))},onError:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.MOVE_STARRED_ITEMS_FAILED,...L(s))}},T=(0,R.LazyFilesActionBar)(),I=(()=>{const e=d();return e?i.createElement(w.UnconnectedExtensionsMenu,{className:"hacky-ext-menu",user:(0,l.getUser)(),file:e,telemetryContext:{surface:"home_starred"}}):null})();return i.createElement(i.Fragment,null,I,i.createElement(T,{isEnabled:!0,showGoToFolder:null!==(t=e.isMounted)&&void 0!==t&&t,onGoToFolder:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.GO_TO_FOLDER,...L(s))},uploadActionEnabled:!1,activeFiles:r?[{fq_path:r,is_dir:(0,f.isFolder)(e),file_id:r}]:void 0,showDelete:!0!==(null===(n=e.perNodeMetadata)||void 0===n?void 0:n.suppress_delete),showDownload:!(0,f.isFolder)(e)&&null!==(o=e.isMounted)&&void 0!==o&&o&&!(null===(a=e.icon)||void 0===a?void 0:a.includes("paper")),deleteCallbacks:u,downloadArgs:m,downloadCallbacks:g,showRename:v,renameArgs:h,renameCallbacks:p,onExtensionClick:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.STARRED_OPEN_IN,...L(s))},file:d(),showMove:!0,moveCallbacks:E,source:"starred",suppressTopLevel:!0,actionScreen:"starred_screen"}))}:void 0,performCopyLinkAction:"ON"===b.RECENTS_TABLE_REDESIGN&&!0!==(null===(o=e.perNodeMetadata)||void 0===o?void 0:o.suppress_shared_link)?e=>{const t={user:(0,l.getUser)(),setIsCreatingSharedLink:(e,t)=>{},anchorRef:e,onActionFlowComplete:()=>{_.homeActivityLogger.logStarredEvent(P.LoggingTypes.STARRED_COPY_LINK,...L(s))},filePath:r};y.CopyLinkMiniModal.show(t)}:void 0}};const F=({item:e,index:t})=>{const n=(0,s.useUniqueId)({prefix:"starred__action-item-"});return i.createElement(d.Button,{id:n,onClick:()=>D(e),onKeyPress:t=>N(t,e),variant:"opacity","aria-labelledby":(0,o.default)(n,(0,T.getLabelIDFromRowIndex)(t))},c.intl.formatMessage({id:"At94iP",defaultMessage:"Share"}))};F.displayName="StarredHoverActions";const D=e=>{if(e.displayType===r.PAPER_DOCUMENT_RESOURCE_TYPE)return void(0,h.sharePaperDoc)(e.url,()=>j(e));j(e);const t=(0,f.isFolder)(e)?e.details.targetNsId:null,n=e.details.fqPath;(0,u.waitForHomeTTI)().then(i=>{i.asyncShowShareModal((0,l.getUser)(),{fqPath:n,isFolder:(0,f.isFolder)(e),targetNsId:t},{origin:p.SHARE_ACTION_ORIGIN_TYPE.STARRED})})},N=(e,t)=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),D(t))},M=(e,t)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=(0,I.getStoreForStarred)();yield n.dispatch((0,S.updateStarredStatus)({id:e.resourceId,idType:e.idType,newStatus:t,itemName:e.title,showSnackbar:!0}))})),O=(e,t,n)=>{if(r.DisplayTypeToResourceType[e.displayType]!==r.FILE_RESOURCE_TYPE||t){const{host:n,pathname:i}=new URL(e.url);!t&&window.location.host===n&&(0,v.shouldUseReactRouter)(i)?(x(e),(0,E.getBrowserHistory)().push(i)):(0,m.logAndNavigate)(e.url,()=>x(e),t?m.NavigationMethod.NEW_TAB:m.NavigationMethod.REDIRECT)}else(0,u.waitForHomeTTI)().then(t=>t.openInFileViewer({resourceId:(0,a.idTypePairToString)({type:e.idType,id:e.resourceId}),logViewFunction:()=>x(e),href:null==n?void 0:n.href,middleClick:null==n?void 0:n.middleClick}))},L=e=>[e.resourceId,r.DisplayTypeToResourceType[e.displayType],e.index],j=e=>_.homeActivityLogger.logClickStarOverflowShare(...L(e)),x=e=>_.homeActivityLogger.logOpenStarredItem(...L(e))})),define("metaserver/static/js/home/util/paper_utils",["require","exports","metaserver/static/js/clean/navigation"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharePaperDoc=void 0,t.sharePaperDoc=function(e,t){(0,n.logAndNavigate)(`${e}?openSharing=1`,t)}})),define("metaserver/static/js/home/starred/starred_uri_interface",["require","exports","metaserver/static/js/home/constants","metaserver/static/js/clean/browse_uri_interface"],(function(e,t,n,i){"use strict";function o(e){return n.DisplayTypeToResourceType[e.displayType]===n.FOLDER_RESOURCE_TYPE}Object.defineProperty(t,"__esModule",{value:!0}),t.isFolder=t.href_for_file=void 0,t.href_for_file=function(e,t,n={}){var s;if(o(t))return t.url;const r=null===(s=t.details)||void 0===s?void 0:s.fqPath;return r?(0,i.preview_uri_for_fq_path)(e,r,n).toString():t.url},t.isFolder=o})),define("typescript/component_libraries/files_components/src/buttons/star_button",["require","exports","tslib","react","classnames","react-intl","dig-components/hooks","dig-components/tooltips","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,n,i,o,s,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarButton=void 0,i=n.__importStar(i),o=n.__importDefault(o);t.StarButton=({isStarred:e,onClick:t,onKeyPress:n,isDisabled:m,tabIndex:g=-1,showTooltip:h=!0,ariaLabelledBy:p})=>{const _=(0,r.useUniqueId)({prefix:"star-button-"}),f=(0,s.useIntl)(),v=u(f,e,m);let E=i.createElement(l.IconButton,{variant:"transparent",role:"button","aria-pressed":e,"aria-label":v,onClick:t,onKeyPress:n,disabled:m,tabIndex:g,"data-testid":"star__toggle",id:_,"aria-labelledby":(0,o.default)(_,p)},i.createElement(c.UIIcon,{src:e?d.StarFill:d.StarLine}));return h&&(E=i.createElement(a.Tooltip,{title:v,placement:"top"},E)),E},t.StarButton.displayName="StarButton";const u=(e,t,n)=>n?t?e.formatMessage({id:"d/rfbV",defaultMessage:"Starred"}):void 0:t?e.formatMessage({id:"U3Qbdz",defaultMessage:"Remove from Starred"}):e.formatMessage({id:"QY29C7",defaultMessage:"Add to Starred"})})),define("js/common/uuid",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=void 0,t.generateUUID=function(e){const t=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1),n=t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t();return e?e+n:n}})),define("typescript/component_libraries/files_components/src/common/file",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCopylinkableFile=t.isShareableFile=t.isStarrableFile=t.isOpenable=t.isCollection=void 0,t.isCollection=function(e){return!!e.attachmentIds},t.isOpenable=function(e){return!!e.performOpenAction},t.isStarrableFile=function(e){return!!e.performStarAction},t.isShareableFile=function(e){return e.isShareable},t.isCopylinkableFile=function(e){return void 0!==e.performCopyLinkAction}})),define("metaserver/static/js/home/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/core/notify","metaserver/static/js/home/api_post_tti","metaserver/static/js/core/i18n"],(function(e,t,n,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSectionVisibilityHelper=t.setSectionVisibilityPostTTI=void 0;t.setSectionVisibilityPostTTI=(e,i,o)=>{(0,t.setSectionVisibilityHelper)(e,i,o,()=>n.__awaiter(void 0,void 0,void 0,(function*(){return r.setSectionVisibility})))};t.setSectionVisibilityHelper=(e,t,r,l)=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=t[".tag"];i.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:n,visible:r}});try{yield(yield l())(e,t,r)}catch(e){const t=r?a.intl.formatMessage({id:"D9XHqB",defaultMessage:"Unable to show section."}):a.intl.formatMessage({id:"W8LAoH",defaultMessage:"Unable to hide section."});throw s.Notify.error(t),i.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:n,visible:!r}}),e}}))})),define("metaserver/static/js/home/actions",["require","exports","tslib","metaserver/static/js/modules/constants/env","metaserver/static/js/core/uri","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/actions_post_tti","metaserver/static/js/clean/viewer"],(function(e,t,n,i,o,s,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeActions=void 0;t.HomeActions=class{static setSectionVisibility(e,t,i){return n.__awaiter(this,void 0,void 0,(function*(){(0,l.setSectionVisibilityHelper)(e,t,i,()=>n.__awaiter(this,void 0,void 0,(function*(){const{setSectionVisibility:e}=yield(0,a.waitForHomeTTI)();return e})))}))}static createPaperDocInNewTab(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=s.intl.formatMessage({id:"PhUVTN",defaultMessage:"Could not create paper document."}),n=window.open("about:blank");try{const{createPaperDoc:s}=yield(0,a.waitForHomeTTI)(),l=yield s(e),d=c.Viewer.get_viewer(),u=d.get_user_by_id(e),m=d.is_paired?{role:u.role}:{};if(n&&!n.closed){const e=new o.URI({scheme:"https",authority:i.NOTES_WEBSERVER,path:"/doc/"+l.doc_id,query:m}).toString();n.location.replace(e)}else r.Notify.error(t)}catch(e){if(r.Notify.error(t),n&&!n.closed)return n.close()}}))}}})),define("metaserver/static/js/home/api_post_tti",["require","exports","metaserver/static/js/api_v2/user_client"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPaperDoc=t.setSectionVisibility=void 0;t.setSectionVisibility=(e,t,i)=>(new n.UserApiV2Client).ns("home").rpc("set_section_visibility",{section:t,visible:i},{subjectUserId:e});t.createPaperDoc=e=>(new n.UserApiV2Client).ns("paper").upload("docs/create",{import_format:{".tag":"plain_text"}},"",{subjectUserId:e})})),define("metaserver/static/js/home/recents/actions/error_actions",["require","exports","tslib","lodash","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/core/exception","metaserver/static/js/core/i18n","metaserver/static/js/core/notify"],(function(e,t,n,i,o,s,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorActions=t.ErrorActions=void 0,i=n.__importStar(i),r=n.__importStar(r);class c{constructor(e){this._flushQueues=()=>{this._rafId=null;const e=this._recentActivityQueue;this._recentActivityQueue=[],e.length&&this._dispatcher.dispatch({type:o.RAW_RECENT_ACTIVITY_PARSE_ERROR,errors:e});const t=this._relatedActivityQueue;this._relatedActivityQueue=[],t.length&&this._dispatcher.dispatch({type:o.RAW_RELATED_ACTIVITY_PARSE_ERROR,errors:t})},this._notify=i.throttle(()=>{const e=a.intl.formatMessage({id:"QANSaH",defaultMessage:"Sorry, we were unable to show some recent items. The team has been notified"});l.Notify.error(e)},500,{trailing:!1}),this._dispatcher=e,this._recentActivityQueue=[],this._relatedActivityQueue=[],this._rafId=null}recentActivityParseError(e,t){r.reportException({err:t}),this._notify(),this._enqueueError(this._recentActivityQueue,e,t)}relatedActivityParseError(e,t){r.reportException({err:t}),this._notify(),this._enqueueError(this._relatedActivityQueue,e,t)}_enqueueError(e,t,n){e.push({activityKey:t,error:n}),this._rafId||(this._rafId=window.requestAnimationFrame(this._flushQueues))}}t.ErrorActions=c,t.errorActions=new c(s.recentActivityDispatcher)})),define("metaserver/static/js/home/recents/actions/federated_recent_activity_actions",["require","exports","tslib","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/components/ui/modal","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_federated_model","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/core/exception","metaserver/static/js/core/notify","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/post_tti/api"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g){"use strict";function h(e,t,n){e?o.open_tab(e):(0,d.reportStack)(`Cannot open tab to preform the action ${t}`,{severity:d.SEVERITY.NONCRITICAL,exc_extra:{paperRecentItem:n.paperRecentItem}})}function p(e,t,n){"cellView"in n?(0,m.logFederatedItemEvent)(e,n.cellView,t):(0,m.logCleanFederatedItemEvent)(e,n.itemNumber,n.subgroupPosition,t)}function _(e,t){a.recentActivityDispatcher.dispatch({type:e,activityKey:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.promptAndArchiveItem=t.previewItem=t.shareItem=void 0,o=n.__importStar(o),t.shareItem=function(e,t){p(r.ActionType.PAPER_SHARE,e,t),h((0,l.getPaperShareUrl)(e),r.ActionType.PAPER_SHARE,e)},t.previewItem=function(e,t){p(r.ActionType.PAPER_OPEN,e,t),h(e.getUrl(),r.ActionType.PAPER_OPEN,e)},t.promptAndArchiveItem=function(e,t,o){const a=e.getActivityKey();if((0,c.getRecentActivityStore)().canArchiveActivityKey(a)){const a=e.getActivityKey();s.SimpleModal.show({title_text:i.intl.formatMessage({id:"bArtK/",defaultMessage:"Archive document?"}),body_html:i.intl.formatMessage({id:"S6cb1J",defaultMessage:"Do you want to archive this document?"}),confirm_text:i.intl.formatMessage({id:"JiHG/V",defaultMessage:"Archive"}),cancel_text:i.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),autoclose:!0,confirm_callback:()=>n.__awaiter(this,void 0,void 0,(function*(){p(r.ActionType.PAPER_ARCHIVE,e,o),_(r.ARCHIVE_PAPER_DOCUMENT_PENDING,a);try{(yield(yield(0,g.waitForHomeTTI)()).archivePaperResources(t,[e.paperRecentItem])).some(t=>(0,l.equalsPaperRecentItem)(e,t))?(_(r.ARCHIVE_PAPER_DOCUMENT_COMMIT,a),u.Notify.success(i.intl.formatMessage({id:"r3vKLt",defaultMessage:"The document was archived."}))):_(r.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,a)}catch(e){_(r.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,a)}}))})}}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions",["require","exports","tslib","lodash","metaserver/static/js/clean/navigation","metaserver/static/js/pnm/utils","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/actions/federated_recent_activity_actions","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/plusplus/logging","metaserver/static/js/core/exception"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refreshRecentItems=t.openVersions=t.downloadFiles=t.openFile=t.hasCursor=t.loadNextPage=t.archiveRecentItem=t.deleteRecentItem=t.previewRecentItem=t.shareRecentItem=void 0,i=n.__importStar(i),t.shareRecentItem=function(e,t,i,o){return n.__awaiter(this,void 0,void 0,(function*(){e.federatedRecentItem?(0,a.shareItem)(e.federatedRecentItem,i):yield(yield(0,r.waitForHomeTTI)()).shareFile(t[0].id,i,o)}))},t.previewRecentItem=function(e,t,i,{isMetaClick:o,href:l,middleClick:c}){if((0,s.isSupportedLinkNodeClickAction)(e.perNodeMetadata))(0,r.waitForHomeTTI)().then(({handleLinkNodeAction:t})=>n.__awaiter(this,void 0,void 0,(function*(){t(e.perNodeMetadata,t=>{(0,u.logProductAnalytics)(e.viewingUserId,"web","select",t,"recents")})})));else if(e.federatedRecentItem)(0,a.previewItem)(e.federatedRecentItem,i);else if(1===e.attachmentIds.length)(0,r.waitForHomeTTI)().then(({previewFileSyncRecentItem:n})=>n(e,!!o,t,i,l,c));else{const{index:n,shouldUseEntityUri:i}=t;(0,m.reportStack)("To preview, file sync items must have 1 attachment id",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,index:n,shouldUseEntityUri:i}})}},t.deleteRecentItem=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function*(){(0,r.waitForHomeTTIWithProps)().then(({imports:o,props:a})=>{o.deleteRecentItem(e,t,i,a),(function(e){if(!(0,s.isPreSetupLinkNode)(e.perNodeMetadata))return;(0,r.waitForHomeTTI)().then(({getLinkNodeEventObject:t})=>n.__awaiter(this,void 0,void 0,(function*(){const n=t(e.perNodeMetadata);n&&(0,u.logProductAnalytics)(e.viewingUserId,"web","delete",n,"recents")})))})(e)})}))},t.archiveRecentItem=function(e,t){e.federatedRecentItem?(0,a.promptAndArchiveItem)(e.federatedRecentItem,e.viewingUserId,t):(0,m.reportStack)("Archiving is not supported",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}})},t.loadNextPage=function(){const e=(0,d.getRecentActivityStore)().getFileSyncCursor();return e&&(0,r.waitForHomeTTI)().then(({loadRecentItems:t})=>t(e)),!!e},t.hasCursor=function(){return!!(0,d.getRecentActivityStore)().getFileSyncCursor()},t.openFile=function(e,t,o=i.noop){return n.__awaiter(this,void 0,void 0,(function*(){yield(yield(0,r.waitForHomeTTI)()).openFile(e,t),o()}))},t.downloadFiles=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){(yield(0,r.waitForHomeTTI)()).downloadFiles(e,t)}))},t.openVersions=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){(yield(0,r.waitForHomeTTI)()).openVersions(o.NavigationMethod.REDIRECT,e,t)}))},t.refreshRecentItems=function(){return n.__awaiter(this,void 0,void 0,(function*(){if((0,d.getRecentActivityStore)().didReceiveItemsFromAllStreams()){c.recentActivityDispatcher.dispatch({type:l.REFRESH_RECENT_ACTIVITIES});const{loadRecentItems:e,loadPaperRecentItems:t}=yield(0,r.waitForHomeTTI)();yield Promise.all([e(),t(!1)])}}))}})),define("metaserver/static/js/home/recents/components/pending_attachment_list_view",["require","exports","tslib","react"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendingAttachmentListView=void 0,i=n.__importDefault(i);class o extends i.default.Component{render(){const{count:e}=this.props;return i.default.createElement("ul",{className:"recents-item__attachments"},new Array(Math.min(e,4)).fill(null).map((e,t)=>i.default.createElement("li",{className:"recents-item__attachment-item",key:t})))}}t.PendingAttachmentListView=o,o.displayName="PendingAttachmentListView"})),define("metaserver/static/js/home/recents/components/recent_activity_container",["require","exports","tslib","classnames","react","react-dom","dig-components/progress_indicators","metaserver/static/js/home/actions","metaserver/static/js/home/constants","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/actions/recent_activity_actions","metaserver/static/js/home/recents/components/recent_activity_item_container","metaserver/static/js/home/recents/stores/recent_activity_store","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/home/store","metaserver/static/js/components/ui/section/section_empty_text","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/logging/timing_component","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/core/i18n","spectrum/media_table_skeleton/index","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/home/util/conditional_api","metaserver/static/js/home/recents/components/recents_files_table","metaserver/static/js/starred/redux/slice","metaserver/static/js/starred/redux/store"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f,v,E,S,T,I,R,y,b,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityContainerInSearchEmptyState=t.RecentActivityContainer=t.RecentActivityContainerInner=void 0,i=n.__importDefault(i),o=n.__importDefault(o),s=n.__importDefault(s);class C extends o.default.PureComponent{constructor(e){super(e),this.onShouldLoadMore=()=>{const e=(0,m.getRecentActivityStore)();if(!this.state.isPending&&this.state.showAll&&!e.didTruncateRecentItems()&&e.didReceiveItemsFromAllStreams()){const{items:t}=e.getRecentItems();t.length>this.state.items.length?this.setState({items:t}):(0,d.loadNextPage)()&&this.setState({isPending:!0})}},this.onChangeRecentsVisibility=()=>{const e=!this.props.isHiddenByUser;a.HomeActions.setSectionVisibility((0,h.getUserId)(),{".tag":"recents"},!e),_.homeActivityLogger.logShowHideSection(l.HomeSections.RECENTS,e)},this.handleVisibilityChange=()=>{"visible"===document.visibilityState&&((0,d.refreshRecentItems)(),this.fetchStarred())},this.onStoreUpdate=()=>{this.setState(this.getStateFromStore()),this.fetchStarred()},this.onShowAll=()=>{this.setState({showAll:!0});const e=s.default.findDOMNode(this.refs.lastUnhiddenActivity);if(e){const t=e.querySelector("a");t&&t.focus()}},this.removeStoreListeners=(0,m.getRecentActivityStore)(this.props.skipPrefetch).addListener(this.onStoreUpdate),this.state=Object.assign(Object.assign({},this.getStateFromStore()),{isUnityAvailable:!1,showAll:!!e.showAll})}componentDidMount(){this.props.isHiddenByUser&&v.homeTimingLogger.logSkippedSection(l.HomeSections.RECENTS),(0,c.waitForHomeTTI)().then(e=>n.__awaiter(this,void 0,void 0,(function*(){e.recentActivityContainerComponentDidMount(this.onShouldLoadMore),(yield e.getUnityFeatures())&&this.setState({isUnityAvailable:!0})}))),!this.state.items.length&&(0,m.getRecentActivityStore)().didReceiveItemsFromAllStreams()&&this.setState({isPending:!1}),(0,d.refreshRecentItems)(),this.fetchStarred(),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)}componentWillUnmount(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.removeStoreListeners()}fetchStarred(){if("ON"===I.RECENTS_TABLE_REDESIGN){const e=(0,A.getStoreForStarred)();return e.dispatch((0,b.fetchMissingStarredStatuses)(this.state.items.filter(({resourceId:e,idType:t})=>e&&t).filter(e=>!w(e)).map(({resourceId:e,idType:t})=>({id:e,type:t})))),void this.state.items.filter(w).forEach(t=>{const{resource_id:n,isFavorite:i}=t.federatedRecentItem.paperRecentItem;e.dispatch(b.StarredActions.setStarredStatus({id:n,isStarred:i}))})}(0,R.waitForStarred)(({getStoreForStarred:e,fetchMissingStarredStatuses:t,StarredActions:n})=>{const i=e();i.dispatch(t(this.state.items.filter(({resourceId:e,idType:t})=>e&&t).filter(e=>!w(e)).map(({resourceId:e,idType:t})=>({id:e,type:t})))),this.state.items.filter(w).forEach(e=>{const{resource_id:t,isFavorite:o}=e.federatedRecentItem.paperRecentItem;i.dispatch(n.setStarredStatus({id:t,isStarred:o}))})})}getStateFromStore(){const e=(0,m.getRecentActivityStore)(),t=!e.didReceiveItemsFromAllStreams(),{items:n}=e.getRecentItems();if(!t&&!this.props.skipPrefetch){if(v.homeTimingLogger.logTTData(l.HomeSections.RECENTS)){const e=n.length;e&&_.homeActivityLogger.logRecentsShown(e,!(0,h.getHomeStore)().getSectionVisibility()[l.HomeSections.RECENTS])}}return{isPending:t,items:n}}renderLoadingView(){const{showSkeletonWhenLoading:e}=this.props;return o.default.createElement("div",{className:"recents-loading-view",key:"loading"},e?o.default.createElement(T.MediaTableSkeletonRow,null):o.default.createElement(r.Spinner,{size:"small","aria-valuetext":S.intl.formatMessage({id:"k2bVak",defaultMessage:"Loading your recent items"})}))}renderItems(){const{now:e,fullItemView:t,loggedComponentName:n,asyncRenderStar:i}=this.props,{items:s,showAll:r,isUnityAvailable:a}=this.state,l={isUnityAvailable:a,now:e,user:(0,h.getUser)()},c=t?10:5,d=r?s:s.slice(0,c);return"ON"===I.RECENTS_TABLE_REDESIGN?o.default.createElement(y.RecentsFilesTable,{renderingInfo:l,items:d,addSelectedRow:this.props.addSelectedRow,removeSelectedRow:this.props.removeSelectedRow,hasRowSelection:this.props.hasRowSelection,hasStarring:this.props.hasStarring}):o.default.createElement("ul",null,d.map((e,s)=>o.default.createElement(u.RecentActivityItemContainer,{key:e.id,recentItem:e,renderingInfo:l,fullItemView:t,ref:9===s?"lastUnhiddenActivity":void 0,loggedComponentName:n,asyncRenderStar:i})))}renderShowMoreLink(){const{items:e,showAll:t}=this.state,n=Math.max(e.length-10,0);return this.props.fullItemView?t||!(0,d.hasCursor)()&&n<=0?null:o.default.createElement(E.ShowHideLink,{key:"show_more",onClick:this.onShowAll,isExpanded:!1,hiddenItemCount:n,canLoadMore:!0}):null}renderContent(){const{isPending:e,items:t}=this.state;return t.length?[this.renderItems(),this.renderShowMoreLink(),e&&this.renderLoadingView()]:e?this.renderLoadingView():o.default.createElement(p.SectionEmptyText,{message:S.intl.formatMessage({id:"hFDfoh",defaultMessage:"Items you recently viewed show up here."}),learnMoreLink:"/help/desktop-web/recents-overview"})}render(){const{canRenderItems:e,isHiddenByUser:t,showHeader:n,className:s}=this.props;if(!e)return null;const{isPending:r,items:a}=this.state,l=(0,i.default)({"home-recents-section__container":!0,"recents-view":!0,"recents-view--is-pending":r&&0===a.length}),c=(0,i.default)("home-access-section home-recents-section",s);return o.default.createElement("section",{className:c},n?o.default.createElement(g.SectionHeader,{title:S.intl.formatMessage({id:"hApMtp",defaultMessage:"Recent"}),ueName:"recents",isHidden:t,onToggleHidden:this.onChangeRecentsVisibility,ariaControls:"RecentActivityContainerInner"}):null,o.default.createElement("div",{className:"home-access-section__content",id:"RecentActivityContainerInner"},!t&&o.default.createElement("div",{className:l},this.renderContent())))}}t.RecentActivityContainerInner=C,C.displayName="RecentActivityContainer";const w=e=>{var t;return void 0!==(null===(t=null==e?void 0:e.federatedRecentItem)||void 0===t?void 0:t.paperRecentItem)};t.RecentActivityContainer=(0,f.timingComponent)(C,l.HomeSections.RECENTS),t.RecentActivityContainerInSearchEmptyState=C})),define("metaserver/static/js/home/recents/components/recent_activity_item_actions_view",["require","exports","tslib","react","classnames","lodash","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/core/i18n"],(function(e,t,n,i,o,s,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemActionsView=void 0,i=n.__importDefault(i),o=n.__importDefault(o);const u=e=>{e.stopPropagation(),e.preventDefault()},m=(e,t)=>{u(t),e(t)},g=e=>t=>t.permissions[e],h=[{name:"handleDownload",label:d.intl.formatMessage({id:"iFX+XI",defaultMessage:"Download"}),shouldRender:g("download")},{name:"handleComment",label:d.intl.formatMessage({id:"tJzlWE",defaultMessage:"Comment"}),shouldRender:g("comment")},{name:"handleDelete",label:d.intl.formatMessage({id:"NQS3dU",defaultMessage:"Delete all…"}),shouldRender:e=>e.permissions.delete&&e.attachmentCount>1},{name:"handleDelete",label:d.intl.formatMessage({id:"Ieup/u",defaultMessage:"Delete…"}),shouldRender:e=>e.permissions.delete&&e.attachmentCount<=1},{name:"handleArchive",label:d.intl.formatMessage({id:"CvAVX3",defaultMessage:"Archive"}),shouldRender:g("archive")},{name:"handleVersions",label:d.intl.formatMessage({id:"jId+M1",defaultMessage:"Version history"}),shouldRender:g("versions")},{name:"handleViewInFolder",label:d.intl.formatMessage({id:"3Dgw+C",defaultMessage:"View in folder"}),shouldRender:g("viewInFolder")}];t.RecentActivityItemActionsView=e=>{if(e.disableActions)return null;const t=h.filter(t=>t.shouldRender(e)),n=(0,s.uniqueId)("recents-item__unportaled-menu-button-");return t.length?i.default.createElement(c.Menu.Wrapper,{className:"recents-item__unportaled-menu",onSelection:m,isPortaled:!1},({getContentProps:m,getTriggerProps:g})=>i.default.createElement(i.default.Fragment,null,i.default.createElement(r.IconButton,Object.assign({id:n,variant:"transparent"},g({onClick:u}),{"aria-label":d.intl.formatMessage({id:"mnOOD/",defaultMessage:"More actions"}),"aria-labelledby":(0,o.default)(n,e.arialabelledby)}),i.default.createElement(a.UIIcon,{src:l.MoreHorizontalLine})),i.default.createElement(c.Menu.Content,Object.assign({},m({onClick:u}),{placement:"bottom-end"}),i.default.createElement(c.Menu.Segment,null,t.map(({name:t,label:n})=>{const r=(0,s.uniqueId)("recents-item__action-item-");return i.default.createElement(c.Menu.ActionItem,{id:r,key:t,value:e.handler[t],"aria-labelledby":(0,o.default)(r,e.arialabelledby)},n)}))))):null},t.RecentActivityItemActionsView.displayName="RecentActivityItemActionsView"})),define("metaserver/static/js/home/recents/components/recent_activity_item_container",["require","exports","tslib","lodash","react","metaserver/static/js/core/assert","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/actions/recent_activity_actions","metaserver/static/js/home/recents/components/recent_activity_item_view","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/post_tti/api"],(function(e,t,n,i,o,s,r,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemContainer=void 0,i=n.__importStar(i),o=n.__importDefault(o);class m extends o.default.PureComponent{constructor(e){super(e),this.onAttachmentStoreChange=()=>{this.setState({attachments:(0,d.getAttachmentStore)().getByIds(this.getRecentItem().attachmentIds)})},this.handleArchive=()=>(0,a.archiveRecentItem)(this.getRecentItem(),this.getLogData()),this.handleComment=()=>{const e=this.getSingleAttachment("handleComment only supports a single attachment"),t=Math.max(0,this.state.attachments.indexOf(e));this.previewOrOpenFiles({index:t,isCommentAction:!0},{isMetaClick:!1,href:void 0,middleClick:!1})},this.handleDelete=()=>{(0,a.deleteRecentItem)(this.getRecentItem(),this.state.attachments,this.getLogData())},this.handleDownload=()=>{const e=this.getSingleAttachment("handleDownload only supports a single attachment");(0,a.downloadFiles)([e.id],this.getLogData())},this.handleHeaderClick=()=>{const{isCollapsed:e,attachments:t}=this.state,n=e?r.ActionType.UNCOLLAPSE:r.ActionType.COLLAPSE;(0,c.logEvent)(n,this,this.state.attachments,t.length),this.setState({isCollapsed:!e})},this.handleOpen=()=>{const e=this.getSingleAttachment("handleOpen only supports a single attachment");(0,a.openFile)(e.id,this.getLogData())},this.handlePathClick=e=>{const t=this.getAttachmentFqPaths(),{recentItem:n}=this.props,{attachmentIds:i,viewingUserId:o}=n;(0,u.waitForHomeTTI)().then(({logOpenPathUrl:n,openUrl:s})=>{n(o,t,i.length,this.getLogData()),s(e,r.ActionType.OPEN_PATH,i,this.getLogData())})},this.handleViewInFolder=()=>{const e=this.getAttachmentFqPaths(),{recentItem:t}=this.props,{attachmentIds:n,viewingUserId:o}=t;(0,u.waitForHomeTTI)().then(({logViewInFolder:s,openUrl:a})=>{s(o,e,n.length,this.getLogData()),a(i.last(t.paths).url,r.ActionType.VIEW_IN_FOLDER,n,this.getLogData())})},this.handlePreview=e=>{this.previewOrOpenFiles({},e)},this.handleShare=()=>{(0,a.shareRecentItem)(this.getRecentItem(),this.state.attachments,this.getLogData(),!1)},this.handleVersions=()=>{const e=this.getSingleAttachment("handleVersions only supports a single attachment");(0,a.openVersions)(e.id,this.getLogData())},this.removeStoreListeners=null,this.state={attachments:[],isCollapsed:!0}}getRecentItem(){return this.props.recentItem}getLogData(){return{totalCount:this.props.recentItem.attachmentIds.length,cellView:this,loggedComponentName:this.props.loggedComponentName}}getAttachmentFqPaths(){return i.compact(i.map(this.state.attachments,"fqPath"))}getSingleAttachment(e){return e&&(0,s.assert)(1===this.state.attachments.length,e),this.state.attachments[0]}previewOrOpenFiles(e,t){const{recentItem:n}=this.props;(0,a.previewRecentItem)(n,Object.assign({},e),this.getLogData(),t)}UNSAFE_componentWillMount(){this.removeStoreListeners=(0,d.getAttachmentStore)().addListener(this.onAttachmentStoreChange),this.onAttachmentStoreChange()}componentWillUnmount(){this.removeStoreListeners&&this.removeStoreListeners()}render(){return o.default.createElement(l.RecentActivityItemView,{recentItem:this.getRecentItem(),attachments:this.state.attachments,handler:this,isCollapsed:this.state.isCollapsed,renderingInfo:this.props.renderingInfo,showExpand:this.props.fullItemView,showStar:this.props.fullItemView,showLastAccess:this.props.fullItemView,showActions:this.props.fullItemView,asyncRenderStar:this.props.asyncRenderStar})}}t.RecentActivityItemContainer=m,m.displayName="RecentActivityItemContainer"})),define("metaserver/static/js/home/recents/components/recent_activity_item_view",["require","exports","tslib","classnames","lodash","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/tooltips","dig-components/typography","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/clean/web_timing_logger","js/common/rendering","metaserver/static/js/datetime/datetime","metaserver/static/js/clean/em_string","js/filepath/filepath","metaserver/static/js/display_types/constants","metaserver/static/js/home/recents/actions/recent_activity_action_permissions","metaserver/static/js/home/recents/components/pending_attachment_list_view","metaserver/static/js/home/recents/components/recent_activity_item_actions_view","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_text_helper","metaserver/static/js/home/util/conditional_api","metaserver/static/js/home/util/post_tti_components","metaserver/static/js/home/util/resource_icon","metaserver/static/js/starred/constants","js/common/uuid","metaserver/static/js/core/exception","metaserver/static/js/core/i18n"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f,v,E,S,T,I,R,y,b,A,C,w,P,F,D){"use strict";function N(e){return(0===e.button||1===e.button)&&!(function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityItemView=void 0,i=n.__importDefault(i),s=n.__importDefault(s),y=n.__importStar(y);class M extends s.default.Component{constructor(e){super(e),this.onShare=e=>{e.preventDefault(),e.stopPropagation(),this.props.handler.handleShare()},this.handleTitleClick=e=>{e.stopPropagation(),N(e)&&(e.preventDefault(),this.props.handler.handlePreview({isMetaClick:e.metaKey,href:e.currentTarget.href,middleClick:1===e.button}))},this.getRowClickHandler=e=>t=>{t.stopPropagation(),t.preventDefault(),this.isAggregation()?this.props.handler.handleHeaderClick():this.props.handler.handlePreview({isMetaClick:t.metaKey,href:e,middleClick:1===t.button})},this.handleParentClick=e=>{e.stopPropagation(),N(e)&&(e.preventDefault(),this.props.handler.handlePathClick(this.getParentPathComponent().url))},this.state={recentsItemID:(0,P.generateUUID)("recents-item-")}}shouldDisableActions(){const{federatedRecentItem:e}=this.props.recentItem;return e?!e.hasMenuActions():!this.hasLoadedAttachments()}isAggregation(){return this.props.recentItem.attachmentIds.length>1}shouldShowThumbnails(){const{recentItem:e}=this.props;return(0,I.isMountedRecentItem)(e)&&(0,I.shouldShowThumbnailsForRecentItem)(e)}getLoadedAttachmentsCount(){return this.props.attachments.filter(e=>e.isLoaded).length}canRenderAttachmentView(){const e=this.getLoadedAttachmentsCount();return e===this.props.recentItem.attachmentIds.length||e>=R.MAX_INITIAL_THUMBNAIL_ATTACHMENTS}hasLoadedAttachments(){return!(!this.props.attachments.length||!this.getLoadedAttachmentsCount())}getHeading(){const{attachments:e,recentItem:t}=this.props;if(e.length<2){const e=t.displayName||"";return _.Emstring.em_snippet(e,30)}{const n=t.attachmentIds.length,i=t.uniqueFilterTypes,o=[];for(const t of e)t.isLoaded&&t.displayName&&o.push(t.displayName);switch(i.length){case 1:switch(i[0]){case R.RECENT_EVENT_FILTER_TYPE.PHOTOS:return D.intl.formatMessage({id:"HxTR1s",defaultMessage:"{count, plural, one{{count} image} other{{count} images}}"},{count:n});case R.RECENT_EVENT_FILTER_TYPE.VIDEOS:return D.intl.formatMessage({id:"fmi87t",defaultMessage:"{count, plural, one{{count} video} other{{count} videos}}"},{count:n});case R.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES:return D.intl.formatMessage({id:"vZtJe2",defaultMessage:"{count, plural, one{{count} visual note} other{{count} visual notes}}"},{count:n})}break;case 2:if(i.indexOf(R.RECENT_EVENT_FILTER_TYPE.PHOTOS)>=0&&i.indexOf(R.RECENT_EVENT_FILTER_TYPE.VIDEOS)>=0)return D.intl.formatMessage({id:"E1nUJ4",defaultMessage:"{count} images and videos"},{count:n})}return o.length?y.snippetList(o,30,{totalCount:n}):D.intl.formatMessage({id:"IGlwYu",defaultMessage:"{count, plural, one{{count} file} other{{count} files}}"},{count:n})}}getParentPathComponent(){const{recentItem:e}=this.props,{type:t,paths:n}=e;if(!(0,I.isMountedRecentItem)(e))return t===R.RECENT_EVENT_TYPES.FILE_SHARED_ADD?{name:D.intl.formatMessage({id:"guiO/P",defaultMessage:"Your links"}),url:"/share/links"}:null;if(n.length){const e=(0,o.last)(n);if(e.url)return e}return null}renderStar(){const{attachments:e,recentItem:t,renderingInfo:n,asyncRenderStar:i}=this.props,{recentsItemID:o}=this.state,a=Boolean(e.length>0&&e[0].isDir);return i?s.default.createElement(L,{isDir:a,recentItem:t,recentsItemID:o,renderingInfo:n}):(0,b.waitForStarred)(e=>{const{Star:i,getIdTypePairFromRecentItem:l,getStoreForStarred:c}=e,d=l(t);return d?s.default.createElement(r.Provider,{store:c()},s.default.createElement(i,{id:d.id,idType:d.type,isDir:a,itemName:t.displayName||void 0,user:n.user,source:w.StarredSource.HOME_RECENTS,ariaLabelledBy:o})):null},!1)}componentDidMount(){this.shouldShowThumbnails()||this.isAggregation()&&(0,F.reportStack)("Tried to render non-photo aggregation but failed",{severity:F.SEVERITY.NONCRITICAL,exc_extra:{isMounted:this.props.recentItem.isMounted,hasSCL:!!this.props.recentItem.scl,attachment_lenth:this.props.attachments.length}})}render(){const{recentItem:e,attachments:t,handler:n,renderingInfo:r,isCollapsed:g,showExpand:h,showStar:_,showLastAccess:R,showActions:y}=this.props,{displayType:b,federatedRecentItem:w,fqPath:P,scl:F}=e,N=this.getParentPathComponent(),M=new Date(e.when),O=(0,E.getRecentActivityItemViewPermissions)(e,t),L=(0,I.isMountedRecentItem)(e),j=O.share&&(w?w.isShareable():this.hasLoadedAttachments()),x=this.isAggregation()?void 0:L?P?(0,m.preview_uri_for_fq_path)(r.user,P).toString():void 0:F,H=(0,i.default)({"recents-item":!0,"recents-item--loaded":this.hasLoadedAttachments()}),V=(0,o.uniqueId)("recents-item__action-share-");return s.default.createElement("li",{"data-item-id":e.id,"data-item-type":e.type,"data-item-date":e.when,className:H,onClick:this.getRowClickHandler(x),onAuxClick:this.getRowClickHandler(x)},s.default.createElement("div",{className:"recents-item-header"},h&&s.default.createElement("div",{className:"recents-item-header__chevron"},this.isAggregation()&&s.default.createElement(a.IconButton,{onClick:this.props.handler.handleHeaderClick,variant:"transparent",className:"recents-item-header__chevron-button","aria-label":g?D.intl.formatMessage({id:"5loFC4",defaultMessage:"Expand"}):D.intl.formatMessage({id:"cwEFpr",defaultMessage:"Collapse"})},s.default.createElement(l.UIIcon,{src:g?c.ChevronRightLine:c.ChevronDownLine,size:"small"}))),s.default.createElement("div",{className:"recents-item-header__icon"},s.default.createElement(C.HomeResourceIcon,{displayType:b||v.DisplayTypes.FILE,fileName:e.displayName||"",shortcutUrlForIcon:e.fqPath&&"web"===(0,f.file_extension)(e.fqPath)&&e.scl||void 0,icon:e.icon||void 0})),s.default.createElement("div",{className:`recents-item-header__content ${R?"":"recents-item-header-search_empty_state"}`},s.default.createElement("div",{className:"recents-item-header__title"},x?s.default.createElement(u.Link,{variant:"monochromatic",hasNoUnderline:!0,className:"recents-item-header__title-text",href:x,onClick:this.handleTitleClick,onAuxClick:this.handleTitleClick,id:this.state.recentsItemID},this.getHeading()):s.default.createElement(u.Text,{className:"recents-item-header__title-text"},this.getHeading()),_&&this.renderStar()),s.default.createElement(u.Text,{size:R?"small":void 0,color:"faint",className:"recents-item-header__subtitle"},R?`${(0,I.getActionTypeLocalizedString)(e)} `:"",R&&s.default.createElement(d.Tooltip,{placement:"top",title:(0,p.format_date)(M,"MMM d, yyyy "+p.localized_time_format)},s.default.createElement("span",null,(0,p.agoFromDate)(M,r.now,!1))),N?R?" · ":" • ":"",N&&s.default.createElement(u.Link,{href:N.url,onClick:this.handleParentClick,variant:"monochromatic",hasNoUnderline:!0},N.name))),y&&s.default.createElement("div",{className:"recents-item__actions"},j&&s.default.createElement("div",{className:"recents-item__action recents-item__action--hover-only recents-item__action--standard-breakpoint-only"},s.default.createElement(a.Button,{id:V,onClick:this.onShare,variant:"opacity","aria-labelledby":(0,i.default)(V,this.state.recentsItemID)},D.intl.formatMessage({id:"2ZK3bH",defaultMessage:"Share"}))),s.default.createElement(A.PostTTIRecentsActivityFileActions,{recentItem:this.props.recentItem,attachments:this.props.attachments,arialabelledby:this.state.recentsItemID}),s.default.createElement(T.RecentActivityItemActionsView,{handler:n,isMountedItem:L,permissions:O,attachmentCount:e.attachmentIds.length,disableActions:this.shouldDisableActions(),renderingInfo:r,arialabelledby:this.state.recentsItemID}))),this.shouldShowThumbnails()&&!this.props.isCollapsed&&(this.canRenderAttachmentView()?s.default.createElement(A.PostTTIRecentActivityImageAttachments,{attachments:t}):s.default.createElement(S.PendingAttachmentListView,{count:e.attachmentIds.length})))}}t.RecentActivityItemView=M,M.displayName="RecentActivityItemView";const O=s.default.lazy(()=>n.__awaiter(void 0,void 0,void 0,(function*(){yield(0,g.waitForTTI)();const t=yield new Promise((t,n)=>{e(["metaserver/static/js/home/starred/conditional_interface"],t,n)}).then(n.__importStar);return{default:e=>{const{Star:n,getIdTypePairFromRecentItem:i,getStoreForStarred:o}=t,a=i(e.recentItem);return a?s.default.createElement(r.Provider,{store:o()},s.default.createElement(n,{id:a.id,idType:a.type,isDir:e.isDir,itemName:e.recentItem.displayName||void 0,user:e.renderingInfo.user,source:w.StarredSource.HOME_RECENTS,ariaLabelledBy:e.recentsItemID})):null}}}))),L=e=>s.default.createElement(h.LazySuspense,{fallback:null},s.default.createElement(O,Object.assign({},e)))})),define("metaserver/static/js/home/recents/models/attachment",["require","exports","metaserver/static/js/core/exception"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialAttachmentsFromRecentActivity=t.convertFileActivityToAttachmentItem=void 0,t.convertFileActivityToAttachmentItem=function(e){const t=e.preview_jsinfo||null;let i=null,o=null;if(t&&(t.thumbnail_url_tmpl&&(i=t.thumbnail_url_tmpl),t.thumbnail_dimensions)){const[e,n]=t.thumbnail_dimensions;o={height:n,width:e}}const s=e.comment||{},r=s.commenter_dict||{};return s.raw_comment_text&&(0,n.reportStack)("Received a comment attachment",{severity:n.SEVERITY.NONCRITICAL,exc_extra:{activity:e}}),{id:e.activity_key,isLoaded:!0,viewingUserId:e.viewing_user.id,displayName:e.name||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,previewInfo:e.preview_jsinfo||null,fqPath:e.fq_path||null,nsPath:e.ns_path||null,nsId:e.ns_id||null,thumbnailUrl:i||null,thumbnailDimensions:o||null,canOpen:!1,inRootCollection:!1,isReadOnly:!!e.is_read_only,isDir:!!e.is_dir,isCloudDoc:!!e.is_cloud_doc,isVersionable:!!e.is_versionable,perNodeMetadata:e.per_node_metadata||null,commentRawText:s.raw_comment_text||null,commenterId:r.id||null,commenterDisplayName:r.display_name||null,commenterPhotoUrl:r.photo_circle_url||null}},t.createPartialAttachmentsFromRecentActivity=function(e){return(e.related_activity_keys||[]).map(t=>({id:t,viewingUserId:e.viewing_user.id,displayName:null,displayType:null,isLoaded:!1,canOpen:!1,inRootCollection:!1,isReadOnly:!1,isDir:!1,isCloudDoc:!1,isVersionable:!1,perNodeMetadata:null,previewInfo:null,fqPath:null,nsPath:null,nsId:null,thumbnailUrl:null,thumbnailDimensions:null,commentRawText:null,commenterId:null,commenterDisplayName:null,commenterPhotoUrl:null}))}})),define("metaserver/static/js/home/recents/models/federated_recent_item",["require","exports","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_federated_model"],(function(e,t,n,i){"use strict";function o(e){switch(e.action||n.PaperRecentItemAction.OPENED){case n.PaperRecentItemAction.CREATED:return n.RECENT_EVENT_TYPES.PAPER_ADD;case n.PaperRecentItemAction.EDITED:return n.RECENT_EVENT_TYPES.PAPER_EDIT;default:return n.RECENT_EVENT_TYPES.PAPER_VIEW}}Object.defineProperty(t,"__esModule",{value:!0}),t.createRecentItemFromPaperRecentItem=void 0,t.createRecentItemFromPaperRecentItem=function(e,t,s){const r=new i.FederatedRecentItem(e),a=r.getActivityKey();return{federatedRecentItem:r,id:a,idType:e.id_type,resourceId:e.resource_id,type:o(e),icon:r.getIcon(),displayType:e.display_type,when:e.time,viewingUserId:t.id,displayName:e.name,accountDisplayName:t.display_name,contextDisplayName:r.getFolderPath()||t.display_name,attachmentIds:[a],paths:e.path,order:s,uniqueFilterTypes:[n.RECENT_EVENT_FILTER_TYPE.DOCUMENTS]}}})),define("metaserver/static/js/home/recents/models/recent_item",["require","exports","tslib","lodash","metaserver/static/js/home/recents/actions/error_actions","metaserver/static/js/home/recents/models/utils"],(function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRecentActivityToRecentItem=void 0,i=n.__importStar(i);let r=0;const a=i.memoize(e=>r+=1);t.convertRecentActivityToRecentItem=function(e){try{const t=e.skeleton_data;return{id:e.activity_key,type:e.recent_event_type||null,icon:e.icon||t&&t.icon||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,when:e.when_milli||null,viewingUserId:e.viewing_user.id,displayName:t&&t.display_name||null,accountDisplayName:t&&t.account_display_name||null,contextDisplayName:t&&t.context_display_name||null,uniqueFilterTypes:t?i.uniq(i.values(t.filter_types_by_key)):[],attachmentIds:e.related_activity_keys||[],paths:(0,s.getPathsByFqPath)(t&&t.context_display_path||"",e.viewing_user.id,!0),order:a(e.activity_key),idType:e.id_type,resourceId:e.resource_id,scl:e.scl,isMounted:e.is_mounted,perNodeMetadata:e.per_node_metadata}}catch(t){return i.defer(()=>o.errorActions.recentActivityParseError(e.activity_key,t)),null}}})),define("metaserver/static/js/home/recents/models/utils",["require","exports","tslib","lodash","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/clean/viewer"],(function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActionTypeLocalizedString=t.getRecentItemActionType=t.getExtension=t.compareRecentItems=t.getPathsByFqPath=t.isMountedRecentItem=t.extractAttachmentIds=t.shouldShowThumbnailsForRecentItem=t.shouldShowThumbnailsForSkeletonData=void 0,i=n.__importStar(i);const{PHOTOS:a,VIDEOS:l,VISUAL_NOTES:c}=s.RECENT_EVENT_FILTER_TYPE,d=[a,l,c];function u(e,t){return!!(e>1&&t.every(e=>d.indexOf(e)>=0))}function m(e){switch(e.type){case s.RECENT_EVENT_TYPES.FILE_PRIVATE_VIEW:case s.RECENT_EVENT_TYPES.FILE_SHARED_VIEW:case s.RECENT_EVENT_TYPES.PAPER_VIEW:return s.RecentItemActionType.OPENED;case s.RECENT_EVENT_TYPES.FILE_EDIT:case s.RECENT_EVENT_TYPES.PAPER_EDIT:return s.RecentItemActionType.EDITED;default:return s.RecentItemActionType.ADDED}}t.shouldShowThumbnailsForSkeletonData=function(e){const t=i.values(e.filter_types_by_key);return u(t.length,i.uniq(t))},t.shouldShowThumbnailsForRecentItem=function(e){return u(e.attachmentIds.length,e.uniqueFilterTypes)},t.extractAttachmentIds=function(e){return i.map(e,"id")},t.isMountedRecentItem=function(e){return!1!==e.isMounted},t.getPathsByFqPath=function(e,t,n=!1){const s=r.Viewer.get_viewer().get_user_by_id(t);"/"===e&&(e="");const a=[],l=e.split("/");for(n||l.pop();l.length;){let e=i.last(l),t=l.join("/");1===l.length&&""===e&&(e=r.Viewer.get_root_name(s),t="");const n=(0,o.browse_uri_for_fq_path)(s,t).toString();a.push({name:e||"",url:n}),l.pop()}return a.reverse()},t.compareRecentItems=function(e,t){return t.when-e.when||e.order-t.order||t.type-e.type},t.getExtension=function(e){const t=e.split(".");return t.length<2?"":"."+t.slice(-1)[0].replace(/\n$/,"").toLowerCase()},t.getRecentItemActionType=m;const g={[s.RecentItemActionType.OPENED]:s.I18N.OPENED,[s.RecentItemActionType.EDITED]:s.I18N.EDITED,[s.RecentItemActionType.ADDED]:s.I18N.ADDED};t.getActionTypeLocalizedString=function(e){return g[m(e)]}})),define("metaserver/static/js/home/recents/recent_activity_client_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPaperRecentItem=t.isSFJRecentItem=t.getPayload=void 0,t.getPayload=function(e){if("ok"===e.status)return e.payload;throw new Error(`Payload not okay: ${JSON.stringify(e)}`)};t.isSFJRecentItem=e=>void 0!==e.activity_key;t.isPaperRecentItem=e=>void 0!==e.time})),define("metaserver/static/js/home/recents/recent_activity_constants",["require","exports","tslib","metaserver/static/js/modules/constants/python","metaserver/static/js/core/i18n"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnsureAttachmentsPurpose=t.ActionScope=t.ActionType=t.I18N=t.RecentItemActionType=t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=t.PaperRecentItemTypes=t.PaperRecentItemAction=t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=t.MAX_INITIAL_DOC_ATTACHMENTS=t.REMOVE_PENDING_ACTIVITY_KEYS=t.ADD_PENDING_ACTIVITY_KEYS=t.REFRESH_RECENT_ACTIVITIES=t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY=t.RECEIVE_RAW_RECENT_ACTIVITIES=t.RECEIVE_PAPER_RECENT_ITEMS=t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO=t.RECEIVE_CAN_OPEN_INFO=t.RAW_RELATED_ACTIVITY_PARSE_ERROR=t.RAW_RECENT_ACTIVITY_PARSE_ERROR=t.RENAME_FILE=t.DELETE_FILES_ROLLBACK=t.DELETE_FILES_PENDING=t.DELETE_FILES_COMMIT=t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK=t.ARCHIVE_PAPER_DOCUMENT_PENDING=t.ARCHIVE_PAPER_DOCUMENT_COMMIT=t.RECENT_EVENT_FILTER_TYPE=t.RECENT_EVENT_TYPES=void 0,i=n.__importStar(i),t.RECENT_EVENT_TYPES=i.RECENT_EVENT_TYPES,t.RECENT_EVENT_FILTER_TYPE=i.RECENT_EVENT_FILTER_TYPE,t.ARCHIVE_PAPER_DOCUMENT_COMMIT="ARCHIVE_PAPER_DOCUMENT_COMMIT",t.ARCHIVE_PAPER_DOCUMENT_PENDING="ARCHIVE_PAPER_DOCUMENT_PENDING",t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK="ARCHIVE_PAPER_DOCUMENT_ROLLBACK",t.DELETE_FILES_COMMIT="DELETE_FILES_COMMIT",t.DELETE_FILES_PENDING="DELETE_FILES_PENDING",t.DELETE_FILES_ROLLBACK="DELETE_FILES_ROLLBACK",t.RENAME_FILE="RENAME_FILE",t.RAW_RECENT_ACTIVITY_PARSE_ERROR="RAW_RECENT_ACTIVITY_PARSE_ERROR",t.RAW_RELATED_ACTIVITY_PARSE_ERROR="RAW_RELATED_ACTIVITY_PARSE_ERROR",t.RECEIVE_CAN_OPEN_INFO="RECEIVE_CAN_OPEN_INFO",t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO="RECEIVE_FILE_IN_ROOT_COLLECTION_INFO",t.RECEIVE_PAPER_RECENT_ITEMS="RECEIVE_PAPER_RECENT_ITEMS",t.RECEIVE_RAW_RECENT_ACTIVITIES="RECEIVE_RAW_RECENT_ACTIVITIES",t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY="RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY",t.REFRESH_RECENT_ACTIVITIES="REFRESH_RECENT_ACTIVITIES",t.ADD_PENDING_ACTIVITY_KEYS="ADD_PENDING_ACTIVITY_KEYS",t.REMOVE_PENDING_ACTIVITY_KEYS="REMOVE_PENDING_ACTIVITY_KEYS",t.MAX_INITIAL_DOC_ATTACHMENTS=3,t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=10,t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=8,t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=4,(function(e){e.CREATED="CREATE",e.OPENED="VIEW",e.EDITED="EDIT"})(t.PaperRecentItemAction||(t.PaperRecentItemAction={})),t.PaperRecentItemTypes={DOCUMENT:"DOCUMENT",FOLDER:"FOLDER",PROJECT:"PROJECT"},t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=10,t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=100,t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=1,(function(e){e.OPENED="OPENED",e.EDITED="EDITED",e.ADDED="ADDED"})(t.RecentItemActionType||(t.RecentItemActionType={})),t.I18N={OPENED:o.intl.formatMessage({id:"xPH1sd",defaultMessage:"Opened"}),EDITED:o.intl.formatMessage({id:"l46MMy",defaultMessage:"Edited"}),ADDED:o.intl.formatMessage({id:"toc0wl",defaultMessage:"Added"})},(function(e){e.COMMENT="comment",e.COPY_LINK="copy_link",e.DELETE="delete",e.DOWNLOAD="download",e.HIDE="hide",e.OPEN="open",e.OPEN_DIR="open_dir",e.OPEN_PATH="open_path",e.OPEN_EXTENSION="open_extension",e.PAPER_ARCHIVE="paper_archive",e.PAPER_OPEN="paper_open",e.PAPER_SHARE="paper_share",e.REPORT_JUNK="report_junk",e.SHARE="share",e.ADD_STAR="add_star",e.REMOVE_STAR="remove_star",e.SHARE_COLLECTION="share_collection",e.UNITY_OPEN="unity_open",e.VERSIONS="versions",e.VIEW_FILE="view",e.VIEW_SHARED_LINK="view_shared_link",e.VIEW_IN_FOLDER="view_in_folder",e.COLLAPSE="collapse",e.UNCOLLAPSE="uncollapse"})(t.ActionType||(t.ActionType={})),(function(e){e.SINGLE="single",e.SUBSET="subset",e.AGGREGATION="aggregation",e.SELECTED="selected"})(t.ActionScope||(t.ActionScope={})),(function(e){e.RECENTS_JSON_CONTINUATION="handleAndLogRecentsJson",e.SHARE_FILE="shareFile",e.PREVIEW_RECENT_ITEM="previewRecentItem",e.OPEN_FILE="openFile",e.DOWNLOAD_FILES="downloadFiles",e.OPEN_VERSIONS="openVersions",e.PROMPT_AND_DELETE_ATTACHMENTS="promptAndDeleteAttachments",e.LOAD_REMAINING_ATTACHMENTS="loadRemainingAttachments"})(t.EnsureAttachmentsPurpose||(t.EnsureAttachmentsPurpose={}))})),define("metaserver/static/js/home/recents/recent_activity_dispatcher",["require","exports","flux"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityDispatcher=void 0,t.recentActivityDispatcher=new n.Dispatcher})),define("metaserver/static/js/home/recents/recent_activity_federated_model",["require","exports","metaserver/static/js/home/recents/recent_activity_constants"],(function(e,t,n){"use strict";function i(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.DOCUMENT}function o(e){return i(e)&&e.paperRecentItem.shareUrl||""}Object.defineProperty(t,"__esModule",{value:!0}),t.FederatedRecentItem=t.equalsPaperRecentItem=t.getPaperShareUrl=t.isPaperProject=t.isPaperDocument=void 0,t.isPaperDocument=i,t.isPaperProject=function(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.PROJECT},t.getPaperShareUrl=o,t.equalsPaperRecentItem=function(e,t){return e.paperRecentItem.id===t.id&&e.paperRecentItem.type===t.type};t.FederatedRecentItem=class{constructor(e){this.paperRecentItem=e}isShareable(){return i(this)&&Boolean(o(this))}isArchiveable(){return i(this)&&Boolean(this.paperRecentItem.isEditable)}hasMenuActions(){return this.isArchiveable()}getIdTypePair(){return{id:this.paperRecentItem.resource_id,type:this.paperRecentItem.id_type}}getStarredStatus(){return{starred:this.paperRecentItem.isFavorite,idTypePair:this.getIdTypePair()}}getIcon(){switch(this.paperRecentItem.display_type){case"PAPER_DOCUMENT":return"paper_doc";case"PAPER_FOLDER":return"folder";case"PAPER_PUBLIC_FOLDER":return"folder_team";case"PAPER_PROJECT":return"paper_project";default:return"file"}}getDisplayType(){return this.paperRecentItem.display_type}getIsDir(){return!1}getFolderPath(){return[""].concat(this.paperRecentItem.path.map(e=>e.name)).join("/")}getFqPath(){return`${this.getFolderPath()}/${this.paperRecentItem.name}`}getActivityKey(){return`paper_id_${this.paperRecentItem.id}`}getUrl(){return this.paperRecentItem.url}}})),define("metaserver/static/js/home/recents/recent_activity_logger_utils",["require","exports","tslib","metaserver/static/js/clean/web_timing_logger"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onLogFirstAction=t.canLogFirstAction=t.reset=t.getRecentsLoggingData=void 0,i=n.__importStar(i);let o=!1,s=!1;t.getRecentsLoggingData=function(){if(!s){const e=i.start_time();if(e)return s=!0,{isFullPage:!0,startTime:e}}return{isFullPage:!1,startTime:Date.now()}},t.reset=function(){s=!1,o=!1},t.canLogFirstAction=function(){return!o},t.onLogFirstAction=function(){o=!0}})),define("metaserver/static/js/home/recents/recent_activity_stream",["require","exports","tslib","lodash","metaserver/static/js/home/recents/models/utils"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMergedRecentItems=t.RecentActivityStream=void 0,i=n.__importStar(i);class s{constructor(e,t){this.sortedRecentItems=e,this.hasMore=t,this.activityKeyToRecentItem={},e.forEach(e=>{this.activityKeyToRecentItem[e.id]=e}),this.oldestTimeForOtherStream=this.getOldestItemTimeForOtherStreams()}getOldestItemTimeForOtherStreams(){return this.hasMore&&this.sortedRecentItems.length&&this.sortedRecentItems[this.sortedRecentItems.length-1].when||0}getRecentItems(){return this.sortedRecentItems.slice()}getRecentItemByActivityKey(e){return this.activityKeyToRecentItem[e]||null}getStreamWithoutActivityKey(e){return new s(this.sortedRecentItems.filter(t=>t.id!==e),this.hasMore)}getItemsAfter(e){if(this.oldestTimeForOtherStream<e){const t=[];for(const n of this.sortedRecentItems){if(n.when<e)break;t.push(n)}return t}return this.sortedRecentItems}}t.RecentActivityStream=s,t.getMergedRecentItems=function(e){const t=e.filter(Boolean),n=i.max(t.map(e=>e.oldestTimeForOtherStream));return[].concat(...t.map(e=>e.getItemsAfter(n))).sort(o.compareRecentItems)}})),define("metaserver/static/js/home/recents/recent_activity_text_helper",["require","exports","metaserver/static/js/clean/em_string","metaserver/static/js/core/i18n"],(function(e,t,n,i){"use strict";function o(e,t){return i.intl.formatMessage({id:"650lWu",defaultMessage:"{count, plural, one{{name} and {count} other} other{{name} and {count} others}}"},{count:t,name:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.snippetList=void 0,t.snippetList=function(e,t,s={}){const r=Math.max(Math.floor(s.totalCount||0),e.length);if(1===r)return n.Emstring.em_snippet(e[0],t);{const s=e[0],a=r-1;let l=o(s,a);if(new n.Emstring(l).length>t){const e=Math.floor(t-new n.Emstring(o("",a)).length)-1;l=e<3?i.intl.formatMessage({id:"aNHFm3",defaultMessage:"{count, plural, one{{count} other} other{{count} others}}"},{count:r}):o(n.Emstring.em_snippet(s,e),a)}let c="",d=1;for(;d<e.length&&(d+=1,c=e.slice(0,d).join(", "),d<r&&(c=o(c,r-d)),new n.Emstring(c).length<t);)l=c;return l}}})),define("metaserver/static/js/home/recents/store_utils",["require","exports","tslib","metaserver/static/js/home/store","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_logger_utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_client_utils"],(function(e,t,n,i,o,s,r,a,l){"use strict";function c(e,t){return n.__awaiter(this,void 0,void 0,(function*(){try{return yield t()}catch(t){throw e().then(({logRequestFailed:e})=>e((0,i.getUserId)(),t)),t}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.handleRetrievePaperRecentsPromise=t.logErrorAndRethrowAsync=t.handleAndLogRecentsJsonPromise=void 0,t.handleAndLogRecentsJsonPromise=function(e,t,d=!0){try{const u=(0,s.getRecentsLoggingData)(),{recent_activities:m,cursor:g,encrypted:h,use_assistant_service:p}=(0,l.getPayload)(t),_=(0,i.getUserId)(),f=[],v=[];return m.forEach(e=>{(0,l.isPaperRecentItem)(e)?f.push(e):(0,l.isSFJRecentItem)(e)&&v.push(e)}),p&&o.recentActivityDispatcher.dispatch({type:r.RECEIVE_PAPER_RECENT_ITEMS,items:f,hasMore:!1,userId:_}),o.recentActivityDispatcher.dispatch({type:r.RECEIVE_RAW_RECENT_ACTIVITIES,rawRecentActivities:v,cursor:g||"",encrypted:h||"",userId:_}),c(e,()=>n.__awaiter(this,void 0,void 0,(function*(){let t=[];v.forEach(e=>{if(e.skeleton_data&&e.related_activity_keys){const n=(0,a.shouldShowThumbnailsForSkeletonData)(e.skeleton_data)?r.MAX_INITIAL_THUMBNAIL_ATTACHMENTS:r.MAX_INITIAL_DOC_ATTACHMENTS;t=t.concat(...e.related_activity_keys.slice(0,n))}});const{ensureAttachments:n}=yield e();yield n(t,r.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION);let i=!1,o=0;v.forEach(({skeleton_data:e})=>{e&&(o+=e.num_related_activities||0,(e.num_related_activities||0)>1&&(i=!0))}),e().then(({logRecentsLoaded:e})=>e(_,u,{is_paginated:!d,contains_aggregation:i,item_count:m.length}))})))}catch(t){throw e().then(({logRequestFailed:e})=>e((0,i.getUserId)(),t)),t}},t.logErrorAndRethrowAsync=c,t.handleRetrievePaperRecentsPromise=function(e,t,n=!0){const s=(0,i.getUserId)(),a=(0,l.getPayload)(t);if(!a.use_assistant_service){const t=n&&a.has_more;o.recentActivityDispatcher.dispatch({type:r.RECEIVE_PAPER_RECENT_ITEMS,items:a.items,hasMore:t,userId:s}),t&&e().then(({loadPaperRecentItems:e})=>e(!1))}}})),define("metaserver/static/js/home/recents/stores/attachment_store",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","lodash","metaserver/static/js/home/resource/store","metaserver/static/js/flux/flux_store","metaserver/static/js/home/recents/actions/error_actions","metaserver/static/js/home/recents/stores/flux_utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/models/attachment","metaserver/static/js/core/assert"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAttachmentStore=t.AttachmentStore=void 0,s=n.__importStar(s);class h extends a.FluxStore{constructor(e,t={}){super(e),this.onCommit=e=>{delete this.transactionHistory[e.transactionId]},this._onDeleteFilesPending=e=>{const t=[];for(const n of e.attachmentIds)n in this.attachmentIdToAttachment&&(t.push(this.attachmentIdToAttachment[n]),delete this.attachmentIdToAttachment[n]);this.transactionHistory[e.transactionId]={deletedAttachments:t},(0,c.emitChangeIfNeeded)(this,!!t.length)},this._onDeleteFilesRollback=e=>{const t=this.transactionHistory[e.transactionId];(0,g.assert)(!!t,`Unable to find data for transaction with id: ${e.transactionId}`),t.deletedAttachments.forEach(e=>this.attachmentIdToAttachment[e.id]=e),(0,c.emitChangeIfNeeded)(this,!!t.deletedAttachments.length)},this.pendingActivityKeys=[],this.attachmentIdToEncryptedToken={},this.attachmentIdToAttachment={},(t.attachments||[]).forEach(e=>{this.attachmentIdToAttachment[e.id]=e,t.encryptedToken&&(this.attachmentIdToEncryptedToken[e.id]=t.encryptedToken)}),this.transactionHistory={}}areSomeActivityKeysPending(e){return!!s.intersection(this.pendingActivityKeys,e).length}getById(e){return this.attachmentIdToAttachment[e]||null}getByIds(e){return s.values(s.pick(this.attachmentIdToAttachment,e))}getByFqPath(e){return this.getAll().find(t=>t.fqPath===e)||null}getAll(){return s.values(this.attachmentIdToAttachment)}getAllById(){return this.attachmentIdToAttachment}groupIdsByEncryptedToken(e){return s.groupBy(e.filter(e=>e in this.attachmentIdToEncryptedToken),e=>this.attachmentIdToEncryptedToken[e])}__onDispatch(e){switch(e.type){case d.ADD_PENDING_ACTIVITY_KEYS:this.onAddPendingActivityKeys(e);break;case d.REMOVE_PENDING_ACTIVITY_KEYS:this.onRemovePendingActivityKeys(e);break;case d.DELETE_FILES_COMMIT:this.onCommit(e);break;case d.DELETE_FILES_PENDING:this._onDeleteFilesPending(e);break;case d.DELETE_FILES_ROLLBACK:this._onDeleteFilesRollback(e);break;case d.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case d.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case d.RECEIVE_CAN_OPEN_INFO:this.onReceiveCanOpenInfo(e);break;case d.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO:this._onReceiveFileInRootCollectionInfo(e)}}mutateAttachmentInNsIdPath(e,t){if(e&&e.indexOf(":")>=0){const[n,i]=e.split(":"),o=this.getAll().find(e=>e.nsId===Number(n)&&e.nsPath===i)||null;if(o){const e=(0,c.getMutatedOrOriginal)(o,t);if(e!==o)return this.attachmentIdToAttachment[o.id]=e,!0}}return!1}updatePendingActivityKeys(e,t){const n=this.pendingActivityKeys.length;if(t){const t=this.pendingActivityKeys.concat(...e);this.pendingActivityKeys=s.uniq(t)}else this.pendingActivityKeys=s.without(this.pendingActivityKeys,...e);(0,c.emitChangeIfNeeded)(this,n!==this.pendingActivityKeys.length)}onAddPendingActivityKeys(e){this.updatePendingActivityKeys(e.activityKeys,!0)}onRemovePendingActivityKeys(e){this.updatePendingActivityKeys(e.activityKeys,!1)}onReceiveRawRecentActivities(e){const t=e.rawRecentActivities.map(m.createPartialAttachmentsFromRecentActivity),n=[].concat(...t).filter(e=>{const t=this.getById(e.id);return!t||!t.isLoaded});n.forEach(t=>{this.attachmentIdToAttachment[t.id]=t,this.attachmentIdToEncryptedToken[t.id]=e.encrypted}),(0,c.emitChangeIfNeeded)(this,!!n.length)}onReceiveRawRelatedActivitiesByKey(e){if(e.rawRelatedActivitiesByKey){const t=Object.keys(e.rawRelatedActivitiesByKey);this.updatePendingActivityKeys(t,!1);const n={};(0,c.iterateAndEmitChangesIfNeeded)(this,e.rawRelatedActivitiesByKey,(e,t)=>{try{const t=(0,m.convertFileActivityToAttachmentItem)(e);return t.previewInfo&&!t.previewInfo.is_dir&&(n[t.id]=t.previewInfo),this.attachmentIdToAttachment[t.id]=t,!0}catch(e){return s.defer(()=>l.errorActions.relatedActivityParseError(t,e)),!1}}),setTimeout(()=>{(0,r.getHomeResourceStore)(),i.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:n})})}}onReceiveCanOpenInfo(e){(0,c.iterateAndEmitChangesIfNeeded)(this,e.canOpenInfo,(e,t)=>this.mutateAttachmentInNsIdPath(t,{canOpen:e.is_locally_available}))}_onReceiveFileInRootCollectionInfo(e){(0,c.iterateAndEmitChangesIfNeeded)(this,e.fileInRootCollectionInfo,(e,t)=>this.mutateAttachmentInNsIdPath(t,{inRootCollection:e}))}}t.AttachmentStore=h;let p=null;t.getAttachmentStore=function(){return null===p&&(p=new h(u.recentActivityDispatcher)),p}})),define("metaserver/static/js/home/recents/stores/flux_utils",["require","exports"],(function(e,t){"use strict";function n(e,t){t&&e.__emitChange()}Object.defineProperty(t,"__esModule",{value:!0}),t.getMutatedOrOriginal=t.emitChangeIfNeeded=t.iterateAndEmitChangesIfNeeded=void 0,t.iterateAndEmitChangesIfNeeded=function(e,t,i){let o=!1;Object.keys(t).forEach(e=>{i(t[e],e)&&(o=!0)}),n(e,o)},t.emitChangeIfNeeded=n,t.getMutatedOrOriginal=function(e,t){for(const n in t)if(t[n]!==e[n])return Object.assign(Object.assign({},e),t);return e}})),define("metaserver/static/js/home/recents/stores/recent_activity_store",["require","exports","tslib","lodash","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/models/federated_recent_item","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/models/recent_item","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/stores/flux_utils","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/store","metaserver/static/js/core/assert","metaserver/static/js/home/recents/recent_activity_stream","metaserver/static/js/home/post_tti/api","metaserver/static/js/clean/viewer","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/home/recents/store_utils","metaserver/static/js/flux/flux_store","metaserver/static/js/modules/constants/web_experience_constants"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m,g,h,p,_,f,v,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRecentActivityStore=t.RecentActivityStore=void 0,i=n.__importStar(i);class T extends E.FluxStore{constructor(e,t=[],n){super(e),this.renameItem=(e,t,n)=>{var i,o;const s=this.fileSyncRecentItemIdToRecentItem[e],r=null===(i=s.scl)||void 0===i?void 0:i.replace(null!==(o=s.fqPath)&&void 0!==o?o:"",null!=n?n:"");this.updateFileSyncItem(s,{displayName:t,fqPath:n,scl:r})},this.removeFileSyncItem=e=>{this.fileSyncRecentItemIdToRecentItem.hasOwnProperty(e.id)&&(delete this.fileSyncRecentItemIdToRecentItem[e.id],this.needsToRefreshFileSyncCache=!0)},this.addFileSyncItem=e=>{e!==this.fileSyncRecentItemIdToRecentItem[e.id]&&(this.fileSyncRecentItemIdToRecentItem[e.id]=e,this.needsToRefreshFileSyncCache=!0)},this.fileSyncRecentItemIdToRecentItem={},this.fileSyncCursor=null,this.fileSyncTransactionIdToRestoreData={},this.didReceiveRawRecentActivities=!!t.length,t.forEach(this.addFileSyncItem),this.fileSyncCache={items:t},this.needsToRefreshFileSyncCache=!1;const i=(0,u.getHomeStore)().getSectionLoadingPreference(_.ConditionalSections.PAPER_RECENTS)===_.ConditionalSectionLoadingPreference.POST_TTI;this.paperStream=i?new g.RecentActivityStream([],!1):null,this.didRecievePaperItems=i,this.paperActivityKeyToPendingArchiving={},this.cachedFederatedRecentItems=[],this.cachedFederatedTruncatedRecentItems=[],this.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI,this.cachedProcessedRecentItems=null,(0,h.waitForHomeTTI)().then(()=>{this.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI,this.didTruncateRecentItems()&&(this.cacheTruncatedFederatedRecentItems(),this.cachedProcessedRecentItems=null)}),(0,d.getAttachmentStore)(),n||(0,f.getHomeAvailabilityLogger)().handlePrefetch(_.HomePrefetchTypes.RECENTS_JSON,e=>(0,v.handleAndLogRecentsJsonPromise)(h.waitForHomeTTI,e))}getSortedFileSyncRecentItems(){return this.fileSyncCache.sortedItems||(this.fileSyncCache.sortedItems=this.fileSyncCache.items.slice().sort(l.compareRecentItems)),this.fileSyncCache.sortedItems}__onDispatch(e){this.fileSyncHandler(e)||this.paperHandler(e)}fileSyncHandler(e){switch(e.type){case o.DELETE_FILES_COMMIT:this.onDeleteCommit(e);break;case o.DELETE_FILES_PENDING:this.onDeleteFilesPending(e);break;case o.DELETE_FILES_ROLLBACK:this.onDeleteFilesRollback(e);break;case o.RENAME_FILE:this.onRenameFile(e);break;case o.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case o.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case o.RAW_RELATED_ACTIVITY_PARSE_ERROR:this.onRawRelatedActivityParseError(e);break;case o.REFRESH_RECENT_ACTIVITIES:this.onRefreshRecentActivities();break;default:return!1}return this.updateFileSyncCache(!0),!0}paperHandler(e){switch(e.type){case o.RECEIVE_PAPER_RECENT_ITEMS:this.onReceivePaperRecentItems(e.items,e.hasMore,e.userId);break;case o.ARCHIVE_PAPER_DOCUMENT_PENDING:this.onArchivePaperDocumentPending(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_COMMIT:this.onArchivePaperDocumentCommit(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_ROLLBACK:this.onArchivePaperDocumentRollback(e.activityKey);break;default:return}this.__emitChange()}updateFileSyncCache(e){this.needsToRefreshFileSyncCache?(this.fileSyncCache={items:i.values(this.fileSyncRecentItemIdToRecentItem)},this.clearFederatedCache(),this.needsToRefreshFileSyncCache=!1,(0,c.emitChangeIfNeeded)(this,e)):(0,c.emitChangeIfNeeded)(this,!this.cachedProcessedRecentItems)}onDeleteCommit(e){delete this.fileSyncTransactionIdToRestoreData[e.transactionId]}onReceiveRawRecentActivities(e){(0,c.emitChangeIfNeeded)(this,!this.didReceiveRawRecentActivities&&!e.rawRecentActivities.length),this.didReceiveRawRecentActivities=!0;const t=!this.fileSyncCache.items.length,n=[],s={};if(e.rawRecentActivities.forEach(r=>{if(!r.viewing_user||r.viewing_user.id!==e.userId)return;const l=(0,a.convertRecentActivityToRecentItem)(r);if(l&&(l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.JUNK)<0||l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.ALL)>=0))if(n.push(r),t)this.fileSyncRecentItemIdToRecentItem[l.id]=l;else if(!s[l.id]){s[l.id]=l;const e=this.fileSyncCache.items.find(e=>e.id!==l.id&&e.contextDisplayName===l.contextDisplayName);if(e){i.intersection(e.attachmentIds,l.attachmentIds).length>0&&(this.removeFileSyncItem(e),this.updateFileSyncCache(!1))}const t=this.fileSyncRecentItemIdToRecentItem[l.id];this.updateFileSyncItem(l,{fqPath:t&&t.fqPath||void 0,paths:t&&t.paths||l.paths})}}),!t)for(const e in this.fileSyncRecentItemIdToRecentItem)if(!s[e]){const t=this.fileSyncCache.items.find(t=>t.id===e);t&&this.removeFileSyncItem(t)}if(this.updateFileSyncCache(!1),!t){const e={};this.getSortedFileSyncRecentItems().forEach(t=>{if(t.attachmentIds.length>0){const n=Object.keys(e).length;t.attachmentIds.forEach(t=>e[t]=!0),n===Object.keys(e).length&&this.removeFileSyncItem(t)}})}this.fileSyncCursor=e.cursor,this.needsToRefreshFileSyncCache=!0}onReceiveRawRelatedActivitiesByKey(e){this.waitForAttachmentStoreDispatcher();const t=Object.keys(e.rawRelatedActivitiesByKey||{});t.length&&this.clearFederatedCache(),this.getFileSyncRecentItemsByAttachmentIds(t).forEach(({id:e})=>{const t=this.fileSyncRecentItemIdToRecentItem[e];if(!t)return;const n=t.attachmentIds;if(!n||!n.length)return;const i=(0,d.getAttachmentStore)().getById(n[0]);if(!i||!i.isLoaded)return;let o=i.fqPath||"";n.slice(1).forEach(e=>{const t=(0,d.getAttachmentStore)().getById(e);if(!t.isLoaded)return;const n=t.fqPath||"";n.split("/").length<o.split("/").length&&(o=n)});const s=o.split("/"),r=s[s.length-2];this.updateFileSyncItem(t,{fqPath:o,paths:(0,l.getPathsByFqPath)(o,t.viewingUserId),contextDisplayName:r||t.contextDisplayName}),i.displayType||(i.displayType=t.displayType)})}onRawRelatedActivityParseError(e){this.getFileSyncRecentItemsByAttachmentIds(i.map(e.errors,"activityKey")).forEach(this.removeFileSyncItem)}onRenameFile(e){this.waitForAttachmentStoreDispatcher(),this.renameItem(e.itemID,e.newName,e.fqPath)}onDeleteFilesPending(e){this.waitForAttachmentStoreDispatcher();const t=this.deleteAttachments(e.attachmentIds);t&&(this.fileSyncTransactionIdToRestoreData[e.transactionId]=t)}onDeleteFilesRollback(e){this.waitForAttachmentStoreDispatcher();const t=this.fileSyncTransactionIdToRestoreData[e.transactionId];(0,m.assert)(!!t,`Unable to find data for transaction with id: ${e.transactionId}`),delete this.fileSyncTransactionIdToRestoreData[e.transactionId],this.rollbackDelete(t)}onRefreshRecentActivities(){this.getUnprocessedRecentItems(),this.didReceiveRawRecentActivities=!1,this.didRecievePaperItems=!1}deleteAttachments(e){let t=null;if("ON"===S.RECENTS_TABLE_REDESIGN&&e.length){this.getFileSyncRecentItemsByAttachmentIds(e).forEach(t=>{const n=i.difference(t.attachmentIds,e);this.updateFileSyncItem(t,{attachmentIds:n}),0===n.length&&this.removeFileSyncItem(t)})}if(e.length){const n=this.getFileSyncRecentItemsByAttachmentIds([e[0]])[0];if(n){const o=i.difference(n.attachmentIds,e);this.updateFileSyncItem(n,{attachmentIds:o}),t={deletedAttachmentIds:e,item:n},0===o.length&&this.removeFileSyncItem(n)}}return t}rollbackDelete(e){let t,n=this.fileSyncRecentItemIdToRecentItem[e.item.id];n?t=n.attachmentIds:(n=e.item,t=[]),this.updateFileSyncItem(n,{attachmentIds:i.uniq(t.concat(...e.deletedAttachmentIds))})}getCachedAttachmentIdToIdToFileSyncItem(){return this.fileSyncCache.attachmentIdToIdToItem||(this.fileSyncCache.attachmentIdToIdToItem={},this.fileSyncCache.items.forEach(e=>e.attachmentIds.forEach(t=>{this.fileSyncCache.attachmentIdToIdToItem[t]?this.fileSyncCache.attachmentIdToIdToItem[t][e.id]=e:this.fileSyncCache.attachmentIdToIdToItem[t]={[e.id]:e}}))),this.fileSyncCache.attachmentIdToIdToItem}getFileSyncRecentItemsByAttachmentIds(e){const t=this.getCachedAttachmentIdToIdToFileSyncItem(),n={};return e.forEach(e=>{t.hasOwnProperty(e)&&i.values(t[e]).forEach(e=>n[e.id]=e)}),i.values(n)}waitForAttachmentStoreDispatcher(){this.getDispatcher().waitFor([(0,d.getAttachmentStore)().getDispatchToken()])}updateFileSyncItem(e,t){this.addFileSyncItem((0,c.getMutatedOrOriginal)(e,t))}onArchivePaperDocumentPending(e){this.paperActivityKeyToPendingArchiving[e]=!0}onArchivePaperDocumentCommit(e){this.deletePendingArchive(e),this.paperStream=this.paperStream.getStreamWithoutActivityKey(e),this.clearFederatedCache()}onArchivePaperDocumentRollback(e){this.deletePendingArchive(e)}deletePendingArchive(e){this.paperActivityKeyToPendingArchiving[e]&&delete this.paperActivityKeyToPendingArchiving[e]}onReceivePaperRecentItems(e,t,n){this.didRecievePaperItems=!0;const i=p.Viewer.get_viewer().get_user_by_id(n),o=e.map((e,t)=>(0,s.createRecentItemFromPaperRecentItem)(e,i,t));this.paperStream=new g.RecentActivityStream(o,t),(0,h.waitForHomeTTI)().then(t=>t.setStarredStatusOfPaperRecentItems(e)),this.clearFederatedCache()}clearFederatedCache(){this.cachedFederatedRecentItems&&this.didReceiveItemsFromAllStreams()&&(this.__emitChange(),this.cachedFederatedRecentItems=null,this.cachedFederatedTruncatedRecentItems=null,this.cachedProcessedRecentItems=null)}cacheTruncatedFederatedRecentItems(){this.cachedFederatedRecentItems?this.cachedFederatedTruncatedRecentItems=this.cachedFederatedRecentItems.slice(0,this.federatedRecentItemsCountMax):this.getUnprocessedRecentItems()}getUnprocessedRecentItems(){if(null===this.cachedFederatedRecentItems){const e=[this.paperStream,new g.RecentActivityStream(this.getSortedFileSyncRecentItems(),!!this.fileSyncCursor)];this.cachedFederatedRecentItems=(0,g.getMergedRecentItems)(e),this.cacheTruncatedFederatedRecentItems()}return this.cachedFederatedTruncatedRecentItems}getFileSyncCursor(){return this.fileSyncCursor}canArchiveActivityKey(e){if(this.paperStream&&!this.paperActivityKeyToPendingArchiving[e]){const t=this.paperStream.getRecentItemByActivityKey(e);return!(!t||!t.federatedRecentItem.isArchiveable())}return!1}didReceiveItemsFromAllStreams(){return this.didRecievePaperItems&&this.didReceiveRawRecentActivities}getRecentItems(){return null===this.cachedProcessedRecentItems&&(this.cachedProcessedRecentItems=this.getUnprocessedRecentItems()),{items:this.cachedProcessedRecentItems}}didTruncateRecentItems(){return!!(this.cachedFederatedRecentItems&&this.cachedFederatedTruncatedRecentItems&&this.cachedFederatedTruncatedRecentItems.length<this.cachedFederatedRecentItems.length)}}t.RecentActivityStore=T;let I=null;t.getRecentActivityStore=function(e=!1){return null===I&&(I=new T(r.recentActivityDispatcher,[],e)),I}})),define("metaserver/static/js/home/recents/utils/events",["require","exports","tslib","lodash","react-dom","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/resource_id_types"],(function(e,t,n,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logFederatedItemEvent=t.logCleanFederatedItemEvent=t.logCleanerEvent=t.logEvent=void 0,i=n.__importStar(i),o=n.__importStar(o);const l=(e,t)=>1===e?s.ActionScope.SINGLE:t.length===e?s.ActionScope.AGGREGATION:s.ActionScope.SUBSET,c=e=>e?Array.prototype.indexOf.call(e.parentNode.childNodes,e):0,d=(e,t,n,i)=>{if(e===s.ActionScope.AGGREGATION||t===s.ActionType.COLLAPSE||t===s.ActionType.UNCOLLAPSE)return{};const o=n[i];if(!o)return{};for(const e of["PAPER","EXTERNAL"])if(o.displayType&&o.displayType.indexOf(e)>=0)return{idType:void 0,resourceId:void 0};return{idType:a.HOME_RESOURCE_ID_TYPE.FQ_PATH,resourceId:o.fqPath,displayType:o.displayType,isDir:o.isDir}},u=(e,t,n,i)=>e===s.ActionScope.AGGREGATION?n.props.recentItem?0:t+1:e===s.ActionScope.SUBSET?i.classList.contains("recents-item")?0:1:0,m=e=>i.filter(e,e=>!!e.fqPath),g=e=>i.map(e,e=>e.fqPath),h=(e,t)=>{const n=e[t];return n&&n.previewInfo?n.previewInfo.icon:""};t.logEvent=function(e,t,n,i,s,a){const p=((e,t,n,i,s)=>{const r=m(n),a=g(r),p=o.findDOMNode(t),_=l(i,a),f=h(n,s||0);return{actionTaken:e,scope:_,itemNumber:c(p),fileDetails:d(_,e,r,s||0),sprite:f,subgroupPosition:u(_,s||0,t,p)}})(e,t,n,i,s);return r.homeActivityLogger.logRecentsAction(p.actionTaken,p.scope,p.itemNumber,p.sprite,p.fileDetails.displayType||"",!!p.fileDetails.isDir,p.subgroupPosition,p.fileDetails.idType,p.fileDetails.resourceId,a)};t.logCleanerEvent=function(e,t,n,i,o,s,a){const c=((e,t,n,i)=>{const o=m(t),s=g(o),r=l(n,s),a=h(t,i||0);return{actionTaken:e,scope:r,fileDetails:d(r,e,o,i||0),sprite:a}})(e,i,o,s);return r.homeActivityLogger.logRecentsAction(c.actionTaken,c.scope,t,c.sprite,c.fileDetails.displayType||"",!!c.fileDetails.isDir,n,c.fileDetails.idType,c.fileDetails.resourceId,a)},t.logCleanFederatedItemEvent=function(e,t,n,i){const o=i.getIdTypePair();return r.homeActivityLogger.logRecentsAction(e,s.ActionScope.SINGLE,t,i.getIcon(),i.getDisplayType(),i.getIsDir(),n,o.type,o.id)},t.logFederatedItemEvent=function(e,t,n){const i=o.findDOMNode(t),a=n.getIdTypePair();return r.homeActivityLogger.logRecentsAction(e,s.ActionScope.SINGLE,c(i),n.getIcon(),n.getDisplayType(),n.getIsDir(),u(s.ActionScope.SINGLE,0,t,i),a.type,a.id)}})),define("metaserver/static/js/home/resource/store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/starred/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/flux/flux_store"],(function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHomeResourceStore=t.HomeResourceStore=void 0;class a extends r.FluxStore{constructor(){super(n.Dispatcher),this.pendingPreviewResourceId=null,this.resourceIdToFile={},this.fileToPreview=null,this.resourceIdToEquivalentResourceId={}}getFileToPreview(){return this.fileToPreview}emitIfPendingFileExists(){if(null!==this.pendingPreviewResourceId){const e=this.resourceIdToEquivalentResourceId[this.pendingPreviewResourceId]||this.pendingPreviewResourceId;this.fileToPreview=this.resourceIdToFile[this.pendingPreviewResourceId]||this.resourceIdToFile[e]||null,null!==this.fileToPreview&&(this.pendingPreviewResourceId=null,this.__emitChange())}}onRequestPreview(e){this.pendingPreviewResourceId=e,this.emitIfPendingFileExists()}onReceivedResourceIdToFile(e){this.resourceIdToFile=Object.assign(Object.assign({},this.resourceIdToFile),e),this.emitIfPendingFileExists()}onStarredSetStatus(e){e.forEach(e=>{if(e.canonicalIdTypePair){const t=(0,s.idTypePairToString)(e.idTypePair),n=(0,s.idTypePairToString)(e.canonicalIdTypePair);t!==n&&(this.resourceIdToEquivalentResourceId[n]=t,this.resourceIdToEquivalentResourceId[t]=n)}}),this.emitIfPendingFileExists()}__onDispatch(e){const t=e.action;switch(t.type){case i.HomeResourceStoreActionTypes.REQUEST_PREVIEW:this.onRequestPreview(t.resourceId);break;case i.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE:this.onReceivedResourceIdToFile(t.resourceIdToFile);break;case o.StarredActionTypes.SET_STATUS:this.onStarredSetStatus(t.starredStatuses)}}}t.HomeResourceStore=a;let l=null;t.getHomeResourceStore=function(){return null===l&&(l=new a),l}})),define("metaserver/static/js/home/store",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/flux_store","metaserver/static/js/photos/thumb_loading/generic_thumb_store","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/availability_logger_common","metaserver/static/js/clean/viewer","metaserver/static/js/core/assert","metaserver/static/js/core/exception","metaserver/static/js/clean/active_user"],(function(e,t,n,i,o,s,r,a,l,c,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockingSection=t.isHomeSection=t.getRole=t.getUserId=t.getUser=t.getHomeStore=t.PrivateHomeStoreClass=void 0,i=n.__importStar(i);class g extends s.FluxStore{constructor(){super(o.Dispatcher),this.handledPrefetches=[],this.activeTabId=a.HomeTabId.STARRED,this.canRenderItems=()=>!!this.pendingPreTTIPrefetches&&!this.pendingPreTTIPrefetches.length,this.thumbStore=new r.GenericThumbStore,this.sectionToDidLoadSynchronously={},this.sectionToPendingCallbacks={},this.preTTIProps=a.DEFAULT_PRE_TTI_PROPS}getRole(){var e;return this.role||(null===(e=this.getUser())||void 0===e?void 0:e.role)}getUser(){return this.user||(0,m.getActiveUser)()}getThumbStore(){return this.thumbStore}getSectionVisibility(){return this.sectionVisibility}getPreTTIProps(){return this.preTTIProps}getPostTTIPropsPromise(){return this.postTTIPropsPromise}getActiveTabId(){return this.activeTabId}getActiveVariants(){return this.preTTIProps.activeVariants}getActiveVariant(e){const t=this.getActiveVariants();return t&&t[e]}getPageType(e){switch(e){case"/recents":case"/edison_test/recents":return"RECENTS";case"/starred":return"STARRED";default:return"HOME"}}executeWhenSectionIsReady(e,t,n){const i=this.getSectionLoadingPreference(e);return i===a.ConditionalSectionLoadingPreference.DO_NOT_LOAD?null:i===a.ConditionalSectionLoadingPreference.IMMEDIATE||this.getSectionLoadingMode(e)!==a.ConditionalSectionLoadingMode.UNKNOWN?n(!0):(t&&(this.sectionToPendingCallbacks[e]?this.sectionToPendingCallbacks[e].push(n):this.sectionToPendingCallbacks[e]=[n]),null)}getSectionLoadingPreference(e){if(this.sectionToExtendedConditionalData){const t=this.sectionToExtendedConditionalData[e];return t?t.isPostTti?a.ConditionalSectionLoadingPreference.POST_TTI:a.ConditionalSectionLoadingPreference.IMMEDIATE:a.ConditionalSectionLoadingPreference.DO_NOT_LOAD}return a.ConditionalSectionLoadingPreference.UNKNOWN}getSectionLoadingMode(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]?this.sectionToExtendedConditionalData[e].loadingMode:a.ConditionalSectionLoadingMode.UNKNOWN}getIsFileViewerOpen(){return this.isFileViewerOpen}canRenderAllHomeSections(){return this.sectionToExtendedConditionalData?i.values(this.sectionToExtendedConditionalData).every(e=>!e.isBlocking||(!!e.isPostTti||e.loadingMode!==a.ConditionalSectionLoadingMode.UNKNOWN)):(this.role||(0,u.reportStack)("Called canRenderAllHomeSections before initialization",{severity:u.SEVERITY.NONCRITICAL}),!0)}setSectionVisibility({section:e,visible:t}){this.sectionVisibility[e]!==t&&(this.sectionVisibility=Object.assign(Object.assign({},this.sectionVisibility),{[e]:t}))}setSectionLoadingMode(e,t){const n=this.getExtendedConditionalData(e);n&&(this.sectionToExtendedConditionalData[e]=Object.assign(Object.assign({},n),{loadingMode:t}))}getExtendedConditionalData(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]}onPrefetchReceivedData({homePrefetchType:e}){this.handledPrefetches.push(e),this.pendingPreTTIPrefetches&&(this.pendingPreTTIPrefetches=i.without(this.pendingPreTTIPrefetches,e),this.pendingPreTTIPrefetches.length||this.__emitChange())}onInitializeStore({role:e,sectionVisibility:t,preTTIProps:n,sectionToConditionalData:o}){this.role=e,this.sectionVisibility=t,this.user=c.Viewer.get_viewer().get_user_by_role(e),(0,d.assert)(!!this.user,`Could not find user for role ${e}`),this.preTTIProps=n||this.preTTIProps,this.pendingPreTTIPrefetches=i.without([a.HomePrefetchTypes.RECENTS_JSON].concat(i.compact(i.map(l.HOME_PREFETCH_TYPE_TO_INFO,({section:e},t)=>{if(o){const n=o[e];if(n&&!n.isPostTti)return t}return null}))),...this.handledPrefetches),this.sectionToExtendedConditionalData=i.mapValues(o,(e,t)=>Object.assign(Object.assign({},e),{loadingMode:a.ConditionalSectionLoadingMode.UNKNOWN,isBlocking:E(t)})),Object.keys(this.sectionToDidLoadSynchronously).forEach(e=>{(0,this.sectionToDidLoadSynchronously[e])(this.getSectionLoadingPreference(e))&&this.setSectionLoadingMode(e,a.ConditionalSectionLoadingMode.SYNCHRONOUS)}),this.sectionToDidLoadSynchronously={}}onDeclareConditionalSection({section:e,didInitializeSynchronously:t}){this.sectionToExtendedConditionalData?(0,u.reportStack)("declared conditional section too late",{severity:u.SEVERITY.CRITICAL,exc_extra:{section:e}}):this.sectionToDidLoadSynchronously[e]?(0,u.reportStack)("Re-declared a conditional section",{severity:u.SEVERITY.CRITICAL,exc_extra:{section:e}}):this.sectionToDidLoadSynchronously[e]=t}onLoadedAsyncConditionalSection({section:e}){const t=this.getExtendedConditionalData(e);t&&this.setSectionLoadingMode(e,t.isPostTti?a.ConditionalSectionLoadingMode.POST_TTI:a.ConditionalSectionLoadingMode.ASYNCHRONOUS_PRE_TTI),(this.sectionToPendingCallbacks[e]||[]).forEach(e=>e(!1)),this.sectionToPendingCallbacks[e]=[]}onSetTabId({activeTabId:e}){this.activeTabId=e}onSetPostTTIPropsPromise({postTTIPropsPromise:e}){this.postTTIPropsPromise=e}__onDispatch(e){const t=e.action;switch(t.type){case a.HomeActionTypes.INITIALIZE_STORE:this.onInitializeStore(t.payload),this.__emitChange();break;case a.HomeActionTypes.SET_TAB_ID:this.onSetTabId(t.payload),this.__emitChange();break;case a.HomeActionTypes.SET_POST_TTI_PROPS_PROMISE:this.onSetPostTTIPropsPromise(t.payload),this.__emitChange();break;case a.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA:this.onPrefetchReceivedData(t.payload);break;case a.HomeActionTypes.SET_SECTION_VISIBILITY:this.setSectionVisibility(t.payload),this.__emitChange();break;case a.HomeActionTypes.DECLARE_CONDITIONAL_SECTION:this.onDeclareConditionalSection(t.payload),this.__emitChange();break;case a.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION:this.onLoadedAsyncConditionalSection(t.payload),this.__emitChange();break;case a.HomeActionTypes.OPEN_FILE_VIEWER:this.isFileViewerOpen=!0,this.__emitChange();break;case a.HomeActionTypes.CLOSE_FILE_VIEWER:this.isFileViewerOpen=!1,this.__emitChange()}}}t.PrivateHomeStoreClass=g;let h=null;function p(){return null===h&&(h=new g),h}function _(){return p().getUser()}t.getHomeStore=p,t.getUser=_,t.getUserId=function(){return _().id},t.getRole=function(){return _().role};const f=(function(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t})(a.HomeSections);function v(e){return!!f[e]}function E(e){return v(e)}t.isHomeSection=v,t.isBlockingSection=E}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};define("metaserver/static/js/home/util/conditional_api",["require","exports","metaserver/static/js/home/store","metaserver/static/js/home/constants"],(function(e,t,n,i){"use strict";function o(e,i=!0,o,s,r){return t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):(0,n.getHomeStore)().executeWhenSectionIsReady(o,i,n=>{if(n&&!t.sectionToConditionalInterface[o])try{t.sectionToConditionalInterface[o]=s()}catch(e){}return t.sectionToConditionalInterface[o]&&Object.keys(t.sectionToConditionalInterface[o]).length>0?e(t.sectionToConditionalInterface[o]):(i&&r().then(n=>{t.sectionToConditionalInterface[o]=n,e(n)}),null)})}Object.defineProperty(t,"__esModule",{value:!0}),t.waitForStarred=t.waitForSection=t.sectionToConditionalInterface=void 0,t.sectionToConditionalInterface={},t.waitForSection=o,t.waitForStarred=function(t,n=!0){return o(t,n,i.HomeSections.STARRED,()=>e("metaserver/static/js/home/starred/conditional_interface"),()=>new Promise((t,n)=>{e(["metaserver/static/js/home/starred/conditional_interface"],t,n)}).then(__importStar))}})),define("metaserver/static/js/home/util/logging/timing_component",["require","exports","tslib","react","metaserver/static/js/home/util/logging/timing_logger"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timingComponent=void 0,i=n.__importDefault(i),t.timingComponent=function(e,t){return class extends i.default.PureComponent{logTTIIfCanRenderItems(){return this.props.canRenderItems&&o.homeTimingLogger.logTTI(t)}componentDidMount(){this.logTTIIfCanRenderItems();const e=this.refs.wrapped,t=e.componentDidUpdate;e.componentDidUpdate=()=>{this.logTTIIfCanRenderItems(),t&&t.call(e)}}render(){return i.default.createElement(e,Object.assign({ref:"wrapped"},this.props))}}}})),define("metaserver/static/js/home/util/post_tti_components",["require","exports","tslib","react","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/recents/components/pending_attachment_list_view"],(function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostTTIStarredItemFileActions=t.PostTTIRecentsActivityFileActions=t.PostTTIRecentActivityImageAttachments=void 0,i=n.__importStar(i),t.PostTTIRecentActivityImageAttachments=(0,o.PostHomeTTIComponent)({displayName:"PostTTIRecentActivityImageAttachments",preTTIRenderer:({attachments:e})=>i.createElement(s.PendingAttachmentListView,{count:e.length}),getPostTTIRenderer:({AttachmentListView:e,Dimensions:t})=>({attachments:n})=>i.createElement(t,{className:"recents-item__attachments"},({width:t})=>i.createElement(e,{attachments:n,width:t}))}),t.PostTTIRecentsActivityFileActions=(0,o.PostHomeTTIComponent)({displayName:"PostTTIRecentsActivityFileActions",getPostTTIRenderer:({RecentActivityFileActionPost:e})=>({recentItem:t,attachments:n,arialabelledby:o})=>i.createElement(e,{recentItem:t,attachments:n,arialabelledby:o})}),t.PostTTIStarredItemFileActions=(0,o.PostHomeTTIComponent)({displayName:"PostTTIStarredItemFileActions",getPostTTIRenderer:({StarredItemFileActionPost:e})=>({starredItem:t,user:n})=>i.createElement(e,{starredItem:t,user:n})})})),define("metaserver/static/js/starred/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredSource=t.IdTypes=t.StarredActionTypes=t.StarredLoadingState=void 0,t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH",FQ_PATH:"FQ_PATH"},(function(e){e.HOME_STARRED="HOME_STARRED",e.HOME_RECENTS="HOME_RECENTS",e.BROWSE="BROWSE",e.FILE_VIEWER="FILE_VIEWER",e.SUGGESTED_STARS="SUGGESTED_STARS",e.HOME_TASKS="HOME_TASKS"})(t.StarredSource||(t.StarredSource={}))})),define("metaserver/static/js/home/api",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","lodash","metaserver/static/js/core/exception","metaserver/static/js/clean/web_timing_logger"],(function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeActivity=t.makeRequest=t.now=void 0,o=n.__importStar(o);t.now=()=>Date.now();let a=0,l=0,c=(0,t.now)();t.makeRequest=function(e,{delayRequest:o,isBackground:r,shouldAssertResponse:d}={}){a++;const u=new Promise((d,u)=>n.__awaiter(this,void 0,void 0,(function*(){const m=yield(function(e){return n.__awaiter(this,void 0,void 0,(function*(){const n=c;if(c=(0,t.now)(),e||c-n<40){l++;const e=10+~~(90*Math.random());return yield new Promise(t=>setTimeout(t,e)),l--,e}return 0}))})(!!o),g=(0,t.now)();(r?i.SilentBackgroundRequest:i.WebRequest)(Object.assign({dataType:"json",success:d,error:(n,i,c)=>{if("abort"===i)return;const d=e&&e.url||"no url",h=c?`: '${c}'`:"",p=`makeRequest to '${d}' failed - ${i}${h}`;(0,s.reportStack)(p,{severity:s.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:c,textStatus:i,requestParams:e,delayRequest:o,isBackground:r,requestDelay:m,openRequests:a,delayedRequests:l,requestDuration:(0,t.now)()-g,status:n.status,"exclog.exc_group":`homeapi:${i}:${c}:${d}`}}),u()}},e))})));return u.finally(()=>a--),u};let d={};const u=o.throttle(()=>{o.size(d)>1&&(0,s.reportStack)("Multiple role activities",{severity:s.SEVERITY.NONCRITICAL,exc_extra:d}),Object.keys(d).forEach(e=>{const n=d[e];(0,t.makeRequest)({url:"/home_feed/log_activities",type:"POST",data:{role:e,activities_json:JSON.stringify(o.map(n,"json")),send_ts:(0,t.now)(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0}).then(()=>n.forEach(e=>e.resolve()),()=>n.forEach(e=>e.reject()))}),d={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=function({role:e,eventName:i,extra:s}){return new Promise((a,l)=>n.__awaiter(this,void 0,void 0,(function*(){d[e]=d[e]||[],d[e].push({json:{event_name:i,event_time:(0,t.now)(),extra:o.mapValues(s||{},e=>String(e))},resolve:a,reject:l}),yield(0,r.waitForTTI)(),u()})))}})),define("metaserver/static/js/home/post_tti/api",["require","exports","tslib","react","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/async/loadable","js/common/rendering"],(function(e,t,n,i,o,s,r){"use strict";function a(){return n.__awaiter(this,void 0,void 0,(function*(){return yield(0,o.waitForTTI)(),yield new Promise((t,n)=>{e(["metaserver/static/js/home/post_tti/interface"],t,n)}).then(n.__importStar)}))}function l(){return n.__awaiter(this,void 0,void 0,(function*(){const e=yield a();return{imports:e,props:window.RUNNING_IN_EDISON?yield e.getPostTTIPropsInEdison():yield e.getPostTTIProps()}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.LazyFileUploader=t.PostHomeTTIComponentWithProps=t.waitForHomeTTIWithProps=t.PostHomeTTIComponent=t.waitForHomeTTI=void 0,i=n.__importDefault(i),t.waitForHomeTTI=a,t.PostHomeTTIComponent=function(e){const{getPostTTIRenderer:t,preTTIRenderer:i,displayName:o}=e;return(0,s.Loadable)({displayName:`PostHomeTTIComponent(${o})`,loader:()=>n.__awaiter(this,void 0,void 0,(function*(){return t(yield a())})),loading:i})},t.waitForHomeTTIWithProps=l;class c extends i.default.PureComponent{render(){return null}}c.displayName="NullComponent",t.PostHomeTTIComponentWithProps=function(e){const{getPostTTIRenderer:t,preTTIRenderer:o,displayName:r}=e;return(0,s.Loadable)({displayName:`PostHomeTTIComponentWithProps(${r})`,loader:()=>n.__awaiter(this,void 0,void 0,(function*(){const e=yield l();return(yield t(e))||(()=>i.default.createElement(c,null))})),loading:o})};const d=i.default.lazy(()=>n.__awaiter(void 0,void 0,void 0,(function*(){const{FileUploader:t}=yield new Promise((t,n)=>{e(["metaserver/static/js/home/roots/file_uploader"],t,n)}).then(n.__importStar);return{default:t}})));t.LazyFileUploader=e=>i.default.createElement(r.LazySuspense,null,i.default.createElement(d,Object.assign({},e)))})),define("metaserver/static/js/home/util/conditional",["require","exports","tslib","react","metaserver/static/js/async/loadable","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/core/exception","metaserver/static/js/flux/dispatcher"],(function(e,t,n,i,o,s,r,a,l,c,d){"use strict";function u(e){return e?(e.initPrefetch(),e.componentClass):null}Object.defineProperty(t,"__esModule",{value:!0}),t.homeConditionalSection=t.IS_PROD=void 0,i=n.__importDefault(i),t.IS_PROD=!0,t.homeConditionalSection=function(e){const{section:m,syncLoader:g,asyncLoader:h,loading:p}=e;let _=null,f=a.ConditionalSectionLoadingPreference.UNKNOWN;return(0,r.getHomeStore)(),d.Dispatcher.dispatch({type:a.HomeActionTypes.DECLARE_CONDITIONAL_SECTION,payload:{section:m,didInitializeSynchronously:e=>{if(f=e,e===a.ConditionalSectionLoadingPreference.UNKNOWN)return!1;if(e===a.ConditionalSectionLoadingPreference.DO_NOT_LOAD)return(0,r.isHomeSection)(m)&&l.homeTimingLogger.logSkippedSection(m),!1;const t=e===a.ConditionalSectionLoadingPreference.POST_TTI;if(t)(0,r.isHomeSection)(m)&&l.homeTimingLogger.logSkippedSection(m);else{try{_=u(g())}catch(e){}if(_)return!0}const c=!t&&(0,r.isBlockingSection)(m),v=()=>n.__awaiter(this,void 0,void 0,(function*(){t&&(yield(0,s.waitForHomeTTI)());const e=u(yield h());return c&&(_=e),d.Dispatcher.dispatch({type:a.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION,payload:{section:m}}),e}));if(c)v();else{const e=p;_=(0,o.Loadable)({loader:v,loading:e?t=>t.canRenderItems?"function"==typeof e?i.default.createElement(e,Object.assign({},t)):e:null:void 0})}return!1}}}),e=>((f===a.ConditionalSectionLoadingPreference.UNKNOWN||!_&&f===a.ConditionalSectionLoadingPreference.IMMEDIATE&&(0,r.isBlockingSection)(m)&&t.IS_PROD)&&(0,c.reportStack)("Premature render",{severity:c.SEVERITY.CRITICAL,exc_extra:{section:m,loadingPreference:f,isBlockingSection:(0,r.isBlockingSection)(m)}}),_?i.default.createElement(_,Object.assign({},e)):null)}})),define("metaserver/static/js/home/util/logging/activity_logger",["require","exports","metaserver/static/js/home/api","metaserver/static/js/home/store","metaserver/static/js/home/constants"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeActivityLogger=t.HomeActivityLogger=void 0;class s{logClickShowAll(e,t){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.CLICK_SHOW_ALL,role:(0,i.getHomeStore)().getRole(),extra:{component_name:e,should_show_all:t,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logHomePageShown(){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.HOME_PAGE_SHOWN,role:(0,i.getHomeStore)().getRole(),extra:{url:r(),home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logStarredShown(e,t,s){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.STARRED_SHOWN,role:(0,i.getHomeStore)().getRole(),extra:{num_items:e,is_hidden:!1,has_hidden_rows:t,has_more:s,url:r(),home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logRecentsShown(e,t){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.RECENTS_SHOWN,role:(0,i.getHomeStore)().getRole(),extra:{num_items:e,is_hidden:t,url:r(),home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logShowHideSection(e,t){return(0,n.logHomeActivity)({eventName:t?o.LoggingTypes.HIDE_SECTION:o.LoggingTypes.UNHIDE_SECTION,role:(0,i.getHomeStore)().getRole(),extra:{section_name:e,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logRecentsAction(e,t,s,r,a,l,c,d,u,m){const g={action_taken:e,scope:t,display_type:a,is_dir:l,item_number:s,sprite:r,subgroup_position:c,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname),component_name:m};return d&&u&&(g.id_type=d,g.resource_id=u),(0,n.logHomeActivity)({eventName:o.LoggingTypes.RECENTS_ITEM_ACTION,role:(0,i.getHomeStore)().getRole(),extra:g})}logSelectedFilesStarredEvent(e,t){return(0,n.logHomeActivity)({eventName:e,role:(0,i.getHomeStore)().getRole(),extra:{num_selected_items:t,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname),source:"HOME_FILES_TABLE_STARRED_TOP"}})}logStarredEvent(e,t,o,s){return(0,n.logHomeActivity)({eventName:e,role:(0,i.getHomeStore)().getRole(),extra:{resource_id:t,resource_type:o,position:s,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname),source:"HOME_FILES_TABLE_STARRED"}})}logOpenStarredItem(e,t,s){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.OPEN_STARRED_ITEM,role:(0,i.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:s,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logUndoUnstarItem(e,t,s){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.UNDO_UNSTAR_ITEM,role:(0,i.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:s,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logClickStarOverflowShare(e,t,s){return(0,n.logHomeActivity)({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_SHARE,role:(0,i.getHomeStore)().getRole(),extra:{resource_id:e,resource_type:t,position:s,home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}logClickRightMenu(e,t){return(0,n.logHomeActivity)({eventName:e,role:(0,i.getHomeStore)().getRole(),extra:Object.assign({home_page_type:(0,i.getHomeStore)().getPageType(location.pathname),click_origin:"right_menu"},t)})}logClickFilesActionBar(e,t){return(0,n.logHomeActivity)({eventName:e,role:(0,i.getHomeStore)().getRole(),extra:Object.assign({home_page_type:(0,i.getHomeStore)().getPageType(location.pathname),click_origin:"files_action_bar"},t)})}logCreateNewFile(e){return(0,n.logHomeActivity)({eventName:e,role:(0,i.getHomeStore)().getRole(),extra:{home_page_type:(0,i.getHomeStore)().getPageType(location.pathname)}})}}function r(){return-1!==location.host.indexOf("dropbox.com")?location.pathname:"unknown"}t.HomeActivityLogger=s,t.homeActivityLogger=new s})),define("metaserver/static/js/home/util/logging/availability_logger_common",["require","exports","metaserver/static/js/home/constants"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withHomePrefix=t.isPendingPrefetch=t.HOME_PREFETCH_TYPE_TO_INFO=void 0;const i=[n.ConditionalSectionLoadingPreference.IMMEDIATE,n.ConditionalSectionLoadingPreference.POST_TTI];t.HOME_PREFETCH_TYPE_TO_INFO={[n.HomePrefetchTypes.RETRIEVE_STARRED]:{fragment:"retrieve_starred",handle:"__REGISTER_RETRIEVE_STARRED_PRELOAD_HANDLER",section:n.HomeSections.STARRED,conditionalSection:n.HomeSections.STARRED},[n.HomePrefetchTypes.RECENTS_JSON]:{fragment:"recents/json",handle:"__REGISTER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.HomeSections.RECENTS},[n.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS]:{fragment:"retrieve_paper_recents",handle:"__REGISTER_PAPER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.ConditionalSections.PAPER_RECENTS},[n.HomePrefetchTypes.GET_SUGGESTED]:{fragment:"get_suggested",handle:"__REGISTER_SUGGEST_GRID_PRELOAD_HANDLER",section:n.HomeSections.SUGGEST,conditionalSection:n.HomeSections.SUGGEST,isOptional:!0}},t.isPendingPrefetch=function(e,{success:t,info:n}){return void 0===t&&(!n.isOptional||i.indexOf(e.getSectionLoadingPreference(n.conditionalSection))>=0)},t.withHomePrefix=function(e){return`home_${e}`}})),define("metaserver/static/js/home/util/logging/availability_logger",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/home/store","metaserver/static/js/core/exception","metaserver/static/js/home/util/prefetch_handler","metaserver/static/js/home/util/logging/availability_logger_common","metaserver/static/js/home/post_tti/api"],(function(e,t,n,i,o,s,r,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHomeAvailabilityLogger=t.HomeAvailabilityLogger=void 0,i=n.__importStar(i);class m{constructor(){this.didLog=!1,this.sectionToTTData={},this.sectionToTTI={},this.sectionToIsSkipped={},this.typeToExecutionData=i.mapValues(d.HOME_PREFETCH_TYPE_TO_INFO,e=>({info:e,homeTiming:{}}))}logPrefetch(e,t){const n=this.typeToExecutionData[e];if(void 0===n.success){const i={type:s.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA,payload:{homePrefetchType:e}};n.homeTiming.asynchronous?o.Dispatcher.dispatch(i):(0,a.getHomeStore)().__onDispatch({action:i}),n.success=t,this.pendingPrefetchesCount&&this.pendingPrefetchesCount--,this.logIfPossible()}}logIfPossible(){!this.didLog&&void 0!==this.pendingPrefetchesCount&&this.pendingPrefetchesCount<=0&&((0,u.waitForHomeTTI)().then(({logHomeAvailability:e})=>e({typeToExecutionData:this.typeToExecutionData,sectionToTTData:this.sectionToTTData,sectionToTTI:this.sectionToTTI,sectionToIsSkipped:this.sectionToIsSkipped})),this.didLog=!0)}logTTData(e){this.sectionToTTData.hasOwnProperty(e)||(this.sectionToTTData[e]=(0,r.time_since_start)(),this.logIfPossible())}logTTI(e,t,n){if(!this.sectionToTTI.hasOwnProperty(e)&&(this.sectionToTTI[e]=(0,r.time_since_start)(),this.sectionToIsSkipped[e]=Number(t),n)){this.pendingPrefetchesCount=0;const e=(0,a.getHomeStore)();i.map(this.typeToExecutionData,t=>{(0,d.isPendingPrefetch)(e,t)&&this.pendingPrefetchesCount++}),this.logIfPossible()}}handlePrefetch(e,t){const{handle:n,conditionalSection:i}=d.HOME_PREFETCH_TYPE_TO_INFO[e],o=()=>this.handlePrefetchImpl(e,n,t);(0,a.getHomeStore)().getSectionLoadingPreference(i)===s.ConditionalSectionLoadingPreference.POST_TTI?(0,u.waitForHomeTTI)().then(o):o()}handlePrefetchImpl(e,t,n){const o=(0,c.getPrefetchHandler)(t),s=this.typeToExecutionData[e],{homeTiming:a,didInvoke:d}=s,u=t=>{(0,l.reportStack)(`prefetch for ${e} failed`,{severity:l.SEVERITY.CRITICAL,exc_extra:{error:t,type:e},silent:!0}),this.logPrefetch(e,!1)};if(o){if(!d){s.didInvoke=!0,a.register_prefetch_callback=(0,r.time_since_start)();const t=t=>{try{a.json_parse_start=(0,r.time_since_start)();const o=JSON.parse(t);a.json_parse_end=(0,r.time_since_start)(),a.json_string_size=16*t.length,i.isEqual(o,{})?u("payload is {}"):(this.logPrefetch(e,!0),a.payload_processing_start=(0,r.time_since_start)(),n(o),a.payload_processing_end=(0,r.time_since_start)())}catch(e){u(e)}};a.asynchronous=(0,c.handlePrefetch)(o,t,u)?0:1}}else u("no prefetch handler")}}t.HomeAvailabilityLogger=m;let g=null;t.getHomeAvailabilityLogger=function(){return g=g||new m,g}})),define("metaserver/static/js/home/util/logging/timing_logger",["require","exports","tslib","metaserver/static/js/clean/js_client_stopwatch","lodash","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/home/util/logging/timing_state","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/core/exception","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/home/util/logging/availability_logger_common"],(function(e,t,n,i,o,s,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeTimingLogger=t._HomeTimingLogger=void 0,o=n.__importStar(o),s=n.__importStar(s);const u=o.once(a.homeActivityLogger.logHomePageShown);class m{constructor(){this.timingStates=new r.HomeTimingStates,this.activate=o.once(()=>i.JSStopwatch.create_stopwatch_if_not_exist("home_access_tti"))}validateActivated(e,t){return!!i.JSStopwatch.stopwatch_exists("home_access_tti")||((0,l.reportStack)(`Did not activate when ${e} before logging ${t}`,{severity:l.SEVERITY.NONCRITICAL}),!1)}logTTData(e){if(this.validateActivated(e,r.HomeTimingState.TTDATA)){if(this.timingStates.progressState(e,r.HomeTimingState.TTDATA))return this.timingStates.haveAllSectionsReachedState(r.HomeTimingState.TTDATA)&&s.log_js_modules_fetched_data_required_for_tti(),(0,c.getHomeAvailabilityLogger)().logTTData(e),!0}return!1}logSkippedSection(e){this.activate(),this.logTTData(e),this.logTTI(e,!0)}logTTI(e,t=!1){if(this.validateActivated(e,r.HomeTimingState.TTI)){if(this.timingStates.progressState(e,r.HomeTimingState.TTI)){u(),i.JSStopwatch.recordTrace((0,d.withHomePrefix)(e),{stopwatchName:"home_access_tti"});const n=this.timingStates.haveAllSectionsReachedState(r.HomeTimingState.TTI);return n&&(s.mark_time_to_interactive(),i.JSStopwatch.flush_current_data()),(0,c.getHomeAvailabilityLogger)().logTTI(e,t,n),!0}}return!1}}t._HomeTimingLogger=m,t.homeTimingLogger=new m})),define("metaserver/static/js/home/util/logging/timing_state",["require","exports","tslib","lodash","metaserver/static/js/home/constants"],(function(e,t,n,i,o){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTimingStates=t.HomeTimingState=void 0,i=n.__importStar(i),(function(e){e[e.INIT=0]="INIT",e[e.TTDATA=1]="TTDATA",e[e.TTI=2]="TTI"})(s=t.HomeTimingState||(t.HomeTimingState={}));t.HomeTimingStates=class{constructor(){this.homeSectionToState={},i.values(o.HomeSections).forEach(e=>this.homeSectionToState[e]=s.INIT)}progressState(e,t){return this.homeSectionToState[e]+1===t&&(this.homeSectionToState[e]=t,!0)}haveAllSectionsReachedState(e){return i.every(this.homeSectionToState,t=>t>=e)}}})),define("metaserver/static/js/starred/id_type_pair",["require","exports","tslib","js/filepath/filepath","metaserver/static/js/home/resource_id_types"],(function(e,t,n,i,o){"use strict";function s(e){return!!e.file_id}function r(e){return!!e.pad_id}function a(e){return!!e.folder_id}function l(e){return!!e.fq_path}function c(e){return!!e.filename}Object.defineProperty(t,"__esModule",{value:!0}),t.itemNameFromStarrableItem=t.idTypePairFromStarrableItem=t.idTypePairToString=void 0,i=n.__importStar(i),t.idTypePairToString=function(e){return e.type+":"+e.id},t.idTypePairFromStarrableItem=function(e){return s(e)||c(e)?{id:e.file_id,type:o.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID}:r(e)?{id:e.pad_id,type:o.HOME_RESOURCE_ID_TYPE.PAPER_DOCUMENT_ID}:a(e)?{id:e.folder_id,type:o.HOME_RESOURCE_ID_TYPE.PAPER_FOLDER_ID}:l(e)?{id:e.fq_path,type:o.HOME_RESOURCE_ID_TYPE.FQ_PATH}:e},t.itemNameFromStarrableItem=function(e){return s(e)||l(e)?i.filename(e.fq_path):r(e)?e.title:a(e)?e.name:c(e)?e.filename:e}})),define("metaserver/static/js/photos/thumb_loading/buffered_thumb_store",["require","exports","tslib","metaserver/static/js/photos/thumb_loading/generic_thumb_store","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/assert"],(function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferedThumbStore=void 0,o=n.__importStar(o);t.BufferedThumbStore=class{constructor(e,t){this.isTTI=!1,this.postTTISuccesses=[],this.postTTIErrors=[],this.postTTIRequests=[],this.wrapHandlers=e=>({onSuccess:t=>{this.isTTI?e.onSuccess(t):this.bufferCallbacks(this.postTTISuccesses,e,t)},onRequest:t=>{e.onRequest&&(this.isTTI?e.onRequest(t):this.bufferCallbacks(this.postTTIRequests,e,t))},onError:()=>{e.onError&&(this.isTTI?e.onError():this.bufferErrorCallback(e))}}),this.innerStore=new i.GenericThumbStore(e,t),o.waitForTTI().then(()=>{this.isTTI=!0,this.postTTIRequests.forEach(e=>{const{onRequest:t}=e[0];t&&t(e[1])}),this.postTTIErrors.forEach(e=>e.onError&&e.onError()),this.postTTISuccesses.forEach(e=>e[0].onSuccess(e[1])),this.postTTIRequests=[],this.postTTIErrors=[],this.postTTISuccesses=[]})}get_thumb(e){return this.isTTI?this.innerStore.get_thumb(e):null}is_batching(){return this.innerStore.is_batching()}bind_url(e,t){const n=this.isTTI?t:this.wrapHandlers(t);return this.innerStore.bind_url(e,n)}bufferCallbacks(e,t,n){(0,s.assert)(!this.isTTI,"Should not buffer callback after TTI"),e.push([t,n])}bufferErrorCallback(e){(0,s.assert)(!this.isTTI,"Should not buffer error callback after TTI"),this.postTTIErrors.push(e)}unbind_url(e){this.innerStore.unbind_url(e)}}})),define("metaserver/static/prod_assets_web_modules/@tanstack/react-table",["exports","react"],(function(e,t){"use strict";var n=(function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)})(t);function i(e,t){return"function"==typeof e?e(t):e}function o(e,t){return n=>{t.setState(t=>({...t,[e]:i(n,t[e])}))}}function s(e){return e instanceof Function}function r(e,t){const n=[],i=e=>{e.forEach(e=>{n.push(e);const o=t(e);null!=o&&o.length&&i(o)})};return i(e),n}function a(e,t,n){let i,o=[];return()=>{let s;n.key&&n.debug&&(s=Date.now());const r=e();if(r.length===o.length&&!r.some((e,t)=>o[t]!==e))return i;let a;if(o=r,n.key&&n.debug&&(a=Date.now()),i=t(...r),null==n||null==n.onChange||n.onChange(i),n.key&&n.debug&&null!=n&&n.debug()){const e=Math.round(100*(Date.now()-s))/100,t=Math.round(100*(Date.now()-a))/100,i=t/16,o=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info("%c⏱ "+o(t,5)+" /"+o(e,5)+" ms","\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl("+Math.max(0,Math.min(120-120*i,120))+"deg 100% 31%);",null==n?void 0:n.key)}return i}}function l(e,t,n,i){var o,s;const r={...e._getDefaultColumnDef(),...t};let l,c=null!=(o=null!=(s=r.id)?s:r.accessorKey)?o:"string"==typeof r.header?r.header:void 0;if(r.accessorFn?l=r.accessorFn:r.accessorKey&&(l=e=>e[r.accessorKey]),!c)throw new Error;let d={id:""+String(c),accessorFn:l,parent:i,depth:n,columnDef:r,columns:[],getFlatColumns:a(()=>[!0],()=>{var e;return[d,...null==(e=d.columns)?void 0:e.flatMap(e=>e.getFlatColumns())]},{key:"column.getFlatColumns",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getLeafColumns:a(()=>[e._getOrderColumnsFn()],e=>{var t;if(null!=(t=d.columns)&&t.length){let t=d.columns.flatMap(e=>e.getLeafColumns());return e(t)}return[d]},{key:"column.getLeafColumns",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}})};return d=e._features.reduce((t,n)=>Object.assign(t,null==n.createColumn?void 0:n.createColumn(d,e)),d),d}function c(e,t,n){var i;let o={id:null!=(i=n.id)?i:t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const e=[],t=n=>{n.subHeaders&&n.subHeaders.length&&n.subHeaders.map(t),e.push(n)};return t(o),e},getContext:()=>({table:e,header:o,column:t})};return e._features.forEach(t=>{Object.assign(o,null==t.createHeader?void 0:t.createHeader(o,e))}),o}const d={createTable:e=>({getHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,i,o)=>{var s,r;const a=null!=(s=null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))?s:[],l=null!=(r=null==o?void 0:o.map(e=>n.find(t=>t.id===e)).filter(Boolean))?r:[];return u(t,[...a,...n.filter(e=>!(null!=i&&i.includes(e.id)||null!=o&&o.includes(e.id))),...l],e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,i,o)=>u(t,n=n.filter(e=>!(null!=i&&i.includes(e.id)||null!=o&&o.includes(e.id))),e,"center"),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,i)=>{var o;return u(t,null!=(o=null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))?o:[],e,"left")},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightHeaderGroups:a(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,i)=>{var o;return u(t,null!=(o=null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))?o:[],e,"right")},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getFooterGroups:a(()=>[e.getHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftFooterGroups:a(()=>[e.getLeftHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterFooterGroups:a(()=>[e.getCenterHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightFooterGroups:a(()=>[e.getRightHeaderGroups()],e=>[...e].reverse(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getFlatHeaders:a(()=>[e.getHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftFlatHeaders:a(()=>[e.getLeftHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterFlatHeaders:a(()=>[e.getCenterHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightFlatHeaders:a(()=>[e.getRightHeaderGroups()],e=>e.map(e=>e.headers).flat(),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getCenterLeafHeaders:a(()=>[e.getCenterFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeftLeafHeaders:a(()=>[e.getLeftFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getRightLeafHeaders:a(()=>[e.getRightFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}}),getLeafHeaders:a(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(e,t,n)=>{var i,o,s,r,a,l;return[...null!=(i=null==(o=e[0])?void 0:o.headers)?i:[],...null!=(s=null==(r=t[0])?void 0:r.headers)?s:[],...null!=(a=null==(l=n[0])?void 0:l.headers)?a:[]].map(e=>e.getLeafHeaders()).flat()},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugHeaders}})})};function u(e,t,n,i){var o,s;let r=0;const a=function(e,t){void 0===t&&(t=1),r=Math.max(r,t),e.filter(e=>e.getIsVisible()).forEach(e=>{var n;null!=(n=e.columns)&&n.length&&a(e.columns,t+1)},0)};a(e);let l=[];const d=(e,t)=>{const o={depth:t,id:[i,""+t].filter(Boolean).join("_"),headers:[]},s=[];e.forEach(e=>{const r=[...s].reverse()[0];let a,l=!1;if(e.column.depth===o.depth&&e.column.parent?a=e.column.parent:(a=e.column,l=!0),r&&(null==r?void 0:r.column)===a)r.subHeaders.push(e);else{const o=c(n,a,{id:[i,t,a.id,null==e?void 0:e.id].filter(Boolean).join("_"),isPlaceholder:l,placeholderId:l?""+s.filter(e=>e.column===a).length:void 0,depth:t,index:s.length});o.subHeaders.push(e),s.push(o)}o.headers.push(e),e.headerGroup=o}),l.push(o),t>0&&d(s,t-1)},u=t.map((e,t)=>c(n,e,{depth:r,index:t}));d(u,r-1),l.reverse();const m=e=>e.filter(e=>e.column.getIsVisible()).map(e=>{let t=0,n=0,i=[0];return e.subHeaders&&e.subHeaders.length?(i=[],m(e.subHeaders).forEach(e=>{let{colSpan:n,rowSpan:o}=e;t+=n,i.push(o)})):t=1,n+=Math.min(...i),e.colSpan=t,e.rowSpan=n,{colSpan:t,rowSpan:n}});return m(null!=(o=null==(s=l[0])?void 0:s.headers)?o:[]),l}const m={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},g={getDefaultColumnDef:()=>m,getInitialState:e=>({columnSizing:{},columnSizingInfo:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]},...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",onColumnSizingChange:o("columnSizing",e),onColumnSizingInfoChange:o("columnSizingInfo",e)}),createColumn:(e,t)=>({getSize:()=>{var n,i,o;const s=t.getState().columnSizing[e.id];return Math.min(Math.max(null!=(n=e.columnDef.minSize)?n:m.minSize,null!=(i=null!=s?s:e.columnDef.size)?i:m.size),null!=(o=e.columnDef.maxSize)?o:m.maxSize)},getStart:n=>{const i=n?"left"===n?t.getLeftVisibleLeafColumns():t.getRightVisibleLeafColumns():t.getVisibleLeafColumns(),o=i.findIndex(t=>t.id===e.id);if(o>0){const e=i[o-1];return e.getStart(n)+e.getSize()}return 0},resetSize:()=>{t.setColumnSizing(t=>{let{[e.id]:n,...i}=t;return i})},getCanResize:()=>{var n,i;return(null==(n=e.columnDef.enableResizing)||n)&&(null==(i=t.options.enableColumnResizing)||i)},getIsResizing:()=>t.getState().columnSizingInfo.isResizingColumn===e.id}),createHeader:(e,t)=>({getSize:()=>{let t=0;const n=e=>{var i;e.subHeaders.length?e.subHeaders.forEach(n):t+=null!=(i=e.column.getSize())?i:0};return n(e),t},getStart:()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},getResizeHandler:()=>{const n=t.getColumn(e.column.id),i=n.getCanResize();return o=>{if(!i)return;if(null==o.persist||o.persist(),_(o)&&o.touches&&o.touches.length>1)return;const s=e.getSize(),r=e?e.getLeafHeaders().map(e=>[e.column.id,e.column.getSize()]):[[n.id,n.getSize()]],a=_(o)?Math.round(o.touches[0].clientX):o.clientX,l=(e,n)=>{if("number"!=typeof n)return;let i={};t.setColumnSizingInfo(e=>{var t,o;const s=n-(null!=(t=null==e?void 0:e.startOffset)?t:0),r=Math.max(s/(null!=(o=null==e?void 0:e.startSize)?o:0),-.999999);return e.columnSizingStart.forEach(e=>{let[t,n]=e;i[t]=Math.round(100*Math.max(n+n*r,0))/100}),{...e,deltaOffset:s,deltaPercentage:r}}),"onChange"!==t.options.columnResizeMode&&"end"!==e||t.setColumnSizing(e=>({...e,...i}))},c={moveHandler:e=>{return t=e.clientX,l("move",t);var t},upHandler:e=>{var n;document.removeEventListener("mousemove",c.moveHandler),document.removeEventListener("mouseup",c.upHandler),n=e.clientX,l("end",n),t.setColumnSizingInfo(e=>({...e,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))}},d=!!p()&&{passive:!1};_(o)||(document.addEventListener("mousemove",c.moveHandler,d),document.addEventListener("mouseup",c.upHandler,d)),t.setColumnSizingInfo(e=>({...e,startOffset:a,startSize:s,deltaOffset:0,deltaPercentage:0,columnSizingStart:r,isResizingColumn:n.id}))}}}),createTable:e=>({setColumnSizing:t=>null==e.options.onColumnSizingChange?void 0:e.options.onColumnSizingChange(t),setColumnSizingInfo:t=>null==e.options.onColumnSizingInfoChange?void 0:e.options.onColumnSizingInfoChange(t),resetColumnSizing:t=>{var n;e.setColumnSizing(t?{}:null!=(n=e.initialState.columnSizing)?n:{})},resetHeaderSizeInfo:t=>{var n;e.setColumnSizingInfo(t?{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}:null!=(n=e.initialState.columnSizingInfo)?n:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]})},getTotalSize:()=>{var t,n;return null!=(t=null==(n=e.getHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getLeftTotalSize:()=>{var t,n;return null!=(t=null==(n=e.getLeftHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getCenterTotalSize:()=>{var t,n;return null!=(t=null==(n=e.getCenterHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},getRightTotalSize:()=>{var t,n;return null!=(t=null==(n=e.getRightHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0}})};let h=null;function p(){if("boolean"==typeof h)return h;let e=!1;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch(t){e=!1}return h=e,h}function _(e){return"touchstart"===e.type}const f={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:o("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;return{_autoResetExpanded:()=>{var i,o;if(t){if(null!=(i=null!=(o=e.options.autoResetAll)?o:e.options.autoResetExpanded)?i:!e.options.manualExpanding){if(n)return;n=!0,e._queue(()=>{e.resetExpanded(),n=!1})}}else e._queue(()=>{t=!0})},setExpanded:t=>null==e.options.onExpandedChange?void 0:e.options.onExpandedChange(t),toggleAllRowsExpanded:t=>{(null!=t?t:!e.getIsAllRowsExpanded())?e.setExpanded(!0):e.setExpanded({})},resetExpanded:t=>{var n,i;e.setExpanded(t?{}:null!=(n=null==(i=e.initialState)?void 0:i.expanded)?n:{})},getCanSomeRowsExpand:()=>e.getRowModel().flatRows.some(e=>e.getCanExpand()),getToggleAllRowsExpandedHandler:()=>t=>{null==t.persist||t.persist(),e.toggleAllRowsExpanded()},getIsSomeRowsExpanded:()=>{const t=e.getState().expanded;return!0===t||Object.values(t).some(Boolean)},getIsAllRowsExpanded:()=>{const t=e.getState().expanded;return"boolean"==typeof t?!0===t:!!Object.keys(t).length&&!e.getRowModel().flatRows.some(e=>e.getIsExpanded())},getExpandedDepth:()=>{let t=0;return(!0===e.getState().expanded?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(e=>{const n=e.split(".");t=Math.max(t,n.length)}),t},getPreExpandedRowModel:()=>e.getSortedRowModel(),getExpandedRowModel:()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())}},createRow:(e,t)=>({toggleExpanded:n=>{t.setExpanded(i=>{var o;const s=!0===i||!(null==i||!i[e.id]);let r={};if(!0===i?Object.keys(t.getRowModel().rowsById).forEach(e=>{r[e]=!0}):r=i,n=null!=(o=n)?o:!s,!s&&n)return{...r,[e.id]:!0};if(s&&!n){const{[e.id]:t,...n}=r;return n}return i})},getIsExpanded:()=>{var n;const i=t.getState().expanded;return!!(null!=(n=null==t.options.getIsRowExpanded?void 0:t.options.getIsRowExpanded(e))?n:!0===i||(null==i?void 0:i[e.id]))},getCanExpand:()=>{var n,i,o;return(null==(n=null==t.options.getRowCanExpand?void 0:t.options.getRowCanExpand(e))||n)&&(null==(i=t.options.enableExpanding)||i)&&!(null==(o=e.subRows)||!o.length)},getToggleExpandedHandler:()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}})},v=(e,t,n)=>{var i;const o=n.toLowerCase();return null==(i=e.getValue(t))?void 0:i.toLowerCase().includes(o)};v.autoRemove=e=>w(e);const E=(e,t,n)=>{var i;return null==(i=e.getValue(t))?void 0:i.includes(n)};E.autoRemove=e=>w(e);const S=(e,t,n)=>{var i;return(null==(i=e.getValue(t))?void 0:i.toLowerCase())===n.toLowerCase()};S.autoRemove=e=>w(e);const T=(e,t,n)=>{var i;return null==(i=e.getValue(t))?void 0:i.includes(n)};T.autoRemove=e=>w(e)||!(null!=e&&e.length);const I=(e,t,n)=>!n.some(n=>{var i;return!(null!=(i=e.getValue(t))&&i.includes(n))});I.autoRemove=e=>w(e)||!(null!=e&&e.length);const R=(e,t,n)=>n.some(n=>{var i;return null==(i=e.getValue(t))?void 0:i.includes(n)});R.autoRemove=e=>w(e)||!(null!=e&&e.length);const y=(e,t,n)=>e.getValue(t)===n;y.autoRemove=e=>w(e);const b=(e,t,n)=>e.getValue(t)==n;b.autoRemove=e=>w(e);const A=(e,t,n)=>{let[i,o]=n;const s=e.getValue(t);return s>=i&&s<=o};A.resolveFilterValue=e=>{let[t,n]=e,i="number"!=typeof t?parseFloat(t):t,o="number"!=typeof n?parseFloat(n):n,s=null===t||Number.isNaN(i)?-1/0:i,r=null===n||Number.isNaN(o)?1/0:o;if(s>r){const e=s;s=r,r=e}return[s,r]},A.autoRemove=e=>w(e)||w(e[0])&&w(e[1]);const C={includesString:v,includesStringSensitive:E,equalsString:S,arrIncludes:T,arrIncludesAll:I,arrIncludesSome:R,equals:y,weakEquals:b,inNumberRange:A};function w(e){return null==e||""===e}const P={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],globalFilter:void 0,...e}),getDefaultOptions:e=>({onColumnFiltersChange:o("columnFilters",e),onGlobalFilterChange:o("globalFilter",e),filterFromLeafRows:!1,globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n,i;return"string"==typeof(null==(n=e.getCoreRowModel().flatRows[0])||null==(i=n._getAllCellsByColumnId()[t.id])?void 0:i.getValue())}}),createColumn:(e,t)=>({getAutoFilterFn:()=>{const n=t.getCoreRowModel().flatRows[0],i=null==n?void 0:n.getValue(e.id);return"string"==typeof i?C.includesString:"number"==typeof i?C.inNumberRange:"boolean"==typeof i||null!==i&&"object"==typeof i?C.equals:Array.isArray(i)?C.arrIncludes:C.weakEquals},getFilterFn:()=>s(e.columnDef.filterFn)?e.columnDef.filterFn:"auto"===e.columnDef.filterFn?e.getAutoFilterFn():C[e.columnDef.filterFn],getCanFilter:()=>{var n,i,o;return(null==(n=e.columnDef.enableColumnFilter)||n)&&(null==(i=t.options.enableColumnFilters)||i)&&(null==(o=t.options.enableFilters)||o)&&!!e.accessorFn},getCanGlobalFilter:()=>{var n,i,o,s;return(null==(n=e.columnDef.enableGlobalFilter)||n)&&(null==(i=t.options.enableGlobalFilter)||i)&&(null==(o=t.options.enableFilters)||o)&&(null==(s=null==t.options.getColumnCanGlobalFilter?void 0:t.options.getColumnCanGlobalFilter(e))||s)&&!!e.accessorFn},getIsFiltered:()=>e.getFilterIndex()>-1,getFilterValue:()=>{var n,i;return null==(n=t.getState().columnFilters)||null==(i=n.find(t=>t.id===e.id))?void 0:i.value},getFilterIndex:()=>{var n,i;return null!=(n=null==(i=t.getState().columnFilters)?void 0:i.findIndex(t=>t.id===e.id))?n:-1},setFilterValue:n=>{t.setColumnFilters(t=>{const o=e.getFilterFn(),s=null==t?void 0:t.find(t=>t.id===e.id),r=i(n,s?s.value:void 0);var a;if(F(o,r,e))return null!=(a=null==t?void 0:t.filter(t=>t.id!==e.id))?a:[];const l={id:e.id,value:r};var c;return s?null!=(c=null==t?void 0:t.map(t=>t.id===e.id?l:t))?c:[]:null!=t&&t.length?[...t,l]:[l]})},_getFacetedRowModel:t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),getFacetedRowModel:()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),_getFacetedUniqueValues:t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),getFacetedUniqueValues:()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,_getFacetedMinMaxValues:t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),getFacetedMinMaxValues:()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}),createRow:(e,t)=>({columnFilters:{},columnFiltersMeta:{}}),createTable:e=>({getGlobalAutoFilterFn:()=>C.includesString,getGlobalFilterFn:()=>{const{globalFilterFn:t}=e.options;return s(t)?t:"auto"===t?e.getGlobalAutoFilterFn():C[t]},setColumnFilters:t=>{const n=e.getAllLeafColumns();null==e.options.onColumnFiltersChange||e.options.onColumnFiltersChange(e=>{var o;return null==(o=i(t,e))?void 0:o.filter(e=>{const t=n.find(t=>t.id===e.id);return!t||!F(t.getFilterFn(),e.value,t)})})},setGlobalFilter:t=>{null==e.options.onGlobalFilterChange||e.options.onGlobalFilterChange(t)},resetGlobalFilter:t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)},resetColumnFilters:t=>{var n,i;e.setColumnFilters(t?[]:null!=(n=null==(i=e.initialState)?void 0:i.columnFilters)?n:[])},getPreFilteredRowModel:()=>e.getCoreRowModel(),_getFilteredRowModel:e.options.getFilteredRowModel&&e.options.getFilteredRowModel(e),getFilteredRowModel:()=>e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel(),_getGlobalFacetedRowModel:e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),getGlobalFacetedRowModel:()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),_getGlobalFacetedUniqueValues:e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),getGlobalFacetedUniqueValues:()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,_getGlobalFacetedMinMaxValues:e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),getGlobalFacetedMinMaxValues:()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}})};function F(e,t,n){return!(!e||!e.autoRemove)&&e.autoRemove(t,n)||void 0===t||"string"==typeof t&&!t}const D={sum:(e,t,n)=>n.reduce((t,n)=>{const i=n.getValue(e);return t+("number"==typeof i?i:0)},0),min:(e,t,n)=>{let i;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(i>n||void 0===i&&n>=n)&&(i=n)}),i},max:(e,t,n)=>{let i;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(i<n||void 0===i&&n>=n)&&(i=n)}),i},extent:(e,t,n)=>{let i,o;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(void 0===i?n>=n&&(i=o=n):(i>n&&(i=n),o<n&&(o=n)))}),[i,o]},mean:(e,t)=>{let n=0,i=0;if(t.forEach(t=>{let o=t.getValue(e);null!=o&&(o=+o)>=o&&(++n,i+=o)}),n)return i/n},median:(e,t)=>{if(!t.length)return;let n=0,i=0;return t.forEach(t=>{let o=t.getValue(e);"number"==typeof o&&(n=Math.min(n,o),i=Math.max(i,o))}),(n+i)/2},unique:(e,t)=>Array.from(new Set(t.map(t=>t.getValue(e))).values()),uniqueCount:(e,t)=>new Set(t.map(t=>t.getValue(e))).size,count:(e,t)=>t.length},N={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,n;return null!=(t=null==(n=e.getValue())||null==n.toString?void 0:n.toString())?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:o("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>({toggleGrouping:()=>{t.setGrouping(t=>null!=t&&t.includes(e.id)?t.filter(t=>t!==e.id):[...null!=t?t:[],e.id])},getCanGroup:()=>{var n,i,o,s;return null!=(n=null==(i=null!=(o=null==(s=e.columnDef.enableGrouping)||s)?o:t.options.enableGrouping)||i)?n:!!e.accessorFn},getIsGrouped:()=>{var n;return null==(n=t.getState().grouping)?void 0:n.includes(e.id)},getGroupedIndex:()=>{var n;return null==(n=t.getState().grouping)?void 0:n.indexOf(e.id)},getToggleGroupingHandler:()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},getAutoAggregationFn:()=>{const n=t.getCoreRowModel().flatRows[0],i=null==n?void 0:n.getValue(e.id);return"number"==typeof i?D.sum:"[object Date]"===Object.prototype.toString.call(i)?D.extent:void 0},getAggregationFn:()=>{if(!e)throw new Error;return s(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:"auto"===e.columnDef.aggregationFn?e.getAutoAggregationFn():D[e.columnDef.aggregationFn]}}),createTable:e=>({setGrouping:t=>null==e.options.onGroupingChange?void 0:e.options.onGroupingChange(t),resetGrouping:t=>{var n,i;e.setGrouping(t?[]:null!=(n=null==(i=e.initialState)?void 0:i.grouping)?n:[])},getPreGroupedRowModel:()=>e.getFilteredRowModel(),getGroupedRowModel:()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())}),createRow:e=>({getIsGrouped:()=>!!e.groupingColumnId,_groupingValuesCache:{}}),createCell:(e,t,n,i)=>({getIsGrouped:()=>t.getIsGrouped()&&t.id===n.groupingColumnId,getIsPlaceholder:()=>!e.getIsGrouped()&&t.getIsGrouped(),getIsAggregated:()=>{var t;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!(null==(t=n.subRows)||!t.length)}})};function M(e,t,n){if(null==t||!t.length||!n)return e;const i=e.filter(e=>!t.includes(e.id));return"remove"===n?i:[...t.map(t=>e.find(e=>e.id===t)).filter(Boolean),...i]}const O={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:o("columnOrder",e)}),createTable:e=>({setColumnOrder:t=>null==e.options.onColumnOrderChange?void 0:e.options.onColumnOrderChange(t),resetColumnOrder:t=>{var n;e.setColumnOrder(t?[]:null!=(n=e.initialState.columnOrder)?n:[])},_getOrderColumnsFn:a(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(e,t,n)=>i=>{let o=[];if(null!=e&&e.length){const t=[...e],n=[...i];for(;n.length&&t.length;){const e=t.shift(),i=n.findIndex(t=>t.id===e);i>-1&&o.push(n.splice(i,1)[0])}o=[...o,...n]}else o=i;return M(o,t,n)},{key:!1})})},L={getInitialState:e=>({...e,pagination:{pageIndex:0,pageSize:10,...null==e?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:o("pagination",e)}),createTable:e=>{let t=!1,n=!1;return{_autoResetPageIndex:()=>{var i,o;if(t){if(null!=(i=null!=(o=e.options.autoResetAll)?o:e.options.autoResetPageIndex)?i:!e.options.manualPagination){if(n)return;n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})}}else e._queue(()=>{t=!0})},setPagination:t=>null==e.options.onPaginationChange?void 0:e.options.onPaginationChange(e=>i(t,e)),resetPagination:t=>{var n;e.setPagination(t?{pageIndex:0,pageSize:10}:null!=(n=e.initialState.pagination)?n:{pageIndex:0,pageSize:10})},setPageIndex:t=>{e.setPagination(n=>{let o=i(t,n.pageIndex);const s=void 0===e.options.pageCount||-1===e.options.pageCount?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return o=Math.min(Math.max(0,o),s),{...n,pageIndex:o}})},resetPageIndex:t=>{var n,i,o;e.setPageIndex(t?0:null!=(n=null==(i=e.initialState)||null==(o=i.pagination)?void 0:o.pageIndex)?n:0)},resetPageSize:t=>{var n,i,o;e.setPageSize(t?10:null!=(n=null==(i=e.initialState)||null==(o=i.pagination)?void 0:o.pageSize)?n:10)},setPageSize:t=>{e.setPagination(e=>{const n=Math.max(1,i(t,e.pageSize)),o=e.pageSize*e.pageIndex,s=Math.floor(o/n);return{...e,pageIndex:s,pageSize:n}})},setPageCount:t=>e.setPagination(n=>{var o;let s=i(t,null!=(o=e.options.pageCount)?o:-1);return"number"==typeof s&&(s=Math.max(-1,s)),{...n,pageCount:s}}),getPageOptions:a(()=>[e.getPageCount()],e=>{let t=[];return e&&e>0&&(t=[...new Array(e)].fill(null).map((e,t)=>t)),t},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getCanPreviousPage:()=>e.getState().pagination.pageIndex>0,getCanNextPage:()=>{const{pageIndex:t}=e.getState().pagination,n=e.getPageCount();return-1===n||0!==n&&t<n-1},previousPage:()=>e.setPageIndex(e=>e-1),nextPage:()=>e.setPageIndex(e=>e+1),getPrePaginationRowModel:()=>e.getExpandedRowModel(),getPaginationRowModel:()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),getPageCount:()=>{var t;return null!=(t=e.options.pageCount)?t:Math.ceil(e.getPrePaginationRowModel().rows.length/e.getState().pagination.pageSize)}}}},j={getInitialState:e=>({columnPinning:{left:[],right:[]},...e}),getDefaultOptions:e=>({onColumnPinningChange:o("columnPinning",e)}),createColumn:(e,t)=>({pin:n=>{const i=e.getLeafColumns().map(e=>e.id).filter(Boolean);t.setColumnPinning(e=>{var t,o,s,r,a,l;return"right"===n?{left:(null!=(s=null==e?void 0:e.left)?s:[]).filter(e=>!(null!=i&&i.includes(e))),right:[...(null!=(r=null==e?void 0:e.right)?r:[]).filter(e=>!(null!=i&&i.includes(e))),...i]}:"left"===n?{left:[...(null!=(a=null==e?void 0:e.left)?a:[]).filter(e=>!(null!=i&&i.includes(e))),...i],right:(null!=(l=null==e?void 0:e.right)?l:[]).filter(e=>!(null!=i&&i.includes(e)))}:{left:(null!=(t=null==e?void 0:e.left)?t:[]).filter(e=>!(null!=i&&i.includes(e))),right:(null!=(o=null==e?void 0:e.right)?o:[]).filter(e=>!(null!=i&&i.includes(e)))}})},getCanPin:()=>e.getLeafColumns().some(e=>{var n,i;return(null==(n=e.columnDef.enablePinning)||n)&&(null==(i=t.options.enablePinning)||i)}),getIsPinned:()=>{const n=e.getLeafColumns().map(e=>e.id),{left:i,right:o}=t.getState().columnPinning,s=n.some(e=>null==i?void 0:i.includes(e)),r=n.some(e=>null==o?void 0:o.includes(e));return s?"left":!!r&&"right"},getPinnedIndex:()=>{var n,i,o;const s=e.getIsPinned();return s?null!=(n=null==(i=t.getState().columnPinning)||null==(o=i[s])?void 0:o.indexOf(e.id))?n:-1:0}}),createRow:(e,t)=>({getCenterVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,t,n)=>{const i=[...null!=t?t:[],...null!=n?n:[]];return e.filter(e=>!i.includes(e.column.id))},{key:"row.getCenterVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getLeftVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,,],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),{key:"row.getLeftVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getRightVisibleCells:a(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),{key:"row.getRightVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}})}),createTable:e=>({setColumnPinning:t=>null==e.options.onColumnPinningChange?void 0:e.options.onColumnPinningChange(t),resetColumnPinning:t=>{var n,i;return e.setColumnPinning(t?{left:[],right:[]}:null!=(n=null==(i=e.initialState)?void 0:i.columnPinning)?n:{left:[],right:[]})},getIsSomeColumnsPinned:t=>{var n;const i=e.getState().columnPinning;var o,s;return t?Boolean(null==(n=i[t])?void 0:n.length):Boolean((null==(o=i.left)?void 0:o.length)||(null==(s=i.right)?void 0:s.length))},getLeftLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getRightLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}}),getCenterLeafColumns:a(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(e,t,n)=>{const i=[...null!=t?t:[],...null!=n?n:[]];return e.filter(e=>!i.includes(e.id))},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}})})},x={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:o("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>({setRowSelection:t=>null==e.options.onRowSelectionChange?void 0:e.options.onRowSelectionChange(t),resetRowSelection:t=>{var n;return e.setRowSelection(t?{}:null!=(n=e.initialState.rowSelection)?n:{})},toggleAllRowsSelected:t=>{e.setRowSelection(n=>{t=void 0!==t?t:!e.getIsAllRowsSelected();const i={...n},o=e.getPreGroupedRowModel().flatRows;return t?o.forEach(e=>{i[e.id]=!0}):o.forEach(e=>{delete i[e.id]}),i})},toggleAllPageRowsSelected:t=>e.setRowSelection(n=>{const i=void 0!==t?t:!e.getIsAllPageRowsSelected(),o={...n};return e.getRowModel().rows.forEach(t=>{H(o,t.id,i,e)}),o}),getPreSelectedRowModel:()=>e.getCoreRowModel(),getSelectedRowModel:a(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?V(e,n):{rows:[],flatRows:[],rowsById:{}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getFilteredSelectedRowModel:a(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?V(e,n):{rows:[],flatRows:[],rowsById:{}},{key:"getFilteredSelectedRowModel",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getGroupedSelectedRowModel:a(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?V(e,n):{rows:[],flatRows:[],rowsById:{}},{key:"getGroupedSelectedRowModel",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}}),getIsAllRowsSelected:()=>{const t=e.getPreFilteredRowModel().flatRows,{rowSelection:n}=e.getState();let i=Boolean(t.length&&Object.keys(n).length);return i&&t.some(e=>!n[e.id])&&(i=!1),i},getIsAllPageRowsSelected:()=>{const t=e.getPaginationRowModel().flatRows,{rowSelection:n}=e.getState();let i=!!t.length;return i&&t.some(e=>!n[e.id])&&(i=!1),i},getIsSomeRowsSelected:()=>{var t;return!e.getIsAllRowsSelected()&&!!Object.keys(null!=(t=e.getState().rowSelection)?t:{}).length},getIsSomePageRowsSelected:()=>{const t=e.getPaginationRowModel().flatRows;return!e.getIsAllPageRowsSelected()&&t.some(e=>e.getIsSelected()||e.getIsSomeSelected())},getToggleAllRowsSelectedHandler:()=>t=>{e.toggleAllRowsSelected(t.target.checked)},getToggleAllPageRowsSelectedHandler:()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}}),createRow:(e,t)=>({toggleSelected:n=>{const i=e.getIsSelected();t.setRowSelection(o=>{if(i===(n=void 0!==n?n:!i))return o;const s={...o};return H(s,e.id,n,t),s})},getIsSelected:()=>{const{rowSelection:n}=t.getState();return k(e,n)},getIsSomeSelected:()=>{const{rowSelection:n}=t.getState();return"some"===U(e,n)},getIsAllSubRowsSelected:()=>{const{rowSelection:n}=t.getState();return"all"===U(e,n)},getCanSelect:()=>{var n;return"function"==typeof t.options.enableRowSelection?t.options.enableRowSelection(e):null==(n=t.options.enableRowSelection)||n},getCanSelectSubRows:()=>{var n;return"function"==typeof t.options.enableSubRowSelection?t.options.enableSubRowSelection(e):null==(n=t.options.enableSubRowSelection)||n},getCanMultiSelect:()=>{var n;return"function"==typeof t.options.enableMultiRowSelection?t.options.enableMultiRowSelection(e):null==(n=t.options.enableMultiRowSelection)||n},getToggleSelectedHandler:()=>{const t=e.getCanSelect();return n=>{var i;t&&e.toggleSelected(null==(i=n.target)?void 0:i.checked)}}})},H=(e,t,n,i)=>{var o;const s=i.getRow(t);s.getIsGrouped(),n?(s.getCanMultiSelect()||Object.keys(e).forEach(t=>delete e[t]),e[t]=!0):delete e[t],null!=(o=s.subRows)&&o.length&&s.getCanSelectSubRows()&&s.subRows.forEach(t=>H(e,t.id,n,i))};function V(e,t){const n=e.getState().rowSelection,i=[],o={},s=function(e,t){return e.map(e=>{var t;const r=k(e,n);if(r&&(i.push(e),o[e.id]=e),null!=(t=e.subRows)&&t.length&&(e={...e,subRows:s(e.subRows)}),r)return e}).filter(Boolean)};return{rows:s(t.rows),flatRows:i,rowsById:o}}function k(e,t){var n;return null!=(n=t[e.id])&&n}function U(e,t,n){if(e.subRows&&e.subRows.length){let n=!0,i=!1;return e.subRows.forEach(e=>{i&&!n||(k(e,t)?i=!0:n=!1)}),n?"all":!!i&&"some"}return!1}const q=/([0-9]+)/gm;function B(e,t){return e===t?0:e>t?1:-1}function G(e){return"number"==typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"==typeof e?e:""}function K(e,t){const n=e.split(q).filter(Boolean),i=t.split(q).filter(Boolean);for(;n.length&&i.length;){const e=n.shift(),t=i.shift(),o=parseInt(e,10),s=parseInt(t,10),r=[o,s].sort();if(isNaN(r[0])){if(e>t)return 1;if(t>e)return-1}else{if(isNaN(r[1]))return isNaN(o)?-1:1;if(o>s)return 1;if(s>o)return-1}}return n.length-i.length}const z={alphanumeric:(e,t,n)=>K(G(e.getValue(n)).toLowerCase(),G(t.getValue(n)).toLowerCase()),alphanumericCaseSensitive:(e,t,n)=>K(G(e.getValue(n)),G(t.getValue(n))),text:(e,t,n)=>B(G(e.getValue(n)).toLowerCase(),G(t.getValue(n)).toLowerCase()),textCaseSensitive:(e,t,n)=>B(G(e.getValue(n)),G(t.getValue(n))),datetime:(e,t,n)=>B(e.getValue(n).getTime(),t.getValue(n).getTime()),basic:(e,t,n)=>B(e.getValue(n),t.getValue(n))},Y={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto"}),getDefaultOptions:e=>({onSortingChange:o("sorting",e),isMultiSortEvent:e=>e.shiftKey}),createColumn:(e,t)=>({getAutoSortingFn:()=>{const n=t.getFilteredRowModel().flatRows.slice(10);let i=!1;for(const t of n){const n=null==t?void 0:t.getValue(e.id);if("[object Date]"===Object.prototype.toString.call(n))return z.datetime;if("string"==typeof n&&(i=!0,n.split(q).length>1))return z.alphanumeric}return i?z.text:z.basic},getAutoSortDir:()=>{const n=t.getFilteredRowModel().flatRows[0];return"string"==typeof(null==n?void 0:n.getValue(e.id))?"asc":"desc"},getSortingFn:()=>{if(!e)throw new Error;return s(e.columnDef.sortingFn)?e.columnDef.sortingFn:"auto"===e.columnDef.sortingFn?e.getAutoSortingFn():z[e.columnDef.sortingFn]},toggleSorting:(n,i)=>{const o=e.getNextSortingOrder();t.setSorting(s=>{var r,a;const l=null==s?void 0:s.find(t=>t.id===e.id),c=null==s?void 0:s.findIndex(t=>t.id===e.id),d=null!=n;let u,m=[];if(u=e.getCanMultiSort()&&i?l?"toggle":"add":null!=s&&s.length&&c!==s.length-1?"replace":l?"toggle":"replace","toggle"!==u||null!=(r=t.options.enableSortingRemoval)&&!r||d||i&&null!=(a=t.options.enableMultiRemove)&&!a||o||(u="remove"),"replace"===u)m=[{id:e.id,desc:d?n:"desc"===o}];else if("add"===u&&null!=s&&s.length){var g;m=[...s,{id:e.id,desc:d?n:"desc"===o}],m.splice(0,m.length-(null!=(g=t.options.maxMultiSortColCount)?g:Number.MAX_SAFE_INTEGER))}else"toggle"===u&&null!=s&&s.length?m=s.map(t=>t.id===e.id?{...t,desc:d?n:"desc"===o}:t):"remove"===u&&null!=s&&s.length&&(m=s.filter(t=>t.id!==e.id));return m})},getNextSortingOrder:()=>{var n,i;const o=(null!=(n=null!=(i=e.columnDef.sortDescFirst)?i:t.options.sortDescFirst)?n:"desc"===e.getAutoSortDir())?"desc":"asc",s=e.getIsSorted();return s?s===o&&("desc"===s?"asc":"desc"):o},getCanSort:()=>{var n,i;return(null==(n=e.columnDef.enableSorting)||n)&&(null==(i=t.options.enableSorting)||i)&&!!e.accessorFn},getCanMultiSort:()=>{var n,i;return null!=(n=null!=(i=e.columnDef.enableMultiSort)?i:t.options.enableMultiSort)?n:!!e.accessorFn},getIsSorted:()=>{var n;const i=null==(n=t.getState().sorting)?void 0:n.find(t=>t.id===e.id);return!!i&&(i.desc?"desc":"asc")},getSortIndex:()=>{var n,i;return null!=(n=null==(i=t.getState().sorting)?void 0:i.findIndex(t=>t.id===e.id))?n:-1},clearSorting:()=>{t.setSorting(t=>null!=t&&t.length?t.filter(t=>t.id!==e.id):[])},getToggleSortingHandler:()=>{const n=e.getCanSort();return i=>{n&&(null==i.persist||i.persist(),null==e.toggleSorting||e.toggleSorting(void 0,!!e.getCanMultiSort()&&(null==t.options.isMultiSortEvent?void 0:t.options.isMultiSortEvent(i))))}}}),createTable:e=>({setSorting:t=>null==e.options.onSortingChange?void 0:e.options.onSortingChange(t),resetSorting:t=>{var n,i;e.setSorting(t?[]:null!=(n=null==(i=e.initialState)?void 0:i.sorting)?n:[])},getPreSortedRowModel:()=>e.getGroupedRowModel(),getSortedRowModel:()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())})},W={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:o("columnVisibility",e)}),createColumn:(e,t)=>({toggleVisibility:n=>{e.getCanHide()&&t.setColumnVisibility(t=>({...t,[e.id]:null!=n?n:!e.getIsVisible()}))},getIsVisible:()=>{var n,i;return null==(n=null==(i=t.getState().columnVisibility)?void 0:i[e.id])||n},getCanHide:()=>{var n,i;return(null==(n=e.columnDef.enableHiding)||n)&&(null==(i=t.options.enableHiding)||i)},getToggleVisibilityHandler:()=>t=>{null==e.toggleVisibility||e.toggleVisibility(t.target.checked)}}),createRow:(e,t)=>({_getAllVisibleCells:a(()=>[e.getAllCells(),t.getState().columnVisibility],e=>e.filter(e=>e.column.getIsVisible()),{key:"row._getAllVisibleCells",debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}}),getVisibleCells:a(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(e,t,n)=>[...e,...t,...n],{key:!1,debug:()=>{var e;return null!=(e=t.options.debugAll)?e:t.options.debugRows}})}),createTable:e=>{const t=(t,n)=>a(()=>[n(),n().filter(e=>e.getIsVisible()).map(e=>e.id).join("_")],e=>e.filter(e=>null==e.getIsVisible?void 0:e.getIsVisible()),{key:t,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugColumns}});return{getVisibleFlatColumns:t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),getVisibleLeafColumns:t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),getLeftVisibleLeafColumns:t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),getRightVisibleLeafColumns:t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),getCenterVisibleLeafColumns:t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),setColumnVisibility:t=>null==e.options.onColumnVisibilityChange?void 0:e.options.onColumnVisibilityChange(t),resetColumnVisibility:t=>{var n;e.setColumnVisibility(t?{}:null!=(n=e.initialState.columnVisibility)?n:{})},toggleAllColumnsVisible:t=>{var n;t=null!=(n=t)?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((e,n)=>({...e,[n.id]:t||!(null!=n.getCanHide&&n.getCanHide())}),{}))},getIsAllColumnsVisible:()=>!e.getAllLeafColumns().some(e=>!(null!=e.getIsVisible&&e.getIsVisible())),getIsSomeColumnsVisible:()=>e.getAllLeafColumns().some(e=>null==e.getIsVisible?void 0:e.getIsVisible()),getToggleAllColumnsVisibilityHandler:()=>t=>{var n;e.toggleAllColumnsVisible(null==(n=t.target)?void 0:n.checked)}}}},J=[d,W,O,j,P,Y,N,f,L,x,g];function $(e){var t;(e.debugAll||e.debugTable)&&console.info("Creating Table Instance...");let n={_features:J};const o=n._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultOptions?void 0:t.getDefaultOptions(n)),{});let s={...null!=(t=e.initialState)?t:{}};n._features.forEach(e=>{var t;s=null!=(t=null==e.getInitialState?void 0:e.getInitialState(s))?t:s});const r=[];let c=!1;const d={_features:J,options:{...o,...e},initialState:s,_queue:e=>{r.push(e),c||(c=!0,Promise.resolve().then(()=>{for(;r.length;)r.shift()();c=!1}).catch(e=>setTimeout(()=>{throw e})))},reset:()=>{n.setState(n.initialState)},setOptions:e=>{const t=i(e,n.options);n.options=(e=>n.options.mergeOptions?n.options.mergeOptions(o,e):{...o,...e})(t)},getState:()=>n.options.state,setState:e=>{null==n.options.onStateChange||n.options.onStateChange(e)},_getRowId:(e,t,i)=>{var o;return null!=(o=null==n.options.getRowId?void 0:n.options.getRowId(e,t,i))?o:""+(i?[i.id,t].join("."):t)},getCoreRowModel:()=>(n._getCoreRowModel||(n._getCoreRowModel=n.options.getCoreRowModel(n)),n._getCoreRowModel()),getRowModel:()=>n.getPaginationRowModel(),getRow:e=>{const t=n.getRowModel().rowsById[e];if(!t)throw new Error;return t},_getDefaultColumnDef:a(()=>[n.options.defaultColumn],e=>{var t;return e=null!=(t=e)?t:{},{header:e=>e.header.column.id,footer:e=>e.header.column.id,cell:e=>{var t,n;return null!=(t=null==(n=e.renderValue())||null==n.toString?void 0:n.toString())?t:null},...n._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultColumnDef?void 0:t.getDefaultColumnDef()),{}),...e}},{debug:()=>{var e;return null!=(e=n.options.debugAll)?e:n.options.debugColumns},key:!1}),_getColumnDefs:()=>n.options.columns,getAllColumns:a(()=>[n._getColumnDefs()],e=>{const t=function(e,i,o){return void 0===o&&(o=0),e.map(e=>{const s=l(n,e,o,i);return s.columns=e.columns?t(e.columns,s,o+1):[],s})};return t(e)},{key:!1,debug:()=>{var e;return null!=(e=n.options.debugAll)?e:n.options.debugColumns}}),getAllFlatColumns:a(()=>[n.getAllColumns()],e=>e.flatMap(e=>e.getFlatColumns()),{key:!1,debug:()=>{var e;return null!=(e=n.options.debugAll)?e:n.options.debugColumns}}),_getAllFlatColumnsById:a(()=>[n.getAllFlatColumns()],e=>e.reduce((e,t)=>(e[t.id]=t,e),{}),{key:!1,debug:()=>{var e;return null!=(e=n.options.debugAll)?e:n.options.debugColumns}}),getAllLeafColumns:a(()=>[n.getAllColumns(),n._getOrderColumnsFn()],(e,t)=>t(e.flatMap(e=>e.getLeafColumns())),{key:!1,debug:()=>{var e;return null!=(e=n.options.debugAll)?e:n.options.debugColumns}}),getColumn:e=>{const t=n._getAllFlatColumnsById()[e];if(!t)throw new Error;return t}};return Object.assign(n,d),n._features.forEach(e=>Object.assign(n,null==e.createTable?void 0:e.createTable(n))),n}const X=(e,t,n,i,o,s)=>{let l={id:t,index:i,original:n,depth:o,_valuesCache:{},getValue:t=>{if(l._valuesCache.hasOwnProperty(t))return l._valuesCache[t];const n=e.getColumn(t);return n.accessorFn?(l._valuesCache[t]=n.accessorFn(l.original,i),l._valuesCache[t]):void 0},renderValue:t=>{var n;return null!=(n=l.getValue(t))?n:e.options.renderFallbackValue},subRows:null!=s?s:[],getLeafRows:()=>r(l.subRows,e=>e.subRows),getAllCells:a(()=>[e.getAllLeafColumns()],t=>t.map(t=>(function(e,t,n,i){const o={id:t.id+"_"+n.id,row:t,column:n,getValue:()=>t.getValue(i),renderValue:()=>{var t;return null!=(t=o.getValue())?t:e.options.renderFallbackValue},getContext:()=>({table:e,column:n,row:t,cell:o,getValue:o.getValue,renderValue:o.renderValue})};return e._features.forEach(i=>{Object.assign(o,null==i.createCell?void 0:i.createCell(o,n,t,e))},{}),o})(e,l,t,t.id)),{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugRows}}),_getAllCellsByColumnId:a(()=>[l.getAllCells()],e=>e.reduce((e,t)=>(e[t.column.id]=t,e),{}),{key:"row.getAllCellsByColumnId",debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugRows}})};for(let t=0;t<e._features.length;t++){const n=e._features[t];Object.assign(l,null==n||null==n.createRow?void 0:n.createRow(l,e))}return l};function Q(e,t,n){return n.options.filterFromLeafRows?(function(e,t,n){const i={},o=function(e,s){const r=[];for(let s=0;s<e.length;s++){var a;let l=e[s];if(null!=(a=l.subRows)&&a.length){const e=X(n,l.id,l.original,l.index,l.depth);if(e.columnFilters=l.columnFilters,e.subRows=o(l.subRows),!e.subRows.length)continue;l=e}t(l)&&(r.push(l),i[l.id]=l,i[s]=l)}return r};return{rows:o(e),flatRows:[],rowsById:i}})(e,t,n):(function(e,t,n){const i=[],o={},s=function(e,r){const a=[];for(let r=0;r<e.length;r++){let c=e[r];if(t(c)){var l;if(null!=(l=c.subRows)&&l.length){const e=X(n,c.id,c.original,c.index,c.depth);e.subRows=s(c.subRows),c=e}a.push(c),i.push(c),o[c.id]=c}}return a};return{rows:s(e),flatRows:i,rowsById:o}})(e,t,n)}function Z(e,t){const n=[],i=e=>{var t;n.push(e),null!=(t=e.subRows)&&t.length&&e.getIsExpanded()&&e.subRows.forEach(i)};return e.rows.forEach(i),{rows:n,flatRows:e.flatRows,rowsById:e.rowsById}}e.ColumnSizing=g,e.Expanding=f,e.Filters=P,e.Grouping=N,e.Headers=d,e.Ordering=O,e.Pagination=L,e.Pinning=j,e.RowSelection=x,e.Sorting=Y,e.Visibility=W,e.aggregationFns=D,e.buildHeaderGroups=u,e.createColumn=l,e.createRow=X,e.createTable=$,e.defaultColumnSizing=m,e.expandRows=Z,e.filterFns=C,e.flattenBy=r,e.flexRender=function(e,t){return e?(function(e){return"function"==typeof e&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()})(i=e)||"function"==typeof i||(function(e){return"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)})(i)?n.createElement(e,t):e:null;var i},e.functionalUpdate=i,e.getCoreRowModel=function(){return e=>a(()=>[e.options.data],t=>{const n={rows:[],flatRows:[],rowsById:{}},i=function(t,o,s){void 0===o&&(o=0);const r=[];for(let l=0;l<t.length;l++){const c=X(e,e._getRowId(t[l],l,s),t[l],l,o);var a;n.flatRows.push(c),n.rowsById[c.id]=c,r.push(c),e.options.getSubRows&&(c.originalSubRows=e.options.getSubRows(t[l],l),null!=(a=c.originalSubRows)&&a.length&&(c.subRows=i(c.originalSubRows,o+1,c)))}return r};return n.rows=i(t),n},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.getExpandedRowModel=function(){return e=>a(()=>[e.getState().expanded,e.getPreExpandedRowModel(),e.options.paginateExpandedRows],(e,t,n)=>t.rows.length&&n&&(!0===e||Object.keys(null!=e?e:{}).length)?Z(t):t,{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}})},e.getFacetedMinMaxValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{var n;const i=null==(n=e.flatRows[0])?void 0:n.getValue(t);if(void 0===i)return;let o=[i,i];for(let n=0;n<e.flatRows.length;n++){var s;const i=null==(s=e.flatRows[n])?void 0:s.getValue(t);i<o[0]?o[0]=i:i>o[1]&&(o[1]=i)}return o},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFacetedRowModel=function(){return(e,t)=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter,e.getFilteredRowModel()],(n,i,o)=>{if(!n.rows.length||(null==i||!i.length)&&!o)return n;const s=[...i.map(e=>e.id).filter(e=>e!==t),o?"__global__":void 0].filter(Boolean);return Q(n.rows,e=>{for(let t=0;t<s.length;t++)if(!1===e.columnFilters[s[t]])return!1;return!0},e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFacetedUniqueValues=function(){return(e,t)=>a(()=>[e.getColumn(t).getFacetedRowModel()],e=>{let n=new Map;for(let s=0;s<e.flatRows.length;s++){var i;const r=null==(i=e.flatRows[s])?void 0:i.getValue(t);var o;n.has(r)?n.set(r,(null!=(o=n.get(r))?o:0)+1):n.set(r,1)}return n},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{}})},e.getFilteredRowModel=function(){return e=>a(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,n,i)=>{if(!t.rows.length||(null==n||!n.length)&&!i){for(let e=0;e<t.flatRows.length;e++)t.flatRows[e].columnFilters={},t.flatRows[e].columnFiltersMeta={};return t}const o=[],s=[];(null!=n?n:[]).forEach(t=>{var n;const i=e.getColumn(t.id).getFilterFn();i&&o.push({id:t.id,filterFn:i,resolvedValue:null!=(n=null==i.resolveFilterValue?void 0:i.resolveFilterValue(t.value))?n:t.value})});const r=n.map(e=>e.id),a=e.getGlobalFilterFn(),l=e.getAllLeafColumns().filter(e=>e.getCanGlobalFilter());let c,d;i&&a&&l.length&&(r.push("__global__"),l.forEach(e=>{var t;s.push({id:e.id,filterFn:a,resolvedValue:null!=(t=null==a.resolveFilterValue?void 0:a.resolveFilterValue(i))?t:i})}));for(let e=0;e<t.flatRows.length;e++){const n=t.flatRows[e];if(n.columnFilters={},o.length)for(let e=0;e<o.length;e++){c=o[e];const t=c.id;n.columnFilters[t]=c.filterFn(n,t,c.resolvedValue,e=>{n.columnFiltersMeta[t]=e})}if(s.length){for(let e=0;e<s.length;e++){d=s[e];const t=d.id;if(d.filterFn(n,t,d.resolvedValue,e=>{n.columnFiltersMeta[t]=e})){n.columnFilters.__global__=!0;break}}!0!==n.columnFilters.__global__&&(n.columnFilters.__global__=!1)}}return Q(t.rows,e=>{for(let t=0;t<r.length;t++)if(!1===e.columnFilters[r[t]])return!1;return!0},e)},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.getGroupedRowModel=function(){return e=>a(()=>[e.getState().grouping,e.getPreGroupedRowModel()],(t,n)=>{if(!n.rows.length||!t.length)return n;const i=t.filter(t=>e.getColumn(t)),o=[],s={},a=function(t,n,l){if(void 0===n&&(n=0),n===i.length)return t;const c=i[n],d=(function(e,t){const n=new Map;return e.reduce((e,n)=>{const i=""+n.getValue(t),o=e.get(i);return o?e.set(i,[...o,n]):e.set(i,[n]),e},n)})(t,c);return Array.from(d.entries()).map((t,d)=>{let[u,m]=t,g=c+":"+u;g=l?l+">"+g:g;const h=a(m,n+1,g),p=n?r(m,e=>e.subRows):m,_=X(e,g,void 0,d,n);return Object.assign(_,{groupingColumnId:c,groupingValue:u,subRows:h,leafRows:p,getValue:t=>{var n;if(i.includes(t))return _._valuesCache.hasOwnProperty(t)?_._valuesCache[t]:(m[0]&&(_._valuesCache[t]=null!=(n=m[0].getValue(t))?n:void 0),_._valuesCache[t]);if(_._groupingValuesCache.hasOwnProperty(t))return _._groupingValuesCache[t];const o=e.getColumn(t).getAggregationFn();return o?(_._groupingValuesCache[t]=o(t,p,m),_._groupingValuesCache[t]):void 0}}),h.forEach(e=>{o.push(e),s[e.id]=e}),_})},l=a(n.rows,0,"");return l.forEach(e=>{o.push(e),s[e.id]=e}),{rows:l,flatRows:o,rowsById:s}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._queue(()=>{e._autoResetExpanded(),e._autoResetPageIndex()})}})},e.getPaginationRowModel=function(e){return e=>a(()=>[e.getState().pagination,e.getPrePaginationRowModel()],(t,n)=>{if(!n.rows.length)return n;const{pageSize:i,pageIndex:o}=t;let{rows:s,flatRows:r,rowsById:a}=n;const l=i*o,c=l+i;let d;s=s.slice(l,c),d=e.options.paginateExpandedRows?{rows:s,flatRows:r,rowsById:a}:Z({rows:s,flatRows:r,rowsById:a}),d.flatRows=[];const u=e=>{d.flatRows.push(e),e.subRows.length&&e.subRows.forEach(u)};return d.rows.forEach(u),d},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable}})},e.getSortedRowModel=function(){return e=>a(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,n)=>{if(!n.rows.length||null==t||!t.length)return n;const i=e.getState().sorting,o=[],s=i.filter(t=>e.getColumn(t.id).getCanSort()),r={};s.forEach(t=>{const n=e.getColumn(t.id);r[t.id]={sortUndefined:n.columnDef.sortUndefined,invertSorting:n.columnDef.invertSorting,sortingFn:n.getSortingFn()}});const a=e=>{const t=e.slice();return t.sort((e,t)=>{for(let i=0;i<s.length;i+=1){var n;const o=s[i],a=r[o.id],l=null!=(n=null==o?void 0:o.desc)&&n;if(a.sortUndefined){const n=void 0===e.getValue(o.id),i=void 0===t.getValue(o.id);if(n||i)return n&&i?0:n?a.sortUndefined:-a.sortUndefined}let c=a.sortingFn(e,t,o.id);if(0!==c)return l&&(c*=-1),a.invertSorting&&(c*=-1),c}return e.index-t.index}),t.forEach(e=>{o.push(e),!e.subRows||e.subRows.length<=1||(e.subRows=a(e.subRows))}),t};return{rows:a(n.rows),flatRows:o,rowsById:n.rowsById}},{key:!1,debug:()=>{var t;return null!=(t=e.options.debugAll)?t:e.options.debugTable},onChange:()=>{e._autoResetPageIndex()}})},e.isFunction=s,e.isRowSelected=k,e.isSubRowSelected=U,e.makeStateUpdater=o,e.memo=a,e.noop=function(){},e.orderColumns=M,e.passiveEventSupported=p,e.reSplitAlphaNumeric=q,e.selectRowsFn=V,e.shouldAutoRemoveFilter=F,e.sortingFns=z,e.useReactTable=function(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[i]=n.useState(()=>({current:$(t)})),[o,s]=n.useState(()=>i.current.initialState);return i.current.setOptions(t=>({...t,...e,state:{...o,...e.state},onStateChange:t=>{s(t),null==e.onStateChange||e.onStateChange(t)}})),i.current},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pkg-files-table.min.js-vfla1Zqbd.map