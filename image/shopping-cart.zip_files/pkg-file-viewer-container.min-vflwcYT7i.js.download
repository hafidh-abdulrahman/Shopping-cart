define("metaserver/static/js/action_bar/file_actions/portable/download",["require","exports","tslib","metaserver/static/js/clean/downloads","metaserver/static/js/share_download/ui/api","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","js/filepath/filepath"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.downloadSingleFileAsZip=t.downloadSingleFile=void 0,r=i.__importStar(r),n=i.__importStar(n);t.downloadSingleFile=({href:e,source:t,isFswm:n=!1},{onAttempt:o,onSuccess:l,onError:c}={})=>i.__awaiter(void 0,void 0,void 0,(function*(){null==o||o();const i=n?yield(0,s.fetchDownloadUrl)(e,void 0,a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE):e;r.get({url:i,source:`${t}_direct`,error:c}),null==l||l()}));t.downloadSingleFileAsZip=({fqPath:e,rootNsId:t,source:s,blockHash:a,user:o},{onAttempt:l,onSuccess:c}={})=>i.__awaiter(void 0,void 0,void 0,(function*(){null==l||l(),r.get_zip({fq_paths:[e],subject_uid:o.id,block_hash:a,parent_path:n.parent_dir(e),source:s,root_ns_id:t}),null==c||c()}))})),define("metaserver/static/js/action_bar/file_actions/portable/save_as_copy/save_as_copy",["require","exports","tslib","metaserver/static/js/share_download/ui/copy_to_dropbox/api","metaserver/static/js/core/browser","metaserver/static/js/action_bar/file_actions/portable/save_as_copy/save_modal","metaserver/static/js/share_download/ui/copy_to_dropbox/copy_to_dropbox_modal","metaserver/static/js/file_store/utils","metaserver/static/js/file_store/utils"],(function(e,t,i,r,s,a,n,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.portableSaveAsCopy=void 0,r=i.__importStar(r),s=i.__importStar(s);t.portableSaveAsCopy=({shareToken:e,user:t,file:c},{onSuccess:d,onError:p,onNetworkRequest:u,onModalClose:_},v)=>{if(v&&(0,l.isSharedFile)(c))(0,n.showCopyToDropboxModal)({shareToken:e,copyable:c,user:t});else{const n=()=>i.__awaiter(void 0,void 0,void 0,(function*(){try{null==u||u();const i=yield r.copySharedFile(e,t.id);null==d||d(),s.redirect(i)}catch(e){null==p||p(e)}})),l=()=>{null==_||_()};(0,a.showSaveFileModal)({user:t,onConfirm:n,onCancel:l,fileName:(0,o.getFilename)(c)})}}})),define("metaserver/static/js/action_bar/file_actions/portable/save_as_copy/save_modal",["require","exports","tslib","dig-components/modal","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/components/ui/modal","react","metaserver/static/js/core/i18n","metaserver/static/js/clean/em_string","metaserver/static/js/clean/viewer","js/filepath/filepath","dig-components/typography","metaserver/static/js/dig-illustrations/spot/file-folders","dig-components/buttons"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showSaveFileModal=t.SaveFileModal=void 0,l=i.__importDefault(l),u=i.__importStar(u);t.SaveFileModal=({user:e,onConfirm:t,onCancel:i,fileName:o})=>{const[f,g]=l.default.useState(!0),h=()=>{null==i||i(),g(!1)};return l.default.createElement(r.Modal,{open:f,onRequestClose:h},l.default.createElement(r.Modal.Header,{hasBottomSpacing:"title-standard",className:"naming-conventions__header"},l.default.createElement("div",{style:{textAlign:"right"}},l.default.createElement(s.IconButton,{onClick:h,variant:"transparent"},l.default.createElement(a.UIIcon,{src:n.CloseLine}))," "),l.default.createElement(_.Title,null,(S=o,e&&e.is_cdm_member?c.intl.formatMessage({id:"bxu2bk",defaultMessage:"Save a copy of ‘{name}’ to your member folder?"},{name:d.Emstring.em_snippet(S,15)}):c.intl.formatMessage({id:"aAhGow",defaultMessage:"Save a copy of ‘{name}’?"},{name:d.Emstring.em_snippet(S,15)})))),l.default.createElement(r.Modal.Body,null,l.default.createElement("div",null,l.default.createElement("div",{style:{width:"60%",margin:"0 auto"}},l.default.createElement(v.FileFoldersSpot,null)),l.default.createElement(_.Text,null,(t=>{const i=p.Viewer.get_viewer();return e&&e.is_cdm_member?c.intl.formatMessage({id:"bxn/4H",defaultMessage:"This will save a copy of the original file to the <strong>{cdm_tmf_name}</strong> folder in your {team_name} Dropbox account."},{cdm_tmf_name:u.filename(e.cdm_tmf_path),team_name:i.team_name,strong:e=>l.default.createElement("strong",null,e)}):c.intl.formatMessage({id:"Qm4Vrc",defaultMessage:"This will save a copy of the original file to your Dropbox account. Changes made to the original file or copy will not be saved to the other."})})()))),l.default.createElement(r.Modal.Footer,null,l.default.createElement(m.Button,{variant:"opacity",onClick:h},c.intl.formatMessage({id:"Li86mZ",defaultMessage:"Cancel"})),l.default.createElement(m.Button,{variant:"primary",onClick:()=>{t(),g(!1)}},c.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"}))));var S},t.showSaveFileModal=function(e){o.Modal.showInstance(l.default.createElement(t.SaveFileModal,Object.assign({},e)))}})),define("metaserver/static/js/action_bar/file_actions/portable/save_as_copy/snackbars",["require","exports","metaserver/static/js/core/i18n","metaserver/static/js/files_view/file_actions/snackbars","metaserver/static/js/clean/ui/snackbar"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveCopyFailedSnackBar=t.saveCopySnackBarInProgress=void 0;t.saveCopySnackBarInProgress=e=>s.Snackbar.sync(i.intl.formatMessage({id:"Adz4fH",defaultMessage:"Saving to your personal Dropbox..."}),!1,e,!0);t.saveCopyFailedSnackBar=(e,t,i)=>s.Snackbar.fail((0,r.renameError)(e.error,t),i)})),define("metaserver/static/js/action_bar/file_actions/portable/utils",["require","exports","tslib","react","dig-components/menu","dig-components/buttons","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types","dig-components/tooltips"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePluginActionDefinition=t.getCustomButton=t.getCustomActionOverflowItem=void 0,r=i.__importDefault(r);t.getCustomActionOverflowItem=({label:e,action:t,id:i,icon:a,disabled:l={disabled:!1},overflowItemTooltipDataAttribute:c})=>{const d=r.default.createElement(s.Menu.ActionItem,{value:{nodeType:"dropdown",actionType:n.ActionBarActionTypes.CUSTOM_ACTION,id:i,menuItem:{handler:t}},withLeftAccessory:a,disabled:l.disabled,"data-tooltip":c},e);return l.disabled?r.default.createElement(o.Tooltip,{title:l.tooltipMessage},r.default.createElement("span",{style:{display:"block"},tabIndex:0},d)):d};t.getCustomButton=({label:e,action:t,icon:i,disabled:s={disabled:!1},primary:n,tooltipMessage:l,actionBarButtonClassName:c,isActionBarButtonLoading:d=!1})=>{const p=e=>{e.preventDefault(),e.stopPropagation(),t()},u=e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),t())};return t=>{const _=r.default.createElement(a.Button,{variant:n?"primary":"opacity",onClick:p,onKeyPress:u,withIconLeft:t?null:i,disabled:s.disabled,className:c,isLoading:d},e);return l?r.default.createElement(o.Tooltip,{title:l,maxWidth:320},_):_}};t.makePluginActionDefinition=e=>{var{overflowItemTooltipDataAttribute:r}=e,s=i.__rest(e,["overflowItemTooltipDataAttribute"]);const a=(0,t.getCustomButton)(s),n=(0,t.getCustomActionOverflowItem)(Object.assign(Object.assign({},s),{overflowItemTooltipDataAttribute:r}));return{id:s.id,renderButton:a,overflowItem:n}}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&("get"in s?t.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/capture/loadable_preview_recorder",["require","exports","metaserver/static/js/async/loadable"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncPreviewRecorder=void 0,t.AsyncPreviewRecorder=(0,i.Loadable)({loader:()=>new Promise((t,i)=>{e(["metaserver/static/js/capture/previews_recorder"],t,i)}).then(__importStar).then(({PreviewRecorder:e})=>e)})})),define("metaserver/static/js/comments2/client_builder",["require","exports","metaserver/static/js/comments2/comments_bolt","metaserver/static/js/comments2/data/mentions_api","metaserver/static/js/flows/approval/approval_io_client"],(function(e,t,i,r,s){"use strict";function a(e){var t;return{channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:parseInt(null!==(t=e.revision)&&void 0!==t?t:"",10),token:e.token}}}function n({channelId:e,revisionInfo:t}){return{app_id:e.appId,unique_id:e.uniqueId,revision:t.revision.toString(),token:t.token}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeComments2Client=t.boltChannelClientToServer=t.boltChannelServerToClient=void 0,t.boltChannelServerToClient=a,t.boltChannelClientToServer=n,t.makeComments2Client=function(e){let t=void 0;if(e){let i=null;const s=()=>{const t=(0,r.mentionsApi)(e);return{search(e,i){0!==e.length?t.query(e,i):i(t.getMatchesWithStarterSuggestions())}}};t=()=>(i||(i=s()),i)}return{boltIOClient:(e=>{let t=e=>{};return{subscribe:i=>(i.forEach(i=>{e.subscribe(n(i),t,t)}),Promise.resolve()),unsubscribe:()=>Promise.resolve(e.unsubscribe()),onSignal:e=>{t=t=>{const i=t.map(e=>a(e));e({updatedChannels:i})}}}})(i.bolt),mentionsIOClient:t,approvalIOClient:e?(0,s.approvalIOClient)(e.id):void 0}}})),define("metaserver/static/js/comments2/comments_bolt",["require","exports","metaserver/static/js/bolt/bolt_nodeps"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bolt=void 0,t.bolt={client:null,subscribe({app_id:e,revision:r,token:s,unique_id:a},n,o){const l=new i.SignedChannelState(e,a,r,s);t.bolt.client?t.bolt.client.update_states([l]):(t.bolt.client=new i.BoltClient([l],n,o),t.bolt.client.start())},unsubscribe(){t.bolt.client&&(t.bolt.client.unsubscribe(),t.bolt.client=null)}}})),define("metaserver/static/js/comments2/util",["require","exports","tslib","metaserver/static/js/core/browser"],(function(e,t,i,r){"use strict";function s(e){return(t,i)=>void 0===t||void 0===i?t===i:e(t,i)}function a(...e){return s((t,i)=>e.every(e=>t[e]===i[e]))}function n({x:e,y:t,width:i,height:r}){return 0===e&&0===t&&1===i&&1===r}Object.defineProperty(t,"__esModule",{value:!0}),t.parseActiveCommentFromUrl=t.isFullImageAnnotation=t.isFullPageAnnotation=t.isTimecodeAnnotation=t.isContextSame=t.isStreamSame=t.isUserSame=void 0,r=i.__importStar(r),t.isUserSame=a("id"),t.isStreamSame=a("type","id"),t.isContextSame=s((e,i)=>(0,t.isStreamSame)(e.stream,i.stream)&&(0,t.isUserSame)(e.viewer,i.viewer)),t.isTimecodeAnnotation=function(e){return void 0!==e&&("audio"===e.type||"video"===e.type)},t.isFullPageAnnotation=function(e){return 1===e.regions.length&&n(e.regions[0])},t.isFullImageAnnotation=function(e){return n(e.region)},t.parseActiveCommentFromUrl=function(){const e=/comment_id=(.*)/.exec(r.get_uri().getFragment());return e?e[1]:void 0}})),define("metaserver/static/js/dig-illustrations/spot/file-folders",["require","exports","tslib","react"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileFoldersSpot=void 0,r=i.__importStar(r);t.FileFoldersSpot=e=>{var{altText:t,inverse:s}=e,a=i.__rest(e,["altText","inverse"]);const n=`dig-Illustration dig-Illustration-spot${s?" dig-Illustration--inverse":""}`;return r.createElement("svg",Object.assign(Object.assign({role:"presentation"},a),{className:n,viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("title",null,t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M408.6 42.5c-30.9 10.2-63.2 18.4-95.4 27.9-15.3 4.9-24.9 15.4-38.4 22.2-12.7 7.2-27.4 14.6-39.9 22.3-20.5 11.2-17.4 29.2-21.7 47.4-1.5 4.4-4.2 10.3-5.1 15.2-2.7 12.8-3 24.6-6.1 37.1.3 9.9-12.2 19.3-1.5 27.3 2.5 1.9 4 3.1 7.1 3.1 10.5-.5 23.5-19.5 29-28.2.5-2.3 8.3-5 11.7-6.7 4.9-2.4 11.9-7 14-9.1 4.5-4.4.7-13.8-.6-19.2 9.3-4 19.8-15 27.8-21.1 4.5-2 15.5-3.5 21.4-5.3 1 9.5 2.3 29.2 3.8 35.3 2.4 6.9 2.7 17.4 2.9 23.8-.3 3.2-6.6 10.6-7.4 13.5-3.3 6.1-5.1 17.5-2.3 23.5 2.9 6.9 11.7 8.7 18.2 6.5 6.8-1.6 19.6-15.4 24.5-18.4 22.2-12.2 37.7-37.1 57-52.5 10.6-6.5 18.7-10.1 29.9-17 5.9-4 11.9-5.9 15.1-10.8 2.6-3 8.7-5.8 10.5-8.6v-8.8c1.8-.3 1.7-.8 2.2-4.8.3-3.6 1.2-2.3.4-6.4-.1-13.3-16.6-30.5-23.5-39.8-9.2-11.3-11.3-26.9-20.5-38.8 0 3.5-5.6 3.4-4.3-3.5-1.4 3.4-3.2 2.4-3.2-2.3-2.8 1.3 1.3-.6 1.4-1.1-.6 2.5-2.6.2-2.8 0-.3-.8-4.2-1.4-4.2-2.7zm-58.9 120.2c1.2.3 7.8 1.5 8.8 1.9-1.7 6.7-8.1 15.9-13.3 21.3.9-1.2.8-22.5 2.4-23.7.1 0 1.1.2 2.1.5z",fill:"#E39D77"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M295.2 192.2c-5.2 2.4-20.7 14.7-28 18.9-.1-10.7-1.6-15.3-12.9-7.8-10.4 6.2-16.5 9.6-25.7 15.3-14.7 6.3-10 16.4-13.3 23.6-1.3.4-4.8 5.1-5.6 5.8-.4.1-2.2 1.2-4 2.3-21 12.8-38.8 24.3-59 37-25.1 16.1-49.1 31.5-72.6 47.8-9 6.7-16.2 10.3-26.2 17.6-7.1 4-5.8 14.3-4 23 1.5 4.2 0 5.7 3 7.2 2 .7 6.9.4 7-1.5 10.8-7.8 18.1-13.7 27.5-20.3 41.3-24.9 83.8-50.8 125.7-77.2 26.7-18 47.7-40.2 71.5-58.5 5.5-4 29.7-19.8 31.2-21.4 2.2-3-2.1-2.7-4-3.2-.9-3.2-3.2-9.3-5.6-8.1-2.3-.8-1.7-2.1-5-.5z",fill:"#B4DC19"}),r.createElement("g",{fillRule:"evenodd",clipRule:"evenodd",fill:"#1E1919"},r.createElement("path",{d:"M317.1 69.9c-23.2 10-31.6 23.2-46.2 41.8-7.1 5.3-11.8 8.4-25.2 18.9-5.8 6.7-15.9 11.4-21.7 18.6-6.5 8.3-12.3 18.2-16.9 26.9-.2.6-.2.7.5 1 1.7 1 3.6-1.7 4.8-3.3 19 6 27.4 2.6 3.9-1.2-.7-.3-2.3-.2-2.8-.4.1-.3 2-3.3 2.6-2.8 2.8.9 12.2 1.8 11.2-1-1.2-.4-8.1-.7-10.9-.6 5.2-7.6 7.3-14 15.3-20.3 4.2-4.3 11.2-7.3 14.8-11.5 5.9-6.9 16.9-13.6 26.4-20.6 8.1-6.3 12.5-16.4 20.5-23.7 7.5-9.3 16.3-13.6 28.2-19.2 7.7-2.3-.2-5.6-4.5-2.6z"}),r.createElement("path",{d:"M232.9 119.2c-3.8 2.1 7.5 4.7 9.5 5.9 3.5 1.8 8.6 1.5 6.6-1.2-.6-.3-8.1-2.7-8.7-3-2.4-.8-5.3-2.8-7.4-1.7zm-8.1 6.1c-1.9 1-2 1.6-.3 2.5 3.4 1.6 7.1 3.2 7.8 3.2 1.5-.1 4.3-2.1 4-2.9-.4-1.1-10.5-4.7-11.5-2.8zm106.4.5c-1.9.4-4 1-1.3 3.1 6.8 6.2 20.7 25.1 27.5 26.8 4.9-1.5 1.4-3-2.4-7-6.2-4.2-19.7-23.9-23.8-22.9z"}),r.createElement("path",{d:"M371.5 138.7c-5 8-9.3 14.2-13.3 21.3-1.2-.4-5.7-2.5-6.7-3.1-3.1-1.6-11-4.9-14.1-6.6-1.4-.5-1.6-1.4-2.5-1.6-1 .1-5.1-2.8-5.9-1.5-.8.7-1.7-.7-3-.8-1.7-.5-6-.8-7.2.6-4.1 3.2-12.9 5.9-17.9 7-4 1.2 1.3 2.6 4.3 1.5 2.4-.4 6.6-2 7.9-1.9-3.7 4 5 1.3 6.6-.1 3.9.8 11.9 3.7 14.4 3.8.9-.4 9.8 5 9.1 5.8-.1.9.4 2.8 1.6 3 7.3.2-2-5.3 10.8-.5-.1.4-1.7 4.5-1.8 5 .5 3 3 1.2 5.4-3.9 7.3-13.7 13.1-19.8 19.8-29.4-1-1-3-1.5-4.8-1.6-.7-.1-1.1.3-2.7 3zm-110.8 12.1c-3.1 1.8.4 2.4 3.3 3.6 11.7 4.5 15.4 5.5 20.3 5.7 3 .1 6.3 0 7.5-1.6-6.7-.2-16.5-3.5-22.5-6.1-2.9-.8-6.6-2.9-8.6-1.6zm78.3 17.9c-4.1 1.8-11.4 3.5-15.5 6.6-1.3 2.6 5.9-1 3.3.9-5.1 3.9 2.1 2.9 5.9.4 2.8-1.7 7.9-5.8 7.8-6.2-.2-.5 1.7-1.5.9-1.8-.6-.3-.7-.3-2.4.1zm-79.6 11.9c-12.6 5.4-14 12.9-20.1 24-.5 2.6-12.1 13.5-3.6 9.8 2.9-1.2 9.9-11.4 12.9-15.8.6 2.1 2 10.4 2.4 9.7 7.7.5 5.1-3 3-11.7-.5-1.8-.3-2.4.8-2.4.6 0 1.8-1.1 8-7.7 1.3-1.8 6.1-3.9 2.3-4.5-1.1.1 1.8-1.3 1.5-1.5-1-1.5-5.1-1.4-7.2.1zm86 6.8c-8.2 4.8-18 13.5-23.4 22.1-.4-1.3-2.7-11.5-4-10.6-3.8.1.7 8.8.5 11.2.2 1.4 2.3 0 2.9.3-.8 2-7.8 10.1-3.5 9.1 10.3-2.4 18.6-22.2 29.6-28.3 1.8-1.4 3.7-2.2 1.2-2.8-2.1-.5-.7-1.6-3.3-1zm20.3 16.6c-1.8 4.8 5.9 6.7 4.6 3.4-1-.9-2.8-4.7-4.6-3.4zm-9.2 3.4c-.9 3.4 14.8 6.3 9.7 2.6-1.4-.5-9-3.8-9.7-2.6zm-14.7 3.5c-.8 1 1.3 1.3 3.3 1.6 4.1.4 12.9 4 15.9 6 2.5 1.8 9.3 8.9 11.6 4.3-7.4-6.3-20.2-12.6-30.8-11.9zm-137.7 1.3c-3.4 1.7-1.9 13.7-3.2 18.1-.2.9-5.7 6.8-4.7 6.8 3.6 1.9 7.7-3.6 9.3-6.6 1.4-3.3.6-14.4 1.2-18.6-.9-.1-1.8 0-2.6.3zm46.4 9.9c-.9.2-1.8.2-2.2 1.3-.2.5-.4.7-.4.4 0-.6-1-.9-2.3-.6-1 .2-1.1.3-2.9 3.7-2.5 4.8-4 7.5-5.3 9.2-.1-1.9.8-7.7 1.3-10.4.7-1.3-2.4-.7-2.7-.4-1.7 4-5.9 19.2 3.6 12.3.8-.6 3.3-4.5 3.8-5.2 0 1.4-.6 3.8 2 3.4 2.9.7 4.3-4.1 5.4-7.6 2.5.2 5.4-.3 5.2-3.1-.1-1.7-1-.2-1.7-.1-.9-1.6-1-3.8-3.8-2.9zm80.3 10.2c-2.6 1.1-7.1 2.7-9.1 4.6-2.8 4.2-8.1 11.7-9 16.2-.7 2.9-.8 5.1 2.2 2.3 2.7-5 6.7-11.1 9.5-15.4 1-3.2 5.2-4.9 9.3-6.4 2.5 2.1 3.9 6.6 5.4 9.8 10.1 4.9 2.3-8.7-1.2-10.5-.8-1.2-5.8-.8-7.1-.6z"})),r.createElement("g",{fill:"currentColor"},r.createElement("path",{d:"M489 150.6c-15.7-20-28.2-42.1-41.6-65.2C439.9 67.9 430.1 57 417 45c-.6-.1-2.1-2.2-2.6-2.3-.2-.2-1.6 1-1.7.6.1-.3-1.5-.8-1.2-1.1 1.8-1.6 29.2-10.5 20.6-12.6-4.8-1.6-3.3-2-8.5.4-4.8 2.8-20.6 6.6-18.4 10.8-2.6-.8-5.1 2.6-4.9 4.3 4.6 1.8 8.5.9 12.9 5.2 4.4 2.3 14.3 14.3 16.3 16.5 4.7 6 8.7 13.9 12.6 22.1 8.2 14.1 15.1 24.8 23.1 38-3.3-1 .2 12.2.5 14.6 1 3.7 1.9 4.5 3.8 6.6 1.6 1.7 1.6 1.3 1.8-1.9.1-2.4.5-4.6.9-6.8.6.8 1.7 2.4 2.5 2.4.4.1.8.3.9.5 2.3 3.5 5.2 7 8 10.6 2.4 3 2.7 3.3 2.9 3.3 1.5-.9 3.9-3.9 2.5-5.6zm-22-21c-.2.2-.9-1.1-1.1-1.4.2.3 1.2 1.2 1.1 1.4z"}),r.createElement("path",{d:"M465.9 128.2c.2.3.9 1.5 1.1 1.4.1-.2-.9-1.1-1.1-1.4zM96 351.6c40.9-26.6 82.5-48.1 122.1-76.8 20.2-15 33.9-27.4 53.5-41.6 6.4-5.1 14.7-9.4 19.9-14.7 4.5-4.5 4.8-4.7 12.5-10 1.5-.9 4.6-3.7 5.9-4.5.6-.2.6-.6-.1-1.1-.6-.4-.6-.4.5-.7 1.2-.3 1.5-.1 1.5 1.4-.4 3 3.9 3.4 5 1.9.4-.6-.4-4.8-1.4-5-5.2-2.6-14.3 4.7-18.9 7.8-1.9.4-10.3 8.6-12.8 10.8-9.1 6.6-27.8 19.1-36.9 27.2-25.4 21.1-54.2 41.3-82.8 58.4-24.7 14.3-50.2 30.6-74.5 45.6-1.6.8-16 10.5-17.3 11.1-5.3 3.1-14.7 8.5-17.1 13.3-2.7 5.7-1.9 15.7-2.4 22.2 1.4.6 4.6.9 5.4.3 1.2-3-1.3-19.4 3.9-23.2 7.1-6.7 22.9-15 34-22.4zm-51.5-56.7c23.5-16.3 52.5-29.4 74.3-46.4 1.9-11.5 4.3-30.2 19.1-33 4.5-.8 20.8-9.5 22.1-9.3 2-.3 1.2 3.1 1.9 5.6.4 6.3 1.8 10 8.4 8.6 8.3-3 20.2-11.5 28.4-15.3-4.3-4.9-13.4 1.5-17.4 4.4-17.5 10.5-11.7 10-15.9-3.3-6.2-7.9-19.9 3.6-28.9 6.3-18.4 3.6-21.3 20.4-24.1 34.9-14.3 11.4-31.3 19.8-46.8 29.8-20.2 12.1-39.9 26-59.6 38.8 11.9-4.3 27.9-14.4 38.5-21.1zm396-3.2c-2.3-18.4-2.4-42.8-4.8-60-1.2-3.1-6.7-.8-8.5-4.3-2.7-8.6-3.8-11.8-13-7.9-1.9-4.5 1.9-15.8-7-15.9-7.2 1-10.7 7.7-17.3 10.6-7.4 4-5.7 3.2-7.8 9-2.3 7.2-3.9 16-3.6 24.2-9.4 8-20 16.7-30 24.3-8.1 6.6-16.7 11.1-24.2 18.2-29.3 25.4-59.8 47.7-91.1 71.1-21.1 16-39.2 24.8-58.7 40.7-12.2 11-14.3 6.7-21.7 17.3-.7 0-2 20.3 3.8 10.9.4 0 .8-6.1 1.2-5.6 4.9 2.8 11.8 7.8 17.3 8.9 2.5.1.8 1.5-.6 2.1-1.6 1.4-.4 4.2-.5 7.8.4 4.1-.1 9.3-.5 17.9.4 1.6 6.2.3 6.4-.7 1.8-5 1.5-16.7 1.5-24.5 2.8-6.4 7.6-6.1 15.1-11.9 17.1-11.4 26.3-16.2 38.4-25.5 3-2.1 5.3-1.2 8.2-3.8 1-.7 1.5-1 2.5-1 2.1 0 2.8-.6 1.2-1.2-3-.2 11.3-10 12-11.4 15.8-14.2 31.1-25.3 47.9-38.5 25.1-18.1 49.1-38.2 71-59.6 16.9-15.9 33.7-36.7 51.5-50.7 3.8-4.2 1.8 7.1 2.9 14.9.8 20.2 2.7 39.1 3.8 58.3 0 5 1.5 6 4.5 4.6.8-.6.9-.8 1-2.4-.1-5.9 0-10.1-.9-15.9zm-56-60.1c1.5-5.3 1.8-11 4.2-13.2 5.5-2.2 14.3-9.4 19.6-12.6 3.1 2.6-1.4 14.1 1.8 15.9-6.4 3.7-19.1 14.8-25.8 20.3-3.6 4.2-.2-5.8.2-10.4zm37.1 2.9c-21.5 17.7-38.6 40.4-60.1 58.9-23.4 22-43.5 36.8-68.1 55.6-16 12.3-30.8 24-45.5 37.1-2.1 1.4-2.9.1-5.5 2.2-8 5.2-3.5.2-14.3 9.1-11.5 8.7-23 15.5-35.5 23.5-3 1.2-15.3 10.6-16.4 7.4 6.7-2.9-2.6-2.9-4.1-4-3.8-1.2-2.7 1-7.3-1.7-4.9-2.7-3.2-3.3-7.4.8-2.4-9.8 3.4-9.1 10-11.4 8-5 25.8-19.7 33.5-24.3 30.7-18 54.6-37.8 84.4-60 17.4-12.9 33.8-26.9 49.8-40.5 11.4-7.9 25-17.6 34.8-26.3 17-13.6 31.6-29 49.1-40.6 2.5-2.9 3.7 14.2 2.6 14.2zM87.3 395.9c-.6-13 29-26 38.8-33.7 14.5-9.1 25.6-16.6 39.8-25 31.6-19.6 57-36 88.6-54.5 16.5-10.1 36-22 44.9-28.9 3.5-2.9 10.9-5.3 4.8-5.9-6.5 1.8-24.8 15.5-32.5 19.4-.3-.7 9.8-8.1 11.8-10.1 11.4-10.1 23.4-24.8 32.7-36.3-1-.9-3.4-1.5-4.9.6-13.5 13.9-26.5 31-42.9 42.5-.1.1-4.5 3.9-4.6 4-.5 1.3-24.8 12.3-17.2 14.5-33.5 18.8-65.6 40.3-98 59.9-12.3 7.5-27.8 18.1-38.6 24.7-12.8 9-31.7 17.2-27.5 34.1.4 3.3.4 3.3 4 3.5 3.5.8-.1-5.8.8-8.8zM70.5 297c28.7-15.9 56-33.7 84.1-49.7 10.9-5.9 24.1-17.7 36.9-22.4 9.7-4.1 2.2-5-4.6-2.1-9.8 4-9.7 5-19.8 11.2-14.3 10.6-30.1 18.3-45.3 27.7-27.8 17.2-56 33.3-84.6 48.4-7.7 4.2-12.7 7-19.5 11.3 18.8-3.4 34.8-15.6 52.8-24.4z"}),r.createElement("path",{d:"M142 414.1c-1.4-.1-6.8-4.1-7.7-2.9-.9.6-.9.3-.3-1.6 6-6.1 22.3-15.6 34.2-23.6 29.6-19.9 58.1-38.5 87-58.5 17.9-12.3 41.9-29.3 58.5-44 17.2-14.4 38.4-35.6 57-49.2 2.6-.9-.8-2-2.5-1.9-12.2 5.1-24 19.2-34.8 26.4-.9-.2-3.6-1.2-4-1.2-.6.2-6.1 4.8-6.7 5-13.2 8.1-30.4 19.8-41.5 30.9-23.3 16.7-51.7 31.8-76.4 48.1-22.6 15.1-45.3 27-66.7 43-7.2 5.6-23.2 12-27.6 22.8l.2 7.6h3.1c1.1-3.3.8-7.6 2.8-10.8 2.7-4.9 9.5-8.7 13.7-11.5 13.4-7.8 30.7-21 44.4-28.3 20.3-12.5 41-25.7 61.7-38.5 17.5-11 37.9-20.2 55.3-35.6 9.4-8.4 24-18.7 33.6-23.5-2.7 3.6-14.2 12.7-19.1 17.1-55 44.1-114.8 81-172.2 120.4-4.8 2.8-4.8 7.7-7.1 12.7-2.5 3.8 3 4.1 4.5 1.7.7-2.8 4 0 6 .2 2.2 1.5 9.4-4 4.6-4.8zm-95.7-34.9c-7.5-1.9-16.2-5.8-24-4.8-2.6.1-2.4.3-2.8 2.4 8.9 2.7 18.9 5.1 27 8.5 1.9-1.9 3.6-5.7-.2-6.1zm32 8.7c-4.6-.4-11.7-4-12.8.5-1.5-4.7.9-5.8 1.3-9.5-.8-1.2-3.3 2.1-3.9 3.5-1.7 3.2-.3 8-.4 12.1-.3 8.1 3.4 2.7 3.2-1.5 0-1.5.1-2 .3-1.8 1.2-.4 10.7 4 12 1.3.7-1.4 1.9-3.9.3-4.6zm29.5 11.9c-2.3-1.1-11.4-4.4-11.8-4.3-.4 0-.8.1-.9.3-.8.8-1.4-1.5.3-1.7 2.2-.7 3.9-.8 4.8-3.5 1.7-5.7-5.3-.8-7 .4-2.5 3.1-2.8 5.1-1.2 10.4 1.2 5.6 2.7 3.7 3.5.1 0-1 .1-.8.9-.3 1.4.9 10.2 4.6 10.6 4.5.8-.6 3.5-5.1.8-5.9zm131.8-.7c-.2.3-.3.8-.3 1.2-.1 1.3 1.2-1.8 1.1-1.6-.3-.3-.6 0-.8.4z"}),r.createElement("path",{d:"M126.5 405.6c-1-1.4-4.1 3.3-4.5 3.9-.3.8-.5 9.4.8 8.7 4-.7 2.7-7.9 3.7-10.8.5-1.3.5-1.4 0-1.8zm27.1 4c-.4-1-.7-1.2-1.4-.1-.6 1-4.8 5.1-5.3 6.2-1 .6-1.6 11.8-.8 13.2.4.6 1.2-.6 1.6-.6 1-.3 1.7-1.8 2.2-2.5 1-1.3-.5-11.3 1.9-12.5.7-1 2.3-2.5 1.8-3.7z"})))},t.FileFoldersSpot.displayName="FileFoldersSpotIllustration"})),define("metaserver/static/js/extensions/common",["require","exports"],(function(e,t){"use strict";function i(e,t,i){e&&e.event(t,i)}function r(e){return e.link_state[".tag"].indexOf("_linked")>=0}Object.defineProperty(t,"__esModule",{value:!0}),t.partitionActionsByLinkStatus=t.isPrelinked=t.isLinked=t.getAppActionExtras=t.getOpenOptionsWithLogging=t.handleShowByline=t.logEvent=void 0,t.logEvent=i,t.handleShowByline=function(e,t){return()=>{i(t,"show_byline",{extension_id:e})}},t.getOpenOptionsWithLogging=function(e,t){return e.map(e=>Object.assign(Object.assign({},e),{handler:()=>{e.handler(),i(t,"select_legacy_action",{type:e.type})}}))},t.getAppActionExtras=function(e){return{action_id:e.id,encoded_app_id:e.app_id,action_type:r(e)?"select_action":"select_connect"}},t.isLinked=r,t.isPrelinked=function(e){return"oauth_prelinked"===e.link_state[".tag"]},t.partitionActionsByLinkStatus=function(e){const t=[],i=[];return e.map(e=>{e.app_id&&(r(e)?t.push(e.app_id):i.push(e.app_id))}),{connected_apps:t,unconnected_apps:i}}})),define("metaserver/static/js/extensions/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSFER_FP_APP_ID=void 0,t.TRANSFER_FP_APP_ID="fp_app_id:dropbox_transfer"})),define("metaserver/static/js/extensions/data/helpers",["require","exports","metaserver/static/js/app_actions/category","metaserver/static/js/file_viewer/open_button/types","metaserver/static/js/extensions/common","metaserver/static/js/extensions/constants"],(function(e,t,i,r,s,a){"use strict";function n(e,t){if(e.priority&&t.priority){const i=t.priority-e.priority;return 0!==i?i:e.description<t.description?-1:e.description>t.description?1:0}return e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.constructAlphabetizeActions=t.partitionOptions=t.partitionActions=t.actionCompareFn=void 0,t.actionCompareFn=n,t.partitionActions=function(e,t=0){const r=[],o=[],l=[],c=[],d=[];return e.sort(n).forEach(e=>{e.category===i.Category.CLOUD_EDITORS?r.push(e):e.app_id===a.TRANSFER_FP_APP_ID?o.push(e):(0,s.isLinked)(e)||(0,s.isPrelinked)(e)?l.push(e):void 0!==e.priority&&e.priority>0&&c.length<t?c.push(e):d.push(e)}),{cloudEditors:r,transferActions:o,installedActions:l,promotedActions:c,unpromotedActions:d}},t.partitionOptions=function(e){const t=[],i=[];let s,a,n,o,l,c;return e.forEach(e=>{const{type:d}=e;d===r.OpenButtonAction.UNITY_FILE||d===r.OpenButtonAction.UNITY_FOLDER?t.push(e):d===r.OpenButtonAction.OPEN_WITH||d===r.OpenButtonAction.OPEN_WITH_CLOUD_DOC?i.push(e):d===r.OpenButtonAction.DOWNLOAD?s=e:d===r.OpenButtonAction.PREVIEW_FILE?a=e:d===r.OpenButtonAction.OPEN_IN_REPLAY?n=e:d===r.OpenButtonAction.OPEN_IN_DESKTOP?o=e:d===r.OpenButtonAction.GO_TO_FOLDER?l=e:d===r.OpenButtonAction.OPEN_IN_NEW_TAB&&(c=e)}),{unityOptions:t,cloudEditorOptions:i,downloadOption:s,previewOption:a,openInReplayOption:n,openInDesktopOption:o,openInNewTabOption:c,goToFolderOption:l}},t.constructAlphabetizeActions=function(e){return(t,i)=>{const r=e[t.category].display_name,s=e[i.category].display_name;return r<s?-1:r>s?1:t.description<i.description?-1:t.description>i.description?1:0}}})),define("metaserver/static/js/file_viewer/container_with_skeleton",["require","exports","metaserver/static/js/file_viewer/container"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerWithSkeleton=void 0,t.ContainerWithSkeleton=i.FileViewerContainer})),define("metaserver/static/js/file_viewer/container",["require","exports","tslib","react","metaserver/static/js/clean/history","metaserver/static/js/cloud_docs/types","metaserver/static/js/open_in_app/actions","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/clean/ui/snackbar_manager","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/viewer","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/extensions/data/store","metaserver/static/js/integrations/zoom_share_dialog/async_modal","metaserver/static/js/core/browser","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/file_viewer/utils","metaserver/static/js/file_viewer/sdk_file_viewer/utils","typescript/libraries/file-viewer/src/core/types/auth_modal","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/file_viewer/constants","metaserver/static/js/action_bar/file_actions/portable/save_as_copy/save_as_copy","metaserver/static/js/file_store/utils","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils","metaserver/static/js/clean/ui/error_boundary","metaserver/static/js/core/exception","metaserver/static/js/previews/ui/constants","metaserver/static/js/sync_everything/constants","metaserver/static/js/file_viewer/sdk_file_viewer/file_viewer","typescript/libraries/file-viewer/src/logging/performance","metaserver/static/js/user_survey/user_survey","metaserver/static/js/privacy_consent/privacy_consent_cookies","js/browser/cookies","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/pass/store"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f,g,h,S,w,E,I,P,A,b,O,y,T,C,R,D,k,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileViewerContainerTestOnly=t.FileViewerContainer=t.useAuthModalKind=void 0,r=i.__importDefault(r),s=i.__importDefault(s),v=i.__importStar(v);const L=({children:e})=>{const t=r.default.useRef(null),i=r.default.useRef(null);return r.default.useEffect(()=>{c.Snackbar.manager=c.Snackbar.manager?c.Snackbar.manager:t.current},[]),r.default.createElement("div",{ref:i},e,r.default.createElement(l.SnackbarManager,{ref:t,getParentElement:()=>i.current,useDigSnackbars:!0}))};L.displayName="SnackbarManagerContainer";const M=(e,t)=>{t&&(0,u.initializeStore)(t,[e])};t.useAuthModalKind=e=>r.default.useMemo(()=>{if(!e)return;return new D.ConsentCookieStore({}).hasPreviouslyDeclinedConsent()?void 0:k.Cookies.read("seen-sl-signup-modal")?k.Cookies.read("seen-sl-download-modal")?void 0:(k.Cookies.create("seen-sl-download-modal","true",30),S.LoginOrRegisterKind.DOWNLOAD):(k.Cookies.create("seen-sl-signup-modal","true",30),S.LoginOrRegisterKind.IMMEDIATE)},[e]);const F=({file:l,userId:c,shareModalVariant:u,openImmediatelyInApp:A,onCloseUrl:b,redirectOnClose:D,isEmbedded:k,brandingInfo:F,encryptionOptions:j,sharedLinkInfo:x,shareToken:U,sharePermission:B,authModalKind:V,copyLinkButtonOOBPreviewsVariant:H,fileViewOrigin:q,appDownloadInterstitialDismissed:K,initialPreviewSourceAction:W,initialPreviewSourceContext:G,hidePageChrome:z,showCloudDocPreview:Y,allowAuthModal:X})=>{const J=r.default.useMemo(()=>{const e=d.Viewer.get_viewer();return c?e.get_user_by_id(c):e.work_user||e.personal_user},[c]),{openInHelloSignSrc:Q,urlSourceContext:$,copyToDropbox:Z,presentInZoom:ee,isCapture:te,shareEmail:ie,saveAs:re,saveAsAction:se}=r.default.useMemo(()=>{var e,t,i;const r=new URLSearchParams(window.location.search);return{openInHelloSignSrc:null!==(e=r.get("hellosign"))&&void 0!==e?e:void 0,urlSourceContext:null!==(t=r.get("context"))&&void 0!==t?t:O.PreviewSourceContext.Unknown,presentInZoom:!!r.get("zoom"),isCapture:!!r.get("capture"),copyToDropbox:r.has("copy_to_dropbox"),shareEmail:null!==(i=r.get("share_email"))&&void 0!==i?i:void 0,saveAs:r.get("save_as"),saveAsAction:r.get("save_as_action")}},[]);(0,C.usePreviewTimingSession)();const ae=(0,t.useAuthModalKind)(X),ne=null!=V?V:ae,oe=G||$,[le,ce]=r.default.useState(l);r.default.useEffect(()=>{(0,p.log_js_modules_application_code_start)(),C.PreviewsEventLogger.mark(C.PreviewsTimingEvents.CONTAINER_CODE_START),M(l,J)},[]);const de=r.default.useMemo(()=>{if(b)return e=>{const{path:t,qargs:i}=s.default.deconstruct_url(b);D?"fileDeleted"===e?v.redirect(t):v.redirect(b):s.default.push_state(t,i)}},[b,D]),pe=r.default.useCallback((e,t)=>{if(e.revision_id===le.revision_id&&(0,I.isBrowseFile)(le))if(t){const e=Object.assign(Object.assign({},le),{file_id:t.file_id,revision_id:t.revision_id,fq_path:t.fq_path});ce(e),M(e,J)}else null==de||de("fileDeleted")},[le,de,J]);r.default.useEffect(()=>{if(oe===O.PreviewSourceContext.PdfEditor&&R.UserSurvey.trackEvent("save_pdf_editor","previews"),Z&&l&&J&&U){const t=new URL(window.location.href);(0,E.portableSaveAsCopy)({file:le,user:J,shareToken:U},{onNetworkRequest:()=>{new Promise((t,i)=>{e(["metaserver/static/js/action_bar/file_actions/portable/save_as_copy/snackbars"],t,i)}).then(i.__importStar).then(({saveCopySnackBarInProgress:e})=>{e(P.PREVIEWS_SNACKBAR_ID)})}}),t.searchParams.delete("copy_to_dropbox"),window.history.replaceState(t.href,"",t.href)}if(re&&l&&J){const t=new URL(window.location.href);t.searchParams.delete("save_as"),t.searchParams.delete("save_as_action"),window.history.replaceState(t.href,"",t.href),new Promise((t,i)=>{e(["metaserver/static/js/action_bar/file_actions/portable/file_conversion"],t,i)}).then(i.__importStar).then(({portableFileConversion:e})=>e({file:l,sharedLinkInfo:x,sharePermission:B,shareToken:U,user:J,actionToTrigger:se}))}if(ie||u&&u!==a.ShareModalVariant.closed&&J?new Promise((t,i)=>{e(["metaserver/static/js/browse/models"],t,i)}).then(i.__importStar).then(({File:e})=>{const t=new e(l);if(u!==a.ShareModalVariant.manageAccess||ie||t.is_unmounted){const e=ie?ie.split(","):[];(0,o.asyncShowPrefilledShareModal)({user:J,sharePrefillEmails:e,content:t})}else(0,o.asyncShowManageAccessModal)(J,t,N.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE)}):ne!==S.LoginOrRegisterKind.IMMEDIATE||J||te?ee&&J&&(0,_.asyncShowModal)(J.id,l.file_id,"file-viewer-modal-overlay","desktop"):(0,g.showAuthModal)({mode:h.AuthMode.REGISTER,kind:h.LoginOrRegisterKind.IMMEDIATE,encryptionOptions:j,loggingExtra:{source:"file_preview_initial_load"}}),A){const e=l;(0,n.openImmediately)(e.open_in_app_data)}v.get_uri().getQuery().sync_from_docsend&&(0,f.showDocSendSnackbar)(J)},[]);const ue=void 0!==J&&q===w.FileViewOriginType.SHARE_PAGE,_e=q===w.FileViewOriginType.SHARED_LINK_PAGE,ve=q===w.FileViewOriginType.PAPER&&k,me=oe===O.PreviewSourceContext.FileLocking,fe=ue||_e||ve?r.default.createElement(L,null,r.default.createElement(T.FileViewer,{closeFile:de,file:l,previewContentOnly:z,showCloudDocPreview:Y,sharedLinkInfo:x,sharePermission:B,shareToken:U,brandingInfo:F,user:J,encryptionOptions:j,previewSurface:ue?m.SDKPreviewSurface.INBAND_SHARE:ve?m.SDKPreviewSurface.SHARED_LINK_EMBED:m.SDKPreviewSurface.SHARED_LINK,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!K,authModalKind:ne,copyLinkButtonOOBPreviewsVariant:H,initialSourceAction:W,fileViewOrigin:q,sourceContext:oe})):r.default.createElement(L,null,r.default.createElement(T.FileViewer,{closeFile:de,file:l,previewContentOnly:z,showCloudDocPreview:Y,user:J,brandingInfo:F,encryptionOptions:j,previewSurface:(0,y.isBackupBrowse)()?m.SDKPreviewSurface.BACKUP:me?m.SDKPreviewSurface.FILE_LOCKING:m.SDKPreviewSurface.STANDALONE_PREVIEW,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!K,authModalKind:ne,onFileChanged:pe,fileViewOrigin:q,sourceContext:oe}));return Q&&((t,r,s)=>{new Promise((t,i)=>{e(["metaserver/static/js/integrations/hellosign_deep_integration/launcher"],t,i)}).then(i.__importStar).then(({getLauncher:e})=>{const i=e();return i.init({entryPoint:"file_preview_side_bar",file:t,user:r,source:s}),i}).then(e=>(e.launch(),e))})(le,J,Q),k?r.default.createElement("div",{className:"embedded"},fe):fe};t.FileViewerContainerTestOnly=F,F.displayName="FileViewerContainer";t.FileViewerContainer=e=>r.default.createElement(A.ErrorBoundary,{onCatch:e=>(0,b.reportException)({err:e,tags:["file-viewer-container"],severity:"critical"})},r.default.createElement(F,Object.assign({},e)))})),define("metaserver/static/js/file_viewer/open_button/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenButtonAction=void 0,(function(e){e[e.DOWNLOAD=0]="DOWNLOAD",e[e.UNITY_FILE=1]="UNITY_FILE",e[e.UNITY_FOLDER=2]="UNITY_FOLDER",e[e.OPEN_WITH=3]="OPEN_WITH",e[e.APP_ACTION=5]="APP_ACTION",e[e.PREPARE_FOR_SIGNATURE=6]="PREPARE_FOR_SIGNATURE",e[e.SHARE_TO_SLACK=7]="SHARE_TO_SLACK",e[e.PRESENT_IN_ZOOM=8]="PRESENT_IN_ZOOM",e[e.SHARE_TO_TRELLO=9]="SHARE_TO_TRELLO",e[e.INVITE_VIA_EMAIL=10]="INVITE_VIA_EMAIL",e[e.OPEN_WITH_CLOUD_DOC=11]="OPEN_WITH_CLOUD_DOC",e[e.OPEN_MORE_APPS=12]="OPEN_MORE_APPS",e[e.OPEN_ADD_APPS=13]="OPEN_ADD_APPS",e[e.DECOMPRESS_FILE=14]="DECOMPRESS_FILE",e[e.PREVIEW_FILE=15]="PREVIEW_FILE",e[e.TRANSFER=16]="TRANSFER",e[e.OPEN_IN_DESKTOP=17]="OPEN_IN_DESKTOP",e[e.GO_TO_FOLDER=18]="GO_TO_FOLDER",e[e.OPEN_IN_REPLAY=19]="OPEN_IN_REPLAY",e[e.OPEN_IN_NEW_TAB=20]="OPEN_IN_NEW_TAB",e[e.CONVERT_AND_SHARE=24]="CONVERT_AND_SHARE",e[e.SELL_WITH_SHOP=25]="SELL_WITH_SHOP",e[e.SHARE_WITH_COLLECTION=26]="SHARE_WITH_COLLECTION",e[e.CREATE_CLIENT_PORTAL=21]="CREATE_CLIENT_PORTAL",e[e.EDIT_CLIENT_PORTAL=22]="EDIT_CLIENT_PORTAL",e[e.SHARE_WITH_ANALYTICS=23]="SHARE_WITH_ANALYTICS"})(t.OpenButtonAction||(t.OpenButtonAction={}))})),define("metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils",["require","exports","metaserver/static/js/clean/filetypes"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getType=t.isCloudDoc=t.isPnmSuppressMoveSelected=t.isPnmLinkNodeSelected=t.isInsideVaultFolder=t.isLiveFile=t.PREVIEWS_SNACKBAR_ID=void 0,t.PREVIEWS_SNACKBAR_ID="preview-action";t.isLiveFile=e=>!("isDeleted"in e&&"is_unmounted"in e)||!e.isDeleted&&!e.is_unmounted;t.isInsideVaultFolder=e=>"is_in_vault_folder"in e&&e.is_in_vault_folder;t.isPnmLinkNodeSelected=e=>{var t;return"per_node_metadata"in e&&!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node)};t.isPnmSuppressMoveSelected=e=>{var t;return"per_node_metadata"in e&&!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_move)};t.isCloudDoc=e=>"is_cloud_doc"in e&&e.is_cloud_doc;t.getType=e=>"type"in e?e.type:i.FileTypes.FILE})),define("metaserver/static/js/file_viewer/sdk_file_viewer/app_download_interstitial",["require","exports","tslib","react","metaserver/static/js/bug_reporting/routing","metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial","metaserver/static/js/file_viewer/constants","metaserver/static/js/clean/analytics","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/file_store/utils","metaserver/static/js/core/browser_detection","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/open_in_app/ui/banner","typescript/libraries/file-viewer/src/file_viewer/context_provider"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenInAppHeader=t.FvsdkAppDownloadInterstitial=void 0,r=i.__importDefault(r),d=i.__importStar(d);t.FvsdkAppDownloadInterstitial=e=>{const{file:t,sharedLinkInfo:i,onDismiss:d,openInAppData:p,fileViewerSessionId:u,filePreviewSessionId:_,onAppDownload:v,logUserAction:m,fileViewOrigin:f}=e,g=(0,c.getFilename)(t),h=r.default.useCallback(e=>{o.MobileFilePreviewLogger.log(e,u,_,t.ns_id,t.sjid,{context:n.UserActionContext.AppDownloadInterstitial,location:"file_viewer",origin:f}),null==m||m(e,n.UserActionContext.AppDownloadInterstitial)},[t,_,u,m,f]);r.default.useEffect(()=>{(0,l.mark_time_to_interactive)(),h(n.UserAction.AppDownloadInterstitialView)},[]);const S=r.default.useCallback(()=>{d(),h(n.UserAction.AppDownloadInterstitialContinue)},[d,h]),w=r.default.useCallback(()=>{d(),h(n.UserAction.AppDownloadInterstitialClose)},[d]),E=r.default.useCallback(()=>{h(n.UserAction.AppDownloadInterstitialInstall),null==v||v()},[d,v]);return r.default.createElement(s.RegisterComponentWithBugReporter,{componentId:"web.previews",componentName:"File Preview"},r.default.createElement("div",{"aria-label":g},r.default.createElement(a.AppDownloadInterstitial,{fileOrFolderName:g,open_in_app_data:p,onContinue:S,onAppDownload:E,ownerName:i.ownerName,ownerTeamName:i.ownerTeamName,onClose:w})))},t.FvsdkAppDownloadInterstitial.displayName="FvsdkAppDownloadInterstitial";t.OpenInAppHeader=e=>{const{onHide:t,user:i,activePreviewFile:s}=e,a=(0,_.useFileViewerContext)(),o=r.default.useCallback(()=>{a.pluginContext.logUserAction(n.UserAction.OpenInApp,n.UserActionContext.OpenInAppBanner)},[]);if(!d.is_mobile_or_tablet()&&(d.iOS||d.is_android()))return null;const{file:l,shareToken:c,sharePermission:v}=s,m=(0,p.getOpenInAppUrls)(l,c,v,i);if(m){const e=!(l&&c&&v);return r.default.createElement("div",{style:{width:"100%"}},r.default.createElement(u.OpenInAppBanner,{urls:m,onClick:o,onClose:t,isMountedFile:e}))}return null},t.OpenInAppHeader.displayName="OpenInAppHeader",t.OpenInAppHeader.displayName="OpenInAppHeader"})),define("metaserver/static/js/file_viewer/sdk_file_viewer/async_plugin_loaders",["require","exports","tslib","typescript/libraries/file-viewer/src/core/types/preview_type","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/extensions/constants","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeVideoEditPluginLoader=t.makeViewCaptureVoiceoverDropdownLoader=t.makeRecordVideoDropdownLoader=t.makeFlowsBoltPluginLoader=t.makeSignaturesDropdownLoader=t.makeStarToolbarButtonLoader=t.makeRestoreActionLoader=t.makeVersionHistoryActionLoader=t.makeUnzipActionLoader=t.makeDocsendAnalyticsAddOnLoader=t.makeStarredActionLoader=t.makeAddToCollectionActionLoader=t.makeTransferActionLoader=t.makeCreateVersionLoader=t.makeRequestApprovalLoader=t.makeGoToFolderActionLoader=t.makeOpenInDesktopActionLoader=t.makeRenameActionLoader=t.makeWaterMarkingActionPluginLoader=t.makePublishPaintedDoorLoader=t.makeOpenInReplayActionLoader=t.makePublishLoader=t.makeOpenDropdownActionLoader=t.makeMoveActionLoader=t.makeDeleteActionLoader=t.makeDownloadActionLoader=t.makeCopyActionLoader=void 0;t.makeCopyActionLoader=(t,r,a,n)=>({pluginId:s.COPY_ACTION_PLUGIN_ID,load:(s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeCopyPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/copy_plugin"],t,i)}).then(i.__importStar);return s(t,r,o,a,n)}))});t.makeDownloadActionLoader=(t,r,a,n,l,c,d,p)=>({pluginId:s.DOWNLOAD_ACTION_PLUGIN_ID,load:(s,u)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeDownloadPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/download_plugin"],t,i)}).then(i.__importStar),_="ON"===o.fileViewerFeatureExperiments.saveAsForFileShmodels;return s(t,u,r,a,n,l,c,d,p,_)}))});t.makeDeleteActionLoader=(t,r,a)=>({pluginId:s.DELETE_ACTION_PLUGIN_ID,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeDeletePlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/delete_plugin"],t,i)}).then(i.__importStar);return s(t,r,n,a)}))});t.makeMoveActionLoader=(t,r,a,n,o)=>({pluginId:s.MOVE_ACTION_PLUGIN_ID,load:(s,l)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeMovePlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/move_plugin"],t,i)}).then(i.__importStar);return s(t,r,l,a,n,o)}))});t.makeOpenDropdownActionLoader=(t,r)=>({pluginId:s.OPEN_DROPDOWN_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeOpenDropdownAction:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/open_dropdown_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makePublishLoader=(t,r)=>({pluginId:s.PUBLISH_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makePublishPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/publish_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeOpenInReplayActionLoader=(t,r)=>({pluginId:s.OPEN_IN_REPLAY_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeOpenInReplayPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/open_in_replay_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makePublishPaintedDoorLoader=(t,r)=>({pluginId:s.PUBLISH_PAINTED_DOOR_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makePublishPaintedDoorPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/publish_painted_door_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeWaterMarkingActionPluginLoader=t=>({pluginId:s.WATERMARKING_ACTION_PLUGIN_ID,load:(r,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeWaterMarkingActionPlugin:a}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/watermarking/edit_plugin/action_plugin"],t,i)}).then(i.__importStar);return a(t,r,s)}))});t.makeRenameActionLoader=(t,r,a,n)=>({pluginId:s.RENAME_ACTION_PLUGIN_ID,load:(s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeRenamePlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/rename_plugin"],t,i)}).then(i.__importStar);return s(t,r,o,a,n)}))});t.makeOpenInDesktopActionLoader=(t,r,a)=>({pluginId:s.OPEN_IN_DESKTOP_ACTION_PLUGIN_ID,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeOpenInDesktopPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/open_in_desktop_plugin"],t,i)}).then(i.__importStar);return s(t,r,n,a)}))});t.makeGoToFolderActionLoader=(t,r)=>({pluginId:s.GO_TO_FOLDER_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeGoToFolderPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/go_to_folder_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeRequestApprovalLoader=(t,r,n)=>({pluginId:s.REQUEST_APPROVAL_ACTION_PLUGIN_ID,load:(s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{RequestApprovalPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/approval/request_approval_plugin"],t,i)}).then(i.__importStar);return new s(o,r,t,e=>(0,a.SDKPreviewSurfaceToPapType)(n,e))}))});t.makeCreateVersionLoader=(t,r,n)=>({pluginId:s.CREATE_VERSION_ACTION_PLUGIN_ID,load:(s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{CreateVersionPlugin:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/version/create_version_plugin"],t,i)}).then(i.__importStar);return new s(o,r,t,e=>(0,a.SDKPreviewSurfaceToPapType)(n,e))}))});t.makeTransferActionLoader=t=>({pluginId:s.TRANSFER_ACTION_PLUGIN_ID,load:(r,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const[{makeTransferPlugin:r},{getStore:a},{getActions:o}]=yield Promise.all([new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/transfer_plugin"],t,i)}).then(i.__importStar),new Promise((t,i)=>{e(["metaserver/static/js/extensions/data/store"],t,i)}).then(i.__importStar),new Promise((t,i)=>{e(["metaserver/static/js/extensions/data/selectors"],t,i)}).then(i.__importStar),new Promise((t,i)=>{e(["metaserver/static/js/extensions/constants"],t,i)}).then(i.__importStar)]),l=!!o(a().getState()).find(e=>e.app_id===n.TRANSFER_FP_APP_ID);return r(t,s,l)}))});t.makeAddToCollectionActionLoader=(t,r)=>({pluginId:s.ADD_TO_COLLECTION_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeAddToCollectionActionLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/add_to_collection_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeStarredActionLoader=(t,r)=>({pluginId:s.STARRED_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeStarredActionLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/starred_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeDocsendAnalyticsAddOnLoader=(t,r,a)=>({pluginId:s.DOCSEND_ANALYTICS_ADD_ON_ACTION_PLUGIN_ID,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeAnalyticsAddOn:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/docsend_analytics_add_on_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeUnzipActionLoader=(t,r)=>({pluginId:s.UNZIP_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeUnzipActionLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/unzip_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeVersionHistoryActionLoader=(t,r)=>({pluginId:s.VERSION_HISTORY_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeVersionHistoryActionLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/version_history_plugin"],t,i)}).then(i.__importStar);return s(t,r,a)}))});t.makeRestoreActionLoader=(t,r)=>({pluginId:s.RESTORE_ACTION_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeRestoreActionLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/restore_plugin"],t,i)}).then(i.__importStar);return s(a,t,r)}))});t.makeStarToolbarButtonLoader=(t,r)=>({pluginId:s.STAR_TOOLBAR_PLUGIN_ID,load:(s,a)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeStarToolbarButtonLoader:s}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/toolbar_plugins/star_plugin"],t,i)}).then(i.__importStar);return new(s(t,r))}))});t.makeSignaturesDropdownLoader=(t,r,a,n)=>({pluginId:s.SIGNATURES_ACTIONBAR_DROPDOWN_PLUGIN_ID,isEnabled:e=>!1!==n,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{logExposure:s,makeSignaturesDropdown:o}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/signatures_dropdown_plugin"],t,i)}).then(i.__importStar);return s(a),o(t,r,n,a)}))});t.makeFlowsBoltPluginLoader=()=>({pluginId:s.FLOWS_BOLT_PLUGIN_ID,isEnabled:e=>e.getPluginData().previewType===r.PreviewType.Video&&"V1"===e.sdkConfig.video_transcription,load:(t,r)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeFlowsBoltPlugin:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/service_plugins/flows_bolt_plugin"],t,i)}).then(i.__importStar);return t(r)}))});t.makeRecordVideoDropdownLoader=(t,r,a,n)=>({pluginId:s.RECORD_VIDEO_DROPDOWN_PLUGIN_ID,isEnabled:e=>!!n,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{logExposure:s,makeRecordVideoDropdown:o}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/record_video_dropdown_plugin"],t,i)}).then(i.__importStar);return s(a),o(t,r,n)}))});t.makeViewCaptureVoiceoverDropdownLoader=(t,r,a)=>({pluginId:s.VIEW_CAPTURE_VIDEO_PLUGIN_ID,isEnabled:e=>"ON"===a,load:(s,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{logExposure:s,makeViewCaptureVideoDropdown:o}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/view_capture_video_dropdown_plugin"],t,i)}).then(i.__importStar);return s(a),o(t,r,n)}))});t.makeVideoEditPluginLoader=t=>({pluginId:s.VIDEO_EDIT_PLUGIN_ID,isEnabled:e=>!!t&&e.getPluginData().previewType===r.PreviewType.Video&&e.sdkConfig.enable_video_crop_rotate,load:(t,r)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeVideoEditPlugin:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/video_edit_plugin"],t,i)}).then(i.__importStar);return t(r)}))})})),define("metaserver/static/js/file_viewer/sdk_file_viewer/blade_plugins/assigned_tasks_blade/loader",["require","exports","tslib","typescript/libraries/file-viewer/src/assigned_tasks_blade/types"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeAssignedTasksBladePluginLoader=void 0,t.makeAssignedTasksBladePluginLoader=function(t){return{pluginId:r.ASSIGNED_TASKS_BLADE_PLUGIN_ID,load:(r,s)=>i.__awaiter(this,void 0,void 0,(function*(){const{makeStore:a}=yield new Promise((t,i)=>{e(["typescript/component_libraries/files_components/src/blades/assigned_tasks_blade/data/store"],t,i)}).then(i.__importStar),{AssignedTasksBladePlugin:n}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/assigned_tasks_blade/assigned_tasks_blade_plugin"],t,i)}).then(i.__importStar),{logRRCTiburonEvent:o,reportRRCException:l}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/blade_plugins/assigned_tasks_blade/logger"],t,i)}).then(i.__importStar),c=a(),d=null==t?void 0:t.id,p=null==t?void 0:t.email,u=o(d,s.getPluginData().file);return new n({platform:r,store:c,context:s,log:u,reportException:l,userId:d,userEmail:p})}))}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/capture_recorder",["require","exports","tslib","react","eventemitter3","metaserver/static/js/file_store/utils","js/filepath/filepath","metaserver/static/js/capture/loadable_preview_recorder","metaserver/static/js/user_metadata/api","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/onboarding/logging/logging"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useCaptureRecorder=t.setUserDismissedCaptureExperiment=t.getHasUserPreviouslyDismissedCaptureExperiment=t.captureExpEmitter=t.handleSafariWorkaround=void 0,r=i.__importStar(r),s=i.__importDefault(s);const p=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);t.handleSafariWorkaround=()=>i.__awaiter(void 0,void 0,void 0,(function*(){window.captureRecorderActive||p&&(window.safariScreenStream=yield navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!0}))}));const u="CAPTURE_PREVIEWS_COMMENTS_TOOLTIP_DISMISSED";function _(e=-1){return i.__awaiter(this,void 0,void 0,(function*(){return(yield(0,l.getUserMetadata)([u],e))[u]||!1}))}function v(e=-1){return i.__awaiter(this,void 0,void 0,(function*(){const t=yield(0,l.setUserMetadata)({[u]:!0},e);return Boolean(t[u])}))}t.captureExpEmitter=new s.default,t.getHasUserPreviouslyDismissedCaptureExperiment=_,t.setUserDismissedCaptureExperiment=v;const m=["ppt","key","pptx"];t.useCaptureRecorder=(e,s,l)=>{const[p,u]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[h,S]=(0,r.useState)(),[w,E]=(function(e){const[t,i]=(0,r.useState)(e),s=(0,r.useRef)(t);return(0,r.useEffect)(()=>{s.current=t},[t]),[s,i]})(!0),I=(0,r.useRef)(h),P=(0,r.useRef)(!1),A=(e=>{const t=(0,a.isBrowseFile)(e)?(0,n.file_extension)(e.fq_path):(0,n.file_extension)(e.filename);return m.includes(t)})(s),b=(0,r.useCallback)(e=>i.__awaiter(void 0,void 0,void 0,(function*(){try{e&&(yield(0,t.handleSafariWorkaround)()),u(e)}catch(e){}})),[u]);P.current=A;const O={captureUploadRef:I,emitter:t.captureExpEmitter,hasSeenCaptureExpRef:w,isRecorderShownRef:P,logger:d.OALogger,setRecorder:b,setCommentLinkAction:g,setHasSeenCaptureExp:E,setShowTooltip:()=>{},onDismiss:()=>v(null==e?void 0:e.id)};return(0,r.useEffect)(()=>{(null==e?void 0:e.id)&&_(null==e?void 0:e.id).then(e=>{e||E(!1)})},[e]),(0,r.useEffect)(()=>{h&&(t.captureExpEmitter.emit("capture-link",h),O.logger.logToProEvents("core_act_capture_previews_comments_upload"))},[h]),(0,r.useEffect)(()=>{const e=()=>{S(void 0)};return t.captureExpEmitter.on("reset-capture-value",e),()=>{t.captureExpEmitter.off("reset-capture-value",e)}},[]),(0,r.useEffect)(()=>{I.current=h},[h]),{CaptureRecorder:(0,r.useMemo)(()=>e?l===c.SDKPreviewSurface.INBAND_SHARE?null:r.default.createElement(o.AsyncPreviewRecorder,{user:e,source:"previews",showRecorder:p,setRecorder:b,setCapture:S,captureUpload:h,userCommentLinkAction:f,setUserCommentLinkAction:g,captureUploadRef:I,onRecordingComplete:()=>v(null==e?void 0:e.id)}):null,[e,p,b,f,h,l]),captureState:O}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/cloud_docs",["require","exports","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/cloud_docs/shared_components/routing","metaserver/static/js/file_store/utils"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCloudDocsClient=void 0,t.makeCloudDocsClient=function(e,t,a){return{triggerDynamicRoutingModalCheck:()=>{const n=t();n.file.file_id&&!(function(e){return(null==e?void 0:e.linkType)===i.SharedLinkType.Shmodel})(a)&&(0,r.maybeShowDynamicRoutingModal)(e,n.file,(0,s.getExtension)(n.file))}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/comments",["require","exports","typescript/libraries/file-viewer/src/comments2/plugin/loader/lazy","metaserver/static/js/comments2/client_builder","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeComments2MetaserverLoader=void 0,t.makeComments2MetaserverLoader=function(e,t){return(0,i.makeLoader)((0,r.makeComments2Client)(e),{showApproval:!!e&&s.fileViewerFlowExperiments.approvalFlowByUserId[e.id],dragSectionAnnotationEnabled:s.fileViewerFeatureExperiments.dragSectionAnnotation},void 0===e,t)}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FVSDK_MOUNT_POINT=void 0,t.FVSDK_MOUNT_POINT="fvsdk-mount-point"})),define("metaserver/static/js/file_viewer/sdk_file_viewer/download_utils",["require","exports","tslib","react","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/file_viewer/sdk_file_viewer/utils","typescript/libraries/file-viewer/src/core/types/auth_modal","metaserver/static/js/action_bar/file_actions/portable/save_as_copy/save_as_copy","metaserver/static/js/file_store/utils","metaserver/static/js/action_bar/file_actions/portable/save_as_copy/snackbars","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils","metaserver/static/js/action_bar/file_actions/portable/download","metaserver/static/js/components/ui/modal","metaserver/static/js/core/persistence/storage","metaserver/static/js/share_download/ui/util","metaserver/static/js/campaigns/emitter","metaserver/static/js/campaigns/types"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.downloadActiveFile=t.saveToDropbox=void 0,r=i.__importDefault(r),t.saveToDropbox=function(e,t,i,r,s,l,p){if(r)if(t("save_to_dropbox"),i)(0,o.portableSaveAsCopy)({file:e,user:i,shareToken:r},{onNetworkRequest:()=>{(0,c.saveCopySnackBarInProgress)(d.PREVIEWS_SNACKBAR_ID),t("save_to_dropbox_approve")},onModalClose:()=>{t("save_to_dropbox_cancel")}},p);else{const e=new URL(window.location.href);e.searchParams.set("copy_to_dropbox","true"),window.history.replaceState(e.href,"",e.href),(0,a.showAuthModal)({mode:n.AuthMode.REGISTER,sharedLinkUrl:e.href,kind:n.LoginOrRegisterKind.DOWNLOAD,encryptionOptions:s,loggingExtra:{source:"save_to_dropbox"},signupTag:l})}},t.downloadActiveFile=function(t,a,n,o,c,d,g){if(o!==s.LoginOrRegisterKind.DOWNLOAD||_.LocalStorage.get("has_seen_download_signup_modal")){if((0,p.downloadSingleFile)({href:t.href,source:"PREVIEWS",isFswm:(0,l.isSharedFile)(t)}),!a){!(t.href.indexOf("scl/fi/")>=0)&&g?(0,m.publishEvent)(f.CampaignEvents.DOWNLOAD_BUTTON_CLICKED,{context:{file_extension:(0,l.getExtension)(t),file_name:(0,l.getFilename)(t),file_path:(0,l.isSharedFile)(t)?t.href:void 0}}):(0,v.showPostDownloadSignInModal)({encryptionOptions:n,logUserAction:c,isFolder:!1,shareToken:d,link_url:t.href})}}else{const t=()=>{_.LocalStorage.set("has_seen_download_signup_modal",!0)},a=()=>{_.LocalStorage.set("has_seen_download_signup_modal",!0)};new Promise((t,i)=>{e(["metaserver/static/js/auth/login_or_register/modal"],t,i)}).then(i.__importStar).then(({LoginOrRegisterModal:e})=>{u.Modal.showInstance(r.default.createElement(e,{downloadAction:s.DownloadAction.DIRECT_DOWNLOAD,id:"shared-link-download-signup-modal",initialMode:s.Mode.REGISTER,kind:o,onAuthenticateSuccess:t,onCancel:a,signup_tag:"shmodel_download_register",encryptionOptions:n,loggingExtra:{source:"download_button"}}))})}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/feature_config",["require","exports","metaserver/static/js/file_viewer/sdk_file_viewer/utils","typescript/libraries/file-viewer/src/core/config","typescript/libraries/file-viewer/src/core/types/preview_type","metaserver/static/js/file_viewer/sdk_file_viewer/experiments","metaserver/static/js/core/browser_detection"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFeatureConfig=void 0;const o=(e,t)=>{const i="ms_view_embed"===t?{embed_support:"ms_view_embed"}:{embed_support:"unsupported"};let r;switch(e){case"OFF":case"CONTROL":r={support:"excel1"};break;case"P0":r={support:"excel2",phase:0};break;case"P1":r={support:"excel2",phase:1};break;case"P2":r={support:"excel2",phase:2};break;case"P3":r={support:"excel2",phase:3};break;case"P4":r={support:"excel2",phase:4};break;default:r={support:"excel1"}}return Object.assign(Object.assign({},r),i)},l=e=>{let t=e,i=!1;const r=e.split("_");r.length>1&&(t=r[0],i=!0);const s=parseInt(t,10);return isNaN(s)?null:{bandwidth:s,ignoreVideoPlayerSize:i}};t.getFeatureConfig=(e,t,c,d,p,u,_)=>{const v=[i.SDKPreviewSurface.BROWSE,i.SDKPreviewSurface.HOME,i.SDKPreviewSurface.RECENTS,i.SDKPreviewSurface.STARRED,i.SDKPreviewSurface.SEARCH,i.SDKPreviewSurface.INBAND_SHARE,i.SDKPreviewSurface.STANDALONE_PREVIEW],m=[i.SDKPreviewSurface.SHARED_CONTENT_LINK,i.SDKPreviewSurface.SHARED_LINK],f=!!_&&(v.includes(e)||m.includes(e)||e===i.SDKPreviewSurface.VIDEO_SYNTHESIS);return{excel_support:o(a.fileViewerFeatureExperiments.fvsdkExcel2Phase,a.fileViewerFeatureExperiments.fvsdkExcelMsEmbedPhase),annotations:v.includes(e),ax_annotations:a.fileViewerFeatureExperiments.fvsdkAxAnnotations,enable_fullscreen:!0,file_flipping:t,keyboard_shortcuts:!0,titlebar_logo_config:{show_logo:!0,base_url:"www.dropbox.com"},preview_types:{[s.PreviewType.SsrDoc]:Object.assign({},r.DEFAULT_CONFIG.preview_types[s.PreviewType.SsrDoc])},mobile_web:(0,n.is_supported_mobile_browser)(),preview_content_only:c,transparent_background:d,force_no_toolbar:p,show_cloud_doc_preview:u,partial_prewarm_allowed:a.fileViewerFeatureExperiments.partialPrewarmAllowed,fvsdk_excel_ms_embed_phase:a.fileViewerFeatureExperiments.fvsdkExcelMsEmbedPhase,tags_section_variant:a.fileViewerFeatureExperiments.tagsSectionVariant,drag_section_annotation:a.fileViewerFeatureExperiments.dragSectionAnnotation,img_size_optimization:a.fileViewerFeatureExperiments.imgSizeOptimization,enable_assigned_tasks_plugin:a.fileViewerFeatureExperiments.enableAssignedTasksPlugin,initial_video_bandwidth:l(a.fileViewerFeatureExperiments.initialVideoBandwidth),fvsdk_slow_connection_banner:a.fileViewerFeatureExperiments.fvsdkSlowConnectionBanner,enable_video_editing:f&&"ON"===a.fileViewerFeatureExperiments.fvsdkVideoEditing,enable_video_crop_rotate:f&&"ON"===a.fileViewerFeatureExperiments.fvsdkVideoCrop,replay_previews_permanent_entrypoint:a.fileViewerFeatureExperiments.replayPreviewsPermanentEntrypoint,video_transcription:a.fileViewerFeatureExperiments.videoTranscription,campaigns_download_sisu:a.fileViewerFeatureExperiments.campaignsDownloadSisu,publish_previews_painted_door_entrypoint:a.fileViewerFeatureExperiments.publishPreviewsPaintedDoorEntrypoint,campaigns_logged_out_sign_up_tooltip:a.fileViewerFeatureExperiments.campaignsLoggedOutSignUpTooltip,logged_out_acquisition_save_as:a.fileViewerFeatureExperiments.loggedOutAcquisitionSaveAs,google_one_tap_variant:a.fileViewerFeatureExperiments.googleOneTapVariant,capture_preview_comment_recording:a.fileViewerFeatureExperiments.capturePreviewCommentRecording,capture_sdk_integration_voice_overs:["V1","V2"].includes(a.fileViewerFeatureExperiments.captureSdkIntegrationVoiceOversVariant),capture_sdk_integration_voice_overs_variant:a.fileViewerFeatureExperiments.captureSdkIntegrationVoiceOversVariant,capture_sdk_integration_voice_overs_view_button:a.fileViewerFeatureExperiments.captureSdkIntegrationVoiceOversViewButton,publish_previews_permanent_entrypoint:a.fileViewerFeatureExperiments.publishPreviewsPermanentEntrypoint,fvsdk_vhs_override_native_hls_video:a.fileViewerFeatureExperiments.fvsdkVhsOverrideNativeHlsVideo}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/file_actions",["require","exports","tslib","metaserver/static/js/action_bar/file_actions/portable/delete/delete","metaserver/static/js/action_bar/file_actions/portable/delete/snackbars","metaserver/static/js/file_store/utils","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils","metaserver/static/js/core/i18n","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/files_view/file_actions/api_v2","metaserver/static/js/action_bar/file_actions/portable/rename/snackbars"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileActionsClient=void 0,t.makeFileActionsClient=function(e,t,p){return{rename:({newFilename:r,onRenameSuccess:s,onRenameFailed:o})=>i.__awaiter(this,void 0,void 0,(function*(){const{file:i}=t();if(!(0,a.isBrowseFile)(i))return;const l=!r.includes("/");let u;if(l&&((0,d.renameSnackBarInProgress)(n.PREVIEWS_SNACKBAR_ID),u=yield(0,c.renameFile)(i.fq_path,r,e.id,{checkFSWs:!0})),!u||u.isError||"success"!==u.result.entries[0][".tag"])return o(),void(0,d.renameFailedSnackBar)(l?(null==u?void 0:u.isError)?u:(0,c.createUndefinedRpcResult)():Object.assign(Object.assign({},(0,c.createUndefinedRpcResult)()),{error:{".tag":"to",to:{".tag":"malformed_path",malformed_path:{}}}}),i.fq_path,n.PREVIEWS_SNACKBAR_ID);const _=u.result.entries[0].success;p&&_&&"file"===_[".tag"]&&p(i,{fq_path:_.path_display||i.fq_path,revision_id:_.rev,file_id:_.id}),s(),(0,d.renameCompleteSnackBar)(n.PREVIEWS_SNACKBAR_ID)})),delete:({onDelete:i,onDeleteSuccess:c,onDeleteFailed:d,onDeleteFailedNoPermission:u,onDeleteCancel:_,setDeleteFileModalOpen:v})=>{const{file:m}=t();if(!(0,a.isBrowseFile)(m)||(0,n.isPnmLinkNodeSelected)(m)||!(0,n.isLiveFile)(m))return;if(i(),m.read_only)return l.Snackbar.warn(o.intl.formatMessage({id:"szm+5q",defaultMessage:"You don't have permission to make changes to this file"}),n.PREVIEWS_SNACKBAR_ID,!0),void u();const f={file_id:m.file_id,is_dir:m.is_dir};(0,r.portableDelete)({user:e,filesPath:[f],fq_path:m.fq_path},{onNetworkRequest:()=>(0,s.deleteSnackBarInProgress)(n.PREVIEWS_SNACKBAR_ID),onSuccess:()=>{(0,s.deleteCompleteSnackBar)(n.PREVIEWS_SNACKBAR_ID),p&&p(m),c()},onError:e=>{(0,s.deleteFailedSnackBar)(e,n.PREVIEWS_SNACKBAR_ID),d()},onRequestClose:()=>{_()},setDeleteFileModalOpen:v})}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/file_system",["require","exports","metaserver/static/js/share_download/ui/util","metaserver/static/js/file_viewer/sdk_file_viewer/download_utils"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileSystemClient=void 0,t.makeFileSystemClient=function(e,t,{allowCopyToDropbox:s,shareToken:a,encryptionOptions:n,sharePermission:o,authModalKind:l}){return{copyToDropbox:!s||o&&!(0,i.isDownloadAllowed)(o)?()=>{}:({logModalConfirm:i,logModalCancel:s})=>{const{file:o}=t();(0,r.saveToDropbox)(o,e=>{"save_to_dropbox_approve"===e?i():"save_to_dropbox_cancel"===e&&s()},e,a,n)},downloadFile:()=>{const{file:i}=t();(0,r.downloadActiveFile)(i,e,n,l,void 0,a)}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/file_viewer.module.css",["require","exports","css!metaserver/static/js/file_viewer/sdk_file_viewer/file_viewer.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.auth=t.pass=t.titleBarSpacing=void 0,t.titleBarSpacing="_titleBarSpacing_wzh7c_1",t.pass="_pass_wzh7c_5",t.auth="_auth_wzh7c_11";t.default={titleBarSpacing:"_titleBarSpacing_wzh7c_1",pass:"_pass_wzh7c_5",auth:"_auth_wzh7c_11"}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/file_viewer",["require","exports","tslib","react","js/common/rendering","classnames","react-redux","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/file_store/utils","metaserver/static/js/components/ui/css","metaserver/static/js/extensions/data/selectors","metaserver/static/js/extensions/data/helpers","metaserver/static/js/file_viewer/sdk_file_viewer/async_plugin_loaders","metaserver/static/js/file_viewer/sdk_file_viewer/toolbar_plugins/crop_rotate_plugin","metaserver/static/js/file_viewer/sdk_file_viewer/comments","metaserver/static/js/browse/models","metaserver/static/js/file_viewer/sdk_file_viewer/file_actions","metaserver/static/js/file_viewer/sdk_file_viewer/file_system","metaserver/static/js/file_viewer/sdk_file_viewer/full_screen","metaserver/static/js/file_viewer/sdk_file_viewer/print","metaserver/static/js/file_viewer/sdk_file_viewer/navigation","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/file_viewer/sdk_file_viewer/pass","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/flows/version/experiments","typescript/libraries/file-viewer/src/core/riviera/api","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/logging/video","metaserver/static/js/file_viewer/sdk_file_viewer/url","metaserver/static/js/file_viewer/sdk_file_viewer/cloud_docs","metaserver/static/js/file_viewer/sdk_file_viewer/constants","typescript/libraries/file-viewer/src/core/data/types","typescript/libraries/file-viewer/src/info_blade/loader","metaserver/static/js/file_viewer/sdk_file_viewer/blade_plugins/assigned_tasks_blade/loader","metaserver/static/js/file_viewer/sdk_file_viewer/preview_logger","metaserver/static/js/file_viewer/sdk_file_viewer/feature_config","metaserver/static/js/share_download/ui/util","metaserver/static/js/extensions/cloud_docs_compat","typescript/libraries/file-viewer/src/file_activity_blade/loader","metaserver/static/js/file_viewer/sdk_file_viewer/preferences","metaserver/static/js/previews/ui/sharing_plugin/loader","typescript/libraries/file-viewer/src/watermarking/edit_plugin/loader","metaserver/static/js/integrations/ui/pdf_editor/plugin/loader","metaserver/static/js/integrations/ui/pdf_editor/plugin/show_plugin_util","metaserver/static/js/photo-editor/plugin/loader","metaserver/static/js/photo-editor/plugin/show-edit-plugin","keymaster","metaserver/static/js/loggers/device_type","metaserver/static/js/file_viewer/sdk_file_viewer/toolbar_plugins/snackbar_manager_plugin","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/previews/ui/constants","metaserver/static/js/core/dom","metaserver/static/js/user_survey/user_survey","metaserver/static/js/file_viewer/toggle_browse_elements_util","metaserver/static/js/file_viewer/sdk_file_viewer/replay_prompt/async_replay_dialog","metaserver/static/js/flows/approval/api","metaserver/static/js/sharing/ui_util","metaserver/static/js/file_viewer/sdk_file_viewer/report_exception","metaserver/static/js/file_viewer/sdk_file_viewer/app_download_interstitial","metaserver/static/js/comments2/util","metaserver/static/js/file_viewer/sdk_file_viewer/app_download_interstitial","typescript/libraries/file-viewer/src/comments2/plugin/types","typescript/libraries/file-viewer/src/core/types/constants","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/ui/snackbar_manager","metaserver/static/js/core/browser_detection","metaserver/static/js/uuid/uuid","metaserver/static/js/file_viewer/sdk_file_viewer/experiments","metaserver/static/js/file_viewer/data/store","metaserver/static/js/flows/version/async_components","typescript/libraries/file-viewer/src/utils","metaserver/static/js/file_viewer/sdk_file_viewer/utils","typescript/libraries/file-viewer/src/file_viewer/components","typescript/libraries/file-viewer/src/core/types/preview_type","typescript/libraries/file-viewer/src/logging/performance","metaserver/static/js/flows/conversions/async_conversion_plugin","metaserver/static/js/integrations/hellosign_deep_integration/async_send_file_viewer_plugin","metaserver/static/js/integrations/hellosign_deep_integration/async_self_sign_plugin","metaserver/static/js/file_viewer/sdk_file_viewer/lazy_components","typescript/libraries/file-viewer/src/core/utils/sizing_utils","typescript/libraries/file-viewer/src/core/utils/support","metaserver/static/js/file_viewer/sdk_file_viewer/titlebar","typescript/libraries/file-viewer/src/transcript_blade/loader","metaserver/static/js/clean/viewer","metaserver/static/js/folder_dialog/api","metaserver/static/js/campaigns/emitter","js/filepath/filepath","metaserver/static/js/docsend_analytics_add_on/helpers/utils","metaserver/static/js/integrations/data/selectors","metaserver/static/js/file_viewer/sdk_file_viewer/pap_logger/pap_preview_logger","metaserver/static/js/file_viewer/sdk_file_viewer/capture_recorder","metaserver/static/js/file_viewer/app_download_interstitial/app_download_interstitial","metaserver/static/js/capture/preview_voiceover_recorder","metaserver/static/js/file_viewer/data/selectors","metaserver/static/js/file_viewer/data/actions"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f,g,h,S,w,E,I,P,A,b,O,y,T,C,R,D,k,N,L,M,F,j,x,U,B,V,H,q,K,W,G,z,Y,X,J,Q,$,Z,ee,te,ie,re,se,ae,ne,oe,le,ce,de,pe,ue,_e,ve,me,fe,ge,he,Se,we,Ee,Ie,Pe,Ae,be,Oe,ye,Te,Ce,Re,De,ke,Ne,Le,Me,Fe,je,xe,Ue,Be,Ve,He,qe){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileViewer=t._FileViewer=t.isWatermarkingEnabled=void 0,r=i.__importDefault(r),a=i.__importDefault(a),A=i.__importStar(A),O=i.__importStar(O),X=i.__importDefault(X),ee=i.__importStar(ee);t.isWatermarkingEnabled=e=>!(!e||!fe.fileViewerConfiguration.watermarkingByUserId[e.id]);const Ke=r.default.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{TagsSectionPreview:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/tagging/components/section/tags_section_preview"],t,i)}).then(i.__importStar);return{default:t}}))),We=(a,n,d,p,u,C,N,L,U,B,G,Y,X,ee,ie,re,oe,le,ce,de,pe,ue=!1,_e=!1,me=!1,ge=!0,Ee=!1,Pe,ye,Re,ke,Ne,je)=>{var Ue,Be;const Ve=U?()=>{U(),(0,I.isAudioPreview)(n().file)?te.UserSurvey.trackEvent("audio_preview_viewed","previews"):(0,I.isVideoPreview)(n().file)&&te.UserSurvey.trackEvent("video_preview_viewed","previews")}:void 0;let He={};const qe=Y?new o.DefaultUserApiV2Client(Y):new l.NoAuthApiV2Client,We=(0,x.getFeatureConfig)(a,Ee,ue,_e,me,ge,Y),Ge=(0,H.makePreferencesClient)(Y);(0,ve.is_supported_mobile_browser)()||te.UserSurvey.trackEvent("preview_viewed","previews");const ze=n().file;(0,c.isSharedFile)(ze)&&setTimeout(()=>{(0,ae.trackReceiverUserLeapEvent)(ae.ReceiverUserLeapEvent.VIEWED_SHARED_FILE)},5e3);const Ye=(e,t)=>({width:(0,Te.calcContentWidth)(window.innerWidth,e,t,(0,ve.is_supported_mobile_browser)()),height:(0,Te.calcContentHeight)(window.innerHeight,We.show_titlebar||!0)});let Xe;const Je=(0,c.isBrowseFile)(ze)&&(0,t.isWatermarkingEnabled)(Y);switch(a){case I.SDKPreviewSurface.BROWSE:case I.SDKPreviewSurface.HOME:case I.SDKPreviewSurface.HELLOSIGN:case I.SDKPreviewSurface.SEARCH:case I.SDKPreviewSurface.RECENTS:case I.SDKPreviewSurface.STARRED:case I.SDKPreviewSurface.STANDALONE_PREVIEW:case I.SDKPreviewSurface.PHOTOS:case I.SDKPreviewSurface.VIDEO_SYNTHESIS:case I.SDKPreviewSurface.COLLECTIONS:case I.SDKPreviewSurface.FILE_LOCKING:case I.SDKPreviewSurface.BACKUP:if(!Y)throw new Error("Must be logged in to browse");Xe=(0,g.makeFileActionsClient)(Y,n,Re),He={presenceBeaconIOClient:(0,P.getPresenceBeaconIOClient)(Y,n),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!1,shareToken:p,encryptionOptions:pe,authModalKind:ye}),fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),navigationClient:(0,E.makeBrowseNavigationClient)(Y,n,Ve,ee,ie,re,ce),fileActionsClient:Xe,urlClient:(0,D.makeUrlClient)(Y),preferencesClient:Ge};break;case I.SDKPreviewSurface.VERSION_HISTORY:if(!Y)throw Error("user required for version history");He={presenceBeaconIOClient:(0,P.getPresenceBeaconIOClient)(Y,n),fileSystemClient:void 0,fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),navigationClient:(0,E.makeVersionHistoryNavigationClient)(Y,n,Ve,ee,ie,re),urlClient:(0,D.makeUrlClient)(Y),preferencesClient:Ge};break;case I.SDKPreviewSurface.SHARED_LINK:He={fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),navigationClient:(0,E.makeInbandShareNavigationClient)(Ve,ee,ie,re,d),urlClient:(0,D.makeUrlClient)(Y),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!0,shareToken:p,encryptionOptions:pe,sharePermission:L,authModalKind:ye}),presenceBeaconIOClient:(0,P.getPresenceBeaconIOClient)(Y,n),preferencesClient:Ge};break;case I.SDKPreviewSurface.SHARED_LINK_EMBED:case I.SDKPreviewSurface.COMMERCE:case I.SDKPreviewSurface.TRANSFER:He={fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),urlClient:(0,D.makeUrlClient)(Y),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!0,shareToken:p,encryptionOptions:pe,sharePermission:L,authModalKind:ye})};break;case I.SDKPreviewSurface.CLIENT_PORTAL:He={fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),urlClient:(0,D.makeUrlClient)(Y),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!0,shareToken:p,encryptionOptions:pe,sharePermission:L,authModalKind:ye}),navigationClient:(0,E.makeSharedCollectionNavigationClient)(U)};break;case I.SDKPreviewSurface.SHARED_COLLECTION:He={fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),urlClient:(0,D.makeUrlClient)(Y),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!0,shareToken:p,encryptionOptions:pe,sharePermission:L,authModalKind:ye}),navigationClient:(0,E.makeSharedCollectionNavigationClient)(U,ee,ie),preferencesClient:{rightRail:{setCollapsedState:()=>{},getCollapsedState:()=>!0,setBladeState:()=>{},getBladeState:()=>{}}}};break;case I.SDKPreviewSurface.SHARED_CONTENT_LINK:case I.SDKPreviewSurface.INBAND_SHARE:He={presenceBeaconIOClient:(0,P.getPresenceBeaconIOClient)(Y,n),fileSystemClient:(0,h.makeFileSystemClient)(Y,n,{allowCopyToDropbox:!0,shareToken:p,encryptionOptions:pe,sharePermission:L,authModalKind:ye}),fullScreenClient:(0,S.makeFullScreenClient)(oe),printClient:(0,w.makePrintClient)(),navigationClient:(0,E.makeInbandShareNavigationClient)(Ve,ee,ie,re),urlClient:(0,D.makeUrlClient)(Y),preferencesClient:Ge}}const Qe=ze.preview?(0,Ce.resolvePreviewType)(ze.preview):void 0;if(ze.preview&&Qe&&Qe===Ie.PreviewType.Image)if(We.img_size_optimization){const e=Ye(!(null===(Ue=Ge.rightRail)||void 0===Ue?void 0:Ue.getCollapsedState())||!1,!1);(0,Se.maybePreloadFile)(ze.preview,e)}else(0,Se.maybePreloadFile)(ze.preview);const $e={logTTI:()=>(e=>{const t=A.get_timer(e);t.markTimeToInteractive(),e&&t.end()})(Ne),logVideo:(e,t)=>{var i,r;const s=n().file;switch((0,j.logVideo)(e,t),(0,I.isVideoPreview)(s)?(0,xe.logVideoToPap)(e,{previewSurface:a,file:s}):(0,I.isAudioPreview)(s)&&(0,xe.logAudioToPap)(e,{previewSurface:a,file:s}),e){case R.VideoPreviewEvent.TimeToLoad:(0,I.isAudioPreview)(s)?(t.video_duration_seconds&&te.UserSurvey.addAttribute("audioPreviewLength",(0,I.bucketLengthForUserSurvey)(t.video_duration_seconds)),te.UserSurvey.addAttribute("audioPreviewType",(0,c.getExtension)(s)),te.UserSurvey.addAttribute("isAudioPreviewFinished","false")):(t.video_duration_seconds&&te.UserSurvey.addAttribute("videoPreviewLength",(0,I.bucketLengthForUserSurvey)(t.video_duration_seconds)),te.UserSurvey.addAttribute("videoPreviewType",(0,c.getExtension)(s)),te.UserSurvey.addAttribute("isVideoPreviewFinished","false"),te.UserSurvey.addAttribute("videoPreviewResolution","auto"));break;case R.VideoPreviewEvent.ChangeVideoQuality:(null===(i=t.extra)||void 0===i?void 0:i.new_video_quality)&&te.UserSurvey.addAttribute("videoPreviewResolution",t.extra.new_video_quality);break;case R.VideoPreviewEvent.MediaEnded:(0,I.isAudioPreview)(s)?(te.UserSurvey.addAttribute("isAudioPreviewFinished","true"),te.UserSurvey.trackEvent("audio_preview_viewed","previews")):(te.UserSurvey.addAttribute("isVideoPreviewFinished","true"),te.UserSurvey.trackEvent("video_preview_viewed","previews"));break;case R.VideoPreviewEvent.VideoPlaybackSmoothness:(null===(r=t.extra)||void 0===r?void 0:r.num_stalls_per_second_playback)&&te.UserSurvey.addAttribute("videoPreviewNumberOfStallsPerSecondPlayback",t.extra.num_stalls_per_second_playback)}},log:(0,j.makeLogger)(a,n),logDuration:j.logDuration},Ze={batteries:{intl:b.intl,coreIOClients:{apiv2ClientBase:qe,rivieraIOClient:new T.WebRivieraIOClient},logger:$e,optionalIOClients:Object.assign(Object.assign({},He),{showAuthModal:d,cloudDocsClient:Y?(0,k.makeCloudDocsClient)(Y,n,p):void 0,reportExceptionClient:(0,ne.makeReportExceptionClient)()})},callbacks:{onRenderSucceeded:()=>{var e;(0,I.cleanupPrerenderPreview)();const t=n().file,i=(0,c.isBrowseFile)(t)?(0,Me.file_extension)(t.fq_path):(0,Me.file_extension)(t.filename);if((0,Le.emitPageLoaded)("preview_page",{file_extension:i,file_name:(0,c.getFilename)(t),file_path:(0,c.isSharedFile)(t)?t.href:t.fq_path,file_id:t.file_id,loggedOutSignUpTooltipVariant:We.campaigns_logged_out_sign_up_tooltip,googleOneTapVariant:We.google_one_tap_variant}),X)if(We.img_size_optimization){const t=Ye(!(null===(e=Ge.rightRail)||void 0===e?void 0:e.getCollapsedState())||!1,!1);(0,Se.maybePreloadFiles)(X,N,t)}else(0,Se.maybePreloadFiles)(X,N);(0,ve.is_supported_mobile_browser)()&&(te.UserSurvey.trackEvent("mobile_web_preview_viewed","previews"),a===I.SDKPreviewSurface.SHARED_LINK&&te.UserSurvey.trackEvent("mobile_web_receiver_preview_viewed","previews")),(0,I.isExcelPreview)(n().file)&&(te.UserSurvey.addAttribute("fvsdk_excel2_phase",fe.fileViewerFeatureExperiments.fvsdkExcel2Phase),te.UserSurvey.trackEvent("excel_preview_viewed","previews"))},onPreviewSessionInitialized:e=>{le&&le(e)}},initData:{accountId:Y?Y.account_id:void 0,deviceType:(0,J.getDeviceType)()},featureConfig:We,platformConfig:{osModifierKey:ve.mac?"metaKey":"ctrlKey"},fileViewerId:ke},et=[],tt=fe.fileViewerFeatureExperiments.tagsSectionVariant,it=tt&&"ON"===tt;tt&&"OFF"!==tt&&new Promise((t,i)=>{e(["metaserver/static/js/stormcrow/stormcrow_exposure_logger"],t,i)}).then(i.__importStar).then(({StormcrowExposureLogger:e})=>{(new e).logExposure("tags_in_previews",tt)});const rt=a===I.SDKPreviewSurface.INBAND_SHARE&&We.enable_assigned_tasks_plugin,st=a!==I.SDKPreviewSurface.CLIENT_PORTAL&&a!==I.SDKPreviewSurface.BACKUP&&a!==I.SDKPreviewSurface.SHARED_COLLECTION,at=a!==I.SDKPreviewSurface.CLIENT_PORTAL&&a!==I.SDKPreviewSurface.BACKUP&&a!==I.SDKPreviewSurface.SHARED_COLLECTION,nt=[I.SDKPreviewSurface.BROWSE,I.SDKPreviewSurface.FILE_LOCKING,I.SDKPreviewSurface.HOME,I.SDKPreviewSurface.RECENTS,I.SDKPreviewSurface.SEARCH,I.SDKPreviewSurface.SHARED_CONTENT_LINK,I.SDKPreviewSurface.SHARED_LINK,I.SDKPreviewSurface.SHARED_LINK_EMBED,I.SDKPreviewSurface.STANDALONE_PREVIEW,I.SDKPreviewSurface.STARRED].includes(a),ot=(0,I.getLinkType)(ze.href)!==I.LinkType.SHARED_FOLDER&&(0,I.getLinkType)(ze.href)!==I.LinkType.SCL_FOLDER,lt=(0,M.makeInfoBladePluginLoader)(Y?String(Y.id):void 0,Y&&"MULTI_APPROVER"===fe.fileViewerFlowExperiments.approvalFlowVariantByUserId[Y.id]?e=>(0,se.getFileApprovalStatus)(Y.id,e):void 0,it?({pluginContext:e})=>{const t=n().file;return it&&Y&&(0,c.isBrowseFile)(t)&&t.ns_path?r.default.createElement(s.LazySuspense,{fallback:null},r.default.createElement(Ke,{files:[f.File.fromAnyFileObject(t)],user:Y,previewsLogUserAction:e.logUserAction})):null}:void 0,({})=>{const e=n().file;if(Y&&(0,y.isVersioningMVPEnabled)(fe.fileViewerFlowExperiments.versioningFlowVariantByUserId[Y.id])){const t=e=>(0,we.SDKPreviewSurfaceToPapType)(a,e);return r.default.createElement(he.AsyncChangeLogSection,{fileId:e.file_id,user:Y,getPreviewSurface:t})}return null}),ct=nt?(0,De.makeTranscriptPluginLoader)(Y?String(Y.id):void 0):void 0,dt=rt?(0,F.makeAssignedTasksBladePluginLoader)(Y):void 0,pt=a===I.SDKPreviewSurface.COLLECTIONS?()=>!(0,c.isSharedFile)(n().file):void 0;C.featureVariant=We.capture_preview_comment_recording;const ut=st?Object.assign(Object.assign({},(0,m.makeComments2MetaserverLoader)(Y,C)),{isEnabled:pt}):void 0,_t=Y&&at?Object.assign(Object.assign({},(0,V.makeFileActivityPluginLoader)(Y,null===(Be=He.navigationClient)||void 0===Be?void 0:Be.openVersionHistory)),{isEnabled:pt}):void 0,vt=Je?(0,K.makeWatermarkLoader)($e,({fqPath:e,overwrite:t})=>{t&&a===I.SDKPreviewSurface.BROWSE||(e&&Y?O.replace_location((0,$.preview_uri_for_fq_path)(Y,e,{context:Z.PreviewSourceContext.Workflow})):O.reload())}):void 0,mt=a!==I.SDKPreviewSurface.BACKUP&&a!==I.SDKPreviewSurface.SHARED_COLLECTION?(0,q.makeShareMetaserverLoader)(n,a,Y):void 0,ft=a!==I.SDKPreviewSurface.SHARED_COLLECTION?(0,_.makeDownloadActionLoader)(n,a,Y,p,L,pe,ye,We.campaigns_download_sisu):void 0,gt=(0,_.makeFlowsBoltPluginLoader)();if(ue||et.push(lt,ut,dt,ct,_t,vt,mt,ft,Q.snackbarManagerLoader),"V1"===We.logged_out_acquisition_save_as&&ot&&!ue){const e=(0,Ae.makeFileConversionsLoader)(n,Y,pe);et.push(e)}const ht=(0,_.makeVideoEditPluginLoader)(Y);if(Y){const e=(0,_.makeOpenDropdownActionLoader)(n,Y),t=(0,_.makeMoveActionLoader)(n,Y,null==B?void 0:B.currentFQPath,G),i=(0,_.makeCopyActionLoader)(n,Y,null==B?void 0:B.currentFQPath,G),r=fe.fileViewerFeatureExperiments.docsendAnalyticsAddOn,s=(0,Fe.getDocsendAnalyticsAddOnConfig)(Y,r),o=s.workflowMenu.logExposure||s.workflowMenu.showMenuItem,l=(0,_.makeAddToCollectionActionLoader)(n,Y),c=(0,_.makeStarredActionLoader)(n,Y),d=(0,_.makeRenameActionLoader)(n,Y,void 0,Xe),p=(0,_.makeDeleteActionLoader)(n,Y),m=o?(0,_.makeDocsendAnalyticsAddOnLoader)(n,Y,r):void 0,f=(0,_.makeSignaturesDropdownLoader)(n,Y,fe.fileViewerFeatureExperiments.btSignaturesActionbarDropdown,je),g=(0,_.makeWaterMarkingActionPluginLoader)(n),h=(0,_.makeOpenInDesktopActionLoader)(n,Y,B),S=(0,_.makeUnzipActionLoader)(n,Y),w=(0,_.makeVersionHistoryActionLoader)(n,Y),E=(0,Ae.makeFileConversionsLoader)(n,Y,pe,fe.fileViewerFeatureExperiments.btSignaturesActionbarDropdown,je),P=ot?(0,Ae.makeFileConversionsLoader)(n,Y):void 0,A=je?(0,be.makeSendForSignatureLoader)(n,Y,fe.fileViewerFeatureExperiments.btSignaturesActionbarDropdown):void 0,b=je?(0,Oe.makeSelfSignLoader)(n,Y,fe.fileViewerFeatureExperiments.btSignaturesActionbarDropdown):void 0,O=We.capture_sdk_integration_voice_overs,y=(0,_.makeRecordVideoDropdownLoader)(n,Y,We.capture_sdk_integration_voice_overs_variant||"OFF",O),T=(0,_.makeViewCaptureVoiceoverDropdownLoader)(n,Y,We.capture_sdk_integration_voice_overs_view_button||"OFF"),C=(0,_.makeRestoreActionLoader)(re,Pe),R=(0,_.makeStarToolbarButtonLoader)(n,Y),D=(0,_.makeRequestApprovalLoader)(n,Y,a),k=(0,_.makeCreateVersionLoader)(n,Y,a),N=(0,v.makeCropRotateButtonsLoader)(Y,n,Re),L=(0,W.makePdfEditorPluginLoader)(n,Y,u,a),M=(0,z.makePhotoEditorPluginLoader)(n,Y,Re),F="MULTI_APPROVER"===fe.fileViewerFlowExperiments.approvalFlowVariantByUserId[Y.id],j="MVP"===fe.fileViewerFlowExperiments.versioningFlowVariantByUserId[Y.id]&&a===I.SDKPreviewSurface.BROWSE,x=(0,_.makeOpenInReplayActionLoader)(n,Y),U=(0,_.makePublishPaintedDoorLoader)(n,Y),V=(0,_.makePublishLoader)(n,Y),H=[(0,_.makeMoveActionLoader)(n,Y,null==B?void 0:B.currentFQPath,G,Re),i,(0,_.makeRenameActionLoader)(n,Y,Re,Xe),(0,_.makeDeleteActionLoader)(n,Y,Re)];switch(a){case I.SDKPreviewSurface.BROWSE:et.push(e,E,ht,M,(0,I.isFvsdkPdfEditorEnabled)()?L:void 0,(0,_.makeGoToFolderActionLoader)(n,Y),t,i,d,p,Je?g:void 0,c,w,S,f,A,b,m,R,N,gt,O?y:void 0,T,F?D:void 0,j?k:void 0,(0,I.isOpenInReplayEnabled)()?x:void 0,(0,I.isPublishPaintedDoorEnabled)()?U:void 0,(0,I.isPublishEnabled)()?V:void 0);break;case I.SDKPreviewSurface.SEARCH:et.push(e,E,ht,M,(0,I.isFvsdkPdfEditorEnabled)()?L:void 0,...H,Je?g:void 0,c,w,S,f,A,b,m,R,N,gt,O?y:void 0,T,F?D:void 0,j?k:void 0,(0,I.isOpenInReplayEnabled)()?x:void 0,(0,I.isPublishPaintedDoorEnabled)()?U:void 0,(0,I.isPublishEnabled)()?V:void 0);break;case I.SDKPreviewSurface.STANDALONE_PREVIEW:case I.SDKPreviewSurface.FILE_LOCKING:et.push(e,E,ht,M,(0,I.isFvsdkPdfEditorEnabled)()?L:void 0,...H,Je?g:void 0,c,w,S,f,A,b,m,C,R,N,gt,O?y:void 0,T,F?D:void 0,j?k:void 0,(0,I.isOpenInReplayEnabled)()?x:void 0,(0,I.isPublishPaintedDoorEnabled)()?U:void 0,(0,I.isPublishEnabled)()?V:void 0);break;case I.SDKPreviewSurface.RECENTS:case I.SDKPreviewSurface.STARRED:case I.SDKPreviewSurface.HOME:et.push(e,E,ht,M,(0,I.isFvsdkPdfEditorEnabled)()?L:void 0,...H,Je?g:void 0,f,c,w,S,A,b,m,C,R,N,gt,O?y:void 0,T,F?D:void 0,j?k:void 0,(0,I.isOpenInReplayEnabled)()?x:void 0);break;case I.SDKPreviewSurface.INBAND_SHARE:case I.SDKPreviewSurface.SHARED_CONTENT_LINK:case I.SDKPreviewSurface.SHARED_LINK:case I.SDKPreviewSurface.HELLOSIGN:case I.SDKPreviewSurface.PHOTOS:et.push(e,P,ht,M,(0,I.isFvsdkPdfEditorEnabled)()?L:void 0,Je?g:void 0,c,w,S,A,b,m,C,R,N,gt,F?D:void 0,j?k:void 0,T);break;case I.SDKPreviewSurface.VERSION_HISTORY:et.push(C);break;case I.SDKPreviewSurface.VIDEO_SYNTHESIS:case I.SDKPreviewSurface.COLLECTIONS:et.push(e,ht,w,A,b,m,F?D:void 0,j?k:void 0);break;case I.SDKPreviewSurface.SHARED_LINK_EMBED:case I.SDKPreviewSurface.COMMERCE:case I.SDKPreviewSurface.TRANSFER:case I.SDKPreviewSurface.SHARED_COLLECTION:case I.SDKPreviewSurface.CLIENT_PORTAL:case I.SDKPreviewSurface.UNKNOWN:break;case I.SDKPreviewSurface.BACKUP:et.push(e,w,h,(0,_.makeTransferActionLoader)(n));break;default:(e=>{throw new Error})()}a!==I.SDKPreviewSurface.BROWSE&&a!==I.SDKPreviewSurface.SEARCH&&a!==I.SDKPreviewSurface.PHOTOS||et.push(l)}return Object.assign(Object.assign({},Ze),{pluginLoaders:et.filter(e=>null!=e)})},Ge=(e,t,i,r,s)=>{const a=[];if(e){const{canCopyToDropboxRoles:n}=e;if(n.length>0){const n=(0,U.getToDropboxOption)(e,t,i,r,void 0,void 0,void 0,void 0,s);a.push({text:n.text,isDisabled:n.isDisabled,role:n.role})}}return a};t._FileViewer=t=>{var s;const{file:o,sharedLinkInfo:l,sharePermission:d,shareToken:_,brandingInfo:v,user:m,previewSurface:f,encryptionOptions:g,closeFile:h,flipToNextFile:S,flipToPreviousFile:E,previewCollection:P,updateFiles:b,fileIndex:O=0,fileCount:y=1,passSessionId:T,previewContentOnly:R=!1,transparentBackground:D=!1,forceNoToolbar:k=!1,showCloudDocPreview:M=!0,onPreviewSessionInitialized:F,onRestoreRevision:j,onFullscreenChange:x,canRestoreRevision:V,canShowFileFlippers:H,authModalKind:q,containerId:K,onFileChanged:J,fileViewerId:Q,sourceContext:$,ajaxTimerName:te}=t,se=(({file:e,initialSourceAction:t})=>{const i=r.default.useRef(t===Z.PreviewSourceAction.Visit?C.SourceAction.Visit:C.SourceAction.Click),s=r.default.useRef();return r.default.useEffect(()=>{s.current=e},[e]),void 0!==s.current&&e!==s.current&&(i.current=C.SourceAction.Click),i.current})(t),ae=(0,n.useDispatch)(),ne=(0,n.useSelector)(He.getVoiceoverTriggerState),oe={file:o,sharedLinkInfo:l,sharePermission:d,shareToken:_,encryptionOptions:g},ve=r.default.useRef(oe),me=r.default.createRef(),fe=r.default.useCallback(()=>ve.current,[]),ge=(0,n.useSelector)(e=>(0,p.getOpenActionsForFile)(e,o),n.shallowEqual),he=r.default.useMemo(()=>(0,u.partitionActions)(ge).cloudEditors,[ge]),Se=r.default.useMemo(()=>K&&document.getElementById(K)||void 0,[K]),Ie=(0,n.useSelector)(e=>(0,je.isSendForSignatureEnabled)(e)),[Pe,Ae]=r.default.useState(!1),{CaptureRecorder:be,captureState:Oe}=(0,Ue.useCaptureRecorder)(m,o,f),Te=t.previewSurface===I.SDKPreviewSurface.BROWSE?t.browseContext:void 0,Ce=t.previewSurface===I.SDKPreviewSurface.BROWSE?t.browseExceptions:void 0,De=t.previewSurface===I.SDKPreviewSurface.BROWSE?t.shouldFocusApproval:void 0,Me=t.previewSurface===I.SDKPreviewSurface.BROWSE?t.shouldFocusComment:void 0,Fe="activeCommentThreadId"in t&&t.activeCommentThreadId?t.activeCommentThreadId:void 0,xe=t.previewSurface===I.SDKPreviewSurface.SHARED_LINK||t.previewSurface===I.SDKPreviewSurface.SHARED_CONTENT_LINK?t.copyLinkButtonOOBPreviewsVariant:void 0;r.default.useEffect(()=>{xe&&"OFF"!==xe&&new Promise((t,i)=>{e(["metaserver/static/js/stormcrow/stormcrow_exposure_logger"],t,i)}).then(i.__importStar).then(({StormcrowExposureLogger:e})=>{(new e).logExposure("sharing_copy_link_button_oob_previews",xe)})},[]);const Ke=e=>(0,I.showAuthModal)(Object.assign(Object.assign({},e),{encryptionOptions:g})),ze=r.default.useMemo(()=>We(f,fe,Ke,_,Ae,Oe,O,d,h,Te,Ce,m,P,S,E,j,x,F,b,0,g,R,D,k,M,H,V,q,J,Q,te,Ie),[m,f]),Ye=r.default.useRef(null),Xe=r.default.useMemo(()=>{var e;const t=null===(e=ve.current)||void 0===e?void 0:e.file,i=t&&(0,c.isBrowseFile)(t)&&(0,c.isBrowseFile)(o)&&t.file_id===o.file_id&&t.fq_path===o.fq_path&&(0,I.sameTimeRangeFromHref)(t.href,o.href);if(Ye.current&&(Pe||i))return Ye.current;ve.current={file:o,sharedLinkInfo:l,sharePermission:d,shareToken:_,encryptionOptions:g};const r=((e,t,i,r,s,a,n,o,l,d)=>{const p=i.map(e=>({displayName:e.description,editorName:"cloud_editor"===e.handler[".tag"]?(0,B.cloudEditorNameToParams)(e.handler.editor_name):"",iconUrl:e.icon.url}));if((0,c.isSharedFile)(t))return{cloud_open_with_buttons:p,download_button:{enable_download_button:!r,enable_open_with_button:!r,can_download:!!s&&(0,U.isDownloadAllowed)(s),copy_targets:Ge(s,a,t,n,d)},enable_print:(0,w.canPrint)(s),enable_open_button:!1,enable_restore_button:l,enable_view_on_dropbox_button:!1,canEdit:!1};{const i=!!o&&!o.isCurrentPathWriteable(),s=!(t.read_only||i||e===I.SDKPreviewSurface.VIDEO_SYNTHESIS);return{cloud_open_with_buttons:p,download_button:{enable_download_button:!r,enable_open_with_button:!r,can_download:!0,copy_targets:[]},enable_print:e!==I.SDKPreviewSurface.COMMERCE,enable_open_button:e!==I.SDKPreviewSurface.VERSION_HISTORY,enable_restore_button:l,enable_view_on_dropbox_button:!1,canEdit:s}}})(f,o,he,R,d,_,g,Te,!!V,m);return((e,t,i,r,s,a,n,o,l,d,p,u,_,v)=>{const m=(0,le.parseActiveCommentFromUrl)(),f=(0,I.parseTimeRangeFromUrl)();let g;return(0,we.isEditModeActive)()&&((0,Y.showEditPlugin)(e,l)?g=z.PHOTO_EDITOR_PLUGIN_ID:(0,G.showEditPlugin)(e,l)&&(g=W.PDF_EDITOR_PLUGIN_ID)),{fileInfo:{file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id,url:null==o?void 0:o.url},fileMetadata:{file_id:e.file_id,file_name:(0,c.getFilename)(e),file_path:(0,c.isBrowseFile)(e)?e.fq_path:void 0,file_last_modified_date:e.ts?new Date(1e3*e.ts).toISOString():void 0,file_collection_context:{file_index:i,parent_files_count:r}},previewMetadata:e.preview,fileConfig:t,fileSize:e.bytes,supportedPreviewTypes:[...pe.DEFAULT_SUPPORTED_PREVIEW_TYPES,...I.INBAND_SUPPORTED_TYPES],sharedLinkInfo:o&&Object.assign(Object.assign({},o),{hasPublicAudienceOrVisibility:!!o.hasPublicAudienceOrVisibility}),sourceSession:{source_action:a,source_context:s,page_start_ts:performance.timing.navigationStart,was_flipped:n},pluginParams:{shouldFocusApproval:d,shouldFocusComment:p,threadId:u,commentId:m},defaultRightRailPlugin:d||p||u||m?de.COMMENTS_PLUGIN_ID:L.INFO_BLADE_PLUGIN_ID,activeEditPlugin:g,brandingInfo:_,timeRange:f,isLoggedIn:!!v}})(o,r,O,y,$,se,!1,l,d,De,Me,Fe,v,m)},[o]);Ye.current=Xe,r.default.useEffect(()=>{if(f!==I.SDKPreviewSurface.VERSION_HISTORY)return(0,ie.hideElementsBehindFileViewer)(),ie.showElementsBehindFileViewer},[]),r.default.useEffect(()=>{const e=document.title;return()=>{document.title=e}},[]);const Je=(0,c.getFilename)(o);r.default.useEffect(()=>{document.title=Je},[Je]),r.default.useEffect(()=>{const e=ue.Snackbar.manager;ue.Snackbar.manager=me.current;const t=X.default.getScope();return X.default.setScope("fvsdk_scope"),ee.scroll_lock_document(),()=>{ee.scroll_unlock_document(),X.default.setScope(t),ue.Snackbar.manager=e}},[]),r.default.useEffect(()=>{(0,Le.emitPageChanged)()},[Xe]),r.default.useEffect(()=>()=>{(0,Le.emitPageChanged)(),(0,Le.emitRequestBrowseRefreshEvent)()},[]);const Qe=r.default.useRef(null),$e=r.default.useCallback(e=>{Qe.current=e;const t=["dragenter","dragover","dragleave","drop"],i=e=>{e.stopPropagation(),e.preventDefault()};for(const r of t)null==e||e.addEventListener(r,i)},[]),Ze=r.default.useMemo(()=>({onHide:e})=>r.default.createElement(ce.OpenInAppHeader,{activePreviewFile:oe,user:m,onHide:e}),[o,m]),et=f===I.SDKPreviewSurface.SHARED_LINK||f===I.SDKPreviewSurface.SHARED_CONTENT_LINK||f===I.SDKPreviewSurface.SHARED_COLLECTION,tt=r.default.useMemo(()=>r.default.createElement(ye.LazyMobileFooter,{user:m,isSharedLink:et,activePreviewFile:oe,authModalKind:q}),[m,oe]),it=r.default.useMemo(()=>r.default.createElement(ye.LazyMobileHeader,{user:m,isSharedLink:et,activePreviewFile:oe,authModalKind:q,browseContext:Te,onFileChanged:J}),[m,oe]),rt=r.default.useMemo(()=>{if(m)return({initialPath:e,onFolderSelected:t})=>r.default.createElement(ye.LazyFolderPicker,{user:m,webTimer:A.get_timer(),onFolderSelected:t,apiClient:{getFolderContents:Ne.getFolderContentsAPIv2},initialPath:e,rootName:ke.Viewer.get_root_name(m),canSelectReadonly:!1,skipFocusOnMount:!0,showFolderSuggestion:!1,showEmptyFolders:!0,size:"small"})},[m]),st=r.default.useMemo(()=>{let e=!0;return e=(0,c.isSharedFile)(oe.file)?!!d&&d.canViewMetadataRoles.length>0:f!==I.SDKPreviewSurface.VERSION_HISTORY,r.default.createElement(Re.TitleBarRightSection,{previewSurface:f,user:m,activePreviewFile:oe,copyLinkButtonOOBPreviewsVariant:xe,passSessionId:T,showAuthModal:Ke,enablePass:e})},[m,oe,T,xe,Xe]);return r.default.createElement("div",{ref:$e,className:(0,a.default)("fvsdk-container",{"fvsdk-embed-viewport":!!Se})},r.default.createElement(_e.SnackbarManager,{ref:me,getParentElement:()=>Qe.current,useDigSnackbars:!0}),r.default.createElement(Ee.FileViewer,Object.assign({},ze,{className:N.FVSDK_MOUNT_POINT,id:N.FVSDK_MOUNT_POINT,viewport:Se,initializeOpts:Xe,header:Ze,mobileFooter:tt,mobileHeader:it,titlebar:{rightSection:st},folderPicker:rt})),r.default.createElement(re.AsyncReplayDialog,{file:o,user:m}),be,m&&(null===(s=ze.featureConfig)||void 0===s?void 0:s.capture_sdk_integration_voice_overs)&&r.default.createElement(Ve.PreviewVoiceoverRecorder,{fileId:o.file_id,logEvent:Be.logInterstitialEventToAmp,triggerResetHandler:()=>{ae((0,qe.resetVoiceoverTrigger)())},user:m,voiceoverState:ne}))},t._FileViewer.displayName="_FileViewer",t._FileViewer.displayName="_FileViewer";const ze=e=>{const i=r.default.useMemo(()=>me.UUID.v4({allowInsecure:!0}),[]),s=r.default.useMemo(()=>me.UUID.v4({allowInsecure:!0}),[]),[a,n]=r.default.useState(!1),o=r.default.useCallback(e=>{(0,Be.logInterstitialEventToAmp)(e,"file_viewer")},[]),l=r.default.useCallback(()=>{n(!0)},[n]);return"open_in_app_data"in e.file&&e.file.open_in_app_data&&!a&&!e.hideOpenInAppInterstitial?r.default.createElement(oe.FvsdkAppDownloadInterstitial,{file:e.file,filePreviewSessionId:i,fileViewerSessionId:s,onDismiss:l,openInAppData:e.file.open_in_app_data,sharedLinkInfo:e.sharedLinkInfo,fileViewOrigin:e.fileViewOrigin,logUserAction:o}):r.default.createElement(t._FileViewer,Object.assign({},e,{fileViewerId:s}))};ze.displayName="FileViewerWithInterstitial";const Ye=(0,ge.getStoreForFileViewer)(),Xe=e=>(Pe.PreviewsEventLogger.mark(Pe.PreviewsTimingEvents.SDK_FILE_VIEWER_CODE_START),r.default.createElement(n.Provider,{store:Ye},r.default.createElement(ze,Object.assign({},e))));Xe.displayName="FileViewerWithProvider",Xe.displayName="FileViewerWithProvider";const Je=(0,d.requireCssWithComponent)(Xe,["/static/typescript/libraries/file-viewer/src/index.web-vfljoiGhs.css","/static/typescript/libraries/comments2/src/index-vfljiK9YC.css","/static/metaserver/static/css/dig-components/index.web-vflD7DS1H.css","/static/metaserver/static/css/preview/sdk_file_viewer-vfliwutJI.css","/static/typescript/component_libraries/dig-experimental/src/index.web-vfl_m6TBk.css","/static/typescript/component_libraries/retrieval-components/src/index.web-vflDzdwKn.css","/static/typescript/component_libraries/photos/src/index.web-vfl2_Z5j-.css","/static/metaserver/static/css/dig-illustrations/index.web-vflzrHQEU.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/font_paper_atlas_grotesk-vflDoDLsu.css"]);t.FileViewer=Je,Je.displayName="FileViewer"})),define("metaserver/static/js/file_viewer/sdk_file_viewer/full_screen_helpers",["require","exports"],(function(e,t){"use strict";let i;function r(){c()||(null==i||i(),n())}function s(){o()}function a(){var e;e=r,document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("mozfullscreenchange",e),(function(e){window.addEventListener("popstate",e)})(s)}function n(){var e;e=r,document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("mozfullscreenchange",e),(function(e){window.removeEventListener("popstate",e)})(s),i=()=>{}}function o(){null==i||i(),l()}function l(){n(),(function(){const e=document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()})()}function c(){const e=document;return null!=e.fullScreen?e.fullScreen:null!=e.webkitIsFullScreen?e.webkitIsFullScreen:null!=e.mozFullScreen?e.mozFullScreen:null!=e.msFullscreenElement||null!=e.fullscreenElement}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserFullScreen=t.browserSupportFullScreen=t.exitFullScreenWithoutCallback=t.exitFullScreen=t.enterFullScreen=void 0,t.enterFullScreen=function({onExitFunction:e}){(function(e){i=e})(e),(function(){const e=document.body;null!=e.requestFullscreen?e.requestFullscreen():null!=e.msRequestFullscreen?e.msRequestFullscreen():null!=e.mozRequestFullScreen?e.mozRequestFullScreen():null!=e.webkitRequestFullscreen&&e.webkitRequestFullscreen()})(),a()},t.exitFullScreen=o,t.exitFullScreenWithoutCallback=l,t.browserSupportFullScreen=function(){const e=document.body;return e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen},t.isBrowserFullScreen=c})),define("metaserver/static/js/file_viewer/sdk_file_viewer/full_screen",["require","exports","metaserver/static/js/file_viewer/sdk_file_viewer/full_screen_helpers"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFullScreenClient=void 0,t.makeFullScreenClient=function(e){return{enterFullScreen:(t,r)=>{r||(0,i.enterFullScreen)({onExitFunction:t}),e&&e(!0)},exitFullScreen:t=>{t||(0,i.exitFullScreenWithoutCallback)(),null==e||e(!1)}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/lazy_components",["require","exports","tslib","react"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyFolderPicker=t.FolderPicker=t.LazyMobileHeader=t.MobileHeader=t.LazyMobileFooter=t.MobileFooter=void 0,r=i.__importStar(r),t.MobileFooter=r.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{MobileFooter:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/mobile_web/footer"],t,i)}).then(i.__importStar);return{default:t}})));t.LazyMobileFooter=e=>r.createElement(r.Suspense,{fallback:null},r.createElement(t.MobileFooter,Object.assign({},e))),t.LazyMobileFooter.displayName="LazyMobileFooter",t.MobileHeader=r.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{MobileHeader:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/mobile_web/header"],t,i)}).then(i.__importStar);return{default:t}})));t.LazyMobileHeader=e=>r.createElement(r.Suspense,{fallback:null},r.createElement(t.MobileHeader,Object.assign({},e))),t.LazyMobileHeader.displayName="LazyMobileHeader",t.FolderPicker=r.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{FolderPicker:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/folder_dialog/folder_picker_dig"],t,i)}).then(i.__importStar);return{default:t}})));t.LazyFolderPicker=e=>r.createElement(r.Suspense,{fallback:null},r.createElement(t.FolderPicker,Object.assign({},e))),t.LazyFolderPicker.displayName="LazyFolderPicker"})),define("metaserver/static/js/file_viewer/sdk_file_viewer/navigation",["require","exports","metaserver/static/js/previews/util"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSharedCollectionNavigationClient=t.makeVersionHistoryNavigationClient=t.makeBrowseNavigationClient=t.makeInbandShareNavigationClient=void 0,t.makeInbandShareNavigationClient=function(e,t,i,r,s){return{closeViewer:e?()=>{e()}:void 0,flipToNextFile:t,showAuthModal:s,flipToPreviousFile:i,restorePreviousVersion:r}},t.makeBrowseNavigationClient=function(e,t,r,s,a,n,o){return{closeViewer:r?()=>{r()}:void 0,openVersionHistory:()=>{const r=t();(0,i.redirectToVersionHistory)(r.file,e)},flipToNextFile:s,flipToPreviousFile:a,restorePreviousVersion:n,updateFiles:o?()=>o():void 0}},t.makeVersionHistoryNavigationClient=function(e,t,i,r,s,a){return{closeViewer:i?()=>{i()}:void 0,flipToNextFile:r,flipToPreviousFile:s,restorePreviousVersion:a}},t.makeSharedCollectionNavigationClient=function(e,t,i){return{closeViewer:e?()=>{e()}:void 0,flipToNextFile:t,flipToPreviousFile:i}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/pass",["require","exports","metaserver/static/js/pass/beacon_presence_helpers","metaserver/static/js/pass/types"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPresenceBeaconIOClient=void 0,t.getPresenceBeaconIOClient=function(e,t){return{subscribe(s){var a;const n=t(),o=(null==n?void 0:n.file.file_id)===s?null===(a=null==n?void 0:n.sharedLinkInfo)||void 0===a?void 0:a.url:void 0;i.BeaconPresenceHelpers.transmitBeaconData({prevBeaconFileData:null,beaconFileData:new r.BeaconFileData(s,o),user:null!=e?e:null,passSessionId:void 0})},unsubscribe(s){var a;const n=t(),o=(null==n?void 0:n.file.file_id)===s?null===(a=null==n?void 0:n.sharedLinkInfo)||void 0===a?void 0:a.url:void 0;i.BeaconPresenceHelpers.shutdown({beaconFileData:new r.BeaconFileData(s,o),user:null!=e?e:null,async:!0})}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/preferences_util",["require","exports","metaserver/static/js/core/persistence/storage"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMutedState=t.getMutedState=t.setVolumeState=t.getVolumeState=t.setDocSidebarIsCollapsed=t.getDocSidebarIsCollapsed=t.setRightRailBlade=t.getRightRailBlade=t.setRightRailIsCollapsed=t.getRightRailIsCollapsed=void 0;t.getRightRailIsCollapsed=function(e){var t;try{return null===(t=i.UserLocalStorage.get(e,"file_viewer_right_rail_collapsed_preference"))||void 0===t||t}catch(e){return!0}},t.setRightRailIsCollapsed=function(e,t){try{i.UserLocalStorage.set(e,"file_viewer_right_rail_collapsed_preference",t)}catch(e){}},t.getRightRailBlade=function(e){var t;try{return null!==(t=i.UserLocalStorage.get(e,"file_viewer_right_rail_blade_preference"))&&void 0!==t?t:void 0}catch(e){return}},t.setRightRailBlade=function(e,t){try{i.UserLocalStorage.set(e,"file_viewer_right_rail_blade_preference",t)}catch(e){}},t.getDocSidebarIsCollapsed=function(e){var t;try{return null===(t=i.UserLocalStorage.get(e,"file_viewer_doc_sidebar_collapsed_preference"))||void 0===t||t}catch(e){return!0}},t.setDocSidebarIsCollapsed=function(e,t){try{i.UserLocalStorage.set(e,"file_viewer_doc_sidebar_collapsed_preference",t)}catch(e){}},t.getVolumeState=function(e){var t;try{return parseFloat(null!==(t=i.UserLocalStorage.get(e,"file_viewer_video_volume_preference"))&&void 0!==t?t:1)}catch(e){return 1}},t.setVolumeState=function(e,t){try{i.UserLocalStorage.set(e,"file_viewer_video_volume_preference",t)}catch(e){}},t.getMutedState=function(e){var t;try{return null!==(t=i.UserLocalStorage.get(e,"file_viewer_video_muted_preference"))&&void 0!==t&&t}catch(e){return!1}},t.setMutedState=function(e,t){try{i.UserLocalStorage.set(e,"file_viewer_video_muted_preference",t)}catch(e){}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/preferences",["require","exports","metaserver/static/js/file_viewer/sdk_file_viewer/preferences_util","metaserver/static/js/account_page/widgets/account_preferences/api"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePreferencesClient=void 0,t.makePreferencesClient=function(e){return e?(function(e){return{rightRail:{setCollapsedState:({isCollapsed:t})=>{(0,i.setRightRailIsCollapsed)(e.id,t)},getCollapsedState:()=>(0,i.getRightRailIsCollapsed)(e.id),setBladeState:({bladeId:t})=>{(0,i.setRightRailBlade)(e.id,t)},getBladeState:()=>(0,i.getRightRailBlade)(e.id)},docSidebar:{setCollapsedState:({isCollapsed:t})=>{(0,i.setDocSidebarIsCollapsed)(e.id,t)},getCollapsedState:()=>(0,i.getDocSidebarIsCollapsed)(e.id)},video:{getVolumeState:()=>(0,i.getVolumeState)(e.id),setVolumeState:t=>(0,i.setVolumeState)(e.id,t),getMutedState:()=>(0,i.getMutedState)(e.id),setMuteState:t=>(0,i.setMutedState)(e.id,t)},accountPageUserRelatedPreference:{setOptInToVideoTranscript:()=>(0,r.updateUserRelatedPreference)(e.id,"previews_transcription",!0)}}})(e):{rightRail:{setCollapsedState:()=>{},getCollapsedState:()=>!0,setBladeState:()=>{},getBladeState:()=>{}},docSidebar:{setCollapsedState:({})=>{},getCollapsedState:()=>!0}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/print",["require","exports","tslib","typescript/libraries/file-viewer/src/core/types/preview_type","metaserver/static/js/clean/referrer_cleansing_redirect","metaserver/static/js/core/i18n"],(function(e,t,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canPrint=t.makePrintClient=void 0,s=i.__importStar(s),t.makePrintClient=function(){return{print:(e,t)=>{var i;t===r.PreviewType.SsrDoc?(i=e,s.safe_open_tab_and_redirect(i)):t===r.PreviewType.Image&&(function(e){const t=window.open("about:blank");if(!t)throw new Error(a.intl.formatMessage({id:"X9xK6f",defaultMessage:"Could not open new window"}));window.setTimeout(()=>{const i=t.document.createElement("style");i.innerHTML="\n      @page { margin: 0;}\n      img { max-width: 100%; max-height: 100%}\n    ",t.document.head.appendChild(i);const r=t.document.createElement("img");r.src=e,r.onload=()=>{t.print()},r.onerror=()=>{t.close()},t.document.body.appendChild(r)},50)})(e)}}},t.canPrint=function(e){return!(e&&e.canPrintRoles&&0===e.canPrintRoles.length)}}));__createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&("get"in s?t.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/file_viewer/sdk_file_viewer/replay_prompt/async_replay_dialog",["require","exports","metaserver/static/js/async/loadable"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncReplayDialog=void 0,t.AsyncReplayDialog=(0,i.Loadable)({loader:()=>new Promise((t,i)=>{e(["metaserver/static/js/file_viewer/sdk_file_viewer/replay_prompt/replay_dialog"],t,i)}).then(__importStar).then(({ReplayDialog:e})=>e)})})),define("metaserver/static/js/file_viewer/sdk_file_viewer/titlebar",["require","exports","tslib","react","react-intl","classnames","metaserver/static/js/size_class/constants","metaserver/static/js/previews/ui/sharing_plugin/share_button","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils","metaserver/static/js/file_viewer/sdk_file_viewer/experiments","metaserver/static/js/pass/seen_state_facepile_controller","dig-components/buttons","typescript/libraries/file-viewer/src/core/types/auth_modal","metaserver/static/js/file_viewer/sdk_file_viewer/file_viewer.module.css"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TitleBarRightSection=t.LoginSignupButtons=void 0,r=i.__importStar(r),a=i.__importDefault(a),v=i.__importStar(v);const m=({activePreviewFile:e,passSessionId:t,user:i})=>r.createElement("div",{className:(0,a.default)(v.titleBarSpacing,v.pass)},r.createElement(p.SeenStateFacepileController,{user:i||null,file:e.file,passSessionId:t,source:"fileViewer",sharedLinkInfo:e.sharedLinkInfo,sizeClass:n.SizeClass.Medium,isViewMetadataDisabled:!1,isViewingFileSubpath:!1,soloAccessText:!0}));m.displayName="PassUi";const f=({activePreviewFile:e,user:t,copyLinkButtonOOBPreviewsVariant:i,previewSurface:s})=>{const a=t&&"MULTI_APPROVER"===d.fileViewerFlowExperiments.approvalFlowVariantByUserId[t.id]&&d.fileViewerFlowExperiments.flowsApprovalInShareModalEnabled&&(0,c.isLiveFile)(e.file)&&!(0,c.isCloudDoc)(e.file);return r.createElement("div",{className:v.titleBarSpacing},r.createElement(o.ShareButton,{previewSurface:s,activeFile:e.file,user:t,copyLinkButtonOOBPreviewsVariant:i,shouldShowApproval:a}))};f.displayName="TitleBarShareButton";t.LoginSignupButtons=({showAuthModal:e})=>{const t=(0,s.useIntl)(),i=t.formatMessage({id:"N0xz5m",defaultMessage:"Sign in"});return r.createElement("div",{className:(0,a.default)(v.auth,v.titleBarSpacing)},r.createElement(u.Button,{onClick:()=>e({mode:_.AuthMode.LOGIN,kind:_.LoginOrRegisterKind.SIDEBAR}),"aria-label":t.formatMessage({id:"Cg3xuN",defaultMessage:"Button to trigger login dialog"}),variant:"opacity"},i),r.createElement(u.Button,{className:"previews_campaign_slot_sign_up",onClick:()=>e({mode:_.AuthMode.REGISTER,kind:_.LoginOrRegisterKind.SIDEBAR}),"aria-label":t.formatMessage({id:"B9J0l9",defaultMessage:"Button to trigger sign up dialog"}),variant:"primary"},t.formatMessage({id:"5KEf7W",defaultMessage:"Sign up"})))},t.LoginSignupButtons.displayName="LoginSignupButtons";t.TitleBarRightSection=e=>{const{activePreviewFile:i,user:s,passSessionId:a,previewSurface:n,showAuthModal:o,enablePass:c}=e,d=n!==l.SDKPreviewSurface.BACKUP&&n!==l.SDKPreviewSurface.SHARED_COLLECTION&&n!==l.SDKPreviewSurface.VERSION_HISTORY,p=!s;return r.createElement(r.Fragment,null,p&&r.createElement(t.LoginSignupButtons,{showAuthModal:o}),d&&r.createElement(f,Object.assign({},e)),c&&r.createElement(m,{activePreviewFile:i,passSessionId:a,user:s}))},t.TitleBarRightSection.displayName="TitleBarRightSection"})),define("metaserver/static/js/file_viewer/sdk_file_viewer/toolbar_plugins/crop_rotate_plugin",["require","exports","tslib","metaserver/static/js/photos/ui/preview_crop_and_rotate/show-crop-rotate-plugin","metaserver/static/js/file_store/utils"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCropRotateButtonsLoader=t.CROP_ROTATE_TOOLBAR_PLUGIN_ID=void 0,t.CROP_ROTATE_TOOLBAR_PLUGIN_ID="CROP_ROTATE_BUTTON";t.makeCropRotateButtonsLoader=(a,n,o)=>({pluginId:t.CROP_ROTATE_TOOLBAR_PLUGIN_ID,isEnabled:()=>{const{file:e,sharePermission:t}=n(),i=(0,s.getExtension)(e);return(0,r.showCropRotatePlugin)(i,e,t)},load:(r,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{loadCropRotatePlugin:r}=yield new Promise((t,i)=>{e(["metaserver/static/js/photos/ui/preview_crop_and_rotate/crop_rotate_exports"],t,i)}).then(i.__importStar);return r(t.CROP_ROTATE_TOOLBAR_PLUGIN_ID,a,s,n,o)}))})})),define("metaserver/static/js/file_viewer/sdk_file_viewer/toolbar_plugins/snackbar_manager_plugin",["require","exports","metaserver/static/js/clean/ui/snackbar"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.snackbarManagerLoader=t.SNACKBAR_MANAGER_PLUGIN_ID=void 0,t.SNACKBAR_MANAGER_PLUGIN_ID="SNACKBAR_MANAGER",t.snackbarManagerLoader={pluginId:t.SNACKBAR_MANAGER_PLUGIN_ID,load:(e,t)=>Promise.resolve({isSnackbarVisible:()=>{var e;return!!(null===(e=i.Snackbar.manager)||void 0===e?void 0:e.state.displayedSnackbar)},lifecycle:{}})}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/url",["require","exports","tslib","metaserver/static/js/clean/history","metaserver/static/js/core/browser","metaserver/static/js/core/uri","metaserver/static/js/clean/browse_uri_interface","metaserver/static/js/clean/referrer_cleansing_redirect"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeUrlClient=void 0,r=i.__importDefault(r),s=i.__importStar(s),o=i.__importStar(o),t.makeUrlClient=function(e){return{getQueryStringParameter(e){const t=s.get_uri().getQuery();return e in t?t[e]:null},getAllQueryStringParameters:()=>r.default.get_uri().getQuery(),setQueryStringParameter(e,t){const i=r.default.get_uri();null!==t?i.updateQuery(e,t):i.removeQuery(e),r.default.push_state(i.getPath(),i.getQuery())},onQueryStringParameterChange(e,t){const i=`/${s.get_uri().getPath().split("/")[1]}`,a=(i,r)=>{let s=null;if(e in r){const t=r[e];s=t instanceof Array?t.length?t[0]:null:null!=t?t:null}t(e,s)};return r.default.add_callback(i,a,!0),()=>r.default.remove_callback(i,a)},openFile(t,i){if(i){const i=(0,n.preview_uri_for_fq_path)(e,t);s.replace_location(i)}else{const i=(0,n.get_browse_root)(e)+a.URI.encode_parts(t);s.replace_location(i)}},redirect(e,t){t?o.safe_open_tab_and_redirect(e):o.redirect(e)},reload(){s.reload()},replaceState(e){const t=r.default.get_uri();r.default.replace_state(t.getPath(),e)}}}})),define("metaserver/static/js/file_viewer/sdk_file_viewer/utils",["require","exports","tslib","react","typescript/libraries/file-viewer/src/core/types/preview_type","metaserver/static/js/pap/util","metaserver/static/js/clean/history","metaserver/static/js/open_in_app/types","metaserver/static/js/core/browser_detection","typescript/libraries/file-viewer/src/core/types/auth_modal","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/file_viewer/sdk_file_viewer/experiments","metaserver/static/js/file_store/utils","typescript/libraries/file-viewer/src/file_extension/extension_constants","metaserver/static/js/core/uri"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v){"use strict";var m;function f(e){return!e}Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkType=t.LinkType=t.sameTimeRangeFromHref=t.parseTimeRangeFromUrl=t.isPublishEnabled=t.isPublishPaintedDoorEnabled=t.isOpenInReplayEnabled=t.isEditModeActive=t.isVideoPreview=t.isAudioPreview=t.isExcelPreview=t.bucketLengthForUserSurvey=t.isFvsdkPdfEditorEnabled=t.showAuthModal=t.cleanupPrerenderPreview=t.canDownloadFile=t.isMountedFile=t.getOpenInAppUrls=t.VIDEO_EDIT_PLUGIN_ID=t.VIEW_CAPTURE_VIDEO_PLUGIN_ID=t.RECORD_VIDEO_WITH_CAMERA_PLUGIN_ID=t.RECORD_VIDEO_PLUGIN_ID=t.RECORD_VIDEO_DROPDOWN_PLUGIN_ID=t.GO_TO_FOLDER_PLUGIN_ID=t.FLOWS_BOLT_PLUGIN_ID=t.PUBLISH_ACTION_PLUGIN_ID=t.PUBLISH_PAINTED_DOOR_ACTION_PLUGIN_ID=t.OPEN_IN_REPLAY_ACTION_PLUGIN_ID=t.SIGNATURES_ACTIONBAR_DROPDOWN_PLUGIN_ID=t.STAR_TOOLBAR_PLUGIN_ID=t.RESTORE_ACTION_PLUGIN_ID=t.VERSION_HISTORY_ACTION_PLUGIN_ID=t.UNZIP_ACTION_PLUGIN_ID=t.DOCSEND_ANALYTICS_ADD_ON_ACTION_PLUGIN_ID=t.STARRED_ACTION_PLUGIN_ID=t.ADD_TO_COLLECTION_ACTION_PLUGIN_ID=t.TRANSFER_ACTION_PLUGIN_ID=t.CREATE_VERSION_ACTION_PLUGIN_ID=t.REQUEST_APPROVAL_ACTION_PLUGIN_ID=t.OPEN_IN_DESKTOP_ACTION_PLUGIN_ID=t.RENAME_ACTION_PLUGIN_ID=t.WATERMARKING_ACTION_PLUGIN_ID=t.OPEN_DROPDOWN_ACTION_PLUGIN_ID=t.MOVE_ACTION_PLUGIN_ID=t.DELETE_ACTION_PLUGIN_ID=t.DOWNLOAD_ACTION_PLUGIN_ID=t.COPY_LINK_ACTION_PLUGIN_ID=t.COPY_ACTION_PLUGIN_ID=t.SDKPreviewSurfaceToPapType=t.SDKPreviewSurface=t.INBAND_SUPPORTED_TYPES=void 0,r=i.__importDefault(r),n=i.__importDefault(n),l=i.__importStar(l),t.INBAND_SUPPORTED_TYPES=[s.PreviewType.HTML],(function(e){e.BROWSE="browse",e.SEARCH="search",e.INBAND_SHARE="inband-share",e.SHARED_LINK="shared-link",e.SHARED_CONTENT_LINK="shared-content-link",e.SHARED_LINK_EMBED="shared-link-embed",e.VERSION_HISTORY="version-history",e.HOME="home",e.HELLOSIGN="hellosign",e.RECENTS="recents",e.STARRED="starred",e.STANDALONE_PREVIEW="standalone-previews",e.PHOTOS="photos",e.COLLECTIONS="collections",e.SHARED_COLLECTION="shared-collection",e.COMMERCE="commerce",e.CLIENT_PORTAL="client-portal",e.TRANSFER="transfer",e.FILE_LOCKING="file-locking",e.BACKUP="backup",e.UNKNOWN="unknown",e.VIDEO_SYNTHESIS="video-synthesis"})(m=t.SDKPreviewSurface||(t.SDKPreviewSurface={})),t.SDKPreviewSurfaceToPapType=function(e,t){let i=void 0;switch(e){case m.UNKNOWN:i=(0,a.getEnumValueForString)("UNKNOWN_PREVIEWS_SURFACE",t);break;case m.BROWSE:i=(0,a.getEnumValueForString)("BROWSE_PREVIEWS_SURFACE",t);break;case m.SEARCH:i=(0,a.getEnumValueForString)("SEARCH_PREVIEWS_SURFACE",t);break;case m.INBAND_SHARE:i=(0,a.getEnumValueForString)("INBAND_SHARE_PREVIEWS_SURFACE",t);break;case m.SHARED_LINK:i=(0,a.getEnumValueForString)("SHARED_LINK_PREVIEWS_SURFACE",t);break;case m.SHARED_CONTENT_LINK:i=(0,a.getEnumValueForString)("SHARED_CONTENT_LINK_PREVIEWS_SURFACE",t);break;case m.SHARED_LINK_EMBED:i=(0,a.getEnumValueForString)("SHARED_LINK_EMBED_PREVIEWS_SURFACE",t);break;case m.VERSION_HISTORY:i=(0,a.getEnumValueForString)("VERSION_HISTORY_PREVIEWS_SURFACE",t);break;case m.HOME:i=(0,a.getEnumValueForString)("HOME_PREVIEWS_SURFACE",t);break;case m.HELLOSIGN:i=(0,a.getEnumValueForString)("HELLOSIGN_PREVIEWS_SURFACE",t);break;case m.RECENTS:i=(0,a.getEnumValueForString)("RECENTS_PREVIEWS_SURFACE",t);break;case m.STARRED:i=(0,a.getEnumValueForString)("STARRED_PREVIEWS_SURFACE",t);break;case m.STANDALONE_PREVIEW:i=(0,a.getEnumValueForString)("STANDALONE_PREVIEWS_PREVIEWS_SURFACE",t);break;case m.PHOTOS:i=(0,a.getEnumValueForString)("PHOTOS_PREVIEWS_SURFACE",t);break;case m.COLLECTIONS:i=(0,a.getEnumValueForString)("COLLECTIONS_PREVIEWS_SURFACE",t);break;case m.VIDEO_SYNTHESIS:i=(0,a.getEnumValueForString)("VIDEO_SYNTHESIS_SURFACE",t);break;case m.COMMERCE:i=(0,a.getEnumValueForString)("COMMERCE_PREVIEWS_SURFACE",t);break;case m.CLIENT_PORTAL:i=(0,a.getEnumValueForString)("CLIENT_PORTAL_PREVIEW_SURFACE",t);break;case m.TRANSFER:i=(0,a.getEnumValueForString)("TRANSFER_PREVIEWS_SURFACE",t);break;case m.FILE_LOCKING:i=(0,a.getEnumValueForString)("FILE_LOCKING_PREVIEWS_SURFACE",t);break;case m.BACKUP:i=(0,a.getEnumValueForString)("BACKUP_PREVIEWS_SURFACE",t)}return i},t.COPY_ACTION_PLUGIN_ID="COPY_ACTION",t.COPY_LINK_ACTION_PLUGIN_ID="COPY_LINK_ACTION",t.DOWNLOAD_ACTION_PLUGIN_ID="DOWNLOAD_ACTION",t.DELETE_ACTION_PLUGIN_ID="DELETE_ACTION",t.MOVE_ACTION_PLUGIN_ID="MOVE_ACTION",t.OPEN_DROPDOWN_ACTION_PLUGIN_ID="OPEN_DROPDOWN_ACTION",t.WATERMARKING_ACTION_PLUGIN_ID="watermarking_overflow_action",t.RENAME_ACTION_PLUGIN_ID="RENAME_ACTION",t.OPEN_IN_DESKTOP_ACTION_PLUGIN_ID="OPEN_IN_DESKTOP_ACTION",t.REQUEST_APPROVAL_ACTION_PLUGIN_ID="REQUEST_APPROVAL_ACTION",t.CREATE_VERSION_ACTION_PLUGIN_ID="CREATE_VERSION_ACTION",t.TRANSFER_ACTION_PLUGIN_ID="TRANSFER_ACTION",t.ADD_TO_COLLECTION_ACTION_PLUGIN_ID="ADD_TO_COLLECTION_ACTION",t.STARRED_ACTION_PLUGIN_ID="STARRED_ACTION",t.DOCSEND_ANALYTICS_ADD_ON_ACTION_PLUGIN_ID="DOCSEND_ANALYTICS_ADD_ON_ACTION",t.UNZIP_ACTION_PLUGIN_ID="UNZIP_ACTION",t.VERSION_HISTORY_ACTION_PLUGIN_ID="VERSION_HISTORY_ACTION",t.RESTORE_ACTION_PLUGIN_ID="RESTORE_ACTION",t.STAR_TOOLBAR_PLUGIN_ID="STAR_TOOLBAR_BUTTON",t.SIGNATURES_ACTIONBAR_DROPDOWN_PLUGIN_ID="SIGNATURES_ACTIONBAR_DROPDOWN",t.OPEN_IN_REPLAY_ACTION_PLUGIN_ID="OPEN_REPLAY_ACTION",t.PUBLISH_PAINTED_DOOR_ACTION_PLUGIN_ID="PUBLISH_PAINTED_DOOR_ACTION",t.PUBLISH_ACTION_PLUGIN_ID="PUBLISH_ACTION",t.FLOWS_BOLT_PLUGIN_ID="FLOWS_BOLT_PLUGIN",t.GO_TO_FOLDER_PLUGIN_ID="GO_TO_FOLDER_PLUGIN",t.RECORD_VIDEO_DROPDOWN_PLUGIN_ID="CAPTURE_RECORD_VIDEO_DROPDOWN_ACTION",t.RECORD_VIDEO_PLUGIN_ID="CAPTURE_RECORD_VIDEO_ACTION",t.RECORD_VIDEO_WITH_CAMERA_PLUGIN_ID="RECORD_VIDEO_WITH_CAMERA_PLUGIN_ACTION",t.VIEW_CAPTURE_VIDEO_PLUGIN_ID="CAPTURE_VIEW_VIDEO_ACTION",t.VIDEO_EDIT_PLUGIN_ID="VIDEO_EDIT_PLUGIN",t.getOpenInAppUrls=function(e,t,i,r){if(e&&t&&i)return e.open_in_app_data;if(l.iOS&&r){const t=encodeURIComponent(e.fq_path),i=encodeURIComponent(r.id);return{platform:o.OpenInMobileAppPlatform.IPHONE,iOSAppUrl:`dbapi-5://1/viewPath?path=${t}&userId=${i}`,iOSAppStoreUrl:"https://itunes.apple.com/us/app/dropbox/id327630330?mt=8e"}}if(l.is_android()){const e="/dl/home/mobile?mobile_app_fallback";return{platform:o.OpenInMobileAppPlatform.ANDROID_MARKET,androidAppUrl:e}}},t.isMountedFile=f,t.canDownloadFile=function(e,t){return f(e)||t&&t.canDownloadRoles.length>0},t.cleanupPrerenderPreview=function(){const e=document.querySelectorAll(".prerender-preview");Array.prototype.forEach.call(e,e=>{e.style.display="none"})};const g={[c.AuthMode.LOGIN]:d.Mode.LOGIN,[c.AuthMode.REGISTER]:d.Mode.REGISTER},h={[c.LoginOrRegisterKind.COMMENT]:d.LoginOrRegisterKind.COMMENT,[c.LoginOrRegisterKind.DOWNLOAD]:d.LoginOrRegisterKind.DOWNLOAD,[c.LoginOrRegisterKind.IMMEDIATE]:d.LoginOrRegisterKind.IMMEDIATE,[c.LoginOrRegisterKind.POSTDOWNLOAD]:d.LoginOrRegisterKind.POSTDOWNLOAD,[c.LoginOrRegisterKind.POSTSAVEAS]:d.LoginOrRegisterKind.POSTSAVEAS,[c.LoginOrRegisterKind.SIDEBAR]:d.LoginOrRegisterKind.SIDEBAR},S={[c.CommentTextVariant.DEFAULT]:d.CommentTextVariant.DEFAULT,[c.CommentTextVariant.POST]:d.CommentTextVariant.POST,[c.CommentTextVariant.SUBSCRIBE]:d.CommentTextVariant.SUBSCRIBE};t.showAuthModal=function({mode:t,kind:s,sharedLinkUrl:a,encryptionOptions:n,commentParams:o,loggingExtra:l,signupTag:c}){return i.__awaiter(this,void 0,void 0,(function*(){const[{Modal:d},{LoginOrRegisterModal:p}]=yield Promise.all([new Promise((t,i)=>{e(["metaserver/static/js/components/ui/modal"],t,i)}).then(i.__importStar),new Promise((t,i)=>{e(["metaserver/static/js/auth/login_or_register/modal"],t,i)}).then(i.__importStar)]);d.showInstance(r.default.createElement(p,{downloadAction:null,id:"shared-link-immediate-signup-modal",initialMode:g[t],kind:h[s],onCancel:()=>{},onAuthenticateSuccess:()=>window.location.reload(),commentParams:o?{stream:o.stream,variant:S[o.variant]}:void 0,signup_tag:c||"shmodel_modal_register",showGoogleRegistration:!0,googleRegisterProps:a?{signupContinuationUrl:a}:void 0,encryptionOptions:n,loggingExtra:l}))}))};const w=["ON"];t.isFvsdkPdfEditorEnabled=()=>w.includes(p.fileViewerFeatureExperiments.enableFvsdkPdfEditor),t.bucketLengthForUserSurvey=function(e){const t=e/60;if(t<2)return"0-2 minutes";if(t<5)return"2-5 minutes";if(t<10)return"5-10 minutes";if(t<30)return"10-30 minutes";const i=t/60;return i<1?"30 minutes - 1 hour":i<5?"1-5 hours":"5+ hours"},t.isExcelPreview=function(e){const t="."+(0,u.getExtension)(e);return".csv"!==t&&_.MSOFFICE_EXCEL_EXTS.includes(t)},t.isAudioPreview=function(e){const t="."+(0,u.getExtension)(e);return _.AUDIO_EXTS.includes(t)},t.isVideoPreview=function(e){const t="."+(0,u.getExtension)(e);return _.TRANSCODE_VIDEO_EXTS.includes(t)},t.isEditModeActive=function(){return"1"===n.default.get_uri().getQuery().edit};t.isOpenInReplayEnabled=()=>"ON"===p.fileViewerFeatureExperiments.replayPreviewsPermanentEntrypoint;t.isPublishPaintedDoorEnabled=()=>"ON"===p.fileViewerFeatureExperiments.publishPreviewsPaintedDoorEntrypoint;t.isPublishEnabled=()=>"ON"===p.fileViewerFeatureExperiments.publishPreviewsPermanentEntrypoint;t.parseTimeRangeFromUrl=()=>{const e=n.default.get_uri().getQuery(),t=e=>{if(e){const t=parseFloat(e);if(!isNaN(t)&&isFinite(t)&&t>=0)return t}},i=t(e.t),r=t(e.e);if(void 0!==i)return{start:i,end:r}};const E=e=>{const t=v.URI.parse(e).getQuery();return(t.t||"")+":"+(t.e||"")};var I;t.sameTimeRangeFromHref=(e="",t="")=>{if(e===t)return!0;return E(e)===E(t)},(function(e){e.SHARED_FILE="SHARED_FILE",e.SHARED_FOLDER="SHARED_FOLDER",e.SCL_FILE="SCL_FILE",e.SCL_FOLDER="SCL_FOLDER"})(I=t.LinkType||(t.LinkType={}));t.getLinkType=e=>e?e.indexOf("/s/")>=0?I.SHARED_FILE:e.indexOf("/sh/")>=0?I.SHARED_FOLDER:e.indexOf("/scl/fi/")>=0?I.SCL_FILE:e.indexOf("/scl/fo/")>=0?I.SCL_FOLDER:null:null}));__createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&("get"in s?t.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("metaserver/static/js/file_viewer/share_helpers",["require","exports","metaserver/static/js/file_store/utils"],(function(e,t,i){"use strict";function r(e,t,r){const s={filename:(0,i.getFilename)(e),isFolder:!1,nsId:e.ns_id,origin:r,sjid:e.sjid,url:t||void 0,fqPath:""};return(0,i.isBrowseFile)(e)&&(s.fqPath=e.fq_path),null!=e.file_id&&(s.fileId=e.file_id),s}Object.defineProperty(t,"__esModule",{value:!0}),t.share=t.getDataForContentInfo=void 0,t.getDataForContentInfo=r,t.share=function(t,i,s,a){new Promise((t,i)=>{e(["metaserver/static/js/sharing/share_modal_util"],t,i)}).then(__importStar).then(e=>{const n=r(t,s,a.origin);e.showShareModal(i,n,a)})}})),define("metaserver/static/js/file_viewer/toggle_browse_elements_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showElementsBehindFileViewer=t.hideElementsBehindFileViewer=void 0;const i=[".maestro-chrome","#maestro-nav","#page-footer","#page-content","#page-header","#page-sidebar","#flash-upload-container","#maestro-header","#maestro-header-portal","#maestro-prompt",".snackbar-container","#onboarding-sidebar-pagelet",".maestro-portal"].join();t.hideElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(i)).forEach(e=>{e.style.display&&e.setAttribute("data-preview-old-display",e.style.display),e.style.display="none"})},t.showElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(i)).forEach(e=>{e.style.display=e.hasAttribute("data-preview-old-display")?e.getAttribute("data-preview-old-display"):""})}})),define("metaserver/static/js/file_viewer/utils",["require","exports","tslib","react","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/previews/ui/constants","metaserver/static/js/open_in_app/types","metaserver/static/js/core/browser_detection","metaserver/static/js/file_viewer/constants","metaserver/static/js/clean/ui/snackbar","metaserver/static/js/clean/web_user_action_logger","metaserver/static/js/clean/web_user_action_events"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u){"use strict";function _(e){if(e)switch(e){case c.FileViewOriginType.BROWSE:return n.PreviewSourceContext.Browse;case c.FileViewOriginType.COLLECTIONS:return n.PreviewSourceContext.Collections;case c.FileViewOriginType.COMMERCE:return n.PreviewSourceContext.Commerce;case c.FileViewOriginType.HELLOSIGN:return n.PreviewSourceContext.HelloSign;case c.FileViewOriginType.HOME:return n.PreviewSourceContext.Home;case c.FileViewOriginType.PHOTOS:return n.PreviewSourceContext.Photos;case c.FileViewOriginType.RECENTS:return n.PreviewSourceContext.Recents;case c.FileViewOriginType.SEARCH:return n.PreviewSourceContext.Search;case c.FileViewOriginType.STARRED:return n.PreviewSourceContext.Starred;case c.FileViewOriginType.TRANSFER:return n.PreviewSourceContext.Transfer;case c.FileViewOriginType.SHARED_COLLECTION:return n.PreviewSourceContext.SharedCollection;case c.FileViewOriginType.CLIENT_PORTAL:return n.PreviewSourceContext.ClientPortal}const t=s.get_uri().path;return/^\/h$/.test(t)?n.PreviewSourceContext.Home:/^\/starred$/.test(t)?n.PreviewSourceContext.Starred:/^\/recents$/.test(t)?n.PreviewSourceContext.Recents:/^\/search$/.test(t)?n.PreviewSourceContext.Search:/^\/(s|scl\/fi)\//.test(t)?n.PreviewSourceContext.SharedLinkFile:/^\/(sh|scl\/fo)\//.test(t)?n.PreviewSourceContext.SharedLinkFolder:/^\/sc\//.test(t)?n.PreviewSourceContext.SharedLinkCollection:/^\/history/.test(t)?n.PreviewSourceContext.VersionHistory:/^\/(home|work|personal)/.test(t)?n.PreviewSourceContext.Browse:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getOpenInAppUrls=t.showDocSendSnackbar=t.getSourceAction=t.getSourceContext=void 0,r=i.__importDefault(r),s=i.__importStar(s),l=i.__importStar(l),t.getSourceContext=_,t.getSourceAction=function(){switch(_()){case n.PreviewSourceContext.SharedLinkFile:case n.PreviewSourceContext.SharedLinkFolder:return n.PreviewSourceAction.Visit;default:return n.PreviewSourceAction.Click}},t.showDocSendSnackbar=function(e){setTimeout(()=>{d.Snackbar.show(r.default.createElement(d.Snackbar,{title:a.intl.formatMessage({id:"d93ce2",defaultMessage:"Always save signed documents in Dropbox? You can change this anytime in DocSend settings."}),closeButtonText:a.intl.formatMessage({id:"6NGNJV",defaultMessage:"Not now"}),actionButtonText:a.intl.formatMessage({id:"gM7OF1",defaultMessage:"Yes"}),id:"sync-from-docsend",onActionClick:()=>{e&&p.WebUserActionLog.log(e.id,u.WebUserActionLogEvent.CLICK_DOCSEND_SNACKBAR_YES,{}),window.open("https://docsend.com/settings/company/users/redirect?anchor=apps-settings","_blank")},onCloseClick:()=>{e&&p.WebUserActionLog.log(e.id,u.WebUserActionLogEvent.CLICK_DOCSEND_SNACKBAR_NOT_NOW,{})}}))},0)},t.getOpenInAppUrls=function(e,t,i,r){if(e&&t&&i)return e.open_in_app_data;if(l.iOS&&r){const t=encodeURIComponent(e.fq_path),i=encodeURIComponent(r.id);return{platform:o.OpenInMobileAppPlatform.IPHONE,iOSAppUrl:`dbapi-5://1/viewPath?path=${t}&userId=${i}`,iOSAppStoreUrl:"https://itunes.apple.com/us/app/dropbox/id327630330?mt=8e"}}if(l.is_android()){const e="/dl/home/mobile?mobile_app_fallback";return{platform:o.OpenInMobileAppPlatform.ANDROID_MARKET,androidAppUrl:e}}}})),define("metaserver/static/js/flows/conversions/async_conversion_plugin",["require","exports","tslib"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileConversionsLoader=t.CONVERSION_ACTION_PLUGIN_ID=void 0,t.CONVERSION_ACTION_PLUGIN_ID="CONVERSION_ACTION";t.makeFileConversionsLoader=(r,s,a,n,o)=>({pluginId:t.CONVERSION_ACTION_PLUGIN_ID,load:(t,l)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeFileConversionsLoader:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/conversions/conversion_plugin"],t,i)}).then(i.__importStar);return new(t(r,s,l,a,n,o))}))})})),define("metaserver/static/js/flows/version/async_components",["require","exports","tslib","react","js/common/rendering"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncChangeLogSection=void 0;const a=(r=i.__importStar(r)).lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{ChangeLogSection:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/version/change_log_section"],t,i)}).then(i.__importStar);return{default:t}})));t.AsyncChangeLogSection=e=>r.createElement(s.LazySuspense,{fallback:r.createElement("div",null)},r.createElement(a,Object.assign({},e)))})),define("metaserver/static/js/flows/version/experiments",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVersioningMVPEnabled=void 0;t.isVersioningMVPEnabled=e=>"MVP"===e})),define("metaserver/static/js/integrations/hellosign_deep_integration/add_signatures_util",["require","exports","metaserver/static/js/cloud_docs/constants"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAddSignatureDropdownEnabled=t.isImageFile=void 0;const r=["jpg","jpeg","png","gif"];function s(e){return!!e&&r.includes(e)}t.isImageFile=s,t.isAddSignatureDropdownEnabled=function(e,t,r){return!(!t||!1===r)&&(t.length>0&&"."===t[0]&&(t=t.substr(1)),!(!(0,i.isHellosignFileByExtension)(t)||s(t))&&!!("pdf"!==t.toLowerCase()||(e=null==e?void 0:e.toLowerCase())&&"off"!==e&&"control"!==e))}})),define("metaserver/static/js/integrations/hellosign_deep_integration/async_self_sign_plugin",["require","exports","tslib","metaserver/static/js/integrations/hellosign_deep_integration/send_file_viewer_plugin_types","metaserver/static/js/integrations/hellosign_deep_integration/add_signatures_util","metaserver/static/js/file_store/utils"],(function(e,t,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSelfSignLoader=void 0;t.makeSelfSignLoader=(t,n,o)=>({pluginId:r.SELF_SIGN_ACTION_PLUGIN_ID,load:(r,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeSelfSignPlugin:r}=yield new Promise((t,i)=>{e(["metaserver/static/js/integrations/hellosign_deep_integration/self_sign_plugin"],t,i)}).then(i.__importStar);return r(t,n,s)})),isEnabled:e=>{const i=(0,a.getExtension)(t().file);return!(0,s.isAddSignatureDropdownEnabled)(o,i)&&!("pdf"===i)}})})),define("metaserver/static/js/integrations/hellosign_deep_integration/async_send_file_viewer_plugin",["require","exports","tslib","metaserver/static/js/integrations/hellosign_deep_integration/send_file_viewer_plugin_types","metaserver/static/js/file_store/utils","metaserver/static/js/integrations/hellosign_deep_integration/add_signatures_util"],(function(e,t,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSendForSignatureLoader=void 0;t.makeSendForSignatureLoader=(t,n,o)=>({pluginId:r.SEND_FOR_SIGNATURE_ACTION_PLUGIN_ID,load:(r,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeSendForSignatureLoader:r}=yield new Promise((t,i)=>{e(["metaserver/static/js/integrations/hellosign_deep_integration/send_file_viewer_plugin"],t,i)}).then(i.__importStar);return r(t,n,s)})),isEnabled:e=>!(0,a.isAddSignatureDropdownEnabled)(o,(0,s.getExtension)(t().file))})})),define("metaserver/static/js/integrations/hellosign_deep_integration/send_file_viewer_plugin_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SELF_SIGN_ACTION_PLUGIN_ID=t.SEND_FOR_SIGNATURE_ACTION_PLUGIN_ID=void 0,t.SEND_FOR_SIGNATURE_ACTION_PLUGIN_ID="SEND_FOR_SIGNATURE_ACTION",t.SELF_SIGN_ACTION_PLUGIN_ID="SELF_SIGN_ACTION"})),define("metaserver/static/js/integrations/integration_popover",["require","exports","tslib","react","lodash","ts-key-enum","spectrum/portal/index","metaserver/static/js/integrations/resize"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationPopoverGroup=t.IntegrationPopover=void 0,r=i.__importStar(r),s=i.__importStar(s);const l="above";class c extends r.Component{constructor(e){super(e),this.id=s.uniqueId("integration_popover_"),this.resolvePortalPosition=()=>{if(this.portalInstance&&this.wrapperElementRef){const e=this.wrapperElementRef.childElementCount<2&&this.wrapperElementRef.firstElementChild||this.wrapperElementRef,{positioning:t=(()=>l),positionOffset:i=0}=this.props,r=this.portalInstance.portalContentElementRef;let s={top:0,left:0};const a=e.getBoundingClientRect(),n=r.getBoundingClientRect();switch(t(this)){case"below":s={top:a.top+a.height+i,left:a.left+a.width/2-n.width/2};break;case"below_left":s={top:a.top+a.height+i,left:a.left+a.width-n.width};break;case"below_right":s={top:a.top+a.height+i,left:a.left};break;case"left":s={top:Math.min(a.top+a.height/2-n.height/2,document.documentElement.clientHeight-n.height-160),left:a.left-n.width-i};break;case"right":s={top:Math.min(a.top+a.height/2-n.height/2,document.documentElement.clientHeight-n.height-160),left:a.left+a.width+i};break;case"above":s={top:a.top-n.height-i,left:a.left+a.width/2-n.width/2}}this.portalInstance.portalContentElementRef.style.top=s.top+"px",this.portalInstance.portalContentElementRef.style.left=s.left+"px"}},this.handleMouseOverTrigger=this.handleMouseOverTrigger.bind(this),this.handleMouseOut=this.handleMouseOut.bind(this),this.handleOnFocus=this.handleOnFocus.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this),this.handleClick=this.handleClick.bind(this),this.handleClickTrigger=this.handleClickTrigger.bind(this),this.closePortal=this.closePortal.bind(this),this.handleKeyEvent=this.handleKeyEvent.bind(this),this.handleScrollEvent=this.handleScrollEvent.bind(this),this.handleOnClickContent=this.handleOnClickContent.bind(this),this.hasInitiallyShown=!1,this.state={isShown:!!e.isShowInitially}}componentDidMount(){this.props.isShowInitially&&this.showPortal()}componentDidUpdate(){!this.hasInitiallyShown&&this.props.isShowInitially||this.state.isShown&&this.portalInstance?(this.mountListeners(),this.props.onWillShow&&this.props.onWillShow(this),this.portalInstance.mountPortal(()=>{this.props.onDidShow&&this.props.onDidShow(this),this.resolvePortalPosition()})):this.portalInstance&&(this.unMountListeners(),this.props.onWillClose&&this.props.onWillClose(this),this.portalInstance.unMountPortal(),this.wrapperElementRef=null)}componentWillUnmount(){this.portalInstance&&this.portalInstance.unMountPortal(),this.unMountListeners()}mountListeners(){document.addEventListener("keydown",this.handleKeyEvent,!0),document.addEventListener("scroll",this.handleScrollEvent,!1),document.addEventListener("click",this.handleOnClickContent,!0)}unMountListeners(){document.removeEventListener("keydown",this.handleKeyEvent,!0),document.removeEventListener("scroll",this.handleScrollEvent,!1),document.removeEventListener("click",this.handleOnClickContent,!0)}handleOnFocus(e){this.showPortal()}handleOnBlur(e){}handleMouseOverTrigger(e){this.props.onMouseOverTrigger&&this.props.onMouseOverTrigger(e,this),this.showPortal()}handleMouseOut(e){this.props.shouldCloseOnMouseMoveOutTrigger&&this.props.shouldCloseOnMouseMoveOutTrigger(this)&&this.hidePortal()}handleClick(e){e.stopPropagation()}handleClickTrigger(e){this.props.onClickTrigger&&this.props.onClickTrigger(e,this),this.showPortal()}handleKeyEvent(e){if(this.state.isShown){const t=e.key;t===a.Key.Escape&&(this.closePortal(),this.props.onClickOutsideContent&&this.props.onClickOutsideContent(this),e.stopPropagation()),t!==a.Key.ArrowUp&&t!==a.Key.ArrowDown&&t!==a.Key.ArrowLeft&&t!==a.Key.ArrowRight||e.stopPropagation(),t===a.Key.Tab&&this.handleMouseOut()}}handleScrollEvent(){this.state.isShown&&this.resolvePortalPosition()}handleOnClickContent(e){this.contentElementRef&&this.contentElementRef.contains(e.target)||(this.props.onClickOutsideContent&&this.props.onClickOutsideContent(this),this.closePortal())}closePortal(){this.hidePortal(),this.props.onDidClose&&this.props.onDidClose(this)}showPortal(){this.setState({isShown:!0})}hidePortal(){this.props.isShowInitially&&!this.hasInitiallyShown&&(this.hasInitiallyShown=!0),this.setState({isShown:!1})}render(){const e=this.props.renderContent&&this.props.renderContent()||null;return r.createElement("div",{"aria-describedby":this.props.id,onMouseLeave:this.handleMouseOut,onFocusCapture:this.handleOnFocus,onBlur:this.handleOnBlur,onClick:this.handleClick,className:this.props.wrapperClassName?this.props.wrapperClassName:"mc-positioned-portal-wrapper",ref:e=>this.wrapperElementRef=e,id:this.id},r.createElement(n.Portal,{ref:e=>this.portalInstance=e,className:"mc-positioned-portal-content",parentElement:this.props.portalParentElement||document.querySelector(`div#${this.id}`)},r.createElement("div",{ref:e=>this.contentElementRef=e},this.props.autoRePosition?r.createElement(o.Resize,{onResize:this.resolvePortalPosition},e):e)),r.createElement("div",{onMouseOver:this.handleMouseOverTrigger,onClick:this.handleClickTrigger},this.props.children))}}t.IntegrationPopover=c,c.displayName="IntegrationPopover";t.IntegrationPopoverGroup=class{constructor(){var e;this.onClickTrigger=()=>{this.clicked=!0},this.onClickOutsideContent=()=>{this.clicked=!1},this.shouldCloseOnMouseMoveOutTrigger=()=>!this.clicked,this.onDidShow=e=>{this.showingPortal&&this.showingPortal!==e&&this.showingPortal.closePortal(),this.showingPortal=e},this.onWillClose=e=>{this.showingPortal===e&&(this.showingPortal=null)},this.popover=(e=this,class extends r.Component{constructor(){super(...arguments),this.openProfileCard=()=>{this.popoverRef&&(e.clicked=!0,this.popoverRef.showPortal())}}render(){const{upsellContent:t,profileCard:i,positioning:s,upsellPositioning:a,wrapperClassName:n,isShowInitially:o,children:d,positionOffset:p,portalParentElement:u,onClickTrigger:_,onMouseOverTrigger:v,autoRePosition:m}=this.props;return r.createElement(c,{ref:e=>this.popoverRef=e,renderContent:()=>e.clicked?i:t,onClickTrigger:(t,i)=>{e.onClickTrigger(i),_&&_(t)},onClickOutsideContent:e.onClickOutsideContent,onMouseOverTrigger:e=>{v&&v(e)},shouldCloseOnMouseMoveOutTrigger:e.shouldCloseOnMouseMoveOutTrigger,onDidShow:e.onDidShow,onWillClose:e.onWillClose,positioning:()=>!e.clicked&&a?a:s||l,wrapperClassName:n,isShowInitially:o,positionOffset:p,portalParentElement:u,autoRePosition:m},d)}})}closePortal(){this.showingPortal&&(this.showingPortal.closePortal(),this.clicked=!1)}}})),define("metaserver/static/js/integrations/resize",["require","exports","tslib","react","resize-observer-polyfill"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resize=void 0,r=i.__importStar(r),s=i.__importDefault(s);class a extends r.Component{constructor(e){super(e),this.ref=null,this.setRef=e=>{this.ref&&this.ro.unobserve(this.ref),this.ref=e,this.ref&&this.ro.observe(this.ref)},this.onResize=e=>{e.length>0&&this.props.onResize(e[0].contentRect)},this.ro=new s.default(this.onResize)}componentWillUnmount(){this.ref&&this.ro.unobserve(this.ref)}render(){return r.createElement("div",{ref:this.setRef},this.props.children)}}t.Resize=a,a.displayName="Resize"})),define("metaserver/static/js/integrations/ui/pdf_editor/plugin/loader",["require","exports","tslib","metaserver/static/js/integrations/ui/pdf_editor/plugin/show_plugin_util","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePdfEditorPluginLoader=t.PDF_EDITOR_PLUGIN_ID=void 0,t.PDF_EDITOR_PLUGIN_ID="pdf_edit_plugin",t.makePdfEditorPluginLoader=function(n,o,l,c){return{pluginId:t.PDF_EDITOR_PLUGIN_ID,isEnabled:()=>{const{file:e,sharePermission:t}=n();return(0,r.showEditPlugin)(e,t)},load:(t,r)=>i.__awaiter(this,void 0,void 0,(function*(){const{PdfEditorPluginBase:d,generateNonceSubdomain:p}=yield new Promise((t,i)=>{e(["metaserver/static/js/integrations/ui/pdf_editor/plugin/plugin_entry"],t,i)}).then(i.__importStar),u=yield p();if(s.fileViewerFlowExperiments.approvalPdfEditingToastByUserId[o.id]){const{showPdfEditingToast:t}=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/approval/pdf_editing_toast"],t,i)}).then(i.__importStar);t(o,n().file,c,r)}return new d(t,r,u,n,o,l,a)}))}};const a=e=>{e.logUserAction("open_with_pdf_editor","title_bar_main")}})),define("metaserver/static/js/integrations/ui/pdf_editor/plugin/show_plugin_util",["require","exports","metaserver/static/js/core/browser_detection","metaserver/static/js/file_store/utils"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showEditPlugin=void 0;t.showEditPlugin=(e,t)=>!!e&&((!t||0!==t.canDownloadRoles.length)&&((!e||"pdf"===(0,r.getExtension)(e))&&!(0,i.is_mobile_or_tablet)(navigator.userAgent)))})),define("metaserver/static/js/integrations/zoom_share_dialog/async_modal",["require","exports","tslib"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowModal=void 0,t.asyncShowModal=function(t,r,s,a){return i.__awaiter(this,void 0,void 0,(function*(){const{showModal:n}=yield new Promise((t,i)=>{e(["metaserver/static/js/integrations/zoom_share_dialog/modal"],t,i)}).then(i.__importStar);n(t,r,s,a||"web")}))}})),define("metaserver/static/js/pass/actions",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/pass/constants"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassActions=void 0;t.PassActions=class{static passPermissionRequest(e){i.Dispatcher.dispatch({type:r.ActionTypes.PASS_PERMISSION_REQUEST,data:{fileId:e}})}static updatePermissions(e,t){i.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_PERMISSIONS,data:{fileId:e,partialPermission:t}})}static fetchPassError(e){i.Dispatcher.dispatch({type:r.ActionTypes.FETCH_PASS_ERROR,data:{fileId:e}})}static fetchPassConcluded(e){i.Dispatcher.dispatch({type:r.ActionTypes.FETCH_PASS_CONCLUDED,data:{fileId:e}})}static receivePresenceDelta(e,t,s,a){i.Dispatcher.dispatch({type:r.ActionTypes.RECEIVE_PRESENCE_DELTA,data:{userId:e,fileId:t,onlineUniqueUsers:s,offlineUniqueUsers:a}})}static receivePresenceSnapshot(e,t,s){i.Dispatcher.dispatch({type:r.ActionTypes.RECEIVE_PRESENCE_SNAPSHOT,data:{userId:e,fileId:t,onlineUniqueUsers:s}})}static resetPassInfo(e){i.Dispatcher.dispatch({type:r.ActionTypes.RESET_PASS_INFO,data:{fileId:e}})}static updateSeenStateInfo(e,t,s){i.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_INFO,data:{fileId:e,seenStateInfo:t,seenStateCursor:s}})}static updateUserTeamInteractionInfo(e,t){i.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_USER_TEAM_INTERACTION_INFO,data:{fileId:e,userTeamInteractionInfo:t}})}static updateSeenStateInfoContinue(e,t,s){i.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_INFO_CONTINUE,data:{fileId:e,seenStateInfo:t,seenStateCursor:s}})}static discontinueSeenStateInfo(e){i.Dispatcher.dispatch({type:r.ActionTypes.DISCONTINUE_SEEN_STATE_INFO,data:{fileId:e}})}static updateSeenStateUnavailable(e,t){i.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_UNAVAILABLE,data:{userId:e,fileId:t}})}}})),define("metaserver/static/js/pass/beacon_presence_helpers",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/clean/beacon_nodeps","metaserver/static/js/pass/seen_state_helpers","metaserver/static/js/pass/actions","metaserver/static/js/uuid/uuid","metaserver/static/js/clean/viewer","metaserver/static/js/core/exception","metaserver/static/js/pass/action_timestamps","metaserver/static/js/pass/constants"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u){"use strict";function _(e){o.PassActions.resetPassInfo(e),o.PassActions.fetchPassError(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconPresenceHelpers=t.BEACON_ONLINE_STATUS=t.BEACON_OFFLINE_STATUS=void 0,a=i.__importStar(a),t.BEACON_OFFLINE_STATUS="",t.BEACON_ONLINE_STATUS="online";class v{static resetClassState(){delete this.receiverData,delete this.transmitterData,delete this.lastFileIdForReceiverTokenRequest,delete this.lastFileIdForTransmitterTokenRequest}static shutdown({beaconFileData:e,user:t,async:i,shouldWritePresence:r=!0}){if(delete this.lastFileIdForReceiverTokenRequest,delete this.lastFileIdForTransmitterTokenRequest,this.transmitterData){const{beaconUserId:s,context:a,identifier:o}=this.transmitterData;this.transmitterData.transmitter.stop(),delete this.transmitterData,!c.Viewer.get_viewer().is_assume_user_session&&r&&n.SeenStateHelpers.updateSeenStateOnResign(t,e,i,s,o,a)}this.receiverData&&this.receiverData.receiver&&(this.receiverData.receiver.stop(),delete this.receiverData)}static receiveBeaconData({beaconFileData:e,user:t,passSessionId:r,onUpdate:s}){return i.__awaiter(this,void 0,void 0,(function*(){const{fileId:i}=e;r&&p.ActionTimestampsTracker.record(u.LoggingActions.RECEIVER_TOKEN_BEGIN,r),this.lastFileIdForReceiverTokenRequest=i;const n=yield this.fetchReceiverToken(t,e);if(this.lastFileIdForReceiverTokenRequest!==i)return;if(n.beacon_presence_error)return o.PassActions.updatePermissions(i,{canReadPresence:!1}),void("no_permission"===n.beacon_presence_error[".tag"]||_(i));o.PassActions.updatePermissions(i,{canReadPresence:!0}),r&&p.ActionTimestampsTracker.record(u.LoggingActions.RECEIVER_TOKEN_RECEIVE,r);const l=[new a.PresenceParams(a.PresenceType.Context,t.account_id,this.APP,n.beacon_presence_info.context,n.beacon_presence_info.token)];this.receiverData&&this.receiverData.receiver&&this.receiverData.receiver.stop(),this.receiverData={authKey:n.beacon_presence_info.auth_key,receiver:new a.Receiver(l,i=>{r&&p.ActionTimestampsTracker.record(u.LoggingActions.PRESENCE_RECEIVE,r);const a=this.parseBeaconUpdates(i[0]);s(a,t.id,e)},()=>this.receiveBeaconData({user:t,beaconFileData:e,passSessionId:r,onUpdate:s})),context:n.beacon_presence_info.context},this.receiverData.receiver.start()}))}static fetchReceiverToken(e,t){const{fileId:i,url:s}=t,a={file_info:m(i,s)};return(new r.UserApiV2Client).ns("file_presence").rpc("get_pass_receiver_token",a,{subjectUserId:e.id})}static isOnline(e){return e&&this.HARMONY_ONLINE_STATUSES.includes(e)||e===t.BEACON_ONLINE_STATUS}static parseBeaconUpdates(e){const t={},i={},r="delta"in e?"delta":"snapshot",s="delta"in e&&e.delta?e.delta:"snapshot"in e&&e.snapshot?e.snapshot:[];for(const e of s){const r=e.agent,s=r.user_id,a=r.source.identifier;this.isOnline(e.status)?(s in t||(t[s]={}),t[s][a]=!0):(s in i||(i[s]={}),i[s][a]=!0)}return{onlineUniqueUsers:t,offlineUniqueUsers:i,type:r}}static transmitBeaconData({user:e,passSessionId:r,beaconFileData:s,prevBeaconFileData:n}){return i.__awaiter(this,void 0,void 0,(function*(){const{fileId:i}=s;this.transmitterData&&n&&(this.transmitterData.transmitter.add_or_update_agents([this.getAgentStatusForFile(this.transmitterData.beaconUserId,this.transmitterData.identifier,this.transmitterData.authKey,this.transmitterData.context,t.BEACON_OFFLINE_STATUS)]),setTimeout(()=>{this.transmitterData.transmitter.stop()},1)),r&&p.ActionTimestampsTracker.record(u.LoggingActions.TRANSMITTER_TOKEN_BEGIN,r),this.lastFileIdForTransmitterTokenRequest=i;const c=yield this.fetchTransmitterToken(e,s);if(this.lastFileIdForTransmitterTokenRequest===i){if(c.beacon_presence_error)return o.PassActions.updatePermissions(i,{canWritePresence:!1}),void("no_permission"===c.beacon_presence_error[".tag"]||_(i));o.PassActions.updatePermissions(i,{canWritePresence:!0}),r&&p.ActionTimestampsTracker.record(u.LoggingActions.TRANSMITTER_TOKEN_RECEIVE,r),this.transmitterData={identifier:l.UUID.v4({allowInsecure:!0}),beaconUserId:c.beacon_presence_info.beacon_user_id,authKey:c.beacon_presence_info.auth_key,transmitter:new a.Transmitter(c.beacon_presence_info.token,()=>this.transmitBeaconData({user:e,passSessionId:r,beaconFileData:s,prevBeaconFileData:null})),context:c.beacon_presence_info.context},this.transmitterData.transmitter.add_or_update_agents([this.getAgentStatusForFile(this.transmitterData.beaconUserId,this.transmitterData.identifier,this.transmitterData.authKey,this.transmitterData.context,t.BEACON_ONLINE_STATUS)]),this.transmitterData.transmitter.start()}}))}static getAgentStatusForFile(e,t,i,r,s){const n=new a.Source(this.PLATFORM,this.SURFACE,t),o=new a.Agent(e,this.APP,r,n);return new a.AgentStatus(o,s,i)}static fetchTransmitterToken(e,t){const{fileId:i,url:a}=t,n={file_info:m(i,a)};return e||a||(0,d.reportStack)("For logged out user URL is needed for get_pass_transmitter_token",{tags:["file_presence","file_presence_js"],severity:"non-critical"}),e?(new r.UserApiV2Client).ns("file_presence").rpc("get_pass_transmitter_token",n,{subjectUserId:e.id}):(new s.NoAuthApiV2Client).ns("file_presence").rpc("logged_out/get_pass_transmitter_token",n,{})}}function m(e,t){return t?{".tag":"shared_link_details",url:t}:{".tag":"file_identifier",file_identifier:e}}t.BeaconPresenceHelpers=v,v.APP="harmony",v.PLATFORM=a.Platforms.WEB,v.SURFACE="file_viewer",v.HARMONY_ONLINE_STATUSES=["modifier","viewer"]})),define("metaserver/static/js/pass/pass_helpers",["require","exports","metaserver/static/js/file_viewer/utils","metaserver/static/js/previews/ui/constants","metaserver/static/js/pass/actions","metaserver/static/js/pass/beacon_presence_helpers","metaserver/static/js/pass/seen_state_helpers","metaserver/static/js/pass/types","metaserver/static/js/pass/constants","metaserver/static/js/sharing/actions/sharing_actions","metaserver/static/js/clean/viewer"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassHelpers=void 0;const p=l.MAX_FACES_NORMAL+l.MAX_OVERFLOW_BUTTON_INDICATOR+1;class u{static setup({user:e,fileData:t,prevFileData:i,passSessionId:r,shouldWritePresence:a=!0,skipSharingEndpoints:n=!1,limit:o=150}){const l=t.file.file_id;this.shouldInitializePass(e,l,a)&&setTimeout(()=>{s.PassActions.passPermissionRequest(l),u.makeAllRequests({user:e,fileData:t,prevFileData:i,passSessionId:r,shouldWritePresence:a,skipSharingEndpoints:n,limit:o})},0)}static teardown({user:e,fileData:t,async:i,shouldWritePresence:r=!0}){const{file:s,url:n}=t,l=s.file_id;if(this.shouldInitializePass(e,l,r)){u.removeUnloadHandler();const t=new o.BeaconFileData(l,n);a.BeaconPresenceHelpers.shutdown({beaconFileData:t,user:e,async:i,shouldWritePresence:r})}}static shouldInitializePass(e,t,s){return(0,i.getSourceContext)()!==r.PreviewSourceContext.SharedLinkCollection&&(null!==e||s)&&t}static onBeaconUpdate(e,t,i){const r=i.fileId;"delta"===e.type?s.PassActions.receivePresenceDelta(t,r,e.onlineUniqueUsers,e.offlineUniqueUsers):"snapshot"===e.type&&s.PassActions.receivePresenceSnapshot(t,r,e.onlineUniqueUsers)}static makeAllRequests({user:e,fileData:t,prevFileData:i,passSessionId:r,limit:l=150,shouldWritePresence:_=!0,skipSharingEndpoints:v=!1}){const{file:m,url:f}=t,{file_id:g,fq_path:h}=m,S=g||h,w=new o.BeaconFileData(m.file_id,f);e?(S&&!v&&(c.SharingActions.fetchFileMemberCount({user:e,contentId:S,limit:p,countGroupsAsMembers:!1,url:f,passSessionId:r,runViewerInfoChecks:!0}),c.SharingActions.listMembers({user:e,contentId:S,isFolder:!1,limit:6,url:f,passSessionId:r,includeSeenState:!1})),n.SeenStateHelpers.fetchSeenStateInfo(e,g,l,f,r),a.BeaconPresenceHelpers.receiveBeaconData({beaconFileData:w,user:e,passSessionId:r,onUpdate:this.onBeaconUpdate})):s.PassActions.updatePermissions(g,{canReadPresence:!1,canReadSeenState:!1});const E=d.Viewer.get_viewer().is_assume_user_session;if(!_||E)s.PassActions.updatePermissions(g,{canWritePresence:!1});else{const s=i&&new o.BeaconFileData(i.file,i.url);a.BeaconPresenceHelpers.transmitBeaconData({user:e,passSessionId:r,beaconFileData:w,prevBeaconFileData:s}),u.removeUnloadHandler(),u.onUnload=i=>(this.teardown({user:e,fileData:t,async:!1,shouldWritePresence:!0}),i.returnValue=void 0,null),document.addEventListener("beforeunload",u.onUnload)}}}t.PassHelpers=u,u.removeUnloadHandler=()=>{u.onUnload&&document.removeEventListener("beforeunload",u.onUnload),u.onUnload=void 0}})),define("metaserver/static/js/pass/seen_state_helpers",["require","exports","tslib","metaserver/static/js/api_v2/transport/fetch","metaserver/static/js/api_v2/user_client","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/api_v2/error","metaserver/static/js/api_v2/types","metaserver/static/js/pass/actions","metaserver/static/js/pass/constants","metaserver/static/js/pass/action_timestamps"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";function p(e){l.PassActions.resetPassInfo(e),l.PassActions.fetchPassError(e)}function u(e,t){return{file_identifier:e,shared_link_details:t?{url:t}:void 0}}var _;Object.defineProperty(t,"__esModule",{value:!0}),t.SeenStateHelpers=t.APITransport=void 0,(function(e){e.create=function(e){return e?new r.FetchAsyncTransport:new r.FetchSyncTransport}})(_=t.APITransport||(t.APITransport={}));t.SeenStateHelpers=class{static constructFakeSeenStateInfo(e,t,i){const r=i.seen_states,s=[];for(const e of r)s.push(e.seen_state_user.user_id);for(const i of e)if(!s.includes(i.user_id)){i.sharing_access_type&&(i.sharing_access_type=this.convertToUnion(i.sharing_access_type));const e={seen_state_user:i,when_last_seen:t,seen_events:[]};r.unshift(e)}return i.seen_states=r,i}static convertToUnion(e){return e?o.Union.parse(e):null}static parseSeenStatePassPlatform(e){if(e){switch(o.Union.parse(e).type){case"web":return c.PassPlatform.WEB;case"mobile":return c.PassPlatform.MOBILE;case"desktop":return c.PassPlatform.DESKTOP}}return c.PassPlatform.UNKNOWN}static fetchSeenStateUsers(e,t,r,a,o,_){return i.__awaiter(this,void 0,void 0,(function*(){const i=Date.now()/1e3;_&&d.ActionTimestampsTracker.record(c.LoggingActions.SEEN_STATE_USERS_BEGIN,_);const v=yield(new s.UserApiV2Client).ns("seen_state").rpc("get_seen_state_users",{user_ids:r,file_info:u(a,o)},{subjectUserId:e}).catch((0,n.catchApiError)(()=>(p(a),Promise.reject(void 0))));_&&d.ActionTimestampsTracker.record(c.LoggingActions.SEEN_STATE_USERS_RECEIVE,_);const m=this.constructFakeSeenStateInfo(v,i,t);l.PassActions.updateSeenStateInfo(a,m)}))}static processAndUpdateSeenStateInfo(e,t,i,r){const{seen_state_info:s,seen_state_error:a,seen_state_cursor:n}=i[0];if(a)if(r)l.PassActions.discontinueSeenStateInfo(t);else{if("no_permission"===o.Union.parse(a).type)return;p(t)}else{for(const e of s.seen_states)e.seen_state_user.sharing_access_type=this.convertToUnion(e.seen_state_user.sharing_access_type),e.platform_type=this.parseSeenStatePassPlatform(e.platform_type);r?l.PassActions.updateSeenStateInfoContinue(t,s,n):l.PassActions.updateSeenStateInfo(t,s,n)}}static fetchSeenStateInfo(e,t,r,a,o){return i.__awaiter(this,void 0,void 0,(function*(){o&&d.ActionTimestampsTracker.record(c.LoggingActions.SEEN_STATE_BEGIN,o);const i=yield(new s.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info",{file_infos:[u(t,a)],limit:r},{subjectUserId:e.id}).catch((0,n.catchApiError)(()=>(p(t),Promise.reject(void 0))));let _=!0;const{seen_state_info:v,seen_state_error:m}=i[0];_=!(!v||m),l.PassActions.updatePermissions(t,{canReadSeenState:_}),_||l.PassActions.updateSeenStateUnavailable(e.id,t),_&&o&&d.ActionTimestampsTracker.record(c.LoggingActions.SEEN_STATE_RECEIVE,o),this.processAndUpdateSeenStateInfo(e,t,i,!1),_&&this.fetchRemainingSeenStateInfo(e,t,i,a)}))}static fetchRemainingSeenStateInfo(e,t,i,r){const s=i[0].seen_state_cursor;if(s&&s.has_next){const i=s.cursor_state;i&&this.fetchSeenStateInfoContinue(e,t,i,1e5,r)}}static fetchSeenStateInfoContinue(e,t,r,a,o){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield(new s.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info/continue",{file_infos:[u(t,o)],cursor:r,limit:a},{subjectUserId:e.id}).catch((0,n.catchApiError)(()=>(l.PassActions.discontinueSeenStateInfo(t),Promise.reject(void 0))));this.processAndUpdateSeenStateInfo(e,t,i,!0)}))}static updateSeenStateOnResign(e,t,i,r,n,o){const l=_.create(i);return(function(e,t,i,r,n){return e?t(new s.UserApiV2Client(n).ns("seen_state"),r,{subjectUserId:e.id}):i(new a.NoAuthApiV2Client(n).ns("seen_state"),r,{})})(e,(e,t,i)=>e.rpc("update_timestamps_and_mark_offline",t,i),(e,t,i)=>e.rpc("logged_out/mark_offline",t,i),{beacon_infos:[{beacon_user_id:r,context:o,shared_link_url:t.url,identifier:n}]},l)}}})),define("metaserver/static/js/pass/store",["require","exports","tslib","lodash","metaserver/static/js/flux/base_store","metaserver/static/js/pass/constants","metaserver/static/js/pass/utils","metaserver/static/js/core/assert","metaserver/static/js/core/exception"],(function(e,t,i,r,s,a,n,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.passStore=t.PassStore=void 0,r=i.__importStar(r),l=i.__importStar(l);class c{constructor(){this.userIdToUniqueIds={}}addUniqueUser(e,t){e in this.userIdToUniqueIds||(this.userIdToUniqueIds[e]={}),this.userIdToUniqueIds[e][t]=!0}removeUniqueUser(e,t){e in this.userIdToUniqueIds&&t in this.userIdToUniqueIds[e]&&(delete this.userIdToUniqueIds[e][t],Object.keys(this.userIdToUniqueIds[e]).length||delete this.userIdToUniqueIds[e])}getOnlineUserIds(){return Object.keys(this.userIdToUniqueIds)}}class d extends s.Store{constructor(e){super(e),this.seenStateInfos={},this.seenStateCursors={},this.presenceInfos={},this.passFetchingStatusMap={},this.userIdsWithoutSeenStateInfoMap={},this.userIdsWithoutTeamInteractionInfoMap={},this.userTeamInteractionInfoMap={},this.passPermissions={}}presence(e){return e in this.presenceInfos?this.presenceInfos[e].getOnlineUserIds():null}seenStateInfo(e){return this.seenStateInfos[e]||null}identifiedSeenStateInfo(e){if(e in this.seenStateInfos){return{seen_states:r.reject(this.seenStateInfos[e].seen_states,n.AnonymousViewerUtils.isAnonymousSeenState)}}return null}seenStateCursorHasNext(e){return e in this.seenStateCursors?this.seenStateCursors[e].has_next:null}seenStateCursorState(e){return e in this.seenStateCursors?this.seenStateCursors[e].cursor_state:null}passFetchingStatus(e){return this.passFetchingStatusMap[e]||a.PassFetchingStatus.NOT_YET_KNOWN}getLinkAndGroupSeenStateInfo(e){let t=null,i=null;if(!this.seenStateInfos[e])return{linkSeenStateInfo:t,groupSeenStateInfo:i};t=[],i={};for(const r of this.seenStateInfos[e].seen_states)if(!n.AnonymousViewerUtils.isAnonymousSeenState(r)){const{seen_state_user:{sharing_access_type:e}}=r;if(e)switch(e.type){case"link_only":case"view_link_access":case"edit_link_access":t.push(r);break;case"view_member_access":case"edit_member_access":const s=e.value.group_ids;for(const e of s)e in i||(i[e]=[]),i[e].push(r)}}return{linkSeenStateInfo:t,groupSeenStateInfo:i}}anonymousPresence(e){return e in this.presenceInfos?n.AnonymousViewerUtils.getAnonymousUserIds(this.presenceInfos[e].getOnlineUserIds()):null}userIdsWithoutSeenStateInfo(e){return this.userIdsWithoutSeenStateInfoMap[e]||[]}userIdsWithoutTeamInteractionInfo(e){return this.userIdsWithoutTeamInteractionInfoMap[e]||[]}userTeamInteractionInfo(e){return this.userTeamInteractionInfoMap[e]||{}}isPassPermissionsPending(e){const t=this.passPermissions[e];return null!=t&&!(t.hasOwnProperty("canReadPresence")&&t.hasOwnProperty("canReadSeenState")&&t.hasOwnProperty("canWritePresence"))}getPassPermissions(e){if(!e)return null;const t=this.passPermissions[e];return null==t||this.isPassPermissionsPending(e)?null:t}resetPassInfo(e){delete this.seenStateInfos[e],delete this.seenStateCursors[e],delete this.presenceInfos[e],delete this.passFetchingStatusMap[e],delete this.passPermissions[e],delete this.userIdsWithoutSeenStateInfoMap[e],this.emit_change()}setPassPermissionRequest(e){this.passPermissions[e]||(this.passPermissions[e]={}),this.setPassFetchingStatus(e,a.PassFetchingStatus.FETCHING)}updatePermissions(e,t){this.passPermissions.hasOwnProperty(e)&&(this.passPermissions[e]=Object.assign(Object.assign({},this.passPermissions[e]),t),this.emit_change())}markPassConcludedIfNecessary(e){const t=this.passPermissions[e];!(t&&t.hasOwnProperty("canReadPresence")&&t.hasOwnProperty("canReadSeenState"))||t.canReadPresence||t.canReadSeenState||(this.resetPassInfo(e),this.setPassFetchingStatus(e,a.PassFetchingStatus.CONCLUDED),this.updateSeenStateInfoWithEmptyData(e))}receivePresenceDelta(e,t,i,r){(0,o.assert)(-1===[a.PassFetchingStatus.FETCHING,a.PassFetchingStatus.NOT_YET_KNOWN].indexOf(this.passFetchingStatus(t)),"Before handling a presence delta, you must call assurePresenceSuccessRegistered");const s=this.getOnlineUsersForFileId(t);this.updatePresenceInfos(t,i,r),this.updateUserIdsWithoutSeenStateInfo(e,t,s),this.emit_change()}receivePresenceSnapshot(e,t,i){(0,o.assert)(-1===[a.PassFetchingStatus.FETCHING,a.PassFetchingStatus.NOT_YET_KNOWN].indexOf(this.passFetchingStatus(t)),"Before handling a presence snapshot, you must call assurePresenceSuccessRegistered");const r=this.getOnlineUsersForFileId(t);this.presenceInfos[t]=new c,this.updatePresenceInfos(t,i,{}),this.updateUserIdsWithoutSeenStateInfo(e,t,r),this.emit_change()}getOnlineUsersForFileId(e){return e in this.presenceInfos||(this.presenceInfos[e]=new c),this.presenceInfos[e].getOnlineUserIds()}updatePresenceInfos(e,t,i){for(const t of Object.keys(i))for(const r of Object.keys(i[t]))this.presenceInfos[e].removeUniqueUser(t,r);for(const i of Object.keys(t))for(const r of Object.keys(t[i]))this.presenceInfos[e].addUniqueUser(i,r)}updateUserIdsWithoutSeenStateInfo(e,t,i){let s;const o=n.AnonymousViewerUtils.filterAnonymousUserIds(this.getOnlineUsersForFileId(t)),l=n.AnonymousViewerUtils.filterAnonymousUserIds(i),c=r.difference(l,o),d=r.difference(o,l);if(t in this.seenStateInfos){let e;const i=this.passFetchingStatus(t);if(-1!==[a.PassFetchingStatus.SEEN_STATE_DISALLOWED,a.PassFetchingStatus.PASS_MIXED_SUCCESS].indexOf(i))({userIdsWithoutSeenStateInfo:s,baseSeenStateInfo:e}=this.createMinimalBaseSeenStateInfo(t,o)),this.updateSeenStateInfo(t,e);else{const i=this.makeSeenStateAgreeWithUpdatedPresence(t,o,c,d);({userIdsWithoutSeenStateInfo:s,baseSeenStateInfo:e}=i)}}else s=[];this.userIdsWithoutSeenStateInfoMap[t]=s}makeSeenStateAgreeWithUpdatedPresence(e,t,i,r){const s=[],a=this.seenStateInfos[e],n=a.seen_states,o=[],l=[],c=[],d=Date.now()/1e3;for(const e of n){const t=e.seen_state_user.user_id;t&&(s.push(t),r.includes(t)?(e.when_last_seen=d,e.seen_events=e.seen_events||[],l.push(e)):i.includes(t)?(e.when_last_seen=d,e.seen_events=e.seen_events||[],e.seen_events.push({ts:d}),c.push(e)):o.push(e))}return a.seen_states=[...l,...c,...o],{userIdsWithoutSeenStateInfo:t.filter(e=>!s.includes(e)),baseSeenStateInfo:a}}createMinimalBaseSeenStateInfo(e,t){const i=[],s=[];for(const r of this.seenStateInfos[e].seen_states){const e=r.seen_state_user.user_id;e&&t.includes(e)&&(i.push(r),s.push(e))}return{userIdsWithoutSeenStateInfo:r.difference(t,s),baseSeenStateInfo:{seen_states:i}}}updateSeenStateInfo(e,t,i=!1){(0,o.assert)(-1===[null,a.PassFetchingStatus.FETCHING].indexOf(this.passFetchingStatus(e)),"Before updating seen state info, you must call assureSeenStateSuccessRegistered or onFetchSeenStateDisabled"),i&&e in this.seenStateInfos?this.seenStateInfos[e].seen_states=this.seenStateInfos[e].seen_states.concat(t.seen_states):this.seenStateInfos[e]=t,this.userIdsWithoutTeamInteractionInfoMap[e]=this.userIdsWithoutSeenStateInfoMap[e],this.userIdsWithoutSeenStateInfoMap[e]=[],this.emit_change()}updateSeenStateInfoWithEmptyData(e){this.updateSeenStateInfo(e,{seen_states:[]})}setPassFetchingStatus(e,t){this.passFetchingStatusMap[e]=t,this.emit_change()}updateSeenStateCursor(e,t){t&&(this.seenStateCursors[e]=t,this.emit_change())}assureSeenStateSuccessRegistered(e){switch(this.passFetchingStatus(e)){case a.PassFetchingStatus.FETCHING:this.setPassFetchingStatus(e,a.PassFetchingStatus.SEEN_STATE_SUCCESS);break;case a.PassFetchingStatus.PRESENCE_SUCCESS:this.setPassFetchingStatus(e,a.PassFetchingStatus.PASS_SUCCESS);break;case a.PassFetchingStatus.SEEN_STATE_DISALLOWED:l.reportStack("Debugging FETCHING_STATUS: pass fetching status is seen state disallowed",{severity:l.SEVERITY.NONCRITICAL,tags:["pass:fetch_seen_state_disallowed"],exc_extra:{storeHasPresence:e in this.presenceInfos,storeHasSeenState:e in this.seenStateInfos,passPermissions:JSON.stringify(this.passPermissions[e]),fetchingStatus:this.passFetchingStatusMap[e]}});break;case a.PassFetchingStatus.NOT_YET_KNOWN:l.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:l.SEVERITY.CRITICAL,tags:["pass:fetch_seen_state_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}}onFetchSeenStateDisabled(e){switch(this.passFetchingStatus(e)){case a.PassFetchingStatus.PRESENCE_SUCCESS:this.setPassFetchingStatus(e,a.PassFetchingStatus.PASS_MIXED_SUCCESS);break;case a.PassFetchingStatus.FETCHING:this.setPassFetchingStatus(e,a.PassFetchingStatus.SEEN_STATE_DISALLOWED);break;case a.PassFetchingStatus.NOT_YET_KNOWN:l.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:l.SEVERITY.CRITICAL,tags:["pass:fetch_seen_state_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}}assurePresenceSuccessRegistered(e){switch(this.passFetchingStatus(e)){case a.PassFetchingStatus.SEEN_STATE_SUCCESS:this.setPassFetchingStatus(e,a.PassFetchingStatus.PASS_SUCCESS);break;case a.PassFetchingStatus.SEEN_STATE_DISALLOWED:this.setPassFetchingStatus(e,a.PassFetchingStatus.PASS_MIXED_SUCCESS);break;case a.PassFetchingStatus.FETCHING:this.setPassFetchingStatus(e,a.PassFetchingStatus.PRESENCE_SUCCESS);break;case a.PassFetchingStatus.NOT_YET_KNOWN:l.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:l.SEVERITY.CRITICAL,tags:["pass:fetch_presence_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}}updateUserTeamInteractionInfo(e,t){if(e in t)for(const i of Object.keys(t))this.userTeamInteractionInfoMap[e][i]=t[i];else this.userTeamInteractionInfoMap[e]=t;this.userIdsWithoutTeamInteractionInfoMap[e]=[],this.emit_change()}_new_payload(e){const{type:t,data:i}=e.action;if(!i)return;let{userId:r,fileId:s,teamId:n,seenStateInfo:o,seenStateCursor:l,onlineUniqueUsers:c,offlineUniqueUsers:d,partialPermission:p,userTeamInteractionInfo:u,userTeamInteractionUserIds:_}=i;switch(r=r,s=s,n=n,o=o,l=l,c=c,d=d,p=p,u=u,_=_,t){case a.ActionTypes.FETCH_PASS_ERROR:this.setPassFetchingStatus(s,a.PassFetchingStatus.ERROR);break;case a.ActionTypes.FETCH_PASS_CONCLUDED:this.setPassFetchingStatus(s,a.PassFetchingStatus.CONCLUDED),this.updateSeenStateInfoWithEmptyData(s);break;case a.ActionTypes.PASS_PERMISSION_REQUEST:this.setPassPermissionRequest(s);break;case a.ActionTypes.RECEIVE_PRESENCE_DELTA:this.assurePresenceSuccessRegistered(s),this.receivePresenceDelta(r,s,c,d);break;case a.ActionTypes.RECEIVE_PRESENCE_SNAPSHOT:this.assurePresenceSuccessRegistered(s),this.receivePresenceSnapshot(r,s,c);break;case a.ActionTypes.RESET_PASS_INFO:this.resetPassInfo(s);break;case a.ActionTypes.UPDATE_PERMISSIONS:this.updatePermissions(s,p),this.markPassConcludedIfNecessary(s);break;case a.ActionTypes.DISCONTINUE_SEEN_STATE_INFO:l={cursor_state:"",has_next:!1},this.updateSeenStateCursor(s,l);break;case a.ActionTypes.UPDATE_SEEN_STATE_INFO:this.assureSeenStateSuccessRegistered(s),this.updateSeenStateInfo(s,o),this.updateSeenStateCursor(s,l);break;case a.ActionTypes.UPDATE_SEEN_STATE_INFO_CONTINUE:this.assureSeenStateSuccessRegistered(s),this.updateSeenStateInfo(s,o,!0),this.updateSeenStateCursor(s,l);break;case a.ActionTypes.UPDATE_SEEN_STATE_UNAVAILABLE:this.onFetchSeenStateDisabled(s),this.updateSeenStateInfoWithEmptyData(s),this.updateUserIdsWithoutSeenStateInfo(r,s,[]);break;case a.ActionTypes.UPDATE_USER_TEAM_INTERACTION_INFO:this.updateUserTeamInteractionInfo(s,u)}}}t.PassStore=d,t.passStore=new d})),define("metaserver/static/js/pass/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconFileData=t.FacepileInfo=t.UserInfo=void 0;t.UserInfo=class{constructor(e,t,i,r,s,a,n,o,l,c,d,p,u){this.key=e,this.displayName=t,this.isActive=i,this.isViewer=r,this.incrementOverflowBasis=s,this.email=a,this.accessLevel=n,this.whenLastSeen=o,this.photoUrl=l,this.userId=c,this.platformType=d,this.same_team=p,this.is_guest=u}};class i{constructor(e,t){this.isLoaded=e,this.data=t}static create(e){return new i(!0,e)}static createNotLoaded(){return new i(!1,null)}}t.FacepileInfo=i;t.BeaconFileData=class{constructor(e,t){this.fileId=e,this.url=t}}})),define("metaserver/static/js/photo-editor/plugin/loader",["require","exports","tslib","metaserver/static/js/photo-editor/plugin/show-edit-plugin"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePhotoEditorPluginLoader=t.PHOTO_EDITOR_PLUGIN_ID=void 0,t.PHOTO_EDITOR_PLUGIN_ID="photo_edit_plugin",t.makePhotoEditorPluginLoader=function(a,n,o){return{pluginId:t.PHOTO_EDITOR_PLUGIN_ID,isEnabled:()=>{const{file:e,sharePermission:t}=a();return(0,r.showEditPlugin)(e,t)},load:(t,r)=>i.__awaiter(this,void 0,void 0,(function*(){const{PhotoEditorPluginBase:l}=yield new Promise((t,i)=>{e(["metaserver/static/js/photo-editor/plugin/plugin"],t,i)}).then(i.__importStar);return new l(t,r,a,n,(...e)=>null==o?void 0:o(...e),s)}))}};const s=e=>{e.logUserAction("open_with_image_editor","title_bar_main")}})),define("metaserver/static/js/photo-editor/plugin/show-edit-plugin",["require","exports","metaserver/static/js/file_store/utils","metaserver/static/js/core/browser_detection"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showEditPlugin=t.VALID_PHOTO_FILE_EXTENSIONS=void 0,t.VALID_PHOTO_FILE_EXTENSIONS=new Set(["jpg","jpeg","png"]),t.showEditPlugin=function(e,s){return!!e&&((!s||0!==s.canDownloadRoles.length)&&(!!t.VALID_PHOTO_FILE_EXTENSIONS.has((0,i.getExtension)(e))&&!(0,r.is_mobile_or_tablet)(navigator.userAgent)))}})),define("metaserver/static/js/photos/ui/preview_crop_and_rotate/show-crop-rotate-plugin",["require","exports","metaserver/static/js/file_store/utils","metaserver/static/js/core/browser_detection","typescript/component_libraries/photos/src/preview-photo-editor/types"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showCropRotatePlugin=void 0;t.showCropRotatePlugin=(e,t,a)=>!(!t||!(0,i.isBrowseFile)(t))&&((!a||0!==a.canDownloadRoles.length)&&((!t||-1!==s.imageTypeAllowed.indexOf(e))&&(!t.read_only&&!(0,r.is_mobile_or_tablet)(navigator.userAgent))))})),define("metaserver/static/js/previews/ui/sharing_plugin/copy_file_link_button",["require","exports","tslib","react","metaserver/static/js/clean/analytics","metaserver/static/js/core/browser_detection","metaserver/static/js/sharing/views/share_modal_evolution/utils/logging","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","typescript/component_libraries/spectrum-sharing/src/utils/logging","metaserver/static/js/previews/ui/sharing_plugin/copy_link_button","metaserver/static/js/sharing/clean/util/link_util/parser"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyFileLinkButton=void 0,r=i.__importDefault(r);const p=(e,t,i,r,l)=>{const c=o.SHARE_ACTION_ORIGIN_TYPE.SHARING_PREVIEW_PAGE,p=(0,a.get_browser_info)(),u=Object.assign(Object.assign({},i&&(0,n.buildExtraFromLinkMetadata)(i)),{file_id:t}),_=l.doesContainShmodelLink?s.ShareTibEventLogger.get_shmodel_extra_for_logging(void 0,(0,d.getCleanedSharingUrl)(l)):s.ShareTibEventLogger.get_scl_extra_for_logging(void 0,(0,d.getCleanedSharingUrl)(l)),v=Object.assign(Object.assign(Object.assign({},u),{browser:p.browser,browser_version:p.version,created_new_link:!1}),_);r?s.ShareTibEventLogger.log(r,e,c,v):s.ShareTibEventLogger.log_unauth(e,c,v)};t.CopyFileLinkButton=e=>{var{file_id:t,link_metadata:s}=e,a=i.__rest(e,["file_id","link_metadata"]);return r.default.createElement(c.CopyLinkButton,Object.assign({},a,{logSuccess:()=>{var e;return p(l.TiburonEventName.CopySharedLink,t,s,null===(e=null==a?void 0:a.user)||void 0===e?void 0:e.id,a.parsedLink)},logFailure:()=>{var e;return p(l.TiburonEventName.CopySharedLinkFailure,t,s,null===(e=null==a?void 0:a.user)||void 0===e?void 0:e.id,a.parsedLink)}}))},t.CopyFileLinkButton.displayName="CopyFileLinkButton"})),define("metaserver/static/js/previews/ui/sharing_plugin/loader",["require","exports","tslib","react","react-intl","metaserver/static/js/action_bar/file_actions/portable/utils","metaserver/static/js/core/i18n","dig-components/icons/src","dig-components/icons","metaserver/static/js/core/browser_detection","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/file_viewer/share_helpers","typescript/libraries/file-viewer/src/core/logging/constants","metaserver/static/js/file_store/utils","metaserver/static/js/sharing/api/client","metaserver/static/js/sharing/access_level","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/action_bar/action_bar_strings"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeShareMetaserverLoader=t.SHARE_PLUGIN_ID=void 0,r=i.__importDefault(r),p=i.__importStar(p),t.SHARE_PLUGIN_ID="SHARE";const h=(0,s.defineMessage)({id:"VzQ1nj",defaultMessage:"Ask the owner of this file for permission to share it with others"});t.makeShareMetaserverLoader=(e,s,S)=>({pluginId:t.SHARE_PLUGIN_ID,load:(w,E)=>{const I=S&&new v.FileShareApiClient({userId:S.id});return Promise.resolve(new class{constructor(r){this.identifier=t.SHARE_PLUGIN_ID,this.lifecycle={previewDidInitialize:()=>i.__awaiter(this,void 0,void 0,(function*(){var t;const{file:i}=e(),r=(0,_.isSharedFile)(i),a=(0,c.is_supported_mobile_browser)();this.isMobile=a||window.innerWidth<801;const n=s===f.SDKPreviewSurface.SHARED_LINK||s===f.SDKPreviewSurface.VERSION_HISTORY;S&&this.isMobile&&r&&I&&!n&&i.file_id!==(null===(t=this.metadata)||void 0===t?void 0:t.id)&&i.file_id!==this.lastFailedId&&(yield I.getMetadataAlpha({contentId:i.file_id}).then(e=>this.metadata=e).catch(()=>this.lastFailedId=i.file_id))}))},this.context=r}actionDefinitions(){return S&&this.isMobile&&s!==f.SDKPreviewSurface.VERSION_HISTORY?{alwaysInOverflow:[[this.shareDefinition(e())]]}:{}}shareDefinition(e){const{file:i}=e,s=(0,_.isSharedFile)(i),c=!!this.metadata&&this.metadata.access_type!==m.ACCESS_LEVEL.WRITER,v=s&&c;return(0,a.makePluginActionDefinition)({label:n.intl.formatMessage(g.SHARE_ACTION_STRING),disabled:v?{disabled:!0,tooltipMessage:n.intl.formatMessage(h)}:{disabled:!1},icon:r.default.createElement(l.UIIcon,{src:o.ShareArrowLine}),id:t.SHARE_PLUGIN_ID,action:()=>{S&&(p.share(i,S,null,{origin:d.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE}),this.context.logUserAction(u.UserAction.Share,u.UserActionContext.TitleBarMain))}})}}(E))}})})),define("metaserver/static/js/previews/ui/sharing_plugin/share_button",["require","exports","tslib","react","react-intl","react-redux","dig-components/buttons","dig-components/tooltips","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/extensions/split_share_button","metaserver/static/js/extensions/data/store","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/file_viewer/share_helpers","typescript/libraries/file-viewer/src/core/logging/constants","metaserver/static/js/file_store/utils","metaserver/static/js/file_viewer/sdk_file_viewer/action_plugins/utils","metaserver/static/js/sharing/api/client","metaserver/static/js/sharing/access_level","metaserver/static/js/file_viewer/sdk_file_viewer/utils","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types","metaserver/static/js/previews/ui/sharing_plugin/copy_file_link_button","typescript/libraries/file-viewer/src/comments2/plugin/types","typescript/libraries/file-viewer/src/file_viewer/context_provider","metaserver/static/js/integrations/zoom_share_dialog/async_modal","typescript/libraries/file-viewer/src/render_context","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f,g,h,S,w,E,I,P,A,b,O,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareButton=t.DisabledShareButton=void 0,r=i.__importStar(r),v=i.__importStar(v);const T=(0,s.defineMessage)({id:"VzQ1nj",defaultMessage:"Ask the owner of this file for permission to share it with others"}),C=(0,s.defineMessage)({id:"JDi0M8",defaultMessage:"Share"});t.DisabledShareButton=()=>{const e=(0,s.useIntl)(),t=e.formatMessage(C),i=e.formatMessage(T),a=r.default.createElement(l.UIIcon,{src:c.ShareArrowLine});return r.default.createElement(o.Tooltip,{title:i,placement:"left"},r.default.createElement("span",{style:{display:"inline-block"},tabIndex:0},r.default.createElement(n.SplitButton,{variant:"primary",disabled:!0,renderMenu:({buttonProps:e})=>r.default.createElement(d.Menu.Wrapper,null,({getTriggerProps:t,getContentProps:i})=>r.default.createElement(r.default.Fragment,null,r.default.createElement(n.Button,Object.assign({"aria-label":"Show options"},e,t(),{disabled:!0})),r.default.createElement(d.Menu.Content,Object.assign({},i(),{placement:"bottom-end"}))))},a,t)))},t.DisabledShareButton.displayName="DisabledShareButton";t.ShareButton=({previewSurface:e,activeFile:s,user:n,copyLinkButtonOOBPreviewsVariant:o,parsedSharedCopyLink:l,shouldShowApproval:c})=>{const d=r.default.useMemo(()=>(0,u.getStore)(),[]),T=r.default.useMemo(()=>n&&new h.FileShareApiClient({userId:n.id}),[n]),[C,R]=r.default.useState(void 0),D=r.default.useRef(null),{responsiveSize:k}=(0,O.useFileViewerRenderContext)(),N=(0,A.useFileViewerContext)(),L=e===w.SDKPreviewSurface.SHARED_CONTENT_LINK||e===w.SDKPreviewSurface.SHARED_LINK,M=L||e===w.SDKPreviewSurface.INBAND_SHARE,F=(0,f.isSharedFile)(s),j=r.default.useCallback(()=>i.__awaiter(void 0,void 0,void 0,(function*(){F&&T&&!(null==l?void 0:l.doesContainShmodelLink)&&(yield T.getMetadataAlpha({contentId:s.file_id}).then(e=>R(e)))})),[s]);(0,r.useEffect)(()=>{D.current!=s.file_id&&j()},[s]);const x=null!=C&&C.access_type===S.ACCESS_LEVEL.WRITER,U=r.default.useCallback(()=>{if(!n)return;const e=M?_.SHARE_ACTION_ORIGIN_TYPE.SHARING_PREVIEW_PAGE:_.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE;v.share(s,n,null,{origin:e,showApproval:c,onCreateApprovalSuccess:()=>N.pluginContext.getPluginData().navigation.openRightRailPlugin(m.UserActionContext.TitleBarMain,P.COMMENTS_PLUGIN_ID),docsendAnalyticsAddOn:y.fileViewerFeatureExperiments.docsendAnalyticsAddOn}),N.pluginContext.logUserAction(m.UserAction.Share,m.UserActionContext.TitleBarMain)},[s,n]),B=r.default.useMemo(()=>Object.assign(Object.assign({},s),{icon:(0,f.isBrowseFile)(s)?s.icon:"",fq_path:(0,f.isBrowseFile)(s)?s.fq_path:"",is_cloud_doc:(0,g.isCloudDoc)(s),type:(0,g.getType)(s)}),[s]),V=!M;if(!n||e===w.SDKPreviewSurface.VERSION_HISTORY)return!n&&L&&"ON"===o&&((null==l?void 0:l.doesContainRlKey)||(null==l?void 0:l.doesContainShmodelLink))?r.default.createElement("div",{className:"share-button-container"},r.default.createElement(I.CopyFileLinkButton,{file_id:s.file_id,parsedLink:l,linkAccessLevel:l.doesContainShmodelLink?"viewer":void 0})):null;let H=!1;if(L||F&&!x)if("ON"===o&&l&&(l.doesContainRlKey||l.doesContainShmodelLink))H=!0;else if("ON"!==o&&!x)return r.default.createElement(t.DisabledShareButton,null);return r.default.createElement("div",{className:"share-actions"},H&&r.default.createElement("div",{className:"share-button-container"},r.default.createElement(I.CopyFileLinkButton,{file_id:s.file_id,link_metadata:null==C?void 0:C.link_metadata,user:n,parsedLink:l,variant:V?"opacity":"primary",linkAccessLevel:x?"editor":"viewer"})),V&&r.default.createElement(a.Provider,{store:d},r.default.createElement(p.SplitShareButton,{files:[B],user:n,variant:"primary",onShowShare:U,onPresentInZoom:()=>((e,t)=>{(0,b.asyncShowModal)(t.id,e,"file-viewer-modal-overlay")})(s.file_id,n),showLeftDigIcon:k===E.ResponsiveSize.DESKTOP,previewsLogUserAction:N.pluginContext.logUserAction})),!V&&!H&&r.default.createElement(t.DisabledShareButton,null))},t.ShareButton.displayName="ShareButton"})),define("metaserver/static/js/previews/util",["require","exports","tslib","metaserver/static/js/core/browser","metaserver/static/js/clean/analytics","js/filepath/filepath","typescript/libraries/file-viewer/src/core/types/preview_type","typescript/libraries/file-viewer/src/file_extension/extension_constants","metaserver/static/js/core/uri"],(function(e,t,i,r,s,a,n,o,l){"use strict";function c(e,t){const i={};return i._subject_uid=String(t),e.updateQuery(i)}function d(e,t){return c(new l.URI({path:"/history"+e.fq_path}),t.id)}Object.defineProperty(t,"__esModule",{value:!0}),t.VALID_PREVIEW_TYPES=t.redirectToVersionHistory=t.getVersionHistoryUrl=t.update_url_with_user_id=t.getWhitelistedExtension=void 0,r=i.__importStar(r),a=i.__importStar(a),t.getWhitelistedExtension=function(e){const t=a.file_extension(e);return o.LOGGING_ALLOWED_EXTS.includes(`.${t}`)?t:o.LOGGING_UNALLOWED_EXT_PLACEHOLDER},t.update_url_with_user_id=c,t.getVersionHistoryUrl=d,t.redirectToVersionHistory=function(e,t){s.UserActivityLogger.log("web","view_version_history");const i=d(e,t);r.redirect(i.toString())},t.VALID_PREVIEW_TYPES=[n.PreviewType.Archive,n.PreviewType.Audio,n.PreviewType.CloudDoc,n.PreviewType.Excel,n.PreviewType.HTML,n.PreviewType.Image,n.PreviewType.Linkfile,n.PreviewType.Other,n.PreviewType.SsrDoc,n.PreviewType.RawHTML,n.PreviewType.Restricted,n.PreviewType.Video,n.PreviewType.Doc,n.PreviewType.Photo,n.PreviewType.Text]})),define("metaserver/static/js/share_download/ui/util",["require","exports","tslib","react","metaserver/static/js/file_viewer/sdk_file_viewer/utils","metaserver/static/js/share_download/ui/models","metaserver/static/js/share_download/types","metaserver/static/js/clean/viewer","metaserver/static/js/loggers/folder_preview_logger","metaserver/static/js/core/i18n","typescript/libraries/file-viewer/src/core/types/auth_modal","dig-components/modal","metaserver/static/js/dig-illustrations/hero/remote-work","dig-components/typography","dig-components/buttons","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/analytics","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m,f,g){"use strict";function h({canCopyToDropboxRoles:e},t,i,r,s,n,l,c,d,p,u){const _=o.Viewer.get_viewer(),v=d?d.role:"anonymous",m=-1===e.indexOf(v);return a.ShareDownloadActionOption.buildToDropboxOption(t,i,_,d,v,m,r,p,s,n,l,c,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.showPostDownloadSignInModal=t.PostDownloadSignInModal=t.isDownloadAllowed=t.callOptionHandler=t.getDownloadOptions=t.getToDropboxOption=void 0,r=i.__importDefault(r),t.getToDropboxOption=h,t.getDownloadOptions=function(e,t,i,r,s,o,l,c,d){const{canDownloadRoles:p,canCopyToDropboxRoles:u}=e,{buildDirectOption:_}=a.ShareDownloadActionOption,v=[];return(0,n.isPendingEntry)(r)?v:(p.length>0&&v.push(_(t,s,o,i.linkType)),u.length>0&&v.push(h(e,i,r,o,c,void 0,void 0,void 0,l||void 0,d)),v)},t.callOptionHandler=function(e,t,i){return()=>{i&&i(),e.handler&&e.handler(),t&&(0,l.logEvent)(e.userAction,t)}},t.isDownloadAllowed=function(e){return e.canDownloadRoles.length>0};t.PostDownloadSignInModal=({encryptionOptions:e,logUserAction:t,isFolder:i,shareToken:a,link_url:n})=>{const[o,l]=r.default.useState(!0),m=()=>{l(!1),null==t||t("post_download_signin_modal_close","post_download_sigin_modal")},f=c.intl.formatMessage({id:"RfGyPH",defaultMessage:"Close"}),g=i=>{S(a,n),(0,s.showAuthModal)({mode:i,kind:d.LoginOrRegisterKind.DOWNLOAD,encryptionOptions:e,loggingExtra:{source:"post_download_modal"}}),null==t||t(i===d.AuthMode.LOGIN?"post_download_signin_modal_login":"post_download_signin_modal_register","post_download_sigin_modal")};return r.default.createElement(p.Modal,{open:o,isCentered:!0,onRequestClose:m},r.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard",className:"naming-conventions__header"},r.default.createElement(u.RemoteWorkHero,{aspectRatio:"16:9"})),r.default.createElement(p.Modal.Body,{hasVerticalSpacing:!0},i?r.default.createElement(_.Title,null,c.intl.formatMessage({id:"gGscZD",defaultMessage:"Your folder is downloading"})):r.default.createElement(_.Title,null,c.intl.formatMessage({id:"I4X18Q",defaultMessage:"Your file is downloading"})),r.default.createElement("div",null,r.default.createElement(_.Text,null,c.intl.formatMessage({id:"F2Wlhv",defaultMessage:"In the meantime, sign up for Dropbox to have secure access to all your files. "}))),r.default.createElement(_.Text,{tagName:"span"},c.intl.formatMessage({id:"NoO24L",defaultMessage:"Collaborate with friends, family, and coworkers from any device."}))),r.default.createElement(p.Modal.Footer,null,r.default.createElement(v.Button,{variant:"transparent",onClick:m},f),r.default.createElement(v.Button,{variant:"opacity",onClick:()=>g(d.AuthMode.LOGIN)},c.intl.formatMessage({id:"N0xz5m",defaultMessage:"Sign in"})),r.default.createElement(v.Button,{variant:"primary",onClick:()=>g(d.AuthMode.REGISTER)},c.intl.formatMessage({id:"5KEf7W",defaultMessage:"Sign up"}))))},t.showPostDownloadSignInModal=function(e){var i;if((function(e){const t=window.localStorage.getItem(e);if(!t)return!0;const i=JSON.parse(t);if((new Date).getTime()>i)return window.localStorage.removeItem(e),!0;return!1})("dbx_previews_log_out_download_modal")){m.Modal.showInstance(r.default.createElement(t.PostDownloadSignInModal,Object.assign({},e))),null===(i=e.logUserAction)||void 0===i||i.call(e,"show_post_download_signin_modal","download"),e.isFolder&&w(e.shareToken,e.link_url);const s=(new Date).getTime()+864e5;window.localStorage.setItem("dbx_previews_log_out_download_modal",JSON.stringify(s))}};const S=(e,t)=>{const i=e&&e.linkType===g.SharedLinkType.Content?f.ShareTibEventLogger.get_scl_extra_for_logging(e,t):f.ShareTibEventLogger.get_shmodel_extra_for_logging(e,t);return f.ShareTibEventLogger.log_unauth("VIEW_AUTH_PAGE",g.SHARE_ACTION_ORIGIN_TYPE.POST_DOWNLOAD_MODAL,i)},w=(e,t)=>{const i=e&&e.linkType===g.SharedLinkType.Content?f.ShareTibEventLogger.get_scl_extra_for_logging(e,t):f.ShareTibEventLogger.get_shmodel_extra_for_logging(e,t);return f.ShareTibEventLogger.log_unauth("VIEW_POST_DOWNLOAD_SIGNIN_SIGNUP_MODAL",g.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,i)}})),define("typescript/component_libraries/flows/src/components/approval-forms/approval_metadata",["require","exports","tslib","react","react-intl","dig-components/typography","dig-components/breadcrumb","typescript/component_libraries/flows/src/components/approval-forms/url_utils"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApprovalMetadata=void 0,r=i.__importStar(r),t.ApprovalMetadata=r.default.memo(({fileId:e,getApprovalStatus:t,InfoBladeRowComponent:i,onClick:l,logger:c})=>{const[d,p]=(0,r.useState)(null),[u,_]=(0,r.useState)(null),v=(0,s.useIntl)(),m={pending:v.formatMessage({id:"bxXd24",defaultMessage:"Pending approval"}),approved:v.formatMessage({id:"wtrJLn",defaultMessage:"Approved"}),no_status:null,other:null};if((0,r.useEffect)(()=>{let i=!0;return p(null),t(e).then(e=>{var t;const r=null===(t=e.status)||void 0===t?void 0:t[".tag"];if(!r||"pending"!==r&&"approved"!=r)return;const s=e.comment_id;if(s&&i){p(m[r]),_(s)}}),()=>{i=!1}},[e]),!d||!u)return null;return r.default.createElement(i,{title:v.formatMessage({id:"vautul",defaultMessage:"Status"}),data:r.default.createElement(n.Breadcrumb,{size:"small"},r.default.createElement(n.Breadcrumb.Link,{onClick:()=>{c&&c(d),(0,o.setApprovalCommentId)(u),l()}},r.default.createElement(a.Text,{variant:"paragraph",size:"small"},d)))})}),t.ApprovalMetadata.displayName="ApprovalMetadata"})),define("typescript/component_libraries/flows/src/components/approval-forms/url_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApprovalCommentId=t.setApprovalCommentId=t.isRequestApproval=void 0;const i=e=>{const t=new URLSearchParams(window.location.search);if(0==t.toString().length)return null;const i=t.get(e);return i&&(t.delete(e),t.toString().length>0?window.history.replaceState(null,"","?"+t.toString()+window.location.hash):window.history.replaceState(null,"",window.location.href.split("?")[0]+window.location.hash)),i};t.isRequestApproval=()=>{const e={key:"request_approval",value:"1"};return i("request_approval")===e.value};t.setApprovalCommentId=e=>{const t=new URLSearchParams(window.location.search),i=(e=>({key:"approval_comment",value:e}))(e);t.set(i.key,i.value),window.history.replaceState(null,"","?"+t.toString()+window.location.hash)};t.getApprovalCommentId=()=>i("approval_comment")})),define("typescript/component_libraries/photos/src/preview-photo-editor/types",["require","exports"],(function(e,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getMimeTypeByExt=t.imageTypeAllowed=t.ImageExtension=t.ImageMimeTypes=void 0,(function(e){e.JPEG="image/jpeg",e.PNG="image/png"})(i=t.ImageMimeTypes||(t.ImageMimeTypes={})),(function(e){e.JPEG="jpeg",e.JPG="jpg",e.PNG="png"})(r=t.ImageExtension||(t.ImageExtension={})),t.imageTypeAllowed=[r.JPEG,r.JPG,r.PNG];t.getMimeTypeByExt=e=>{switch(e){case r.JPEG:case r.JPG:return i.JPEG;case r.PNG:return i.PNG}}})),define("typescript/libraries/comments2/src/components/rich_facepile/avatars",["require","exports","tslib","typescript/libraries/comments2/src/components/rich_facepile/index.module.css","react","spectrum/avatar/index","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar","spectrum/util/uuid_generator","typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Avatars=void 0,r=i.__importDefault(r),s=i.__importStar(s);const p=r.default.scRichFacepileOverflowTooltipContent;class u extends s.Component{constructor(){super(...arguments),this.state={},this.tooltipContentWrapperClassName=(0,l.generateUUID)("sc-rich-facepile-tooltip-content"),this.documentClickListener=e=>{const t=e.target;void 0===this.state.activeTooltipIndex||this.closest(t,this.tooltipContentWrapperClassName)||this.closest(t,"mc-facepile-container")||this.setActiveTooltipIndex(void 0)},this.leaveActiveMode=()=>{this.setActiveTooltipIndex(void 0)},this.bindN=e=>{const t=[];for(let i=0;i<d.MAX_FACES;i++)t.push(()=>e(i));return t},this.onTooltipShownForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,i=this.infoFromIndex(e);if(t&&null!==i){const r=this.avatarRectForIndex(e,i);t({activeMode:this.activeMode,displayInfo:null},{activeMode:this.activeMode,displayInfo:i,avatarRect:r})}},this.onTooltipHiddenForIndex=e=>{if(this.activeMode)return;const{onTooltipChange:t}=this.props,i=this.infoFromIndex(e);t&&null!==i&&t({activeMode:this.activeMode,displayInfo:i},{activeMode:this.activeMode,displayInfo:null})},this.onAvatarClickForIndex=e=>{const{becomePassiveOnOverflowAvatarClick:t,onAvatarClick:i}=this.props,r=this.infoFromIndex(e),s=t&&r===d.OVERFLOW;s||this.activeMode||this.setActiveTooltipIndex(e),s&&this.activeMode&&this.setActiveTooltipIndex(void 0),r&&i&&i(r)},this.onAvatarMouseOverForIndex=e=>{this.activeMode&&this.setActiveTooltipIndex(e)},this.onAvatarMouseEnterForIndex=e=>{if(this.props.onAvatarMouseEnter){const t=this.infoFromIndex(e),i=this.avatarRectForIndex(e,t);this.props.onAvatarMouseEnter({activeMode:this.activeMode,displayInfo:t,avatarRect:i})}},this.onAvatarFocusForIndex=e=>{this.onAvatarMouseEnterForIndex(e),this.onAvatarMouseOverForIndex(e)},this.onTooltipShown=this.bindN(this.onTooltipShownForIndex),this.onTooltipHidden=this.bindN(this.onTooltipHiddenForIndex),this.onAvatarClick=this.bindN(this.onAvatarClickForIndex),this.onAvatarMouseOver=this.bindN(this.onAvatarMouseOverForIndex),this.onAvatarMouseEnter=this.bindN(this.onAvatarMouseEnterForIndex),this.onAvatarFocus=this.bindN(this.onAvatarFocusForIndex),this.avatarDivRefs=Array(d.MAX_FACES).fill(0).map(e=>s.createRef())}componentDidMount(){document.addEventListener("click",this.documentClickListener,!0),window.addEventListener("resize",this.leaveActiveMode,!0)}componentWillUnmount(){document.removeEventListener("click",this.documentClickListener,!0),window.removeEventListener("resize",this.leaveActiveMode,!0)}closest(e,t){for(;e;e=e.parentElement)if(e.classList.contains(t))return e;return null}get activeMode(){return void 0!==this.state.activeTooltipIndex}setActiveTooltipIndex(e){const{activeTooltipIndex:t}=this.state,{onTooltipChange:i}=this.props;if(i&&t!==e){const{activeMode:r}=this,s=void 0!==e,a=s?this.infoFromIndex(e):null;i({activeMode:r,displayInfo:r?this.infoFromIndex(t):a},{activeMode:s,displayInfo:a,avatarRect:s?this.avatarRectForIndex(e,a):void 0})}this.setState({activeTooltipIndex:e})}displayModeForIndex(e){const{activeTooltipIndex:t}=this.state,i=this.props.passiveShowOnHover?d.DisplayMode.Hover:d.DisplayMode.Auto;return void 0===t?i:t===e?d.DisplayMode.ForceShow:d.DisplayMode.ForceHide}infoFromIndex(e){const{avatarInfoList:t,avatarInfoList:{length:i},overflowRemainderCount:r}=this.props;return r&&e===i?d.OVERFLOW:e>=i?null:t[e]}getBoundingClientRectForRef({current:e}){return e?e.getBoundingClientRect():{left:-1,top:-1,width:0,height:0,right:-1,bottom:-1}}avatarRectForIndex(e,t){if(void 0===t&&(t=this.infoFromIndex(e)),!t)return;const{left:i,top:r,width:s,height:a}=this.getBoundingClientRectForRef(this.avatarDivRefs[e]);return{origin:{x:i,y:r},size:{width:s,height:a}}}render(){const{avatarSize:e,avatarInfoList:t,overflowRemainderCount:i,tooltipComponent:r,renderFacepile:l,initialsToColorAssigner:u,source:_,intl:v}=this.props,m=t.map((t,i)=>{const{present:n,activeTooltipContent:l,avatarColorSeed:d,displayName:p,initials:v,memberKey:m,passiveTooltipContent:f,photoUrl:g}=t,h=d||p,S=s.createElement("div",{onFocusCapture:this.onAvatarFocus[i],ref:this.avatarDivRefs[i]},s.createElement(o.FacepileMembersAvatar,{active:n,"aria-label":p,avatarColorSeed:h,avatarSize:e,initials:v,onClick:this.onAvatarClick[i],onMouseEnter:this.onAvatarMouseEnter[i],onMouseOver:this.onAvatarMouseOver[i],photoUrl:g,initialsToColorAssigner:u||void 0}));let w;return this.activeMode?(w=void 0!==l?l:f,null!==w&&(w=s.createElement(c.LeaveActiveModeWrapperContext.Provider,{value:{signalClick:this.leaveActiveMode}},w))):w=f,s.createElement(r,{avatar:S,source:_,displayMode:this.displayModeForIndex(i),tooltipContent:w,avatarColor:u?u(h):(0,a.avatarColorForUserIdentifier)(h),onTooltipShown:this.onTooltipShown[i],onTooltipHidden:this.onTooltipHidden[i],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:m})});if(i){const a=v.formatMessage({id:"tkBGME",defaultMessage:"99+"}),o=i>=99?a:""+i,l=t.length,c=s.createElement("div",{onFocusCapture:this.onAvatarMouseOver[l],ref:this.avatarDivRefs[l]},s.createElement(n.FacepileMembersOverflowCircle,{avatarSize:e,backgroundColor:"#627283",textColor:"white",onClick:this.onAvatarClick[l],onMouseOver:this.onAvatarMouseOver[l],remainderCount:o})),u=v.formatMessage({id:"U34Aor",defaultMessage:"{count, plural, one {# other} other {# others}}"},{count:i});m.push(s.createElement(r,{source:_,avatar:c,displayMode:this.displayModeForIndex(l),tooltipContent:s.createElement("div",{className:p},u),avatarColor:"#627283",onTooltipShown:this.onTooltipShown[l],onTooltipHidden:this.onTooltipHidden[l],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:d.OVERFLOW}))}return l(m)}}t.Avatars=u,u.displayName="Avatars"})),define("typescript/libraries/comments2/src/components/rich_facepile/index.module.css",["require","exports","css!typescript/libraries/comments2/src/components/rich_facepile/index.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offsetFacepile=t.scRichFacepileOverflowTooltipContent=t.scRichFacepileTooltipContentContainer=void 0,t.scRichFacepileTooltipContentContainer="_sc-rich-facepile-tooltip-content-container_1qstf_3",t.scRichFacepileOverflowTooltipContent="_sc-rich-facepile-overflow-tooltip-content_1qstf_11",t.offsetFacepile="_offset-facepile_1qstf_16";t.default={scRichFacepileTooltipContentContainer:"_sc-rich-facepile-tooltip-content-container_1qstf_3",scRichFacepileOverflowTooltipContent:"_sc-rich-facepile-overflow-tooltip-content_1qstf_11",offsetFacepile:"_offset-facepile_1qstf_16"}})),define("typescript/libraries/comments2/src/components/rich_facepile/index",["require","exports","typescript/libraries/comments2/src/components/rich_facepile/util","typescript/libraries/comments2/src/components/rich_facepile/rich_facepile","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepileProps=t.MAX_FACES=t.OVERFLOW=t.TooltipComponentProps=t.SizeClass=t.DisplayMode=t.AvatarInfo=t.RichFacepilePresentationInfo=t.RichFacepile=t.UtilTooltip=void 0,Object.defineProperty(t,"UtilTooltip",{enumerable:!0,get:function(){return i.UtilTooltip}}),Object.defineProperty(t,"RichFacepile",{enumerable:!0,get:function(){return r.RichFacepile}}),Object.defineProperty(t,"RichFacepilePresentationInfo",{enumerable:!0,get:function(){return r.RichFacepilePresentationInfo}}),Object.defineProperty(t,"AvatarInfo",{enumerable:!0,get:function(){return s.AvatarInfo}}),Object.defineProperty(t,"DisplayMode",{enumerable:!0,get:function(){return s.DisplayMode}}),Object.defineProperty(t,"SizeClass",{enumerable:!0,get:function(){return s.SizeClass}}),Object.defineProperty(t,"TooltipComponentProps",{enumerable:!0,get:function(){return s.TooltipComponentProps}}),Object.defineProperty(t,"OVERFLOW",{enumerable:!0,get:function(){return s.OVERFLOW}}),Object.defineProperty(t,"MAX_FACES",{enumerable:!0,get:function(){return s.MAX_FACES}}),Object.defineProperty(t,"RichFacepileProps",{enumerable:!0,get:function(){return s.RichFacepileProps}})})),define("typescript/libraries/comments2/src/components/rich_facepile/leave_active_mode_wrapper",["require","exports","tslib","react"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaveActiveModeWrapper=t.LeaveActiveModeWrapperContext=void 0,r=i.__importStar(r),t.LeaveActiveModeWrapperContext=r.createContext({signalClick:()=>{}});t.LeaveActiveModeWrapper=({children:e})=>r.createElement(t.LeaveActiveModeWrapperContext.Consumer,null,({signalClick:t})=>r.createElement("span",{onClick:t},e)),t.LeaveActiveModeWrapper.displayName="LeaveActiveModeWrapper"})),define("typescript/libraries/comments2/src/components/rich_facepile/rich_facepile",["require","exports","tslib","react","spectrum/facepile/index","typescript/libraries/comments2/src/components/rich_facepile/avatars","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichFacepile=void 0,r=i.__importStar(r);const o={[n.SizeClass.Small]:2,[n.SizeClass.Medium]:3,[n.SizeClass.Large]:n.MAX_FACES,[n.SizeClass.ExtraLarge]:n.MAX_FACES};t.RichFacepile=r.memo(e=>{const{avatarSize:t=32,avatarInfoList:i,becomePassiveOnOverflowAvatarClick:l,onAvatarClick:c,onTooltipChange:d,onAvatarMouseEnter:p,overflowBasis:u,shadowBackgroundColor:_,sizeClass:v,source:m,sizeClassToCircleCountOverrides:f,tooltipComponent:g,passiveShowOnHover:h,initialsToColorAssigner:S,intl:w}=e,E={...o,...f},I=Math.min(E[v],n.MAX_FACES);if(I<=0)return null;const P=Math.max(u,i.length);let A,b;return"fileViewer"===e.source&&window.innerWidth<768?(b=i.length-1,A=i):P<=I?(A=i,b=void 0):(A=i.slice(0,I-1),b=P-A.length),r.createElement(a.Avatars,{intl:w,avatarSize:t,onAvatarClick:c,onTooltipChange:d,onAvatarMouseEnter:p,avatarInfoList:A,becomePassiveOnOverflowAvatarClick:l,passiveShowOnHover:h,overflowRemainderCount:b,source:m,tooltipComponent:g,renderFacepile:e=>r.createElement(s.Facepile,{avatarSize:t,shadowBackgroundColor:_},e.reverse()),initialsToColorAssigner:S||void 0})}),t.RichFacepile.displayName="RichFacepile"})),define("typescript/libraries/comments2/src/components/rich_facepile/spectrum_fork/facepile_members_avatar",["require","exports","tslib","react","spectrum/avatar/index","spectrum/button/index"],(function(e,t,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FacepileMembersAvatar=void 0,r=i.__importStar(r);class n extends r.PureComponent{constructor(){super(...arguments),this.renderAvatarInitials=()=>{const{active:e,"aria-label":t,avatarColorSeed:i,avatarSize:a,initials:n,initialsToColorAssigner:o}=this.props;return r.createElement(s.AvatarInitials,{avatarSize:a,"aria-label":t,backgroundColor:o?o(i):(0,s.avatarColorForUserIdentifier)(i),variant:e?"normal":"inactive"},n)}}render(){const{active:e,"aria-label":t,"aria-describedby":i,avatarColorSeed:n,avatarSize:o,disabled:l,photoUrl:c,onClick:d,onMouseEnter:p,onMouseLeave:u,onMouseOver:_,tabIndex:v,initialsToColorAssigner:m}=this.props,f=m?m(n):(0,s.avatarColorForUserIdentifier)(n);return r.createElement(a.Button,{"aria-label":t,"aria-describedby":i,className:"mc-facepile-members-avatar",disabled:l,onClick:d,onMouseEnter:p,onMouseLeave:u,onMouseOver:_,tabIndex:v,variant:"circular"},c?r.createElement(s.Avatar,{renderFallback:this.renderAvatarInitials,size:o,src:c||void 0,variant:e?"normal":"inactive",style:{background:e?f:"#BFBFBF"}}):this.renderAvatarInitials())}}t.FacepileMembersAvatar=n,n.displayName="FacepileMembersAvatar"})),define("typescript/libraries/comments2/src/components/rich_facepile/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeClass=t.DisplayMode=t.MAX_FACES=t.OVERFLOW=void 0,t.OVERFLOW="overflow",t.MAX_FACES=5,(function(e){e[e.Auto=1]="Auto",e[e.ForceShow=2]="ForceShow",e[e.ForceHide=3]="ForceHide",e[e.Hover=4]="Hover"})(t.DisplayMode||(t.DisplayMode={})),(function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e[e.ExtraLarge=3]="ExtraLarge"})(t.SizeClass||(t.SizeClass={}))})),define("typescript/libraries/comments2/src/components/rich_facepile/util",["require","exports","tslib","typescript/libraries/comments2/src/components/rich_facepile/index.module.css","react","classnames","spectrum/positioned_portal/index","spectrum/facepile_tooltip/facepile_tooltip_content","typescript/libraries/comments2/src/components/rich_facepile/types"],(function(e,t,i,r,s,a,n,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UtilTooltip=void 0,r=i.__importDefault(r),s=i.__importStar(s),a=i.__importDefault(a);const c=r.default.scRichFacepileTooltipContentContainer,d=r.default.offsetFacepile;class p extends s.PureComponent{constructor(e){super(e),this.tooltipDirection="below",this.hidePortal=()=>{const e=this.portalRef.current;e&&e.hidePortal.call(e)},this.handlePortalMouseout=e=>{const{displayMode:t}=this.props;t===l.DisplayMode.Hover&&this.hasLeftIntoTooltip(e)&&e.stopPropagation()},this.onContentMouseLeave=()=>{this.props.displayMode===l.DisplayMode.Hover&&this.hidePortal()},this.renderContent=()=>{var e,t;const{avatarColor:i,tooltipContent:r,tooltipContentWrapperClassName:n,source:l}=this.props;return null===r?null:s.createElement(o.FacepileTooltipContent,{backgroundColor:i,className:(0,a.default)(c,n,{[d]:"fileViewer"===l&&(r.props.colorSeed||(null===(t=null===(e=r.props.children)||void 0===e?void 0:e.props)||void 0===t?void 0:t.colorSeed))}),tooltipContent:r,onMouseLeave:this.onContentMouseLeave})},this.portalRef=s.createRef()}componentDidUpdate({displayMode:e}){const{displayMode:t}=this.props,{current:i}=this.portalRef;i&&t!==e&&(t===l.DisplayMode.ForceShow?(this.hidePortal(),window.setTimeout(()=>i.showPortal.call(i),0)):i.state.isShown&&this.hidePortal())}hasLeftIntoTooltip(e){const t=e.target.getBoundingClientRect(),i=Math.abs(t.top-e.pageY),r=Math.abs(t.bottom-e.pageY),s=Math.abs(t.left-e.pageX),a=Math.abs(t.right-e.pageX);switch(Math.min(i,r,s,a)){case i:return"above"===this.tooltipDirection;case r:return"below"===this.tooltipDirection;case s:return"left"===this.tooltipDirection;case a:default:return"right"===this.tooltipDirection}}render(){const{avatar:e,onTooltipShown:t,onTooltipHidden:i,displayMode:r=l.DisplayMode.Auto}=this.props,a=r===l.DisplayMode.Hover?s.createElement("div",{onMouseLeave:this.handlePortalMouseout},e):e;return s.createElement(n.PositionedPortal,{renderContent:this.renderContent,onDidShow:t,onWillClose:i,isShowInitially:r===l.DisplayMode.ForceShow,positioning:this.tooltipDirection,ref:this.portalRef,showOnMouseMove:r===l.DisplayMode.Auto||r===l.DisplayMode.Hover,closeOnBlur:r===l.DisplayMode.Auto||r===l.DisplayMode.Hover},a)}}t.UtilTooltip=p,p.displayName="UtilTooltip"})),define("typescript/libraries/file-viewer/src/assigned_tasks_blade/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ASSIGNED_TASKS_BLADE_PLUGIN_ID=void 0,t.ASSIGNED_TASKS_BLADE_PLUGIN_ID="assigned_tasks_blade"})),define("typescript/libraries/file-viewer/src/comments2/plugin/loader/lazy",["require","exports","tslib","typescript/libraries/file-viewer/src/comments2/plugin/types"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeLoader=void 0,t.makeLoader=function(t,s={},a,n){const o=(()=>{let r=null;return()=>i.__awaiter(this,void 0,void 0,(function*(){if(null==r){const{makeLoader:o}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/comments2/plugin/loader/eager"],t,i)}).then(i.__importStar);r=o(t,a,s,n)}return r}))})();return{pluginId:r.COMMENTS_PLUGIN_ID,load:(e,t)=>i.__awaiter(this,void 0,void 0,(function*(){return(yield o()).load(e,t)}))}}})),define("typescript/libraries/file-viewer/src/comments2/plugin/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMENTS_PLUGIN_ID=void 0,t.COMMENTS_PLUGIN_ID="comments"})),define("typescript/libraries/file-viewer/src/core/types/auth_modal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginOrRegisterKind=t.CommentTextVariant=t.AuthMode=void 0,(function(e){e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER"})(t.AuthMode||(t.AuthMode={})),(function(e){e.DEFAULT="",e.POST="post_comment_variant",e.SUBSCRIBE="subscribe_variant"})(t.CommentTextVariant||(t.CommentTextVariant={})),(function(e){e.COMMENT="comment",e.DOWNLOAD="download",e.IMMEDIATE="immediate",e.SIDEBAR="sidebar",e.POSTDOWNLOAD="postdownload",e.POSTSAVEAS="postsaveas"})(t.LoginOrRegisterKind||(t.LoginOrRegisterKind={}))})),define("typescript/libraries/file-viewer/src/file_activity_blade/loader",["require","exports","tslib","typescript/libraries/file-viewer/src/file_activity_blade/types"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileActivityPluginLoader=void 0,t.makeFileActivityPluginLoader=function(t,s){return{pluginId:r.FILE_ACTIVITY_PLUGIN_ID,load:(r,a)=>i.__awaiter(this,void 0,void 0,(function*(){const{makeStore:n}=yield new Promise((t,i)=>{e(["typescript/component_libraries/files_components/src/blades/file_activity/index"],t,i)}).then(i.__importStar),{FileActivityPluginBase:o}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/file_activity_blade/file_activity_blade_plugin"],t,i)}).then(i.__importStar),l=n({apiV2Client:r.apiv2ClientBase});return new o(r,l,t,a,s)}))}}})),define("typescript/libraries/file-viewer/src/file_activity_blade/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_ACTIVITY_PLUGIN_ID=void 0,t.FILE_ACTIVITY_PLUGIN_ID="file_activity"})),define("typescript/libraries/file-viewer/src/info_blade/info_blade_plugin",["require","exports","tslib","react","typescript/component_libraries/files_components/src/blades/info_blade/index","typescript/component_libraries/files_components/src/blades/info_blade/metadata/metadata_row","react-redux","typescript/libraries/file-viewer/src/utils","typescript/component_libraries/flows/src/components/approval-forms/approval_metadata","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/comments2/plugin/types","typescript/libraries/file-viewer/src/core/data/types","react-intl","dig-components/typography"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoBladePluginBase=void 0,r=i.__importStar(r);t.InfoBladePluginBase=class{constructor(e,t,i,v,m,f,g){this.layerUI={},this.rightRailUI={Sidebar:e=>{const t=e.file,i=(0,u.useIntl)(),v=(0,r.useMemo)(()=>{const{fqPath:e,name:i,lastModifiedDate:r,size:s}=t;return{fqPath:e,size:s,name:i,lastModifiedMs:r?new Date(r).getTime():void 0}},[t]),m=(0,r.useMemo)(()=>({enabled:!0,openPath:e.navigation.navigateToPath}),[e.navigation.navigateToPath]),f=(0,r.useMemo)(()=>{if("loaded"===e.account.state&&e.account.data)return(0,o.getRootName)(e.account.data)},[e.account]),g=(0,r.useCallback)(e=>{this.context.logUserAction(e?"click_show_all_metadata":"click_hide_all_metadata","right_sidebar")},[]),h=(0,r.useCallback)(()=>{this.context.logUserAction("right_rail_approval_status_click","right_sidebar",{file_id:t.fileId})},[t]);return r.default.createElement(n.Provider,{store:this.store},r.default.createElement(s.InfoBlade,{intl:this.platform.intl,id:p.INFO_BLADE_PLUGIN_ID},this.tagSection&&r.default.createElement(this.tagSection,{pluginContext:this.context}),r.default.createElement(_.Text,{variant:"paragraph",size:"small",isBold:!0},i.formatMessage({id:"bNnicH",defaultMessage:"Properties"})),r.default.createElement(s.BasicFileMetadata,{file:v,pathBar:m,accountRootName:f}),r.default.createElement(s.SharedLinkMetadata,Object.assign({},e.sharedLinkInfo)),r.default.createElement(s.UploadMetadata,{fileId:t.fileId,sharedLinkURL:e.file.url}),this.getApprovalStatus&&r.default.createElement(l.ApprovalMetadata,{fileId:t.fileId,getApprovalStatus:this.getApprovalStatus,onClick:()=>{h(),this.context.getPluginData().navigation.openRightRailPlugin(c.UserActionContext.ApprovalStatus,d.COMMENTS_PLUGIN_ID)},InfoBladeRowComponent:a.InfoBladeMetadataRow}),this.userId&&r.default.createElement(s.FileContentMetadata,{fileId:t.fileId,userId:this.userId,sharedLinkURL:e.file.url,onShowMore:g}),this.changeLogSection&&r.default.createElement(this.changeLogSection,{pluginContext:this.context})))},Control:()=>r.default.createElement(s.InfoBladeCollapsedBladeButton,{intl:this.platform.intl,id:p.INFO_BLADE_PLUGIN_ID})},this.lifecycle={},this.platform=e,this.store=t,this.userId=v,this.context=i,this.getApprovalStatus=m,this.tagSection=f,this.changeLogSection=g}}})),define("typescript/libraries/file-viewer/src/info_blade/loader",["require","exports","tslib","typescript/component_libraries/files_components/src/blades/info_blade/index","typescript/libraries/file-viewer/src/info_blade/info_blade_plugin","typescript/libraries/file-viewer/src/core/data/types"],(function(e,t,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeInfoBladePluginLoader=void 0,t.makeInfoBladePluginLoader=function(e,t,n,o){return{pluginId:a.INFO_BLADE_PLUGIN_ID,load:(a,l)=>i.__awaiter(this,void 0,void 0,(function*(){const i=(0,r.makeStore)({apiV2ClientBase:a.apiv2ClientBase});return new s.InfoBladePluginBase(a,i,l,e,t,n,o)}))}}})),define("typescript/libraries/file-viewer/src/titlebar/truncate",["require","exports","tslib","grapheme-splitter"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.measureRenderedTextLen=t.recalcText=t.truncateStringByLength=t.truncateStringByRenderWidth=void 0,r=i.__importDefault(r);function s(e,t,i=""){const r=Math.floor(t/2),s=e.slice(0,r);return i&&s.push(i),s.push(...e.slice(e.length-r,e.length)),{newGraphemes:s,newStr:s.join("")}}const a=new r.default;function n(e,t=""){const i=a.splitGraphemes(e);return s(i,i.length,t).newStr}function o(e,t,i){let r=i(e);const n=a.splitGraphemes(e);if(r<t||n.length<=2)return e;const o=Math.floor(t/r*n.length);let{newGraphemes:l,newStr:c}=s(n,o);for(r=i(c);r>t;)({newGraphemes:l,newStr:c}=s(l,l.length-1)),r=i(c);return c}t.truncateStringByRenderWidth=function(e,t,i){const r=i(e),n=a.splitGraphemes(e);if(r<=t||n.length<=2)return e;let o,l=Math.floor(t/r*n.length);do{({newStr:o}=s(n,l,"…")),l--}while(i(o)>t&&l>1);return o},t.truncateStringByLength=function(e,t){const i=a.splitGraphemes(e),{length:r}=i;return r<=Math.max(t,2)?e:s(i,t,"…").newStr},t.recalcText=function(e,t,i){const r=t-80;if(r>0){const t=e.substring(e.lastIndexOf(".")||e.length,e.length)||"",s=e.substring(0,e.length-t.length),a=r-i(`…${t}`);if(a<0){const t=o(e,r,i);return t!==e?n(t,"…"):e}{const r=o(s,a,i);return r!==s?`${n(r,"…")}${t}`:e}}return""},t.measureRenderedTextLen=function(e,t){if(!t)return 0;if("function"!=typeof t.getComputedTextLength)return 0;t.textContent=e;const i=t.getComputedTextLength();return t.textContent="",i}})),define("typescript/libraries/file-viewer/src/transcript_blade/components/transcript_blade",["require","exports","tslib","react","dig-components/icons","dig-components/icons/src","typescript/component_libraries/files_components/src/right-rail/right_rail","react-intl","dig-components/badges","dig-components/menu","dig-components/buttons","typescript/component_libraries/files_components/src/right-rail/context","typescript/libraries/file-viewer/src/transcript_blade/transcript_blade.module.css","typescript/libraries/file-viewer/src/transcript_blade/utils"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptBladeCollapsedBladeButton=t.TranscriptBlade=void 0,r=i.__importStar(r),u=i.__importDefault(u),t.TranscriptBlade=r.memo(({id:e,intl:t,transcript:i,onMenuSelection:v,showTranscriptionDetails:m,children:f})=>{const{expandedBlade:g}=r.useContext(p.RightRailContext),h=g===e,S=(0,_.getIsTranscriptNonempty)(i),w=r.createElement(r.Fragment,null,t.formatMessage({id:"+7+KXv",defaultMessage:"Transcript"}),r.createElement(l.AccessoryBadge,{className:u.default.transcriptHeaderBetaBadge},t.formatMessage({id:"XdjMGi",defaultMessage:"Beta"}))),E=h&&S?r.createElement("div",{className:u.default.transcriptHeaderOptionMenuWrapper},r.createElement(c.Menu.Wrapper,{onSelection:v,shouldPropagateClickOutsideMouseEvents:!0},({getContentProps:e,getTriggerProps:i})=>r.createElement(r.Fragment,null,r.createElement(d.IconButton,Object.assign({},i(),{variant:"transparent",size:"small","data-testid":"transcript-settings-menu"}),r.createElement(s.UIIcon,{src:a.MoreHorizontalLine,size:"small"})),r.createElement(c.Menu.Content,Object.assign({id:"parent"},e()),r.createElement(c.Menu.Segment,null,r.createElement(c.Menu.ActionItem,{key:"toggle_transcript_details",value:"toggle_transcript_details"},m?t.formatMessage({id:"6YJBBm",defaultMessage:"Hide transcript details"}):t.formatMessage({id:"T6egx/",defaultMessage:"Show transcript details"})),r.createElement(c.Menu.ActionItem,{key:"copy_transcript",value:"copy_transcript"},t.formatMessage({id:"L//QR/",defaultMessage:"Copy transcript"}))))))):null;return r.createElement(o.RawIntlProvider,{value:t},r.createElement(n.RightRail.Blade,{id:e,withIcon:r.createElement(s.UIIcon,{src:a.KeyboardLine}),withTitle:w,withTitleRightAccessory:E,bladePanelClassname:u.default.transcriptBlade},f))}),t.TranscriptBlade.displayName="TranscriptBlade",t.TranscriptBladeCollapsedBladeButton=r.memo(({id:e,intl:t})=>r.createElement(o.RawIntlProvider,{value:t},r.createElement(n.RightRail.CollapsedBladeIcon,{withIcon:r.createElement(s.UIIcon,{src:a.KeyboardLine,"aria-label":t.formatMessage({id:"qtZ4fj",defaultMessage:"Open transcript panel"})}),id:e,tooltip:t.formatMessage({id:"+VVWXN",defaultMessage:"Transcript"})}))),t.TranscriptBladeCollapsedBladeButton.displayName="TranscriptBladeCollapsedBladeButton"})),define("typescript/libraries/file-viewer/src/transcript_blade/components/transcript_progress_bar",["require","exports","tslib","react","react-intl","dig-components/progress_indicators","dig-components/typography","typescript/libraries/file-viewer/src/transcript_blade/constants","typescript/libraries/file-viewer/src/transcript_blade/transcript_blade.module.css"],(function(e,t,i,r,s,a,n,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptProgressBar=void 0,r=i.__importDefault(r),l=i.__importDefault(l),t.TranscriptProgressBar=r.default.memo(({showLoadingMessage:e=!0})=>{const t=(0,s.useIntl)(),[i,c]=r.default.useState(!1),d=r.default.useRef(null);return r.default.useEffect(()=>{if(e)return d.current=window.setTimeout(()=>{c(!0),d.current=null},o.LOADING_TEXT_DISPLAY_THRESHOLD),()=>{null!=d.current&&window.clearTimeout(d.current)}},[e]),r.default.createElement("div",{className:l.default.transcriptLoadingScreen},r.default.createElement(a.ProgressBar,{className:l.default.transcriptProgressBar,value:0,in:!0,isIndeterminate:!0}),i&&r.default.createElement(n.Text,{variant:"label",size:"small",color:"standard"},t.formatMessage({id:"BY163J",defaultMessage:"Depending on the length of the video, this may take a moment."})))}),t.TranscriptProgressBar.displayName="TranscriptProgressBar"})),define("typescript/libraries/file-viewer/src/transcript_blade/components/transcript_settings_modal",["require","exports","tslib","react","dig-components/buttons","dig-components/modal","dig-components/typography"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptSettingsModal=void 0,r=i.__importStar(r),t.TranscriptSettingsModal=r.memo(({intl:e,pluginNavigation:t,onClose:o,source:l,logUserAction:c})=>{const d=r.useCallback(()=>i.__awaiter(void 0,void 0,void 0,(function*(){null==t||t.setOptInToVideoTranscript(),c("transcript_opt_in_allow",l),o()})),[t,c,l,o]),p=r.useCallback(()=>{c("transcript_opt_in_cancel",l),o()},[c,o,l]);return r.useEffect(()=>{null==t||t.setHasShownTranscriptSettingModal(),c("transcript_opt_in_shown",l)},[c,t,l]),r.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:e.formatMessage({id:"AeW0AX",defaultMessage:"Close"}),onRequestClose:p},r.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},r.createElement(a.Modal.Title,null,"right_sidebar"===l?e.formatMessage({id:"O+lgqO",defaultMessage:"View transcripts of all your videos in one place."}):e.formatMessage({id:"TN7E34",defaultMessage:"Follow along with all of your videos with closed captions."}))),r.createElement(a.Modal.Body,null,r.createElement(n.Text,null,e.formatMessage({id:"e6nprz",defaultMessage:"This feature is powered by Amazon Transcribe. Your data will be sent to Amazon Web Services for transcription and closed captioning. <a>Learn More</a>"},{a:e=>r.createElement(n.Link,{href:"https://help.dropbox.com/view-edit/transcript-closed-captions"},e)}))),r.createElement(a.Modal.Footer,null,r.createElement(s.Button,{variant:"opacity",onClick:p,autoFocus:!0},e.formatMessage({id:"4JpPox",defaultMessage:"Cancel"})),r.createElement(s.Button,{onClick:d,variant:"primary"},e.formatMessage({id:"glzssT",defaultMessage:"Allow"}))))}),t.TranscriptSettingsModal.displayName="TranscriptSettingsModal"})),define("typescript/libraries/file-viewer/src/transcript_blade/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESUME_AUTO_SCROLL_BUTTON_PLACEHOLDER_HEIGHT=t.ESTIMATE_SEGMENT_ITEM_HEIGHT=t.MAX_TRANSCRIPT_VIDEO_DURATION_S=t.DEFAULT_VIRTUAL_LIST_HEIGHT=t.AUTO_SCROLL_PAUSE_THRESHOLD=t.COPIED_BUTTON_DISPLAY_THRESHOLD=t.LOADING_TEXT_DISPLAY_THRESHOLD=void 0,t.LOADING_TEXT_DISPLAY_THRESHOLD=1e4,t.COPIED_BUTTON_DISPLAY_THRESHOLD=3e3,t.AUTO_SCROLL_PAUSE_THRESHOLD=1e4,t.DEFAULT_VIRTUAL_LIST_HEIGHT=1e3,t.MAX_TRANSCRIPT_VIDEO_DURATION_S=480,t.ESTIMATE_SEGMENT_ITEM_HEIGHT=132,t.RESUME_AUTO_SCROLL_BUTTON_PLACEHOLDER_HEIGHT=40})),define("typescript/libraries/file-viewer/src/transcript_blade/hooks",["require","exports","tslib","react"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDuration=void 0,r=i.__importDefault(r),t.useDuration=function(e){const t=e&&e.readyState()>0?e.duration():void 0,[i,s]=r.default.useState(t);return r.default.useEffect(()=>{if(e){const t=()=>s(e.duration());return e.on("loadedmetadata",t),e.on("durationchange",t),()=>{e.off("loadedmetadata",t),e.off("durationchange",t)}}},[e]),i}})),define("typescript/libraries/file-viewer/src/transcript_blade/loader",["require","exports","tslib","typescript/libraries/file-viewer/src/transcript_blade/transcript_blade_plugin","typescript/libraries/file-viewer/src/core/data/types"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTranscriptPluginLoader=void 0,t.makeTranscriptPluginLoader=function(e){return{pluginId:s.TRANSCRIPT_BLADE_PLUGIN_ID,load:(t,s)=>i.__awaiter(this,void 0,void 0,(function*(){return new r.TranscriptBladePluginBase(t,s,e)}))}}})),define("typescript/libraries/file-viewer/src/transcript_blade/transcript_blade_plugin",["require","exports","tslib","react","typescript/libraries/file-viewer/src/core/data/types","typescript/libraries/file-viewer/src/transcript_blade/components/transcript_blade","typescript/libraries/file-viewer/src/core/types/preview_type","typescript/libraries/file-viewer/src/transcript_blade/utils","typescript/libraries/file-viewer/src/transcript_blade/components/transcript_settings_modal","typescript/component_libraries/files_components/src/right-rail/context","typescript/libraries/file-viewer/src/toolbar/toolbar_actions","typescript/libraries/file-viewer/src/transcript_blade/hooks","typescript/libraries/file-viewer/src/transcript_blade/constants","typescript/libraries/file-viewer/src/transcript_blade/components/transcript_progress_bar","typescript/libraries/file-viewer/src/core/riviera/types"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptBladePluginBase=void 0;const m=(r=i.__importDefault(r)).default.lazy(()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{TranscriptBladeContent:t}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/transcript_blade/components/transcript_blade_content"],t,i)}).then(i.__importStar);return{default:t}})));t.TranscriptBladePluginBase=class{constructor(e,t,f){this.layerUI={},this.rightRailUI={Sidebar:({previewType:e,ui:t})=>{var f,g;const[h,S]=r.default.useState(!0),w=this.context.getPluginData(),E=this.context.sdkConfig,I=w.previewType===n.PreviewType.Video,P=I?w.file:null,A=null===(f=null==w?void 0:w.file)||void 0===f?void 0:f.fileId,b=null==P?void 0:P.transcript,O="loaded"===(null==b?void 0:b.state)?null===(g=null==b?void 0:b.data)||void 0===g?void 0:g.segments:void 0,y=(0,o.getTranscriptPermission)(null==w?void 0:w.previewData),{videoPlayer:T}=(0,d.useToolbarAction)(),[C,R]=r.default.useState(!1),{expandedBlade:D}=r.default.useContext(c.RightRailContext),k=D===s.TRANSCRIPT_BLADE_PLUGIN_ID,N=I&&(0,o.shouldShowTranscriptUi)(b,y,E.video_transcription),L=(0,p.useDuration)(T);r.default.useEffect(()=>{I&&L&&L>u.MAX_TRANSCRIPT_VIDEO_DURATION_S&&w.navigation.setTranscriptError("too_long")},[L,I,w.navigation]),r.default.useEffect(()=>{I&&"ineligible"===(null==y?void 0:y[".tag"])&&"errored"===(null==b?void 0:b.state)&&b.error.statusCode===v.RivieraStatus.NotFound&&w.navigation.setTranscriptError("insufficient_permissions")},[I,y,w.navigation,b]),r.default.useEffect(()=>{const i=e===n.PreviewType.Video&&t.hasShownTranscriptSettingModal;k&&(0,o.shouldShowOptInModal)(y,b,i)&&R(!0)},[k,y,e,b,t]),r.default.useEffect(()=>{const e=(0,o.shouldGenerateTranscript)(y,b);N&&k&&e&&this.userId&&A&&(function(e,t){i.__awaiter(this,void 0,void 0,(function*(){I&&(yield w.navigation.generateTranscript(e,t))}))})(this.userId,A)},[A,k,I,y,w.navigation,N,b]),r.default.useEffect(()=>{N&&k&&this.context.logUserAction("open_transcript","right_sidebar",{transcript_opt_in:"opted_in"===(null==y?void 0:y[".tag"])?"true":"false"})},[k,y,N]);const M=r.default.useCallback(e=>{"toggle_transcript_details"===e?S(e=>!e):"copy_transcript"===e&&((0,o.writeTranscriptToClipboard)(O),this.context.logUserAction("copy_transcript_click","right_sidebar"))},[O]),F=r.default.useCallback(()=>{R(!1)},[]);return N&&y?r.default.createElement(r.default.Fragment,null,r.default.createElement(a.TranscriptBlade,{intl:this.platform.intl,id:s.TRANSCRIPT_BLADE_PLUGIN_ID,onMenuSelection:M,transcript:b,showTranscriptionDetails:h},r.default.createElement(r.default.Suspense,{fallback:r.default.createElement(_.TranscriptProgressBar,{showLoadingMessage:!1})},r.default.createElement(m,{transcript:b,showTranscriptionDetails:h,permission:y,logUserAction:this.context.logUserAction,setIsTranscriptShowing:w.navigation.setIsTranscriptShowing}))),C&&k&&r.default.createElement(l.TranscriptSettingsModal,{intl:this.platform.intl,pluginNavigation:w.navigation,source:"right_sidebar",onClose:F,logUserAction:this.context.logUserAction})):null},Control:()=>{const e=this.context.getPluginData(),t=e.previewType===n.PreviewType.Video,i=t?e.file:null,l=null==i?void 0:i.transcript,c=this.context.sdkConfig,d=(0,o.getTranscriptPermission)(null==e?void 0:e.previewData);return t&&(0,o.shouldShowTranscriptUi)(l,d,c.video_transcription)?r.default.createElement(a.TranscriptBladeCollapsedBladeButton,{intl:this.platform.intl,id:s.TRANSCRIPT_BLADE_PLUGIN_ID}):null}},this.lifecycle={},this.platform=e,this.context=t,this.userId=f}}})),define("typescript/libraries/file-viewer/src/transcript_blade/transcript_blade.module.css",["require","exports","css!typescript/libraries/file-viewer/src/transcript_blade/transcript_blade.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showing=t.resumeAutoScrollButton=t.currentSearchMatch=t.transcriptCaptionText=t.transcriptSearchNavigatorWrapper=t.transcriptSearchMatchFoundText=t.transcriptProgressBar=t.transcriptProgressBarWrapper=t.transcriptLoadingScreen=t.transcriptErrorInfo=t.transcriptSegmentListContentWrapper=t.transcriptHeaderOptionMenuWrapper=t.transcriptHeaderBetaBadge=t.transcriptSearchWrapper=t.transcriptBladeContentWrapper=t.transcriptBlade=t.transcriptSearchHeight=t.minSegmentHeight=void 0,t.minSegmentHeight="42",t.transcriptSearchHeight="52",t.transcriptBlade="_transcriptBlade_jvlqx_10",t.transcriptBladeContentWrapper="_transcriptBladeContentWrapper_jvlqx_17",t.transcriptSearchWrapper="_transcriptSearchWrapper_jvlqx_22",t.transcriptHeaderBetaBadge="_transcriptHeaderBetaBadge_jvlqx_28",t.transcriptHeaderOptionMenuWrapper="_transcriptHeaderOptionMenuWrapper_jvlqx_32",t.transcriptSegmentListContentWrapper="_transcriptSegmentListContentWrapper_jvlqx_38",t.transcriptErrorInfo="_transcriptErrorInfo_jvlqx_45",t.transcriptLoadingScreen="_transcriptLoadingScreen_jvlqx_52",t.transcriptProgressBarWrapper="_transcriptProgressBarWrapper_jvlqx_63",t.transcriptProgressBar="_transcriptProgressBar_jvlqx_63",t.transcriptSearchMatchFoundText="_transcriptSearchMatchFoundText_jvlqx_83",t.transcriptSearchNavigatorWrapper="_transcriptSearchNavigatorWrapper_jvlqx_88",t.transcriptCaptionText="_transcriptCaptionText_jvlqx_93",t.currentSearchMatch="_currentSearchMatch_jvlqx_97",t.resumeAutoScrollButton="_resumeAutoScrollButton_jvlqx_101",t.showing="_showing_jvlqx_110";t.default={minSegmentHeight:"42",transcriptSearchHeight:"52",transcriptBlade:"_transcriptBlade_jvlqx_10",transcriptBladeContentWrapper:"_transcriptBladeContentWrapper_jvlqx_17",transcriptSearchWrapper:"_transcriptSearchWrapper_jvlqx_22",transcriptHeaderBetaBadge:"_transcriptHeaderBetaBadge_jvlqx_28",transcriptHeaderOptionMenuWrapper:"_transcriptHeaderOptionMenuWrapper_jvlqx_32",transcriptSegmentListContentWrapper:"_transcriptSegmentListContentWrapper_jvlqx_38",transcriptErrorInfo:"_transcriptErrorInfo_jvlqx_45",transcriptLoadingScreen:"_transcriptLoadingScreen_jvlqx_52",transcriptProgressBarWrapper:"_transcriptProgressBarWrapper_jvlqx_63",transcriptProgressBar:"_transcriptProgressBar_jvlqx_63",transcriptSearchMatchFoundText:"_transcriptSearchMatchFoundText_jvlqx_83",transcriptSearchNavigatorWrapper:"_transcriptSearchNavigatorWrapper_jvlqx_88",transcriptCaptionText:"_transcriptCaptionText_jvlqx_93",currentSearchMatch:"_currentSearchMatch_jvlqx_97",resumeAutoScrollButton:"_resumeAutoScrollButton_jvlqx_101",showing:"_showing_jvlqx_110"}})),define("typescript/libraries/file-viewer/src/watermarking/edit_plugin/loader",["require","exports","tslib","typescript/libraries/file-viewer/src/core/utils/paths","typescript/libraries/file-viewer/src/watermarking/utils"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeWatermarkLoader=t.WATER_MARKING_PLUGIN_ID=void 0,t.WATER_MARKING_PLUGIN_ID="water_marking";t.makeWatermarkLoader=(a,n)=>({pluginId:t.WATER_MARKING_PLUGIN_ID,isEnabled:e=>{const t=e.getPluginData().file;return!!t&&(0,s.isSupportedPreviewType)((0,r.getFileExtension)(t.name))},load:(t,r)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{makeStore:s}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/watermarking/plugin/redux/store"],t,i)}).then(i.__importStar),{WatermarkingPlugin:o}=yield new Promise((t,i)=>{e(["typescript/libraries/file-viewer/src/watermarking/edit_plugin/plugin"],t,i)}).then(i.__importStar),l=s({platformAdapter:t,logger:a,onWatermarkingSuccessHandler:n});return new o(t,r,l)}))})})),define("typescript/libraries/file-viewer/src/watermarking/utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupportedPreviewType=void 0;const i=[".pdf",".jpg",".jpeg",".png",".bmp"];t.isSupportedPreviewType=e=>i.includes(e)})),define("metaserver/static/js/comments2/data/mentions_api",["require","exports","tslib","lodash","metaserver/static/js/contacts/bloodhound_contacts_v2","metaserver/static/js/contacts/data_v2","metaserver/static/js/comments2/transforms"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mentionsApi=t.MentionsApiImpl=void 0,r=i.__importStar(r);class o{constructor(e,t=!1){this.cache={},this.filterContact=e=>{const t=!!e.group_id,i=!this.allowMentionSelf&&e.email===this.user.email;return!(t||i)},this.updateCache=(e,t,i)=>{let r;const s=t.map(n.contactToIMentionUser);if(i){r=[...this.cache[e]||[],...s]}else r=s;return this.cache=Object.assign(Object.assign({},this.cache),{[e]:r}),this.cache},this.user=e,this.allowMentionSelf=t,this.dataSource=new a.ContactsDataSourceV2(e,this.filterContact)}query(e,t,i){this.dataSource.search(e,i=>{t(this.updateCache(e,i,!1))},r=>{(i||t)(this.updateCache(e,r,!0))})}getMatchesWithStarterSuggestions(){const e=s.BloodhoundContactsV2.getAll(this.user).filter(this.filterContact).map(n.contactToIMentionUser),t=r.sortBy(e.slice(0,50),e=>e.name||e.email);return this.cache=Object.assign(Object.assign({},this.cache),{"":t}),this.cache}}t.MentionsApiImpl=o,t.mentionsApi=function(e,t){return e?new o(e,t):{cache:{},query:()=>{},getMatchesWithStarterSuggestions:()=>({})}}})),define("metaserver/static/js/comments2/transforms",["require","exports","tslib","metaserver/static/js/core/user_i18n"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contactToIMentionUser=t.sharingTextAndUsersToICommentContent=t.dbxUserToIUser=void 0,r=i.__importStar(r),t.dbxUserToIUser=function(e){return{id:e.account_id,name:{display:e.display_name,initials:r.getInitials(e.display_name),public:r.getShortName(e.display_name)},photoUrl:e.photo_circle_url}},t.sharingTextAndUsersToICommentContent=function(e,t){if(!t.length)return{metadata:[],text:e};const i=[],s=[];let a=0;for(const e of t){let t,n;"accountId"in e?(t=r.getShortName(e.displayName),n={type:"id",identifier:e.accountId}):(t=e.email,n={type:"email",identifier:e.email}),t&&(t="@"+t,i.push(t),s.push({location:{start:a,end:a+t.length},type:"mention",user:n}),a+=t.length+1)}return i.push(e),{text:i.join(" "),metadata:s}},t.contactToIMentionUser=function(e){return{id:e.dbx_account_id,email:e.email,name:{display:e.name,initials:r.getInitials(e.name),public:r.getShortName(e.name)},photoUrl:e.photo_url||e.avatar_url}}})),define("typescript/component_libraries/files_components/src/common/format_bytes",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBytes=t.SWITCH_UNIT_THRESHOLD=void 0,t.SWITCH_UNIT_THRESHOLD=900,t.formatBytes=function(e,i,r=2,s=!0,a=!0,n=!0){i=n?parseFloat(i):Math.max(0,parseFloat(i));const o=Math.abs(i);let l,c;return o<1024?(r=0,l=i,c=e.formatMessage({id:"se/5fs",defaultMessage:"{count, plural, one{byte} other{bytes}}"},{count:i}),s=!0):o<1024*t.SWITCH_UNIT_THRESHOLD?(l=i/1024,c=e.formatMessage({id:"fcOrPH",defaultMessage:"KB"})):o<1048576*t.SWITCH_UNIT_THRESHOLD?(l=i/1048576,c=e.formatMessage({id:"UFZYVH",defaultMessage:"MB"})):o<1073741824*t.SWITCH_UNIT_THRESHOLD||0===r&&i<1099511627776?(l=i/1073741824,c=e.formatMessage({id:"5nCO1R",defaultMessage:"GB"})):(l=i/1099511627776,c=e.formatMessage({id:"4rrpQj",defaultMessage:"TB"})),`${e.formatNumber(l,{maximumFractionDigits:r,minimumFractionDigits:a?0:r})}${s?" ":""}${c}`}})),define("metaserver/static/js/flows/approval/api",["require","exports","metaserver/static/js/api_v2/user_client"],(function(e,t,i){"use strict";function r(e,t,r,s,a,n){const o={file_id:t,comment:{content:n},thread_id:r,status:{".tag":s},approval_type:{".tag":a}};return(new i.UserApiV2Client).ns("flows").rpc("respond_to_approval",o,{subjectUserId:e})}function s(e,t,r,s,a){const n={file_id:t,comment_id:r,comment:{content:a},status:{".tag":s}};return(new i.UserApiV2Client).ns("flows").rpc("edit_approval",n,{subjectUserId:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.getSubmittedApprovalsCount=t.getFileApprovalStatus=t.deleteApprovalThread=t.deleteApproval=t.editApprovalRequest=t.editApprovalResponse=t.resubmitApprovalRequest=t.respondToApprovalRequest=t.createApproval=void 0,t.createApproval=function(e,t,r,s,a){const n={file_id:t,comment:{content:r},status:{".tag":"pending"},approvers:s,requires_all:a};return(new i.UserApiV2Client).ns("flows").rpc("create_approval",n,{subjectUserId:e})},t.respondToApprovalRequest=function(e,t,i,s,a){return r(e,t,i,s?"approved":"rejected","response",a)},t.resubmitApprovalRequest=function(e,t,i,s){return r(e,t,i,"pending","request",s)},t.editApprovalResponse=function(e,t,i,r,a){return s(e,t,i,r?"approved":"rejected",a)},t.editApprovalRequest=function(e,t,i,r){return s(e,t,i,"pending",r)},t.deleteApproval=function(e,t,r){const s={file_id:t,comment_id:r};return(new i.UserApiV2Client).ns("flows").rpc("delete_approval",s,{subjectUserId:e})},t.deleteApprovalThread=function(e,t,r){const s={file_id:t,comment_id:r};return(new i.UserApiV2Client).ns("flows").rpc("delete_approval_thread",s,{subjectUserId:e})},t.getFileApprovalStatus=function(e,t){const r={file_id:t};return(new i.UserApiV2Client).ns("flows").rpc("get_file_status",r,{subjectUserId:e})},t.getSubmittedApprovalsCount=function(e){return(new i.UserApiV2Client).ns("flows").rpc("get_submitted_approvals_count",{},{subjectUserId:e})}})),define("metaserver/static/js/flows/approval/approval_delete_modal",["require","exports","tslib","react","dig-components/modal","dig-components/typography","dig-components/buttons","metaserver/static/js/flows/approval/api","dig-components/form_row","react-intl","metaserver/static/js/flows/logging/approvals_logger"],(function(e,t,i,r,s,a,n,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApprovalDeleteThreadModal=t.ApprovalDeleteCommentModal=void 0,r=i.__importStar(r);const p=({open:e,title:t,body:i,onCancel:o,onDelete:c,error:d,isLoading:p})=>{const{closeButton:_,deleteButton:v,genericError:m}=u();return r.default.createElement(s.Modal,{open:e,onRequestClose:o},r.default.createElement(s.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(a.Title,null,t)),r.default.createElement(s.Modal.Body,null,r.default.createElement(a.Text,null,i),d&&r.default.createElement(l.FormHelperText,{isInvalid:!0},m)),r.default.createElement(s.Modal.Footer,null,r.default.createElement(n.Button,{variant:"opacity",onClick:o},_),r.default.createElement(n.Button,{variant:"primary",onClick:c,isLoading:p},v)))};p.displayName="ApprovalDeleteModal";t.ApprovalDeleteCommentModal=({userId:e,fileId:t,actor:i,onDeleteSuccess:s,commentId:a})=>{const[n,l]=(0,r.useState)(!1),[c,_]=(0,r.useState)(!0),[v,m]=(0,r.useState)(!1),{getDeleteCommentTitle:f,getDeleteCommentBody:g}=u();r.default.useEffect(()=>{d.PapLogger.logShownRemoveApprovalModal(t,"delete_comment_modal",a)},[]);const h=f(i),S=g(i);return h&&S?r.default.createElement(p,{open:c,onCancel:()=>{d.PapLogger.logRemoveApprovalCancelClick(t,"delete_comment_modal",a),_(!1)},onDelete:()=>{d.PapLogger.logRemoveApprovalConfirmClick(t,"delete_comment_modal",a),l(!1),m(!0),(0,o.deleteApproval)(e,t,a).then(()=>{s(),_(!1)}).catch(()=>{l(!0),m(!1)})},title:h,body:S,error:n,isLoading:v}):null},t.ApprovalDeleteCommentModal.displayName="ApprovalDeleteCommentModal";t.ApprovalDeleteThreadModal=({userId:e,fileId:t,threadId:i,onDeleteSuccess:s})=>{const[a,n]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!0),[_,v]=(0,r.useState)(!1),{deleteThreadTitle:m,deleteThreadBody:f}=u();r.default.useEffect(()=>{d.PapLogger.logShownRemoveApprovalModal(t,"delete_approval_modal",i)},[e,t,i]);return r.default.createElement(p,{open:l,onCancel:()=>{d.PapLogger.logRemoveApprovalCancelClick(t,"delete_approval_modal",i),c(!1)},onDelete:()=>{d.PapLogger.logRemoveApprovalConfirmClick(t,"delete_approval_modal",i),n(!1),v(!0),(0,o.deleteApprovalThread)(e,t,i).then(()=>{s(),c(!1)}).catch(()=>{n(!0),v(!1)})},title:m,body:f,error:a,isLoading:_})},t.ApprovalDeleteThreadModal.displayName="ApprovalDeleteThreadModal";const u=()=>{const e=(0,c.useIntl)();return{getDeleteCommentTitle:t=>"requester"===t?e.formatMessage({id:"l623DN",defaultMessage:"Delete your approval request?"}):"approver"===t?e.formatMessage({id:"a6tb8g",defaultMessage:"Delete your response?"}):null,getDeleteCommentBody:t=>"requester"===t?e.formatMessage({id:"o4wQ1b",defaultMessage:"Your request for approval on this file will be deleted. You’ll be able to start a new approval request."}):"approver"===t?e.formatMessage({id:"lTKaYp",defaultMessage:"Your response to the approval request on this file will be deleted. You’ll be able to submit a new response."}):null,closeButton:e.formatMessage({id:"67AKp5",defaultMessage:"Cancel"}),deleteButton:e.formatMessage({id:"sDOGa0",defaultMessage:"Delete"}),genericError:e.formatMessage({id:"cdCpqV",defaultMessage:"Something went wrong. Please try again later."}),deleteThreadTitle:e.formatMessage({id:"bJ6YI2",defaultMessage:"Remove approval request?"}),deleteThreadBody:e.formatMessage({id:"OtCoJc",defaultMessage:"Your request for approval on this file and all of its responses will be deleted. You can always initiate a new approval request."})}}})),define("metaserver/static/js/flows/approval/approval_io_client",["require","exports","tslib","metaserver/static/js/flows/utils/use_suggestions","metaserver/static/js/core/user_i18n","metaserver/static/js/flows/approval/api","metaserver/static/js/flows/approval/utils","metaserver/static/js/user_survey/user_survey","metaserver/static/js/logging/hive/schemas/web-approvals_feedback","metaserver/static/js/logging/telemetry","metaserver/static/js/flows/logging/approvals_logger","metaserver/static/js/file_viewer/sdk_file_viewer/experiments"],(function(e,t,i,r,s,a,n,o,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.approvalIOClient=void 0;const u=new((c=i.__importStar(c)).HiveLogger);t.approvalIOClient=e=>{const t=e=>{o.UserSurvey.trackEvent(e,"browse")};return{useSuggestions:t=>(0,r.useSuggestions)(e,t,!1,!0),getInitials:s.getInitials,createApproval(t,i,r,s){const n=r.map(e=>({email:e.email}));return(0,a.createApproval)(e,t,i,n,s)},respondToApprovalRequest:(t,i,r,s)=>(0,a.respondToApprovalRequest)(e,t,i,r,s),editApprovalResponse:(t,i,r,s)=>(0,a.editApprovalResponse)(e,t,i,r,s),showApprovalDeleteCommentModal(t,i,r,s){(0,n.launchApprovalDeleteCommentModal)(e,t,i,r,s)},editApprovalRequest:(t,i,r)=>(0,a.editApprovalRequest)(e,t,i,r),resubmitApprovalRequest:(t,i,r)=>(0,a.resubmitApprovalRequest)(e,t,i,r),showApprovalDeleteThreadModal(t,i,r){(0,n.launchApprovalDeleteThreadModal)(e,t,i,r)},triggerSprigSurvey(){return i.__awaiter(this,void 0,void 0,(function*(){const{num_requested_approvals:i}=yield(0,a.getSubmittedApprovalsCount)(e);1===i?t("approval_requested_one_time"):5===i?t("approval_requested_five_times"):25===i&&t("approval_requested_twenty_five_times")}))},trackUserSurveyEvent:t,logApprovalsFeedback(e,t){u.log(new l.ApprovalsFeedbackLoggingTableRow({is_feature_helpful:e,feedback:t}))},logger:d.PapLogger,getUserExperiments:()=>({flows_approval_flow_variant:p.fileViewerFlowExperiments.approvalFlowVariantByUserId[e],flows_approval_copy_experiment_variant:p.fileViewerFlowExperiments.approvalCopyVariantByUserId[e],flows_approval_flow_enabled:p.fileViewerFlowExperiments.approvalFlowByUserId[e]})}}})),define("metaserver/static/js/flows/approval/utils",["require","exports","tslib","react","metaserver/static/js/components/ui/modal","metaserver/static/js/core/i18n","react-intl","metaserver/static/js/flows/approval/approval_delete_modal"],(function(e,t,i,r,s,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchApprovalDeleteThreadModal=t.launchApprovalDeleteCommentModal=void 0,r=i.__importDefault(r),t.launchApprovalDeleteCommentModal=function(e,t,i,l,c){s.Modal.showInstance(r.default.createElement(n.RawIntlProvider,{value:a.intl},r.default.createElement(o.ApprovalDeleteCommentModal,{userId:e,fileId:t,commentId:i,actor:l,onDeleteSuccess:c})))},t.launchApprovalDeleteThreadModal=function(e,t,i,l){s.Modal.showInstance(r.default.createElement(n.RawIntlProvider,{value:a.intl},r.default.createElement(o.ApprovalDeleteThreadModal,{userId:e,fileId:t,threadId:i,onDeleteSuccess:l})))}})),define("metaserver/static/js/flows/logging/approvals_logger",["require","exports","tslib","metaserver/static/js/pap/analytics_client","metaserver/static/js/pap/util"],(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PapLogger=void 0;const a=(()=>{let t;return{getOrLoadPapEvents:()=>i.__awaiter(void 0,void 0,void 0,(function*(){return t||(t=yield new Promise((t,i)=>{e(["metaserver/static/js/flows/logging/approvals_logging_events"],t,i)}).then(i.__importStar)),t}))}})();function n(e,t){let i=void 0;switch(e){case"approved":i=(0,s.getEnumValueForString)("APPROVED_APPROVAL_STATUS",t);break;case"rejected":i=(0,s.getEnumValueForString)("REJECTED_APPROVAL_STATUS",t);break;case"pending":i=(0,s.getEnumValueForString)("PENDING_APPROVAL_STATE",t);break;case"other":i=(0,s.getEnumValueForString)("OTHER_APPROVAL_STATE",t)}return i}t.PapLogger={logRequestApprovalClick:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalButton.create({actionSurface:e,fileId:t,previewsSurface:s?s(i.Select_RequestApprovalButton.PreviewsSurface):void 0}))})),logShownRequestForm:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Shown_RequestApprovalForm({actionSurface:t,fileId:e}))})),logFocusApproverTypeahead:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalApproverInput({actionSurface:t,fileId:e}))})),logRequestFormCancelClick:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalFormCancelButton({actionSurface:t,fileId:e}))})),logAddApprover:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalApprover({actionSurface:t,fileId:e,approverId:s}))})),logSubmitApprovalRequest:e=>i.__awaiter(void 0,void 0,void 0,(function*(){const t=yield a.getOrLoadPapEvents();(0,r.logEvent)(t.Initiate_RequestApproval(e))})),logSubmitApprovalSuccess:(e,t,s,n,o,l,c)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Succeed_RequestApproval({actionSurface:t,threadId:c,fileId:e,approvalDetailsLength:s,approvers:n,requiresAll:o,numApprovers:l}))})),logSubmitApprovalFailure:e=>i.__awaiter(void 0,void 0,void 0,(function*(){const t=yield a.getOrLoadPapEvents();let i=void 0;switch(e.errorReason){case"user_not_found":i=(0,s.getEnumValueForString)("USER_NOT_FOUND_REQUEST_APPROVAL_ERROR_REASON",t.Fail_RequestApproval.RequestApprovalErrorReason);break;default:i=(0,s.getEnumValueForString)("UNKNOWN_REQUEST_APPROVAL_ERROR_REASON",t.Fail_RequestApproval.RequestApprovalErrorReason)}(0,r.logEvent)(t.Fail_RequestApproval.create({actionSurface:e.actionSurface,fileId:e.fileId,requestApprovalErrorReason:i}))})),logApproverOptionsClick:(e,t,s="request_approval_form")=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalApproverOption({actionSurface:s,fileId:e,requiresAll:t}))})),logRespondClick:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RespondApprovalButton({actionSurface:"respond_approval_form",threadId:t,fileId:e}))})),logShownRespondForm:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Shown_RespondApprovalForm({actionSurface:"respond_approval_form",threadId:t,fileId:e}))})),logApproveChipClick:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();s?(0,r.logEvent)(i.Select_RespondApprovalApproveButton({actionSurface:"respond_approval_form",threadId:t,fileId:e})):(0,r.logEvent)(i.Select_RespondApprovalRejectButton({actionSurface:"respond_approval_form",threadId:t,fileId:e}))})),logRespondFormCancelClick:e=>i.__awaiter(void 0,void 0,void 0,(function*(){const t=yield a.getOrLoadPapEvents();(0,r.logEvent)(t.Select_RespondApprovalFormCancelButton({actionSurface:"respond_approval_form",fileId:e}))})),logSubmitResponseSuccess:(e,t,s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Succeed_RespondApproval.create({actionSurface:"respond_approval_form",threadId:s,fileId:t,approvalStatus:n(e,i.Succeed_RespondApproval.ApprovalStatus),approvalDetailsLength:o}))})),logResubmitRequestClick:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_ResubmitApprovalButton({actionSurface:"respond_approval_form",threadId:t,fileId:e}))})),logResubmitRequestSuccess:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Succeed_ResubmitRequestApproval({actionSurface:"respond_approval_form",fileId:e,threadId:t,approvalDetailsLength:s}))})),logShownRemoveApprovalModal:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Shown_RemoveApprovalModal({actionSurface:t,fileId:e,commentId:s}))})),logRemoveApprovalConfirmClick:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RemoveApprovalConfirmButton({actionSurface:t,fileId:e,commentId:s}))})),logRemoveApprovalCancelClick:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RemoveApprovalCancelButton({actionSurface:t,fileId:e,commentId:s}))})),logEditApprovalResponseClick:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RespondApprovalEditButton({actionSurface:"respond_approval_form",fileId:e,threadId:t}))})),logEditApprovalRequestClick:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Select_RequestApprovalEditButton({actionSurface:"request_approval_form",fileId:e,threadId:t}))})),logApprovalResponseResubmitSuccess:(e,t,s,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Succeed_ResubmitRespondApproval.create({actionSurface:"respond_approval_form",fileId:e,threadId:t,approvalStatus:n(s,i.Succeed_RespondApproval.ApprovalStatus),approvalDetailsLength:o}))})),logEditApprovalRequestSuccess:(e,t,s)=>i.__awaiter(void 0,void 0,void 0,(function*(){const i=yield a.getOrLoadPapEvents();(0,r.logEvent)(i.Succeed_RequestApprovalEdit.create({actionSurface:"request_approval_form",fileId:e,threadId:s,approvalDetailsLength:t}))})),logShownApprovalPostPdfEditingToast:e=>i.__awaiter(void 0,void 0,void 0,(function*(){const t=yield a.getOrLoadPapEvents();(0,r.logEvent)(t.Shown_ApprovalPostPdfEditingToast({fileId:e}))}))}})),define("metaserver/static/js/flows/utils/use_suggestions",["require","exports","tslib","react","typescript/component_libraries/flows/src/components/contact-typeahead/index","metaserver/static/js/contacts/data_v2","metaserver/static/js/contacts/types","metaserver/static/js/clean/viewer"],(function(e,t,i,r,s,a,n,o){"use strict";function l(e,t,i,r=!1,a=!1){if(!i)return[];const o=new Set;for(const e of t)o.add((0,s.getContactKey)(e));const l=[];for(const t of i)if(t.email&&(t.type===n.default.DBX_ID||t.type===n.default.EMAIL)){if(a&&t.email===e.email)continue;if(r&&(!t.dbx_account_id||!t.dbx_team_id||t.dbx_team_id!==e.team_dbtid))continue;const i={name:t.name,email:t.email,avatarUrl:t.photo_url,dbx_account_id:t.dbx_account_id};o.has((0,s.getContactKey)(i))||l.push(i)}return l}Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestions=void 0,n=i.__importDefault(n),t.useSuggestions=function(e,t,i=!1,s=!1){const[n,c]=(0,r.useState)(""),[d,p]=(0,r.useState)([]),u=o.Viewer.get_viewer().get_user_by_id(e),_=new a.ContactsDataSourceV2(u);return(0,r.useEffect)(()=>{let e=!1;const r=[];if(!n.length)return void p(r);return _.search(n,e=>{const a=l(u,t,e,i,s);r.push(...a),p(r)},a=>{const n=l(u,t,a,i,s);!e&&n.length>0&&(r.push(...n),p(r))}),()=>{e=!0}},[n,t]),{suggestions:d,onQueryChange:e=>{c(e)}}}})),define("metaserver/static/js/logging/hive/schemas/web-approvals_feedback",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApprovalsFeedbackLoggingTableRow=void 0;t.ApprovalsFeedbackLoggingTableRow=class{constructor(e){this.category="web-approvals_feedback",this.user_id=null,this.is_feature_helpful=e.is_feature_helpful,this.feedback=e.feedback,this.timestamp=Date.now(),Object.seal(this)}}})),define("typescript/component_libraries/flows/src/components/contact-typeahead/index",["require","exports","tslib","react","dig-components/typeahead","dig-components/text_fields","dig-components/form_row","dig-components/chips","dig-components/avatar","react-intl","dig-components/typography","dig-components/tooltips"],(function(e,t,i,r,s,a,n,o,l,c,d,p){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0}),t.TypeaheadEmailSuggestion=t.TypeaheadSuggestion=t.ContactTypeahead=t.getContactKey=t.ValidationResult=void 0,r=i.__importStar(r),(function(e){e.OK="OK",e.DUPLICATE="DUPLICATE",e.INVALID="INVALID",e.OVER_RECIPIENTS_LIMIT="OVER_RECIPIENTS_LIMIT"})(u=t.ValidationResult||(t.ValidationResult={})),t.getContactKey=function(e){return`CONTACT-${e.email}`};const _=/[ ,]+/,v=/^['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}$/i;t.ContactTypeahead=e=>{const[i,c]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[h,S]=(0,r.useState)(!1),[w,E]=(0,r.useState)(!1),I=(0,r.useRef)(null),{noMatches:P,selectFromSuggestionErrMsg:A}=m();(0,r.useEffect)(()=>{e.recipients.length>e.recipientNumLimit?S(!0):S(!1),e.recipients.length>0&&e.recipients.filter(e=>e.validationResult!==u.OK).length>0?g(!0):g(!1)},[e.recipients,e.recipientNumLimit]);const b=t=>{const i=e.recipients.filter(e=>e.email!==t.email);e.onRecipientsChange(i)},O=t=>{if(e.recipients.length>e.recipientNumLimit)return u.OVER_RECIPIENTS_LIMIT;return e.recipients.find(e=>t.email===e.email)?u.DUPLICATE:v.test(t.email)?u.OK:u.INVALID},y=(t,i,r)=>{if(e.onQueryChange(""),c(""),!t)return!1;if(!t&&!r)return!1;const s=t?[t]:r.split(_).filter(Boolean).map(e=>({email:e})),a={},n=[...e.recipients];for(const e of s){if(e.email in a)continue;const t=O(e);if(t===u.OVER_RECIPIENTS_LIMIT)break;t!==u.DUPLICATE&&(a[e.email]=null,e.validationResult=t,n.push(e))}return n.length>e.recipients.length&&e.onRecipientsChange(n),0===n.filter(e=>e.validationResult!==u.OK).length},T=t=>{y(t,0,i),e.onTypeAheadSelection&&e.onTypeAheadSelection(t)},C=t=>{const i=t.currentTarget.value;c(i),e.onQueryChange(i)},R=t=>{if(8===t.keyCode&&""===i&&e.recipients.length>0&&b(e.recipients[e.recipients.length-1]),(9==t.keyCode||13===t.keyCode)&&""!==i){let t=null;e.suggestions.length>0?t=e.suggestions[0]:v.test(i)&&(t={email:i}),y(t,0,i)}},D=()=>{e.onFocus&&e.onFocus(),E(!0)},k="flows-typeahead__input",N=e.recipients.length>=e.recipientNumLimit,L=()=>r.default.createElement(s.Typeahead.Wrapper,{onSelection:T},({getTriggerProps:c,getContentProps:d})=>r.default.createElement(r.default.Fragment,null,r.default.createElement(a.TextInput.Container,{isInvalid:f||h||!w&&!!i,ref:I},r.default.createElement(a.TextInput.ChipsContainer,null,!!e.recipients.length&&e.recipients.map((e,t)=>r.default.createElement(o.InputChip,{key:t,size:"small",isAlert:e.validationResult!==u.OK,onDelete:()=>b(e),withAvatarLeft:e.avatarUrl&&r.default.createElement(l.Avatar,{hasNoOutline:!0,size:"xsmall",src:e.avatarUrl})},e.name||e.email)),r.default.createElement(a.TextInput.Input,Object.assign({autoFocus:!0,id:k,placeholder:N?void 0:e.placeholder,"aria-label":e.placeholder,value:i},c({onChange:C,onKeyDown:R}),{disabled:N,onBlur:()=>E(!1),onFocus:D,style:{fontSize:"12px"},autoComplete:"off"})))),!w&&i&&r.default.createElement(n.FormHelperText,{isInvalid:!0},A),r.default.createElement(s.Typeahead.Container,Object.assign({},d(),{triggerRef:{current:I.current},isEmptyQuery:Boolean(i)&&0==e.suggestions.length&&!v.test(i),emptyPrompt:r.default.createElement(s.Typeahead.EmptyPrompt,{placeholderText:P}),onBlur:()=>E(!1),onFocus:()=>E(!0)}),e.suggestions.length>0?r.default.createElement(s.Typeahead.Results,{results:e.suggestions,renderRow:e.renderTypeaheadSuggestion}):Boolean(i)&&r.default.createElement(s.Typeahead.Results,{results:[{email:i}],renderRow:e=>r.default.createElement(t.TypeaheadEmailSuggestion,{suggestion:e})}))));return r.default.createElement(r.default.Fragment,null,e.label&&r.default.createElement(n.FormLabel,{htmlFor:k},r.default.createElement(d.Text,{isBold:!0,size:"small",tagName:"label"},e.label),e.labelSubtext),N&&e.maxNumTooltip?r.default.createElement(p.Tooltip,{title:e.maxNumTooltip},r.default.createElement("span",{style:{display:"inline-block",width:"100%"},tabIndex:0},L())):L())},t.ContactTypeahead.displayName="ContactTypeahead";t.TypeaheadSuggestion=({suggestion:e,getInitials:t})=>{const i=t(e.name||e.email);return r.default.createElement(s.Typeahead.Row,{key:e.email,value:e,withTitle:e.name,withSubtitle:e.email,withLeftAccessory:r.default.createElement(l.Avatar,{src:e.avatarUrl,backgroundColor:(0,l.avatarColorForUserIdentifier)(i),hasNoOutline:!0},i),onKeyDown:e=>{e.nativeEvent.stopImmediatePropagation()}})},t.TypeaheadSuggestion.displayName="TypeaheadSuggestion";function m(){const e=(0,c.useIntl)();return{noMatches:e.formatMessage({id:"T2ynaE",defaultMessage:"No matches"}),selectFromSuggestionErrMsg:e.formatMessage({id:"4gphPK",defaultMessage:"Please select an assignee"}),inviteEmailMsg:t=>e.formatMessage({id:"E9a3yV",defaultMessage:"Invite {email}"},{email:t})}}t.TypeaheadEmailSuggestion=({suggestion:e})=>{const{inviteEmailMsg:t}=m();return r.default.createElement(s.Typeahead.Row,{key:e.email,value:e,withTitle:t(e.email)})},t.TypeaheadEmailSuggestion.displayName="TypeaheadEmailSuggestion"})),define("metaserver/static/js/open_in_app/types",["require","exports","typescript/dropbox/proto/js_init_data/sharing/open_in_app_urls_pb"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areUrlsAndroid=t.areUrlsIOS=t.OpenInMobileAppPlatform=void 0,t.OpenInMobileAppPlatform=i.OpenInMobileAppPlatform,t.areUrlsIOS=function(e){return e.platform===t.OpenInMobileAppPlatform.IPAD||e.platform===t.OpenInMobileAppPlatform.IPHONE},t.areUrlsAndroid=function(e){return e.platform===t.OpenInMobileAppPlatform.ANDROID_MARKET}})),define("typescript/dropbox/proto/js_init_data/sharing/open_in_app_urls_pb",["require","exports","@bufbuild/protobuf"],(function(e,t,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AndroidOpenInAppUrls=t.IOSOpenInAppUrls=t.OpenInMobileAppPlatform=void 0,(function(e){e[e.UNUSED=0]="UNUSED",e[e.UNSUPPORTED=1]="UNSUPPORTED",e[e.IPHONE=2]="IPHONE",e[e.ANDROID_MARKET=3]="ANDROID_MARKET",e[e.IPAD=4]="IPAD"})(r=t.OpenInMobileAppPlatform||(t.OpenInMobileAppPlatform={})),i.proto3.util.setEnumType(r,"open_in_app_urls.OpenInMobileAppPlatform",[{no:0,name:"UNUSED"},{no:1,name:"UNSUPPORTED"},{no:2,name:"IPHONE"},{no:3,name:"ANDROID_MARKET"},{no:4,name:"IPAD"}]);class s extends i.Message{constructor(e){super(),this.platform=r.UNUSED,this.iOSAppUrl="",this.iOSAppStoreUrl="",i.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new s).fromBinary(e,t)}static fromJson(e,t){return(new s).fromJson(e,t)}static fromJsonString(e,t){return(new s).fromJsonString(e,t)}static equals(e,t){return i.proto3.util.equals(s,e,t)}}t.IOSOpenInAppUrls=s,s.runtime=i.proto3,s.typeName="open_in_app_urls.IOSOpenInAppUrls",s.fields=i.proto3.util.newFieldList(()=>[{no:1,name:"platform",kind:"enum",T:i.proto3.getEnumType(r)},{no:2,name:"iOS_app_url",kind:"scalar",T:9},{no:3,name:"iOS_app_store_url",kind:"scalar",T:9}]);class a extends i.Message{constructor(e){super(),this.platform=r.UNUSED,this.androidAppUrl="",i.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new a).fromBinary(e,t)}static fromJson(e,t){return(new a).fromJson(e,t)}static fromJsonString(e,t){return(new a).fromJsonString(e,t)}static equals(e,t){return i.proto3.util.equals(a,e,t)}}t.AndroidOpenInAppUrls=a,a.runtime=i.proto3,a.typeName="open_in_app_urls.AndroidOpenInAppUrls",a.fields=i.proto3.util.newFieldList(()=>[{no:1,name:"platform",kind:"enum",T:i.proto3.getEnumType(r)},{no:2,name:"android_app_url",kind:"scalar",T:9}])})),define("typescript/dropbox/proto/js_init_data/file_viewer/experiments_pb",["require","exports","@bufbuild/protobuf"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileViewerFlowExperiments=t.FileViewerFeatureExperiments=t.FileViewerConfiguration=void 0;class r extends i.Message{constructor(e){super(),this.wopiButtonVisible=!1,this.watermarkingByUserId={},this.watermarkTrialVariantByUserId={},i.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new r).fromBinary(e,t)}static fromJson(e,t){return(new r).fromJson(e,t)}static fromJsonString(e,t){return(new r).fromJsonString(e,t)}static equals(e,t){return i.proto3.util.equals(r,e,t)}}t.FileViewerConfiguration=r,r.runtime=i.proto3,r.typeName="file_viewer.FileViewerConfiguration",r.fields=i.proto3.util.newFieldList(()=>[{no:4,name:"wopi_button_visible",kind:"scalar",T:8},{no:6,name:"watermarking_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:8}},{no:7,name:"watermark_trial_variant_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:9}}]);class s extends i.Message{constructor(e){super(),this.partialPrewarmAllowed=!1,this.fvsdkAxAnnotations=!1,this.enableFvsdkPdfEditor="",this.enableFvsdkDynamicActions=!1,this.fvsdkExcel2Phase="",this.enableAddToCollection=!1,this.fvsdkTtiAaExperiment="",this.fvsdkExcelMsEmbedPhase="",this.tagsSectionVariant="",this.dragSectionAnnotation=!1,this.docsendAnalyticsAddOn="",this.btSignaturesActionbarDropdown="",this.imgSizeOptimization=!1,this.enableAssignedTasksPlugin=!1,this.initialVideoBandwidth="",this.fvsdkVideoEditing="",this.fvsdkSlowConnectionBanner=!1,this.replayPreviewsPermanentEntrypoint="",this.videoTranscription="",this.captureSdkIntegrationSharing=!1,this.captureSdkIntegrationSharingVariant="",this.campaignsDownloadSisu=!1,this.publishPreviewsPaintedDoorEntrypoint="",this.fvsdkVideoCrop="",this.campaignsLoggedOutSignUpTooltip="",this.loggedOutAcquisitionSaveAs="",this.googleOneTapVariant="",this.capturePreviewCommentRecording="",this.publishPreviewsPermanentEntrypoint="",this.saveAsForFileShmodels="",this.captureSdkIntegrationVoiceOversVariant="",this.fvsdkVhsOverrideNativeHlsVideo=!1,this.captureSdkIntegrationVoiceOversViewButton="",i.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new s).fromBinary(e,t)}static fromJson(e,t){return(new s).fromJson(e,t)}static fromJsonString(e,t){return(new s).fromJsonString(e,t)}static equals(e,t){return i.proto3.util.equals(s,e,t)}}t.FileViewerFeatureExperiments=s,s.runtime=i.proto3,s.typeName="file_viewer.FileViewerFeatureExperiments",s.fields=i.proto3.util.newFieldList(()=>[{no:1,name:"partial_prewarm_allowed",kind:"scalar",T:8},{no:5,name:"fvsdk_ax_annotations",kind:"scalar",T:8},{no:10,name:"enable_fvsdk_pdf_editor",kind:"scalar",T:9},{no:17,name:"enable_fvsdk_dynamic_actions",kind:"scalar",T:8},{no:20,name:"fvsdk_excel2_phase",kind:"scalar",T:9},{no:23,name:"enable_add_to_collection",kind:"scalar",T:8},{no:24,name:"fvsdk_tti_aa_experiment",kind:"scalar",T:9},{no:29,name:"fvsdk_excel_ms_embed_phase",kind:"scalar",T:9},{no:33,name:"tags_section_variant",kind:"scalar",T:9},{no:38,name:"drag_section_annotation",kind:"scalar",T:8},{no:39,name:"docsend_analytics_add_on",kind:"scalar",T:9},{no:45,name:"bt_signatures_actionbar_dropdown",kind:"scalar",T:9},{no:46,name:"img_size_optimization",kind:"scalar",T:8},{no:47,name:"enable_assigned_tasks_plugin",kind:"scalar",T:8},{no:50,name:"initial_video_bandwidth",kind:"scalar",T:9},{no:51,name:"fvsdk_video_editing",kind:"scalar",T:9},{no:52,name:"fvsdk_slow_connection_banner",kind:"scalar",T:8},{no:54,name:"replay_previews_permanent_entrypoint",kind:"scalar",T:9},{no:55,name:"video_transcription",kind:"scalar",T:9},{no:56,name:"capture_sdk_integration_sharing",kind:"scalar",T:8},{no:60,name:"capture_sdk_integration_sharing_variant",kind:"scalar",T:9},{no:65,name:"campaigns_download_sisu",kind:"scalar",T:8},{no:66,name:"publish_previews_painted_door_entrypoint",kind:"scalar",T:9},{no:67,name:"fvsdk_video_crop",kind:"scalar",T:9},{no:69,name:"campaigns_logged_out_sign_up_tooltip",kind:"scalar",T:9},{no:70,name:"logged_out_acquisition_save_as",kind:"scalar",T:9},{no:71,name:"google_one_tap_variant",kind:"scalar",T:9},{no:72,name:"capture_preview_comment_recording",kind:"scalar",T:9},{no:73,name:"publish_previews_permanent_entrypoint",kind:"scalar",T:9},{no:74,name:"save_as_for_file_shmodels",kind:"scalar",T:9},{no:75,name:"capture_sdk_integration_voice_overs_variant",kind:"scalar",T:9},{no:76,name:"fvsdk_vhs_override_native_hls_video",kind:"scalar",T:8},{no:77,name:"capture_sdk_integration_voice_overs_view_button",kind:"scalar",T:9}]);class a extends i.Message{constructor(e){super(),this.manualVideoGifByUserId={},this.approvalFlowByUserId={},this.approvalFlowVariantByUserId={},this.flowsApprovalInShareModalEnabled=!1,this.versioningFlowVariantByUserId={},this.approvalAndVersioningNewBadgeByUserId={},this.approvalCopyVariantByUserId={},this.approvalPdfEditingToastByUserId={},i.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new a).fromBinary(e,t)}static fromJson(e,t){return(new a).fromJson(e,t)}static fromJsonString(e,t){return(new a).fromJsonString(e,t)}static equals(e,t){return i.proto3.util.equals(a,e,t)}}t.FileViewerFlowExperiments=a,a.runtime=i.proto3,a.typeName="file_viewer.FileViewerFlowExperiments",a.fields=i.proto3.util.newFieldList(()=>[{no:4,name:"manual_video_gif_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:8}},{no:8,name:"approval_flow_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:8}},{no:9,name:"approval_flow_variant_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:9}},{no:11,name:"flows_approval_in_share_modal_enabled",kind:"scalar",T:8},{no:14,name:"versioning_flow_variant_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:9}},{no:15,name:"approval_and_versioning_new_badge_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:9}},{no:16,name:"approval_copy_variant_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:9}},{no:17,name:"approval_pdf_editing_toast_by_user_id",kind:"map",K:3,V:{kind:"scalar",T:8}}])})),define("metaserver/static/js/file_viewer/sdk_file_viewer/experiments",["require","exports","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/file_viewer_flows_experiments","typescript/dropbox/proto/js_init_data/file_viewer/experiments_pb","js/proto_utils/unpack"],(function(e,t,i,r,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileViewerFlowExperiments=t.fileViewerFeatureExperiments=t.fileViewerConfiguration=void 0,t.fileViewerConfiguration=(0,n.unmarshalProto)(i.proto,a.FileViewerConfiguration),t.fileViewerFeatureExperiments=(0,n.unmarshalProto)(r.proto,a.FileViewerFeatureExperiments),t.fileViewerFlowExperiments=(0,n.unmarshalProto)(s.proto,a.FileViewerFlowExperiments)})),define("metaserver/static/js/open_in_app/actions",["require","exports","tslib","metaserver/static/js/open_in_app/types","metaserver/static/js/clean/open_in_mobile_app"],(function(e,t,i,r,s){"use strict";function a(){const e=(navigator.userAgent||"").match(/OS (\d+)_(\d+)_?(\d+)?/);return!e||parseInt(e[1],10)>=9}Object.defineProperty(t,"__esModule",{value:!0}),t.cleanUp=t.openImmediately=t.openInApp=t.isIOS9OrHigher=void 0,s=i.__importStar(s),t.isIOS9OrHigher=a,t.openInApp=function(e){(0,r.areUrlsIOS)(e)?s.open_ios(e.iOSAppUrl,e.iOSAppStoreUrl,a()):(0,r.areUrlsAndroid)(e)&&s.open_android_intent(e.androidAppUrl)},t.openImmediately=function(e){let t;if((0,r.areUrlsIOS)(e))t=e.iOSAppUrl;else{if(!(0,r.areUrlsAndroid)(e))return;t=e.androidAppUrl}const i=document.createElement("iframe");i.setAttribute("class","open-in-app-transport"),i.setAttribute("src",t),i.setAttribute("style","display: none"),document.body.appendChild(i)},t.cleanUp=function(){s.cleanup()}})),define("metaserver/static/js/open_in_app/ui/banner",["require","exports","tslib","react","metaserver/static/js/open_in_app/actions","metaserver/static/js/open_in_app/types","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/core/browser_detection","metaserver/static/js/clean/open_in_mobile_app","dig-components/icons","dig-components/icons/src","dig-components/buttons","dig-components/banner","metaserver/static/js/open_in_app/ui/banner.module.css","dig-components/icons/src"],(function(e,t,i,r,s,a,n,o,l,c,d,p,u,_,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenInAppBanner=void 0,r=i.__importStar(r),o=i.__importStar(o),l=i.__importStar(l),v=i.__importStar(v);t.OpenInAppBanner=e=>{const{onClick:t,onClose:i,urls:f,isMountedFile:g}=e,[h,S]=(0,r.useState)(!1);r.default.useEffect(()=>s.cleanUp,[]);const w=(0,r.useCallback)(()=>{S(!0),null==i||i()},[i]),E=(0,r.useCallback)(()=>{null==t||t(),g&&(null==f?void 0:f.platform)===a.OpenInMobileAppPlatform.ANDROID_MARKET?o.redirect(f.androidAppUrl):(0,s.openInApp)(f)},[t,g,f]);return h||!f?null:l.iOS&&(0,s.isIOS9OrHigher)()?r.default.createElement(_.Banner,{type:"attention",withLeftIcon:!1,withCloseButton:"Close",onRequestClose:w},r.default.createElement(_.Banner.Message,null,n.intl.formatMessage({id:"eNdtXI",defaultMessage:"Browse files faster in the Dropbox app"})),r.default.createElement(_.Banner.Actions,null,r.default.createElement(u.Button,{onClick:E,variant:"outline",withIconLeft:r.default.createElement(d.UIIcon,{src:m.DropboxLine})},n.intl.formatMessage({id:"/239AG",defaultMessage:"Open in App"})))):r.default.createElement("div",{className:v.banner},r.default.createElement("div",{className:v.textContainer},r.default.createElement(u.Button,{onClick:E,variant:"transparent",hasNoUnderline:!0},g&&f.platform===a.OpenInMobileAppPlatform.ANDROID_MARKET?n.intl.formatMessage({id:"gxO/+x",defaultMessage:"Open App"}):n.intl.formatMessage({id:"pezXnL",defaultMessage:"View In App"})),r.default.createElement(c.CopyUrlLabelText,{className:v.copyNotification,color:"standard",size:"small"})),r.default.createElement(u.IconButton,{variant:"transparent",className:v.closeButton,size:"large","aria-label":n.intl.formatMessage({id:"LwqLT7",defaultMessage:"Close"}),onClick:w},r.default.createElement(d.UIIcon,{src:p.CloseLine})))},t.OpenInAppBanner.displayName="OpenInAppBanner"})),define("metaserver/static/js/open_in_app/ui/banner.module.css",["require","exports","css!metaserver/static/js/open_in_app/ui/banner.module.out.css"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeButton=t.copyNotification=t.textContainer=t.banner=void 0,t.banner="_banner_1qu5f_1",t.textContainer="_text-container_1qu5f_9",t.copyNotification="_copy-notification_1qu5f_14",t.closeButton="_close-button_1qu5f_18";t.default={banner:"_banner_1qu5f_1",textContainer:"_text-container_1qu5f_9",copyNotification:"_copy-notification_1qu5f_14",closeButton:"_close-button_1qu5f_18"}}));
//# sourceMappingURL=pkg-file-viewer-container.min.js-vflk00i8E.map