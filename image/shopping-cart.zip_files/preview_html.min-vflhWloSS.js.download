define(["require","exports","tslib","react","classnames","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/preview_html/preview-html.module.css","typescript/libraries/file-viewer/src/preview_core.module.css","typescript/libraries/file-viewer/src/preview_html/types","typescript/libraries/file-viewer/src/libraries/frame_messenger/html_frame_messenger_host","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/hooks/useStabilizedCallback","typescript/libraries/file-viewer/src/core/utils/paths","ts-keycode-enum","typescript/libraries/file-viewer/src/toolbar/toolbar_actions","react-redux","typescript/libraries/file-viewer/src/hooks/selectors"],(function(e,r,t,i,a,s,l,c,n,o,d,u,p,_,m,v,f){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PreviewHTML=void 0,i=t.__importStar(i),a=t.__importDefault(a),l=t.__importStar(l),c=t.__importStar(c);const y={[_.Key.RightArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.LeftArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.Backspace]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.Delete]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.Escape]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.F]:{altKey:!0,ctrlKey:!0,metaKey:!0}},w=[".xlsx"];r.PreviewHTML=e=>{var r;const{fileConfig:t,isRawHtml:_,onSetPreviewLoaded:b,iframeSrc:C,iframeSandbox:K,fileViewerId:E,previewKey:I}=e,S=(0,v.useDispatch)(),{fileMetadata:M,previewMetadata:T}=null!==(r=(0,f.usePreviewState)(E,I,()=>({}),e=>e))&&void 0!==r?r:{},O=null!=C?C:T&&T.preview_url,L=M&&M.file_name,D=i.useRef(),h=r=>{var t;if((e=>n.ACTIONS_FROM_CHILD_IFRAME.includes(e.action))(r))switch(r.action){case n.FROM_CHILD_ACTIONS.FAILED:e.onRenderFailed();break;case n.FROM_CHILD_ACTIONS.VIEWER_READY:e.onInteractive(),e.onRenderSucceeded();break;case n.FROM_CHILD_ACTIONS.KEYDOWN_KEYS:null===(t=D.current)||void 0===t||t.postMessageToChildren(n.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:y});break;case n.FROM_CHILD_ACTIONS.KEYDOWN:const i=new KeyboardEvent("keydown",r.parameters);document.dispatchEvent(i);break;case n.FROM_CHILD_ACTIONS.ACTIVE_MOUSE:window.dispatchEvent(new MouseEvent("mousemove"))}},N=i.useRef(null);i.useEffect(()=>{M&&(null===N.current||N.current!==M.file_name)&&w.includes((0,p.getFileExtension)(M.file_name))&&(S((0,d.triggerDynamicRoutingModalCheck)()),N.current=M.file_name)},[S,M]),i.useEffect(()=>{if(!_)return D.current=new o.HTMLFrameMessengerHost([]),D.current.configureChildMessaging("iframe.previewhtml",h,n.ACTIONS_FROM_CHILD_IFRAME),D.current.startListening(),D.current.postMessageToChildren(n.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:[]}),()=>{var e;null===(e=D.current)||void 0===e||e.stopListening()}},[]),i.useEffect(()=>{null==b||b()},[b]);const R=(0,u.useStabilizedCallback)(()=>{e.onRenderFailed()}),g=(0,u.useStabilizedCallback)(()=>{_&&(e.onInteractive(),e.onRenderSucceeded())}),A=(0,u.useStabilizedCallback)(()=>{var e;null===(e=D.current)||void 0===e||e.postMessageToChildren(n.TO_CHILD_ACTIONS.PRINT,{context:s.UserActionContext.Toolbar})}),{setPrintCallback:H}=(0,m.useToolbarAction)();i.useEffect(()=>(null==H||H(A),()=>{null==H||H(void 0)}),[A]);const k=null!=K?K:t.enable_print?"allow-modals allow-scripts":"allow-scripts";return i.createElement("div",{className:(0,a.default)(l.app,c.app)},i.createElement("iframe",{title:L,onError:R,name:"preview-content",src:O,sandbox:k,className:(0,a.default)("previewhtml",l.previewContent),onLoad:g,"data-testid":"fvsdk_html_iframe"}))},r.PreviewHTML.displayName="PreviewHTML",r.PreviewHTML.displayName="PreviewHTML"}));
//# sourceMappingURL=preview_html.min.js-vfldRb3eb.map