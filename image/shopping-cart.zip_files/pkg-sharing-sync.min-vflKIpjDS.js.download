define("metaserver/static/js/upsell/home_inline_location",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","typescript/component_libraries/retrieval-components/src/collapsable-section/index","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/api_v2/user_client","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/core/persistence/storage","metaserver/static/js/upsell/prompt_event_emitter"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.HomeInlineContentPromptUI=t.HomeInlineContentPrompt=t.initPrefetchHomeInlineContentPrompt=void 0,s=a.__importDefault(s),r=a.__importDefault(r),l=a.__importStar(l);t.initPrefetchHomeInlineContentPrompt=()=>{};class m extends r.default.PureComponent{constructor(e){super(e),this.state={promptData:null}}listenForPromptData(){p.promptBufferedEventEmitter.on(p.Events.ON_HOME_INLINE_CONTENT_LOADED,e=>{this.setState({promptData:e})})}componentDidMount(){this.listenForPromptData()}render(){const{canRenderItems:e,isOnBrowse:t}=this.props,{promptData:a}=this.state;return e&&a?r.default.createElement(g,Object.assign({isOnBrowse:t},a)):null}}t.HomeInlineContentPrompt=m,m.displayName="HomeInlineContentPrompt";class g extends r.default.Component{constructor(t){super(t),this.confirmPrompt=e=>{this.callStateManager(t=>{t.onConfirm(e)});const{campaign:t}=this.props,{content:a}=t;l.redirect(a.confirmUrl)},this.dismissPrompt=e=>{this.callStateManager(t=>{t.onDismiss(e)})},this.toggleSectionHidden=()=>{this.setState(e=>{const t=!e.promptBodyHidden,{subjectUser:a}=this.props;return t?h.UserLocalStorage.set(a,this.localStorageItemName,1):h.UserLocalStorage.delete(a,this.localStorageItemName),{promptBodyHidden:t}})};const{subjectUser:s,campaign:r}=t;this.localStorageItemName=`prompt_home_inline_content_hidden_${r.campaignId}`,this.state={isConfirmed:!1,isDismissed:!1,isShown:!1,promptBodyHidden:null!==h.UserLocalStorage.get(s,this.localStorageItemName),renderPrevented:!t.isPreview},this.stateManagerOnload=[],t.isPreview||new Promise((t,a)=>{e(["metaserver/static/js/prompt/ui/campaign_state_manager"],t,a)}).then(a.__importStar).then(e=>{this.stateManager=new e.CampaignStateManager(this);for(const e of this.stateManagerOnload)e(this.stateManager)})}preventRenderUntilSafe(e){var t;return a.__awaiter(this,void 0,void 0,(function*(){const a=(new c.UserApiV2Client).ns("team_discovery"),s=yield a.rpc("joinable_teams/list",{member_to_fetch_limit:1},{subjectUserId:e});if(!!(null===(t=null==s?void 0:s.values)||void 0===t?void 0:t.length))return;const{isOnBrowse:r}=this.props,i=r?".maestro-app-content":".home-access-sections";if(!!document.querySelector(`${i}:hover`)){const e=document.querySelector(i),t=()=>{!!!document.querySelector(`${i}:hover`)&&this.state.renderPrevented&&(this.setState({renderPrevented:!1}),e.removeEventListener("mouseout",t))};e.addEventListener("mouseout",t)}else this.setState({renderPrevented:!1})}))}callStateManager(e){this.props.isPreview||(this.stateManager?e(this.stateManager):this.stateManagerOnload.push(e))}componentDidUpdate(e,t){t.renderPrevented&&!this.state.renderPrevented&&this.callStateManager(e=>{e.onShow()})}componentDidMount(){this.props.isPreview||this.preventRenderUntilSafe(this.props.subjectUser),this.state.renderPrevented||this.callStateManager(e=>{e.onShow()})}render(){const{campaign:e,isOnBrowse:t}=this.props,{content:a}=e,{isDismissed:s,promptBodyHidden:n,renderPrevented:l}=this.state;let d=null;if(!n){const e=a.showDismissButton?r.default.createElement(i.Button,{variant:"transparent",onClick:this.dismissPrompt},a.dismissText):null;d=r.default.createElement(r.default.Fragment,null,r.default.createElement(o.Text,{tagName:"p",className:"home-inline-content-prompt__content"},a.text),r.default.createElement("div",{className:"home-inline-content-prompt__cta"},r.default.createElement(i.Button,{variant:"outline",onClick:this.confirmPrompt},a.confirmText),e))}return r.default.createElement(_,{visible:!l&&!s,isOnBrowse:!!t,title:a.titleText,promptBodyHidden:n,onToggleBodyHidden:this.toggleSectionHidden},t?null:r.default.createElement(u.SectionHeader,{title:a.titleText,ueName:"prompt",isHidden:n,onToggleHidden:this.toggleSectionHidden}),d)}}t.HomeInlineContentPromptUI=g,g.displayName="HomeInlineContentPromptUI";const _=e=>{const{children:t,visible:a,isOnBrowse:i,title:o,promptBodyHidden:l,onToggleBodyHidden:c}=e;return i?r.default.createElement("div",{className:(0,s.default)("prompt-inline-content",{"prompt-inline-content__removed":!a})},r.default.createElement(n.CollapsableSection,{title:o,isOpen:!l,onHeaderClick:c,strings:{buttonClose:d.intl.formatMessage({id:"D8K+9v",defaultMessage:"Hide"}),buttonOpen:d.intl.formatMessage({id:"pDnAQ5",defaultMessage:"Show"})},containerClassName:"home-access-section__inline_prompt"},t)):r.default.createElement("section",{className:(0,s.default)({"prompt-inline-content":!0,"home-access-section":!0,"home-access-section__content":!0,"home-access-section__inline_prompt":!0,"home-access-section__removed":!a,"prompt-inline-content__removed":!a})},t)};_.displayName="PromptFrame",_.displayName="PromptFrame";t.RootComponent=e=>r.default.createElement(m,Object.assign({},e))})),define("metaserver/static/js/overquota/overquota_modal",["require","exports","tslib","react","spectrum/tertiary_link/index","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/image","metaserver/static/js/core/i18n","metaserver/static/js/clean/analytics","metaserver/static/js/clean/static_urls","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/components/ui/modal","metaserver/static/js/modules/constants/payments","metaserver/static/js/overquota/overquota_modal_helpers","metaserver/static/js/core/browser"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OverquotaModal=t.OverquotaModalElement=void 0,s=a.__importDefault(s),h=a.__importStar(h),m=a.__importStar(m);class g extends s.default.Component{constructor(){super(...arguments),this.dismiss=()=>{u.Modal.close(),this.trackCancel(),this.props.onClose&&this.props.onClose()},this.trackCTAClick=()=>{const{ctaTextUntranslated:e}=this.props,t=e?e.toLowerCase():"";this.trackShareTibEvent("OUT_OF_QUOTA_MODAL_UPGRADE",{ns_id:this.props.nsId,usage_remaining:this.props.usageRemaining,usage_needed:this.props.usageNeeded}),l.NQOQLogger.logAcceptModal(this.props.oqa,{modal_type:"billboard",cta_text:t}),this.props.isRequestModal&&l.GrowthEventsLogger.log("oq_fr",{action:"click",button_text:"Get more space",destination_url:"http://www.dropbox.com/upgrade",location:"overlay",quota_status:"over",upsell_type:"modal"}),this.props.onSubmit&&this.props.onSubmit()},this.trackShareTibEvent=(e,t)=>{const{ctaTextUntranslated:a}=this.props;if(this.props.activeUserId){const s=this.getShareTibOrigin(),r=l.ShareTibEventLogger.get_scl_extra_for_logging(void 0,m.get_href());l.ShareTibEventLogger.log(this.props.activeUserId,e,s,Object.assign(Object.assign({cta_text:a?a.toLowerCase():"",oqa:this.props.oqa},t),r))}},this.getShareTibOrigin=()=>{const e=m.get_uri().getPath();return this.props.origin?this.props.origin:"/share"===e||e.startsWith("/share/")?c.SHARE_ACTION_ORIGIN_TYPE.SHARE:"/requests"===e||e.startsWith("/requests/")?c.SHARE_ACTION_ORIGIN_TYPE.FILE_REQUESTS:c.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE},this.onClose=()=>{this.trackClose(),this.props.onClose&&this.props.onClose()},this.trackClose=()=>{l.NQOQLogger.logCloseModal(this.props.oqa,{modal_type:"billboard"})},this.trackCancel=()=>{l.NQOQLogger.logCancelModal(this.props.oqa,{modal_type:"billboard"})},this._renderButtons=()=>this.props.isFamily?null:s.default.createElement(u.ModalButtons,{className:"oq-modal__buttons"},s.default.createElement("a",{href:this.getMoreSpaceUrl(),id:"oq-cta-button",className:"mc-button mc-button-primary",onClick:this.trackCTAClick},this.props.ctaText))}componentDidMount(){this.trackShareTibEvent("OUT_OF_QUOTA_MODAL_RENDER",{ns_id:this.props.nsId,modal_version:"default"})}getMoreSpaceUrl(){if(this.props.ctaUrl)return this.props.ctaUrl;const{oqa:e}=this.props;return-1!==e.search("_nq_")?`${h.LOW_SPACE_URL}?oqa=${e}`:`${h.OUT_OF_SPACE_URL}?oqa=${e}`}_renderAltAction(){return this.props.dismissText?s.default.createElement("div",{className:"overquota_modal__alt-action-container"},s.default.createElement(r.TertiaryLink,{onClick:this.dismiss},this.props.dismissText)):null}_renderContentTitle(){return s.default.createElement("p",{className:"oq-modal__content--title"},this.props.headline)}_renderImage(){if(!this.props.imageObject)return;const{height:e,width:t,src:a,srcHiRes:r}=this.props.imageObject;return s.default.createElement(o.Image,{height:e,width:t,src:(0,d.static_url)(a),srcHiRes:(0,d.static_url)(r)})}render(){return s.default.createElement(u.Modal,{className:"overquota_modal",title:this.props.headline,buttonComponent:this._renderButtons(),altAction:this._renderAltAction(),style:"clean",showX:this.props.showX,onDismiss:this.onClose},s.default.createElement("div",{className:"oq-modal__content"},this._renderImage(),this._renderContentTitle(),s.default.createElement("p",null,this.props.tagline)))}}t.OverquotaModalElement=g,g.defaultProps={headline:n.intl.formatMessage({id:"0eDgXK",defaultMessage:"Your Dropbox is full"}),tagline:n.intl.formatMessage({id:"/5zkWm",defaultMessage:"Before you can update or move your files, you need more space."}),imageObject:(0,p.constructImageObject)(),oqa:"",ctaText:n.intl.formatMessage({id:"iIucBq",defaultMessage:"Get more space"}),ctaTextUntranslated:"Get more space",showX:!0},g.displayName="OverquotaModalElement",t.OverquotaModal=(0,i.requireCssWithComponent)(g,["/static/metaserver/static/css/react/overquota_modal-vfl444b98.css"])})),define("metaserver/static/js/sharing/share_page/views/row_actions",["require","exports","tslib","classnames","react","dig-components/menu","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowActions=void 0,s=a.__importDefault(s),r=a.__importDefault(r);class c extends r.default.Component{render(){return r.default.createElement("div",{className:"share-page-row-actions"},null!=this.props.mainAction?r.default.createElement("button",{"data-testid":"main-action-button",className:(0,s.default)({"share-page-row-actions__main-action":!0,"u-l-ib u-l-ib--m":!0,[`c-btn c-btn--${this.props.importance}`]:!0,"mu-height-4x":!0}),disabled:this.props.disabled||this.props.mainAction.disabled,onClick:this.props.mainAction.onClick},this.props.mainAction.label):void 0,this.props.overflowActions.length>0&&r.default.createElement(i.Menu.Wrapper,{className:"overflow-menu",onSelection:this.props.handleOverflowActionSelection},({getContentProps:e,getTriggerProps:t})=>r.default.createElement(r.default.Fragment,null,r.default.createElement(o.IconButton,Object.assign({variant:"transparent","data-testid":"open-menu-button"},t()),r.default.createElement(n.UIIcon,{src:l.MoreHorizontalLine,"aria-label":d.intl.formatMessage({id:"3IzbEU",defaultMessage:"More actions"})})),r.default.createElement(i.Menu.Content,Object.assign({id:"parent"},e()),r.default.createElement(i.Menu.Segment,null,this.props.overflowActions)))))}}t.RowActions=c,c.displayName="RowActions",c.defaultProps={disabled:!1,importance:"primary",overflowActions:[],rowIsHovered:!1}})),define("metaserver/static/js/sharing/share_page/views/tab_states",["require","exports","tslib","react","metaserver/static/js/sharing/share_page/constants","metaserver/static/js/core/i18n","metaserver/static/js/sharing/share_page/signatures/empty_signatures"],(function(e,t,a,s,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnverifiedEmailView=t.PageTab=t.LoadingView=t.ErrorView=t.EmptyView=void 0,s=a.__importDefault(s);class n extends s.default.Component{constructor(){super(...arguments),this._renderEmptyView=()=>{let e;if(this.props.tabType===r.SharePageTab.SIGNATURES)return s.default.createElement(o.EmptySignaturesTab,null);switch(this.props.tabType){case r.SharePageTab.RECENT:e=i.intl.formatMessage({id:"9AyxI5",defaultMessage:"Your shared folders and files will show up here so they’re easy to find."});break;case r.SharePageTab.FOLDER:e=i.intl.formatMessage({id:"RCz/Wx",defaultMessage:"Your shared folders will show up here so they’re easy to find."});break;case r.SharePageTab.FILE:e=i.intl.formatMessage({id:"Rhqv2C",defaultMessage:"Your shared files will show up here so they’re easy to find."});break;case r.SharePageTab.LINK:e=i.intl.formatMessage({id:"CCmgaO",defaultMessage:"You haven’t created any shared links."});break;default:throw new Error("Unknown share page tab type")}return s.default.createElement(l,{descriptionText:e})}}renderByListingState(){switch(this.props.listingState){case r.ListingState.NEEDS_LOAD:case r.ListingState.PREFETCH_FETCHING:case r.ListingState.FETCHING:return s.default.createElement(c,null,this.props.children);case r.ListingState.PREFETCH_FINISHED:case r.ListingState.FINISHED:return null!=this.props.children?this.props.children:this._renderEmptyView();case r.ListingState.EMAIL_UNVERIFIED:return s.default.createElement(u,{onEmailWantToVerify:this.props.onEmailWantToVerify,tab:this.props.tabType});case r.ListingState.ERROR:return s.default.createElement(d,{tab:this.props.tabType},this.props.children);default:throw new Error("Unknown listing state")}}render(){return s.default.createElement("div",{className:this.props.className},null!=this.props.header?s.default.createElement("div",{className:"u-mar-vertical-m mu-mar-vertical-2x mu-lh-3x"},this.props.header):null,this.renderByListingState())}}t.PageTab=n,n.displayName="PageTab",n.defaultProps={className:""};class l extends s.default.Component{constructor(){super(...arguments),this._renderEmptyRow=(e,t="")=>s.default.createElement("li",{className:"empty-row",key:e},s.default.createElement("span",null,t))}render(){const e=`share-page__empty-view ${this.props.headerText?"":"share-page__empty-view--no-header}"}`,t=(function(e,t,a=!1){const s=[],r=e<t,i=a?r?t+1:t-1:t;for(let t=e;r?t<i:t>i;r?t++:t--)s.push(t);return s})(1,this.props.numEmptyRows,!0).map(e=>this._renderEmptyRow(e));return s.default.createElement("div",{className:e},this.props.headerText?s.default.createElement("div",{className:"u-mar-vertical-xs"},this.props.headerText):void 0,s.default.createElement("ul",{className:"o-list-ui"},this._renderEmptyRow("emptyrow")),this._renderEmptyRow(0,this.props.descriptionText),t)}}t.EmptyView=l,l.displayName="EmptyView",l.defaultProps={numEmptyRows:12};class d extends s.default.Component{renderErrorMsg(){const{tab:e}=this.props;if(e===r.SharePageTab.RECENT)return i.intl.formatMessage({id:"v0GnKn",defaultMessage:"Couldn’t retrieve shared folders and files. Reload the page to try again."});if(e===r.SharePageTab.FOLDER)return i.intl.formatMessage({id:"l81CUR",defaultMessage:"Couldn’t retrieve shared folders. Reload the page to try again."});if(e===r.SharePageTab.FILE)return i.intl.formatMessage({id:"H4k98t",defaultMessage:"Couldn’t retrieve files shared with you. Reload the page to try again."});if(e===r.SharePageTab.SIGNATURES)return i.intl.formatMessage({id:"qONb/v",defaultMessage:"Couldn’t retrieve signature requests. Reload the page to try again."});throw new Error("Unknown share page tab type")}render(){return s.default.createElement("div",null,s.default.createElement("div",{className:"c-banner c-banner--error c-banner--unpinned u-font-center"},this.renderErrorMsg()),this.props.children)}}t.ErrorView=d,d.displayName="ErrorView";class c extends s.default.Component{render(){return s.default.createElement("div",null,this.props.children,s.default.createElement("div",{className:"u-font-center"},s.default.createElement("div",{className:"u-mar-top-xl c-loader c-loader--spinner--blue"},i.intl.formatMessage({id:"M85BdF",defaultMessage:"Loading…"}))))}}t.LoadingView=c,c.displayName="LoadingView";class u extends s.default.Component{render(){let e;switch(this.props.tab){case r.SharePageTab.RECENT:e=i.intl.formatMessage({id:"vPiRDz",defaultMessage:"To see folders or files shared with you, you need to verify your email."});break;case r.SharePageTab.FOLDER:e=i.intl.formatMessage({id:"nd23j7",defaultMessage:"To see folders shared with you, you need to verify your email."});break;case r.SharePageTab.FILE:e=i.intl.formatMessage({id:"KEquRu",defaultMessage:"To see files shared with you, you need to verify your email."});break;case r.SharePageTab.SIGNATURES:e=i.intl.formatMessage({id:"AXYs60",defaultMessage:"To see your signature requests, you need to verify your email."});break;default:throw new Error("Unknown share page tab type")}return s.default.createElement("div",{className:"u-font-center"},s.default.createElement("h1",null,i.intl.formatMessage({id:"hP3HgD",defaultMessage:"Verify your email"})),s.default.createElement("h2",null,e),s.default.createElement("button",{className:"c-btn c-btn--primary",onClick:this.props.onEmailWantToVerify},i.intl.formatMessage({id:"2PqJRP",defaultMessage:"Send verification email"})))}}t.UnverifiedEmailView=u,u.displayName="UnverifiedEmailView"})),define("metaserver/static/js/sharing/share_page/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharePageVersion=t.ConfirmationModalType=t.ListingState=t.SharePageTabV3=t.SharePageTab=void 0,(function(e){e.RECENT="recent",e.FOLDER="folder",e.FILE="file",e.LINK="link",e.SIGNATURES="signatures"})(t.SharePageTab||(t.SharePageTab={})),(function(e){e.RECENT="recent",e.RECEIVED="received",e.SENT="sent"})(t.SharePageTabV3||(t.SharePageTabV3={})),(function(e){e.NEEDS_LOAD="needs-load",e.EMAIL_UNVERIFIED="email-unverified",e.PREFETCH_FETCHING="prefetch_fetching",e.PREFETCH_FINISHED="prefetch_finished",e.FETCHING="fetching",e.ERROR="error",e.FINISHED="finished"})(t.ListingState||(t.ListingState={})),(function(e){e.CLOSED="closed",e.RELINQUISH_FILE="relinquish_file",e.RELINQUISH_FOLDER="relinquish_folder",e.UNMOUNT_FOLDER="unmount_folder"})(t.ConfirmationModalType||(t.ConfirmationModalType={})),(function(e){e.LEGACY="legacy",e.V3="v3",e.M11="m11"})(t.SharePageVersion||(t.SharePageVersion={}))})),define("metaserver/static/js/sharing/share_page/actions",["require","exports","tslib","react","react-dom","metaserver/static/js/account/email_verify_reasons","metaserver/static/js/clean/analytics","metaserver/static/js/api_v2/error","metaserver/static/js/api_v2/user_client","metaserver/static/js/clean/display_format","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/store_listener","metaserver/static/js/clean/history","metaserver/static/js/components/ui/modal","metaserver/static/js/sharing/api/client","metaserver/static/js/sharing/async_share_modal_util","metaserver/static/js/sharing/confirmation_modals/relinquish_membership_confirmation_modal","metaserver/static/js/sharing/confirmation_modals/reset_access_modal","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/sharing/share_page/action_types","metaserver/static/js/sharing/share_page/constants","metaserver/static/js/sharing/share_page/store","metaserver/static/js/sharing/share_page/tab_actions","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/util","metaserver/static/js/sharing/share_page/views/share_page_redesign","metaserver/static/js/sharing/ui_notifications_util","metaserver/static/js/sharing/wizard/async_wizard_modals","metaserver/static/js/clean/viewer","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/loggers/shared_page_logger","metaserver/static/js/sharing/share_page/clean/features","metaserver/static/js/sharing/shared_content_link_mount_folder","metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_modal","classnames","metaserver/static/js/components/ui/modal"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S,E,b,v,T,y,P,w,M,C,N,I,A,R,O,L,D,F,U,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharePagePropsFromStores=t.SharePageActions=t.RecentFolderListingFetcher=t.RecentFileListingFetcher=t.FolderRowActions=t.FolderListingFetcher=t.FileRowActions=t.FileListingFetcher=void 0,s=a.__importDefault(s),r=a.__importDefault(r),d=a.__importStar(d),h=a.__importDefault(h),g=a.__importStar(g),_=a.__importStar(_),P=a.__importStar(P),I=a.__importStar(I),A=a.__importStar(A),L=a.__importStar(L),D=a.__importStar(D),U=a.__importDefault(U),Object.defineProperty(t,"FileListingFetcher",{enumerable:!0,get:function(){return T.FileListingFetcher}}),Object.defineProperty(t,"FolderListingFetcher",{enumerable:!0,get:function(){return T.FolderListingFetcher}}),Object.defineProperty(t,"RecentFileListingFetcher",{enumerable:!0,get:function(){return T.RecentFileListingFetcher}}),Object.defineProperty(t,"RecentFolderListingFetcher",{enumerable:!0,get:function(){return T.RecentFolderListingFetcher}});const j=y.SharePageTab.RECENT;class k{constructor(e){const t=(e=e||{}).groupsEnabled||!1,a=e.activeUserId||null,s=e.expProShareUpsellModalFileAttr||null,r=e.expSubgrowthProShareModalIllustration||null,i=e.numMembersOnTeam||0,o=null!=e.pageSize?e.pageSize:100,n=e.teamAdminInfo||null,d=e.promptAdminToUpgradeEmailUrl||null,u=e.disablePrefetchFallback||!1,p=!0===e.logSharePageApplicationCodeStart,g={variant:e.expSubgrowthProSharePageUpdates&&e.expSubgrowthProSharePageUpdates.variant?e.expSubgrowthProSharePageUpdates.variant:"CONTROL",quotaType:e.expSubgrowthProSharePageUpdates&&e.expSubgrowthProSharePageUpdates.quotaType?e.expSubgrowthProSharePageUpdates.quotaType:null},_=e.expPgDocsendUpsellVariant||"OFF",f=e.expSignaturesTabVariant||"OFF",S=e.isFirstTimeSeeingSignaturesTab||!1;let b=e.viewer||null;if(p&&I.log_js_modules_application_code_start(),this.expProShareUpsellModalFileAttr=s,this.expSubgrowthProShareModalIllustration=r,this.pageSize=o,this.disablePrefetchFallback=u,this.expSubgrowthProSharePageUpdates=g,this.expPgDocsendUpsellVariant=_,this.expSignaturesTabVariant=f,this.isFirstTimeSeeingSignaturesTab=S,this.enableClickableUnmountedFolders=!0===e.enableClickableUnmountedFolders,this.enableGrayUnmountedFolders=!0===e.enableGrayUnmountedFolders,t&&"groups"===A.get_hash())return I.set_tti_exclusion_flow("groups_tab_redirect"),void A.redirect("/team#groups");null==b&&(b=N.Viewer.get_viewer()),c.Dispatcher.dispatch({type:E.SharePageActionTypes.INITIALIZE,viewer:b});const v=null!=b?b.get_users():[];this.folderRowActionsByUserId={},this.fileRowActionsByUserId={},this.folderShareApiClientByUserId={},this.fileShareApiClientByUserId={};for(const e of v)this.folderShareApiClientByUserId[e.id]=new m.FolderShareApiClient({userId:e.id,client:new l.UserApiV2Client}),this.folderRowActionsByUserId[e.id]=new q({user:e,client:this.folderShareApiClientByUserId[e.id],expProShareUpsellModalFileAttr:this.expProShareUpsellModalFileAttr,expSubgrowthProShareModalIllustration:this.expSubgrowthProShareModalIllustration,expSubgrowthProSharePageUpdates:this.expSubgrowthProSharePageUpdates,numMembersOnTeam:i,teamAdminInfo:n,promptAdminToUpgradeEmailUrl:d}).actions,this.fileShareApiClientByUserId[e.id]=new m.FileShareApiClient({userId:e.id,client:new l.UserApiV2Client}),this.fileRowActionsByUserId[e.id]=new B({user:e,client:this.fileShareApiClientByUserId[e.id]}).actions;T.SharePageTabActions.initialize({pageSize:this.pageSize,disablePrefetchFallback:this.disablePrefetchFallback,folderShareApiClientByUserId:this.folderShareApiClientByUserId,fileShareApiClientByUserId:this.fileShareApiClientByUserId,isLoadingBehindSyncModal:e.isLoadingBehindSyncModal}),c.Dispatcher.dispatch({type:E.SharePageActionTypes.SWITCH_USER,userId:a}),h.default.add_callback("/share",k.handleHistoryChange.bind(this),!1),this._fetchInitialData(v)}static initialize(e){e=e||{};const{containerId:t=""}=e,a=new k(e);return r.default.render(a.getPageElement(),document.getElementById(t)),a}getPageElement(){const e=(0,u.listenToStores)(w.SharePageRedesign,{SharePageStore:v.SharePageStore},G);return s.default.createElement(L.ClickableUnmountedFolders.SetIsEnabled,{isEnabled:this.enableClickableUnmountedFolders},s.default.createElement(L.GrayUnmountedFolders.SetIsEnabled,{isEnabled:this.enableGrayUnmountedFolders},s.default.createElement(e,{fileTabActions:{onEmailWantToVerify:()=>k.handleEmailWantToVerify(i.EmailVerificationReasons.GENERIC)},fileRowActionsByUserId:this.fileRowActionsByUserId,folderRowActionsByUserId:this.folderRowActionsByUserId,folderTabActions:{onEmailWantToVerify:()=>k.handleEmailWantToVerify(i.EmailVerificationReasons.SHARE_FOLDER),onNewSharedFolderClick:C.asyncShowShareAFolderWizardModal},recentTabActions:{onEmailWantToVerify:()=>k.handleEmailWantToVerify(i.EmailVerificationReasons.SHARE_FOLDER)},linkTabActions:{onEmailWantToVerify:()=>k.handleEmailWantToVerify(i.EmailVerificationReasons.GENERIC)},signaturesTabActions:{onEmailWantToVerify:k.handleEmailWantToVerify.bind(this,i.EmailVerificationReasons.GENERIC)},onChangeTab:e=>T.SharePageTabActions.handleChangeTab(e),expSubgrowthProSharePageUpdates:this.expSubgrowthProSharePageUpdates,expPgDocsendUpsellVariant:this.expPgDocsendUpsellVariant,expSignaturesTabVariant:this.expSignaturesTabVariant,isFirstTimeSeeingSignaturesTab:this.isFirstTimeSeeingSignaturesTab})))}_fetchInitialData(e){for(const t of e)this._fetchTeamPolicy(t,3);const t=A.get_uri().getPath();if(0===t.indexOf("/share")){const e=t.substr("/share".length+1);return k.handleHistoryChange(e)}return T.SharePageTabActions.handleChangeTab(j,!0,!1)}_fetchTeamPolicy(e,t,a){return t<=0?((0,M.sharingNotificationError)(R.intl.formatMessage({id:"A4nKxB",defaultMessage:"There was an error retrieving your account information."})),null==a||a(),Promise.resolve()):(c.Dispatcher.dispatch({type:E.SharePageActionTypes.FETCH_TEAM_POLICY_REQUEST,user:e}),this.folderShareApiClientByUserId[e.id].getCurrentAccountCached().then((function(t){c.Dispatcher.dispatch({type:E.SharePageActionTypes.FETCH_TEAM_POLICY_SUCCESS,teamPolicy:null!=t.team?t.team.sharing_policies:void 0,user:e}),null==a||a()})).catch((0,n.catchApiError)(s=>{c.Dispatcher.dispatch({type:E.SharePageActionTypes.FETCH_TEAM_POLICY_ERROR,user:e}),this._fetchTeamPolicy(e,t-1,a)})))}static handleHistoryChange(e){let t=W[e];return null==t&&(h.default.replace_state(`/share/${Q[j]}`),t=j),T.SharePageTabActions.handleChangeTab(t,!0,!1)}static handleEmailWantToVerify(t){const s=v.SharePageStore.getCurrentUser();return new Promise((t,a)=>{e(["metaserver/static/js/account/email"],t,a)}).then(a.__importStar).then(({EmailVerification:e})=>{e.get_for_user(s).verified_or_send_and_show(t,s.is_email_verified?void 0:A.reload)})}}t.SharePageActions=k;class q{constructor(e){e=e||{},this.logClickFolder=this.logClickFolder.bind(this),this.user=e.user,this.client=e.client||null,this.expProShareUpsellModalFileAttr=e.expProShareUpsellModalFileAttr||null,this.expSubgrowthProShareModalIllustration=e.expSubgrowthProShareModalIllustration||null,this.expSubgrowthProSharePageUpdates=e.expSubgrowthProSharePageUpdates||null,this.numMembersOnTeam=e.numMembersOnTeam||0,this.teamAdminInfo=e.teamAdminInfo||null,this.promptAdminToUpgradeEmailUrl=e.promptAdminToUpgradeEmailUrl||null,null==this.client&&(this.client=new m.FolderShareApiClient({userId:this.user.id,client:new l.UserApiV2Client})),this.actions={logClickFolder:this.logClickFolder,onMountClick:this.handleMountClickRedesign.bind(this),onRelinquishMembershipClick:this.handleRelinquishMembershipClick.bind(this),onDownloadClick:this.handleDownloadClick.bind(this),onShareClick:this.handleShareClick.bind(this),onUnmountClick:this.handleUnmountClick.bind(this),onUnshareClick:this.handleUnshareClick.bind(this),onViewFolderClick:this.handleViewFolderClick.bind(this)}}handleMountClick(t){return O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.ADD_TO_DROPBOX,t,b.SharePageVersion.LEGACY),c.Dispatcher.dispatch({type:E.SharePageActionTypes.MOUNT_FOLDER_REQUEST,metadata:t,user:this.user}),this.client.mount({contentId:t.shared_folder_id}).then(s=>new Promise((t,a)=>{e(["metaserver/static/js/sharing/shared_content_link_handle_folder_mount_done"],t,a)}).then(a.__importStar).then(({handleFolderMountDone:e})=>{e(this.user,s,t.is_team_folder,t.can_mount||!1,t.folder_size,t.permissions)})).catch((0,n.catchApiError)(s=>{if(c.Dispatcher.dispatch({type:E.SharePageActionTypes.MOUNT_FOLDER_ERROR,user:this.user,metadata:t}),"insufficient_quota"===(null!=s.error?s.error[".tag"]:void 0)&&null!=(null!=s.error?s.error.space_left:void 0)){const r=P.getOutOfQuotaVars(t,s);return r.numMembersOnTeam=this.numMembersOnTeam,r.teamAdminInfo=this.teamAdminInfo,r.promptAdminToUpgradeEmailUrl=this.promptAdminToUpgradeEmailUrl,r.activeUser=this.user,r.expProShareUpsellModalFileAttr=this.expProShareUpsellModalFileAttr,r.expSubgrowthProShareModalIllustration=this.expSubgrowthProShareModalIllustration,new Promise((t,a)=>{e(["metaserver/static/js/sharing/out_of_quota_modal"],t,a)}).then(a.__importStar).then(({showOutOfQuotaModal:e})=>{e(r)})}return(0,M.sharingNotificationError)(R.intl.formatMessage({id:"1dh2zK",defaultMessage:"We were unable to complete your request."}))}))}handleMountClickRedesign(e,t){return a.__awaiter(this,void 0,void 0,(function*(){O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.ADD_TO_DROPBOX,t,b.SharePageVersion.LEGACY);const a="reader"===t.access_type?"can_view":"can_edit",r=t.folder_size?t.folder_size:0,i=V(a,t.can_mount);if(i){const o=(0,U.default)({"content-link-sync-modal":!0}),n=s.default.createElement(F.OutOfQuotaModal,{activeUserId:e.id,accessLevel:a,folderName:t.name,folderSize:d.format_bytes(r,2),outOfQuotaQP:i,previewUrl:t.preview_url,syncNSId:t.shared_folder_id,className:o});x.Modal.showInstance(n)}else D.mountSharedFolder({shared_folder_id:t.shared_folder_id,origin:S.SHARE_ACTION_ORIGIN_TYPE.SHARE,should_redirect:!0,target_file:null,metadata:t,user:e})}))}handleRelinquishMembershipClick(e){O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE,e,b.SharePageVersion.LEGACY);const t=null!=e.parent_shared_folder_id,a=null!=e.path_lower;return _.showRelinquishMembershipConfirmationModal(!0,t,()=>(this.relinquishMembership(e),p.Modal.close()),H,a)}relinquishMembership(e){return c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_REQUEST,metadata:e,user:this.user}),this.client.relinquishMembership({contentId:e.shared_folder_id}).then(()=>((0,M.sharingNotificationSuccess)(R.intl.formatMessage({id:"tCwBHH",defaultMessage:"You have removed your own access to this folder."})),c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_SUCCESS,metadata:e,user:this.user}))).catch((0,n.catchApiError)(()=>((0,M.sharingNotificationError)(R.intl.formatMessage({id:"nZhREZ",defaultMessage:"We were unable to complete your request."})),O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE_ERROR,e,b.SharePageVersion.LEGACY),c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_ERROR,metadata:e,user:this.user}))))}handleShareClick(e){return O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.SHARE,e,b.SharePageVersion.LEGACY),g.asyncShowShareModal(this.user,{fqPath:e.path_lower,isFolder:!0,isTeamSharedFolder:e.is_team_folder,targetNsId:e.shared_folder_id},{origin:S.SHARE_ACTION_ORIGIN_TYPE.SHARE})}handleUnmountClick(e){return O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE_FROM_DROPBOX,e,b.SharePageVersion.LEGACY),c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNMOUNT_FOLDER_REQUEST,metadata:e,user:this.user}),this.client.unmount({contentId:e.shared_folder_id}).then(()=>{const t=e.set("path_lower",null).setIn(["permissions","unmount","allow"],!1);return c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNMOUNT_FOLDER_SUCCESS,metadata:t,user:this.user}),(0,M.sharingNotificationSuccess)(R.intl.formatMessage({id:"1PU8LZ",defaultMessage:"This folder has been successfully removed from your Dropbox."}))}).catch((0,n.catchApiError)(t=>(c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNMOUNT_FOLDER_ERROR,metadata:e,user:this.user}),O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE_FROM_DROPBOX_ERROR,e,b.SharePageVersion.LEGACY),(0,M.sharingNotificationError)(R.intl.formatMessage({id:"viK6c+",defaultMessage:"We were unable to complete your request."})))))}handleUnshareClick(e){return(0,f.confirmResetAccess)({allowLeaveACopy:null!=e.permissions.leave_a_copy?e.permissions.leave_a_copy.allow:void 0,contentName:e.name,isFolder:!0,isNestedSharedFolder:null!=e.parent_shared_folder_id,onCancel:H,onConfirm:t=>(this.unshareFolder(e,t),p.Modal.close())})}unshareFolder(e,t=!1){return c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNSHARE_FOLDER_REQUEST,metadata:e,user:this.user}),this.client.unshare({contentId:e.shared_folder_id,leaveACopy:t}).then(()=>(c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNSHARE_FOLDER_SUCCESS,metadata:e,user:this.user}),(0,M.sharingNotificationSuccess)(R.intl.formatMessage({id:"O4leSN",defaultMessage:"This folder has been successfully unshared."})))).catch((0,n.catchApiError)(t=>(c.Dispatcher.dispatch({type:E.SharePageActionTypes.UNSHARE_FOLDER_ERROR,metadata:e,user:this.user}),(0,M.sharingNotificationError)(R.intl.formatMessage({id:"rhXtn/",defaultMessage:"We were unable to complete your request."})))))}handleViewFolderClick(e){return this.logClickFolder(e),A.open_tab(e.preview_url)}handleDownloadClick(t){return a.__awaiter(this,void 0,void 0,(function*(){O.SharedPageLogger.logFolderEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.DOWNLOAD,t,b.SharePageVersion.LEGACY),new Promise((t,a)=>{e(["metaserver/static/js/share_download/ui/api"],t,a)}).then(a.__importStar).then(({fetchDownloadUrl:s})=>a.__awaiter(this,void 0,void 0,(function*(){const r=yield s(t.preview_url,void 0,S.SHARE_ACTION_ORIGIN_TYPE.SHARE);new Promise((t,a)=>{e(["metaserver/static/js/clean/downloads"],t,a)}).then(a.__importStar).then(({get:e})=>{e({url:r})})})))}))}logClickFolder(e){const t=v.SharePageStore.getCurrentTab(),a=v.SharePageStore.getSummaryCount();t===y.SharePageTab.FOLDER&&delete a.num_file_displayed,O.SharedPageLogger.logFolderEvent(t,O.SharedPageEventType.CLICK_CONTENT,e,b.SharePageVersion.LEGACY,a);const s=S.SHARE_ACTION_ORIGIN_TYPE.SHARE;return o.ShareTibEventLogger.log(this.user.id,"SHARE_PAGE_CLICK_FOLDER",s,{ns_id:e.shared_folder_id})}}function H(){return p.Modal.close()}t.FolderRowActions=q;class B{constructor(e){e=e||{},this.user=e.user,this.client=e.client||null,null==this.client&&(this.client=new m.FileShareApiClient({userId:this.user.id,client:new l.UserApiV2Client})),this.actions={onRelinquishMembershipClick:this.handleRelinquishMembershipClick.bind(this),onDownloadClick:this.handleDownloadClick.bind(this),onCommentClick:this.handleCommentClick.bind(this),onViewFileClick:this.handleViewFileClick.bind(this)}}handleViewFileClick(e){const t=v.SharePageStore.getCurrentTab(),a=v.SharePageStore.getSummaryCount();t===y.SharePageTab.FILE&&delete a.num_folder_displayed,O.SharedPageLogger.logFileEvent(t,O.SharedPageEventType.CLICK_CONTENT,e,b.SharePageVersion.LEGACY,a);const s=S.SHARE_ACTION_ORIGIN_TYPE.SHARE;return o.ShareTibEventLogger.log(this.user.id,"SHARE_PAGE_CLICK_FILE",s,{file_id:e.id}),A.open_tab(e.preview_url)}handleDownloadClick(t){return a.__awaiter(this,void 0,void 0,(function*(){O.SharedPageLogger.logFileEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.DOWNLOAD,t,b.SharePageVersion.LEGACY),new Promise((t,a)=>{e(["metaserver/static/js/share_download/ui/api"],t,a)}).then(a.__importStar).then(({fetchDownloadUrl:s})=>a.__awaiter(this,void 0,void 0,(function*(){const r=yield s(t.preview_url,void 0,S.SHARE_ACTION_ORIGIN_TYPE.SHARE);new Promise((t,a)=>{e(["metaserver/static/js/clean/downloads"],t,a)}).then(a.__importStar).then(({get:e})=>{e({url:r})})})))}))}handleCommentClick(e){A.redirect(e.preview_url)}handleRelinquishMembershipClick(e){O.SharedPageLogger.logFileEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE,e,b.SharePageVersion.LEGACY);return _.showRelinquishMembershipConfirmationModal(!1,!1,()=>(this.relinquishMembership(e),p.Modal.close()),H,!1)}relinquishMembership(e){return c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_REQUEST,metadata:e,user:this.user}),this.client.relinquishMembership({contentId:e.id}).then(()=>(c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_SUCCESS,metadata:e,user:this.user}),(0,M.sharingNotificationSuccess)(R.intl.formatMessage({id:"7O9HTU",defaultMessage:"You have removed your own access to this file."})))).catch((0,n.catchApiError)(()=>(c.Dispatcher.dispatch({type:E.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_ERROR,metadata:e,user:this.user}),O.SharedPageLogger.logFileEvent(v.SharePageStore.getCurrentTab(),O.SharedPageEventType.REMOVE_ERROR,e,b.SharePageVersion.LEGACY),(0,M.sharingNotificationError)(R.intl.formatMessage({id:"uQ9oGF",defaultMessage:"We were unable to complete your request."})))))}}t.FileRowActions=B;const V=function(e,t){if(null!=t&&!t)return"can_edit"===e?"wb_oq_shm_share_w":"wb_oq_shm_share_ro"},G=function(e,t){const a=t.SharePageStore.getCurrentUser();return{fileRowActions:e.fileRowActionsByUserId[a.id],fileTabActions:e.fileTabActions,folderRowActions:e.folderRowActionsByUserId[a.id],folderTabActions:e.folderTabActions,linkTabActions:e.linkTabActions,signaturesTabActions:e.signaturesTabActions,isMaestroDesign:!0,isTeamPolicyLoaded:t.SharePageStore.isTeamPolicyLoaded(a.id),listing:new y.SharedContentListing,onChangeTab:e.onChangeTab,user:a,viewingTab:t.SharePageStore.state.viewingTab,expSubgrowthProSharePageUpdates:e.expSubgrowthProSharePageUpdates,expPgDocsendUpsellVariant:e.expPgDocsendUpsellVariant,expSignaturesTabVariant:e.expSignaturesTabVariant,isFirstTimeSeeingSignaturesTab:e.isFirstTimeSeeingSignaturesTab,isLoadingBehindSyncModal:t.SharePageStore.state.isLoadingBehindSyncModal,listingFolders:t.SharePageStore.getCurrentFoldersListing(),listingFiles:t.SharePageStore.getCurrentFilesListing(),recentTabActions:e.recentTabActions,inviteCount:0}};t.sharePagePropsFromStores=G;const Q={[y.SharePageTab.RECENT]:"recents",[y.SharePageTab.FOLDER]:"folders",[y.SharePageTab.FILE]:"files",[y.SharePageTab.LINK]:"links",[y.SharePageTab.SIGNATURES]:"signatures"},W={recent:y.SharePageTab.RECENT,folders:y.SharePageTab.FOLDER,files:y.SharePageTab.FILE,links:y.SharePageTab.LINK,signatures:y.SharePageTab.SIGNATURES}})),define("metaserver/static/js/sharing/share_page/pap_logger",["require","exports","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/sharing_shared_page/shown_shared_page","metaserver/static/js/sharing/share_page/types"],(function(e,t,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTabView=void 0;t.logTabView=e=>{return(0,a.logEvent)(s.pap_events.sharing_shared_page.Shown_SharedPage.create({actionSurface:"share_page",accountRole:(i=e.user,"personal"===i.role?s.pap_events.sharing_shared_page.Shown_SharedPage.AccountRole.PERSONAL_ACCOUNT_ROLE:"work"===i.role?s.pap_events.sharing_shared_page.Shown_SharedPage.AccountRole.WORK_ACCOUNT_ROLE:s.pap_events.sharing_shared_page.Shown_SharedPage.AccountRole.UNKNOWN_ACCOUNT_ROLE),sharedPageTab:(t=e.tab,t===r.SharePageTab.RECENT?s.pap_events.sharing_shared_page.Shown_SharedPage.SharedPageTab.RECENTS_SHARED_PAGE_TAB:t===r.SharePageTab.FILE?s.pap_events.sharing_shared_page.Shown_SharedPage.SharedPageTab.FILES_SHARED_PAGE_TAB:t===r.SharePageTab.FOLDER?s.pap_events.sharing_shared_page.Shown_SharedPage.SharedPageTab.FOLDERS_SHARED_PAGE_TAB:t===r.SharePageTab.LINK?s.pap_events.sharing_shared_page.Shown_SharedPage.SharedPageTab.LINKS_SHARED_PAGE_TAB:s.pap_events.sharing_shared_page.Shown_SharedPage.SharedPageTab.UNKNOWN_SHARED_PAGE_TAB),sharedPageIsBehindSyncModal:e.isBehindSyncModal}));var t,i}})),define("metaserver/static/js/dropbox/proto/pap_events/sharing_shared_page/shown_shared_page",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;(s=a.__importStar(s)).Reader,s.Writer,s.util;const r=s.roots.default||(s.roots.default={});var i,o;t.default=r,t.pap_events=r.pap_events=((i=r.pap_events||{}).sharing_shared_page=((o=i.sharing_shared_page||{}).Shown_SharedPage=(function(e){function e(e){if(e)for(let t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.accountRole=0,e.prototype.sharedPageTab=0,e.prototype.sharedPageIsBehindSyncModal=!1,e.create=function(t){return new e(t)},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.sharing_shared_page.Shown_SharedPage"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="SHARING_SHARED_PAGE"]=0,t})(),e.AccountRole=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_ACCOUNT_ROLE"]=0,t[e[1]="WORK_ACCOUNT_ROLE"]=1,t[e[2]="PERSONAL_ACCOUNT_ROLE"]=2,t})(),e.SharedPageTab=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_SHARED_PAGE_TAB"]=0,t[e[1]="RECENTS_SHARED_PAGE_TAB"]=1,t[e[2]="FILES_SHARED_PAGE_TAB"]=2,t[e[3]="FOLDERS_SHARED_PAGE_TAB"]=3,t[e[4]="LINKS_SHARED_PAGE_TAB"]=4,t})(),e})(o.Shown_SharedPage||{}),o),i)})),define("metaserver/static/js/sharing/share_page/store",["require","exports","tslib","immutable","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/base_store","metaserver/static/js/sharing/share_page/action_types","metaserver/static/js/sharing/share_page/types","metaserver/static/js/clean/viewer"],(function(e,t,a,s,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharePageStore=void 0,s=a.__importStar(s);const d=n.SharePageTab.RECENT;class c extends i.Store{getCurrentListing(){return this.getListing(this.state.viewingTab,this.state.viewingUserId)}getCurrentFoldersListing(){return this.getListing(n.SharePageTab.FOLDER,this.state.viewingUserId)}getCurrentFilesListing(){return this.getListing(n.SharePageTab.FILE,this.state.viewingUserId)}getCurrentUser(){return this.state.viewer.get_user_by_id(this.state.viewingUserId)}getCurrentTeamPolicy(e){return this.state.teamPolicy[e]}getIsSharedFolderSyncing(){return this.state.isSharedFolderSyncing}isTeamPolicyLoaded(e){return e in this.state.teamPolicy}getCurrentTab(){return this.state.viewingTab}getListing(e,t){const a=this.state.listingByUserByType.getIn([e,t]);return null!=a?a:new n.SharedContentListing}getSummaryCount(){const e=this.getListing(n.SharePageTab.FILE,this.state.viewingUserId),t=e.listingEntries?e.listingEntries.size:0,a=this.getListing(n.SharePageTab.FOLDER,this.state.viewingUserId),s=a.listingEntries?a.listingEntries.size:0;return{num_file_displayed:t.toString(),num_folder_displayed:s.toString()}}_init(...e){const t=e[0],a=null!=t?t:{},r=a.viewer,i=a.viewingRole,o=null!=i?i:null,c=a.viewingTab,u=null!=c?c:d;let h=null!=r?r:null;null==h&&(h=l.Viewer.get_viewer());const p=null!=h?h.get_users():void 0;let m=null;if(null!=h&&p.length>0){if(null!=o){const e=h.get_user_by_role(o);null!=e&&(m=e.id)}null==m&&(m=h.get_users()[0].id)}return this.state={listingByUserByType:s.Map([[n.SharePageTab.FOLDER,s.Map()],[n.SharePageTab.FILE,s.Map()]]),teamPolicy:{},viewer:h,viewingTab:u,viewingUserId:m,isLoadingBehindSyncModal:!1,isSharedFolderSyncing:!1}}_new_payload(e){switch(e.action.type){case o.SharePageActionTypes.INITIALIZE:return this._init(e.action),this.emit_change();case o.SharePageActionTypes.EMAIL_UNVERIFIED:return this._setEmailUnverified(e.action.user.id),this.emit_change();case o.SharePageActionTypes.RECENT_TAB_EMAIL_UNVERIFIED:return this._setRecentTabEmailUnverified(e.action.user.id),this.emit_change();case o.SharePageActionTypes.SWITCH_TAB:return this.state.viewingTab=e.action.viewingTab,this.state.isLoadingBehindSyncModal=e.action.isLoadingBehindSyncModal,this.emit_change();case o.SharePageActionTypes.SWITCH_ROLE:const t=this.state.viewer.get_user_by_role(e.action.role);return this.state.viewingUserId=t.id,this.emit_change();case o.SharePageActionTypes.SWITCH_USER:return this.state.viewingUserId=e.action.userId,this.emit_change();case o.SharePageActionTypes.LOAD_PRE_FOLDER_DATA_REQUEST:return this._loadPreViewDataRequest(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_PRE_FOLDER_DATA_SUCCESS:return this._loadPreViewDataSuccess(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_PRE_FOLDER_DATA_ERROR:return this._loadPreViewDataError(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_FOLDER_DATA_REQUEST:return this._loadDataRequest(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_FOLDER_DATA_SUCCESS:return this._loadDataSuccess(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_FOLDER_DATA_ERROR:return this._loadDataError(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.LOAD_PRE_FILE_DATA_REQUEST:return this._loadPreViewDataRequest(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.LOAD_PRE_FILE_DATA_SUCCESS:return this._loadPreViewDataSuccess(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.LOAD_PRE_FILE_DATA_ERROR:return this._loadPreViewDataError(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.LOAD_FILE_DATA_REQUEST:return this._loadDataRequest(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.LOAD_FILE_DATA_SUCCESS:return this._loadDataSuccess(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.LOAD_FILE_DATA_ERROR:return this._loadDataError(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.MOUNT_FOLDER_REQUEST:return this._mountFolderRequest(e.action);case o.SharePageActionTypes.MOUNT_FOLDER_SUCCESS:return this._mountFolderSuccess(e.action);case o.SharePageActionTypes.MOUNT_FOLDER_ERROR:return this._mountFolderError(e.action);case o.SharePageActionTypes.UNMOUNT_FOLDER_REQUEST:return this._unmountFolderRequest(e.action);case o.SharePageActionTypes.UNMOUNT_FOLDER_SUCCESS:return this._unmountFolderSuccess(e.action);case o.SharePageActionTypes.UNMOUNT_FOLDER_ERROR:return this._unmountFolderError(e.action);case o.SharePageActionTypes.UNSHARE_FOLDER_REQUEST:return this._unshareFolderRequest(e.action);case o.SharePageActionTypes.UNSHARE_FOLDER_SUCCESS:return this._unshareFolderSuccess(e.action);case o.SharePageActionTypes.UNSHARE_FOLDER_ERROR:return this._unshareFolderError(e.action);case o.SharePageActionTypes.FETCH_TEAM_POLICY_REQUEST:return delete this.state.teamPolicy[e.action.user.id],this.emit_change();case o.SharePageActionTypes.FETCH_TEAM_POLICY_SUCCESS:return this._fetchTeamPolicySuccess(e.action);case o.SharePageActionTypes.FETCH_TEAM_POLICY_ERROR:return null;case o.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS:return this._fetchFolderPolicySuccess(e.action);case o.SharePageActionTypes.FETCH_METADATA_SUCCESS:return this._fetchMetadataSuccess(e.action);case o.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_REQUEST:return this._relinquishMembershipRequest(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_SUCCESS:return this._relinquishMembershipSuccess(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.RELINQUISH_FOLDER_MEMBERSHIP_ERROR:return this._relinquishMembershipError(n.SharePageTab.FOLDER,e.action);case o.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_REQUEST:return this._relinquishMembershipRequest(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_SUCCESS:return this._relinquishMembershipSuccess(n.SharePageTab.FILE,e.action);case o.SharePageActionTypes.RELINQUISH_FILE_MEMBERSHIP_ERROR:return this._relinquishMembershipError(n.SharePageTab.FILE,e.action)}}_setListing(e,t,a){return this.state.listingByUserByType=this.state.listingByUserByType.setIn([e,t],a)}_loadPreViewDataRequest(e,t){const a=this.getListing(e,t.user.id).set("state",n.ListingState.PREFETCH_FETCHING);return this._setListing(e,t.user.id,a),this.emit_change()}_loadPreViewDataSuccess(e,t){const a=this.getListing(e,t.user.id).listingEntries.merge(t.entries),s=new n.SharedContentListing({cursor:t.cursor,listingEntries:a,nextResultCallback:t.nextResultCallback,state:null!=t.cursor?n.ListingState.NEEDS_LOAD:n.ListingState.FINISHED});return this._setListing(e,t.user.id,s),this.emit_change()}_loadPreViewDataError(e,t){const a=this.getListing(e,t.user.id).set("state",n.ListingState.ERROR);return this._setListing(e,t.user.id,a),this.emit_change()}_loadDataRequest(e,t){const a=this.getListing(e,t.user.id).set("state",n.ListingState.FETCHING);return this._setListing(e,t.user.id,a),this.emit_change()}_loadDataSuccess(e,t){const a=this.getListing(e,t.user.id),s=new n.SharedContentListing({cursor:t.cursor,listingEntries:a.listingEntries.merge(t.entries),nextResultCallback:t.nextResultCallback,state:null!=t.cursor?n.ListingState.NEEDS_LOAD:n.ListingState.FINISHED});return this._setListing(e,t.user.id,s),this.emit_change()}_loadDataError(e,t){const a=this.getListing(e,t.user.id).set("state",n.ListingState.ERROR);return this._setListing(e,t.user.id,a),this.emit_change()}_setEmailUnverified(e){const t=this.state.viewingTab,a=this.getListing(t,e).set("state",n.ListingState.EMAIL_UNVERIFIED);return this._setListing(t,e,a)}_setRecentTabEmailUnverified(e){const t=this.getListing(n.SharePageTab.FOLDER,e).set("state",n.ListingState.EMAIL_UNVERIFIED);this._setListing(n.SharePageTab.FOLDER,e,t);const a=this.getListing(n.SharePageTab.FILE,e).set("state",n.ListingState.EMAIL_UNVERIFIED);return this._setListing(n.SharePageTab.FILE,e,a)}_mountFolderRequest(e){this.state.isSharedFolderSyncing=!0;const t=e.metadata?e.metadata.shared_folder_id:e.shared_folder_id,a=this.getListing(n.SharePageTab.FOLDER,e.user.id).setIn(["entryPendingStates",t],n.EntryPendingState.MOUNTING);return this._setListing(n.SharePageTab.FOLDER,e.user.id,a),this.emit_change()}_mountFolderSuccess(e){this.state.isSharedFolderSyncing=!1;const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).setIn(["listingEntries",e.metadata.shared_folder_id],e.metadata).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_mountFolderError(e){this.state.isSharedFolderSyncing=!1;const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unmountFolderRequest(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).setIn(["entryPendingStates",e.metadata.shared_folder_id],n.EntryPendingState.UNMOUNTING);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unmountFolderSuccess(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).setIn(["listingEntries",e.metadata.shared_folder_id],e.metadata).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unmountFolderError(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unshareFolderRequest(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).setIn(["entryPendingStates",e.metadata.shared_folder_id],n.EntryPendingState.UNSHARING);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unshareFolderSuccess(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).removeIn(["listingEntries",e.metadata.shared_folder_id]).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_unshareFolderError(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id).removeIn(["entryPendingStates",e.metadata.shared_folder_id]);return this._setListing(n.SharePageTab.FOLDER,e.user.id,t),this.emit_change()}_fetchTeamPolicySuccess(e){return this.state.teamPolicy[e.user.id]=e.teamPolicy,this.emit_change()}_fetchMetadataSuccess(e){const t=e.metadata.isSharedFolder()?n.SharePageTab.FOLDER:n.SharePageTab.FILE,a=this._getContentId(t,e),s=this.getListing(t,e.user.id),r=s.set("listingEntries",s.listingEntries.set(a,e.metadata));return this._setListing(t,e.user.id,r),this.emit_change()}_fetchFolderPolicySuccess(e){const t=this.getListing(n.SharePageTab.FOLDER,e.user.id);let a=t.listingEntries.get(e.metadata.shared_folder_id);a=a.set("policy",e.folderPolicy);const s=t.set("listingEntries",t.listingEntries.set(e.metadata.shared_folder_id,a));return this._setListing(n.SharePageTab.FOLDER,e.user.id,s),this.emit_change()}_relinquishMembershipRequest(e,t){const a=this._getContentId(e,t),s=this.getListing(e,t.user.id).setIn(["entryPendingStates",a],n.EntryPendingState.RELINQUISHING_MEMBERSHIP);return this._setListing(e,t.user.id,s),this.emit_change()}_relinquishMembershipSuccess(e,t){const a=this._getContentId(e,t),s=this.getListing(e,t.user.id).removeIn(["listingEntries",a]).removeIn(["entryPendingStates",a]);return this._setListing(e,t.user.id,s),this.emit_change()}_relinquishMembershipError(e,t){const a=this._getContentId(e,t),s=this.getListing(e,t.user.id).removeIn(["entryPendingStates",a]);return this._setListing(e,t.user.id,s),this.emit_change()}_getContentId(e,t){switch(e){case n.SharePageTab.FOLDER:return t.metadata.shared_folder_id;case n.SharePageTab.FILE:return t.metadata.id}}}t.SharePageStore=new c(r.Dispatcher)})),define("metaserver/static/js/sharing/share_page/types",["require","exports","tslib","immutable","metaserver/static/js/sharing/share_page/constants","metaserver/static/js/sharing/share_page/constants"],(function(e,t,a,s,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListingState=t.SharePageTabV3=t.SharePageTab=t.SnackbarType=t.SortField=t.SharedContentListing=t.EntryPendingState=void 0,s=a.__importStar(s),(function(e){e.MOUNTING="unmounting",e.UNMOUNTING="unmounting",e.UNSHARING="unsharing",e.RELINQUISHING_MEMBERSHIP="relinquishing-membership"})(t.EntryPendingState||(t.EntryPendingState={}));class o extends(s.Record({cursor:null,listingEntries:s.Map(),entryPendingStates:s.Map(),nextResultCallback:null,state:r.ListingState.NEEDS_LOAD},"SharedContentListing")){}t.SharedContentListing=o,(function(e){e.NAME="name",e.TIME_INVITED="time_invited",e.SIGNATURES_STATUS="signatures_status"})(t.SortField||(t.SortField={})),(function(e){e[e.ERROR=0]="ERROR",e[e.PENDING=1]="PENDING",e[e.SUCCESS=2]="SUCCESS"})(t.SnackbarType||(t.SnackbarType={})),Object.defineProperty(t,"SharePageTab",{enumerable:!0,get:function(){return i.SharePageTab}}),Object.defineProperty(t,"SharePageTabV3",{enumerable:!0,get:function(){return i.SharePageTabV3}}),Object.defineProperty(t,"ListingState",{enumerable:!0,get:function(){return i.ListingState}})})),define("metaserver/static/js/sharing/share_page/util",["require","exports","metaserver/static/js/sharing/access_level","metaserver/static/js/sharing/api/types/metadata","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/views/share_column_header","metaserver/static/js/core/i18n","typescript/libraries/dbx-i18n/src/index","metaserver/static/js/modules/constants/time"],(function(e,t,a,s,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOutOfQuotaVars=t.getOQA=t.getOQALoggingData=t.getAgo=t.sortedEntries=t.convertShareColumnHeaderKeyToLinkField=t.isMetadataMounted=t.groupEntriesByMounted=t.ACTION_TYPE=t.QOUTA_TYPE=t.expSubgrowthProSharePageUpdatesButtonText=t.expSubgrowthProSharePageUpdatesUntranslatedButtonText=t.sortSharedContent=void 0;const d=e=>null!=e.path_lower;t.isMetadataMounted=d;t.groupEntriesByMounted=e=>e.groupBy(d);t.convertShareColumnHeaderKeyToLinkField=function(e){return"time_invited"===e?"created_ts":"filename"};t.getAgo=e=>(0,n.timeSince)(o.intl,e.getTime(),{displayLocation:"list",timeZone:l.TIMEZONE});t.sortedEntries=function(e,t,a,s=null){const o=(()=>{if(t===r.SortField.TIME_INVITED)return function(e){return e.time_invited};if(t===r.SortField.NAME||t===r.SortField.INVITER)return e=>e.name.toLowerCase();throw Error("Unexpected sort field")})(),n=a===i.SortDirection.DESCENDING?function(e,t){return t<e?-1:e===t?0:1}:function(e,t){return e<t?-1:e===t?0:1},l=e.sortBy(o,n);return null!=s?l.take(s).valueSeq():l.valueSeq()};t.sortSharedContent=(e,t=r.SortField.TIME_INVITED,a=i.SortDirection.DESCENDING)=>{let o;if(t===r.SortField.TIME_INVITED)o=e=>e instanceof s.SharedFileMetadata?new Date(e.time_invited):e.time_invited;else{if(t!==r.SortField.NAME)throw Error("Unexpected sort field");o=e=>e.name.toLowerCase()}return a===i.SortDirection.DESCENDING?e.sortBy(o).reverse():e.sortBy(o)};t.getOutOfQuotaVars=function(e,t){const s=`wb${0===t.error.space_left?"_oq":"_nq"}_shm_share`+(e.access_type===a.ACCESS_LEVEL.READER?"_ro":"_w");return{folderName:e.name,folderSize:t.error.space_needed,queryParams:s,usageRemaining:t.error.space_left,usageNeeded:t.error.space_needed,nsId:e.shared_folder_id}};t.getOQA=e=>["oq","nq","uq"].includes(e)?`wb_${e}_share`:"",t.expSubgrowthProSharePageUpdatesUntranslatedButtonText="Get more space",t.expSubgrowthProSharePageUpdatesButtonText=o.intl.formatMessage({id:"iIucBq",defaultMessage:"Get more space"}),t.QOUTA_TYPE={OVER:"over",UNDER:"under",NEAR:"near"},t.ACTION_TYPE={VIEW:"view",CLICK:"click"};t.getOQALoggingData=({eventName:e,action:a=t.ACTION_TYPE.VIEW,destinationUrl:s="/low-space-sharing"})=>({wb_uq_share:{action:a,button_text:t.expSubgrowthProSharePageUpdatesButtonText,destination_url:s,location:"in_product",quota_status:t.QOUTA_TYPE.UNDER,upsell_type:"button"},wb_nq_share:{action:a,button_text:t.expSubgrowthProSharePageUpdatesButtonText,destination_url:s,location:"in_product",quota_status:t.QOUTA_TYPE.NEAR,upsell_type:"button"},wb_oq_share:{action:a,button_text:t.expSubgrowthProSharePageUpdatesButtonText,destination_url:s,location:"in_product",quota_status:t.QOUTA_TYPE.OVER,upsell_type:"button"}}[e])})),define("metaserver/static/js/sharing/share_page/views/file_listing_redesign",["require","exports","tslib","classnames","react","metaserver/static/js/clean/ui/columnheader","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/util","metaserver/static/js/sharing/share_page/views/file_row_redesign","metaserver/static/js/sharing/share_page/views/share_column_header","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileListingRedesign=void 0,s=a.__importDefault(s),r=a.__importDefault(r);class u extends r.default.Component{constructor(){super(...arguments),this.state={sortDirection:this.props.initialSortDirection,sortField:this.props.initialSortField},this.handlePopoverSelection=e=>this._handleSortChange(e.newSortField,e.newSortDirection),this._renderNewColumnHeader=e=>e.label?r.default.createElement(d.ShareColumnHeader,{headerClassName:e.headerClassName,onSelection:this.handlePopoverSelection,sortField:e.sortField,activeSortField:this.state.sortField,label:e.label,activeSortDirection:this.state.sortDirection}):r.default.createElement("span",null),this.renderHeader=()=>{let e;e=[];for(const t of Array.from(this._getColumns()))e.push(this._renderNewColumnHeader(t));return r.default.createElement("thead",{className:"mcl-style-header u-trim-margin u-trim-padding"},r.default.createElement("tr",null,e))},this._getColumns=()=>[{canToggleSortDirection:!0,headerClassName:(0,s.default)("filename-col","filename-col--pagelet"),label:this.props.label,sortField:o.SortField.NAME,type:i.ColumnTypes.SINGLE},{canToggleSortDirection:!0,headerClassName:(0,s.default)("time-invited-col","time-invited-col--pagelet"),label:c.intl.formatMessage({id:"2ADqSr",defaultMessage:"Shared on"}),sortField:o.SortField.TIME_INVITED,type:i.ColumnTypes.SINGLE},{headerClassName:(0,s.default)("actions-col","actions-col--pagelet"),label:null,type:i.ColumnTypes.STATIC}],this._getSortedEntries=()=>(0,n.sortedEntries)(this.props.entries,this.state.sortField,this.state.sortDirection),this._handleSortChange=(e,t)=>this.setState({sortDirection:t,sortField:e}),this._handlePreRedesignSortChange=(e,t)=>this._handleSortChange(e,this._convertBrowseSortDirectionToShareSortDirection(t)),this._convertShareSortDirectionToBrowseSortDirection=e=>e===d.SortDirection.DESCENDING?i.SortDirections.DESCENDING:i.SortDirections.ASCENDING,this._convertBrowseSortDirectionToShareSortDirection=e=>e===i.SortDirections.DESCENDING?d.SortDirection.DESCENDING:d.SortDirection.ASCENDING}render(){return r.default.createElement("table",{className:"mu-mar-bottom-5x share-page-table"},this.renderHeader(),r.default.createElement("tbody",{className:"o-list-ui o-list-ui--dividers u-trim-margin"},this._getSortedEntries().map(e=>r.default.createElement(l.FileRowRedesign,Object.assign({key:e.id,metadata:e,pendingState:this.props.entryPendingStates.get(e.id),expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates,isMaestroDesign:this.props.isMaestroDesign,viewingTab:this.props.viewingTab},this.props.fileRowActions))).toArray()))}}t.FileListingRedesign=u,u.displayName="FileListing",u.defaultProps={initialSortDirection:d.SortDirection.DESCENDING,initialSortField:o.SortField.TIME_INVITED}})),define("metaserver/static/js/sharing/share_page/views/file_row_redesign",["require","exports","tslib","classnames","react","metaserver/static/js/datetime/datetime","metaserver/static/js/components/ui/css","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/views/row_actions","metaserver/static/js/sharing/share_page/views/shared_file_icon","metaserver/static/js/core/i18n","dig-components/menu"],(function(e,t,a,s,r,i,o,n,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileRowRedesign=void 0,s=a.__importDefault(s),r=a.__importDefault(r),i=a.__importStar(i);const h=r.default.createElement;var p;(function(e){e.RELINQUISH_MEMBERSHIP="relinquish-membership",e.DOWNLOAD="download",e.COMMENT="comment"})(p||(p={}));class m extends r.default.Component{constructor(){super(...arguments),this.state={isHovered:!1},this._handleMouseEnter=()=>this.setState({isHovered:!0}),this._handleMouseLeave=()=>this.setState({isHovered:!1}),this._handleOverflowActionSelection=e=>{var t,a,s,r,i,o;switch(e){case p.RELINQUISH_MEMBERSHIP:null===(a=(t=this.props).onRelinquishMembershipClick)||void 0===a||a.call(t,this.props.metadata);break;case p.DOWNLOAD:null===(r=(s=this.props).onDownloadClick)||void 0===r||r.call(s,this.props.metadata);break;case p.COMMENT:null===(o=(i=this.props).onCommentClick)||void 0===o||o.call(i,this.props.metadata)}},this._renderIconAndName=()=>[h(d.SharedFileIcon,{sharedFileMetadata:this.props.metadata,className:(0,s.default)("share-page-file-row__file-icon","u-l-ib","u-l-ib--m","u-mar-right-xs","mu-mar-right-2x")}),r.default.createElement("span",{className:(0,s.default)("share-page-file-row__file-name","u-l-ib","u-l-ib--m"),key:"file-row-name"},this.props.metadata.name)],this._renderFileActions=()=>{const e=[];return this.props.metadata.permissions&&(this.props.metadata.permissions.relinquish_membership&&this.props.metadata.permissions.relinquish_membership.allow&&this.props.onRelinquishMembershipClick&&e.push(r.default.createElement(u.Menu.ActionItem,{key:p.RELINQUISH_MEMBERSHIP,value:p.RELINQUISH_MEMBERSHIP,className:"relinquish-membership"},c.intl.formatMessage({id:"zZfSQd",defaultMessage:"Remove me"}))),this.props.onDownloadClick&&this.props.metadata.preview_url&&e.push(r.default.createElement(u.Menu.ActionItem,{key:p.DOWNLOAD,value:p.DOWNLOAD},c.intl.formatMessage({id:"neG5BR",defaultMessage:"Download"}))),this.props.onCommentClick&&this.props.metadata.preview_url&&e.push(r.default.createElement(u.Menu.ActionItem,{key:p.COMMENT,value:p.COMMENT},c.intl.formatMessage({id:"4+ePi5",defaultMessage:"Add comment"})))),r.default.createElement(l.RowActions,{disabled:null!=this.props.pendingState,handleOverflowActionSelection:this._handleOverflowActionSelection,importance:"secondary",overflowActions:e,rowIsHovered:this.state.isHovered})}}render(){var e;const t=new Date(this.props.metadata.time_invited),a="V1"===(null===(e=this.props.expSubgrowthProSharePageUpdates)||void 0===e?void 0:e.variant)&&this.props.viewingTab===n.SharePageTab.RECENT;return r.default.createElement("tr",{className:(0,s.default)(["share-page-file-row",["mu-height-8x","mu-pad-horizontal-2x"]]),key:`shared-file-${this.props.metadata.id}`,title:this.props.metadata.name,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave},r.default.createElement("td",{className:(0,s.default)("filename-col u-l-ib u-l-ib--m",this.props.isMaestroDesign?"filename-col--pagelet":void 0,a?"filename-col--subgrowth_pro_share_page_updates":void 0)},r.default.createElement("button",{className:"u-l-b button-as-link share-page-file-row__file-name-col share-page-row-name",onClick:null!=this.props.onViewFileClick?this.props.onViewFileClick.bind(this,this.props.metadata):void 0},this._renderIconAndName())),a&&r.default.createElement("td",{className:(0,s.default)("size-col",this.props.isMaestroDesign?"size-col--pagelet":void 0,"u-l-ib","u-l-ib--m","u-font-meta")}),r.default.createElement("td",{className:(0,s.default)("share-page-file-row__time-invited","time-invited-col","time-invited-col--pagelet","u-l-ib","u-l-ib--m","u-font-meta"),title:null!=this.props.metadata.time_invited?i.ago(t):void 0},null!=this.props.metadata.time_invited?i.format_date(t,i.localized_datetime_format):""),r.default.createElement("td",{className:(0,s.default)("actions-col u-l-ib u-l-ib--m u-font-right","actions-col--pagelet")},this._renderFileActions()))}}m.displayName="FileRow",t.FileRowRedesign=(0,o.requireCssWithComponent)(m,["/static/metaserver/static/css/sharing/share_page-vfldSBPq5.css","/static/metaserver/static/css/scooter/scooter-scoped-vflhkBqI_.css"])})),define("metaserver/static/js/sharing/share_page/views/files_tab_redesign",["require","exports","tslib","react","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/views/file_listing_redesign","metaserver/static/js/sharing/share_page/views/tab_states","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesTab=void 0,s=a.__importDefault(s);class l extends s.default.Component{render(){return s.default.createElement("div",{className:"redesign"},s.default.createElement(o.PageTab,{className:"share-page-files-tab",header:null,listingState:this.props.listing.state,onEmailWantToVerify:this.props.onEmailWantToVerify,user:this.props.user,tabType:r.SharePageTab.FILE},this.props.listing.listingEntries.count()>0?s.default.createElement(i.FileListingRedesign,{entries:this.props.listing.listingEntries,entryPendingStates:this.props.listing.entryPendingStates,fileRowActions:this.props.fileRowActions,label:n.intl.formatMessage({id:"icJd4i",defaultMessage:"Name"}),isMaestroDesign:this.props.isMaestroDesign,viewingTab:r.SharePageTab.FILE,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates}):null))}}t.FilesTab=l,l.displayName="FilesTab"})),define("metaserver/static/js/sharing/share_page/views/folder_icon_from_metadata",["require","exports","tslib","react","typescript/libraries/spectrum-content-icon-compatibility/src/index","metaserver/static/js/sharing/ui_util"],(function(e,t,a,s,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderIconFromMetadata=void 0,s=a.__importDefault(s),i=a.__importStar(i);t.FolderIconFromMetadata=({className:e,metadata:t,group:a,showUnmountedAsDisabled:o})=>{const n=i.spectrumFolderIconForMetadata(t),l=null==t.path_lower&&o;return s.default.createElement(r.IconContent,{className:e,disabled:l,name:n,"aria-label":t.name,role:"img"})}})),define("metaserver/static/js/sharing/share_page/views/folder_listing_redesign",["require","exports","tslib","classnames","react","metaserver/static/js/clean/ui/columnheader","metaserver/static/js/clean/ui/sprite","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/util","metaserver/static/js/sharing/share_page/views/folder_row_redesign","metaserver/static/js/sharing/share_page/views/share_column_header","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderListingRedesign=void 0,s=a.__importDefault(s),r=a.__importDefault(r);class h extends r.default.Component{constructor(){super(...arguments),this.state={collapsed:null!=this.props.maxInitialDisplay,sortDirection:this.props.initialSortDirection,sortField:this.props.initialSortField},this.handlePopoverSelection=e=>this._handleSortChange(e.newSortField,e.newSortDirection),this._renderNewColumnHeader=e=>e.label?r.default.createElement(c.ShareColumnHeader,{headerClassName:e.headerClassName,onSelection:this.handlePopoverSelection,sortField:e.sortField,activeSortField:this.state.sortField,label:e.label,activeSortDirection:this.state.sortDirection,showSort:e.showSort}):r.default.createElement("span",null),this.renderHeader=()=>r.default.createElement("thead",{className:"mcl-style-header u-trim-margin u-trim-padding"},r.default.createElement("tr",null,this._getColumns().map(e=>this._renderNewColumnHeader(e)))),this._numberToHide=()=>{if(!this.state.collapsed||null==this.props.maxInitialDisplay)return 0;const e=this.props.entries.count();return e<=this.props.maxInitialDisplay?0:e-this.props.maxInitialDisplay},this._getColumns=()=>{const e=this.props.expSubgrowthProSharePageUpdates&&this.props.expSubgrowthProSharePageUpdates.variant&&"V1"===this.props.expSubgrowthProSharePageUpdates.variant,t=u.intl.formatMessage({id:"FAd9tz",defaultMessage:"Name"}),a={canToggleSortDirection:!0,headerClassName:(0,s.default)("filename-col",e?"filename-col--subgrowth_pro_share_page_updates":void 0,this.props.isMaestroDesign?"filename-col--pagelet":void 0),label:t,sortField:n.SortField.NAME,type:i.ColumnTypes.SINGLE},r=u.intl.formatMessage({id:"2ADqSr",defaultMessage:"Shared on"}),o={canToggleSortDirection:!0,headerClassName:(0,s.default)("time-invited-col",this.props.isMaestroDesign?"time-invited-col--pagelet":void 0),label:r,sortField:n.SortField.TIME_INVITED,type:i.ColumnTypes.SINGLE};let l=null;if(e){const e=u.intl.formatMessage({id:"/eW+X1",defaultMessage:"Size"});l={canToggleSortDirection:!1,headerClassName:(0,s.default)("size-col",this.props.isMaestroDesign?"size-col--pagelet":void 0),label:e,sortField:null,type:i.ColumnTypes.SINGLE,showSort:!1}}return[a,l,o,{headerClassName:(0,s.default)("actions-col",this.props.isMaestroDesign?"actions-col--pagelet":void 0),label:null,type:i.ColumnTypes.STATIC}].filter(e=>e)},this._getSortedEntries=()=>(0,l.sortedEntries)(this.props.entries,this.state.sortField,this.state.sortDirection,this.state.collapsed?this.props.maxInitialDisplay:null),this._handleShowAllFoldersClick=()=>this.setState({collapsed:!1}),this._handleSortChange=(e,t)=>this.setState({sortDirection:t,sortField:e}),this._handlePreRedesignSortChange=(e,t)=>this._handleSortChange(e,this._convertBrowseSortDirectionToShareSortDirection(t)),this._convertShareSortDirectionToBrowseSortDirection=e=>e===c.SortDirection.DESCENDING?i.SortDirections.DESCENDING:i.SortDirections.ASCENDING,this._convertBrowseSortDirectionToShareSortDirection=e=>e===i.SortDirections.DESCENDING?c.SortDirection.DESCENDING:c.SortDirection.ASCENDING}render(){const e=this._numberToHide();return r.default.createElement("table",{className:"mu-mar-bottom-5x share-page-table"},this.renderHeader(),r.default.createElement("tbody",{className:"o-list-ui o-list-ui--dividers u-trim-margin"},this._getSortedEntries().map(e=>r.default.createElement(d.FolderRow,Object.assign({isMaestroDesign:this.props.isMaestroDesign,key:e.shared_folder_id,metadata:e,pendingState:this.props.entryPendingStates.get(`${e.shared_folder_id}`),user:this.props.user,isTeamPolicyLoaded:this.props.isTeamPolicyLoaded,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates},this.props.folderRowActions))).toArray(),e?r.default.createElement("tr",{className:"u-pad-vertical-s"},r.default.createElement("button",{className:"share-page-folder-listing__show-more button-as-link",onClick:this._handleShowAllFoldersClick},r.default.createElement("div",{className:"u-l-ib u-mar-right-xs mu-trim-margin"},r.default.createElement("button",{className:(0,s.default)("share-page-folder-listing__show-more-caret","mu-width-8x","mu-trim-padding","mu-mar-horizontal-auto","u-pad-horizontal-xxs","u-mar-horizontal-xxs","u-l-ib"),onClick:this._handleShowAllFoldersClick},r.default.createElement(o.Sprite,{alt:"",group:"web",name:"caret_gray"}))),r.default.createElement("span",null,u.intl.formatMessage({id:"SLwrSx",defaultMessage:"{count, plural, one{Show one more folder} other{Show {count} more folders}}"},{count:e})))):void 0))}}t.FolderListingRedesign=h,h.displayName="FolderListingRedesign",h.defaultProps={initialSortDirection:c.SortDirection.DESCENDING,initialSortField:n.SortField.TIME_INVITED,maxInitialDisplay:void 0}})),define("metaserver/static/js/sharing/share_page/views/folder_row_redesign",["require","exports","tslib","classnames","metaserver/static/js/clean/analytics","metaserver/static/js/clean/browse_interface","metaserver/static/js/datetime/datetime","metaserver/static/js/clean/display_format","metaserver/static/js/components/ui/css","metaserver/static/js/sharing/share_page/util","metaserver/static/js/sharing/share_page/views/folder_icon_from_metadata","metaserver/static/js/sharing/share_page/views/row_actions","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","react","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/loggers/shared_page_logger","metaserver/static/js/sharing/share_page/constants","metaserver/static/js/sharing/share_page/clean/features","metaserver/static/js/sharing/share_page/store","dig-components/menu"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S,E,b){"use strict";var v,T;Object.defineProperty(t,"__esModule",{value:!0}),t.FolderRow=void 0,s=a.__importDefault(s),o=a.__importStar(o),n=a.__importStar(n),h=a.__importStar(h),m=a.__importDefault(m),S=a.__importStar(S),(function(e){e.DOWNLOAD="download",e.OPEN_SETTINGS="open-settings",e.SHARE="share",e.UNMOUNT="unmount"})(v||(v={})),(function(e){e.RELINQUISH_MEMBERSHIP="relinquish-membership",e.UNSHARE="unshare",e.VIEW_FOLDER="view-folder"})(T||(T={}));class y extends m.default.Component{constructor(){super(...arguments),this.state={isHovered:!1,buttonViewEventAlreadyFired:!1},this.handleOnClick=e=>()=>{if(this.hasQuotaType()){const t=(0,d.getOQA)(this.props.expSubgrowthProSharePageUpdates.quotaType),a=(0,d.getOQALoggingData)({eventName:t,action:d.ACTION_TYPE.CLICK,destinationUrl:`https://www.dropbox.com${e}`});r.ProEventsLogger.log(t,a)}const t=this.getOqaParams(),a=`${e}${t}`;r.ShareTibEventLogger.log(this.props.user.id,"OUT_OF_QUOTA_MODAL_UPGRADE",g.SHARE_ACTION_ORIGIN_TYPE.SHARE_PAGE_INLINE,{ns_id:this.props.metadata.shared_folder_id,cta_text:d.expSubgrowthProSharePageUpdatesUntranslatedButtonText,cta_url:a}),_.SharedPageLogger.logFolderEvent(f.SharePageTab.RECENT,_.SharedPageEventType.GET_MORE_SPACE,this.props.metadata,f.SharePageVersion.LEGACY),h.redirect(a)},this.onUnmountedFolderClick=e=>{e.preventDefault(),this.props.logClickFolder&&this.props.logClickFolder(this.props.metadata),this.props.onMountClick&&this.props.onMountClick.call(this,this.props.user,this.props.metadata)},this.handleMouseEnter=()=>(this.props.metadata.can_mount||this.state.buttonViewEventAlreadyFired||(this.proEventsLogButtonViewEvent(),this.props.expSubgrowthProSharePageUpdates&&this.props.expSubgrowthProSharePageUpdates.variant&&"V1"===this.props.expSubgrowthProSharePageUpdates.variant&&(null===this.props.metadata.path_lower||void 0===this.props.metadata.path_lower)&&_.SharedPageLogger.logFolderEvent(f.SharePageTab.RECENT,_.SharedPageEventType.GET_MORE_SPACE_EXPOSURE,this.props.metadata,f.SharePageVersion.LEGACY)),this.setState({isHovered:!0,buttonViewEventAlreadyFired:!0})),this.handleMouseLeave=()=>this.setState({isHovered:!1}),this.getMoreSpaceRoute=()=>"https://www.dropbox.com/low-space-sharing",this.proEventsLogButtonViewEvent=()=>{if("V1"===this.props.expSubgrowthProSharePageUpdates.variant&&this.hasQuotaType()){const e=this.props.expSubgrowthProSharePageUpdates.quotaType,t=(0,d.getOQA)(e),a=(0,d.getOQALoggingData)({eventName:t,action:d.ACTION_TYPE.VIEW,destinationUrl:this.getMoreSpaceRoute()});r.ProEventsLogger.log(t,a)}},this.renderIconAndNameForUnmountedFolders=()=>[this.getIcon(),m.default.createElement("span",{className:"share-page-folder-row share-page-folder-row__name-width u-l-ib u-l-ib--m",key:"folder-row-name"},m.default.createElement("span",{className:"share-page-folder-row__unmounted-folder-name u-l-ib u-l-ib--m"},this.props.metadata.name),m.default.createElement("span",{className:"share-page-folder-row__folder-subtext u-l-ib u-l-ib--m"},p.intl.formatMessage({id:"2T0ULp",defaultMessage:"Not added to Dropbox"})))],this.renderIconAndNameForMountedFolders=()=>[this.getIcon(),m.default.createElement("span",{className:"share-page-folder-row share-page-folder-row__name-width u-l-ib u-l-ib--m",key:"folder-row-name"},m.default.createElement("span",{className:"share-page-folder-row__folder-name u-l-ib u-l-ib--m",key:"folder-row-name"},this.props.metadata.name))],this.getIcon=()=>m.default.createElement(m.default.Fragment,null,m.default.createElement(S.GrayUnmountedFolders.WhenEnabled,null,m.default.createElement(c.FolderIconFromMetadata,{className:"u-l-ib u-l-ib--m u-mar-right-xs mu-mar-right-2x",metadata:this.props.metadata,group:"web",showUnmountedAsDisabled:!0})),m.default.createElement(S.GrayUnmountedFolders.WhenDisabled,null,m.default.createElement(c.FolderIconFromMetadata,{className:"u-l-ib u-l-ib--m u-mar-right-xs mu-mar-right-2x",metadata:this.props.metadata,group:"web",showUnmountedAsDisabled:!1}))),this.renderMountedFolderActions=()=>{const e=[],t=this.props.metadata.permissions;return t&&(t.change_options&&t.change_options.allow&&this.props.isTeamPolicyLoaded&&e.push(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",disabled:!this.props.isTeamPolicyLoaded,key:v.OPEN_SETTINGS,value:v.OPEN_SETTINGS},p.intl.formatMessage({id:"3QmSF8",defaultMessage:"Folder settings"}))),this.props.metadata.preview_url&&e.push(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",key:v.DOWNLOAD,value:v.DOWNLOAD},p.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}))),t.unmount&&t.unmount.allow&&e.push(m.default.createElement(b.Menu.ActionItem,{className:"u-font-error","data-testid":"menu-action-item",key:v.UNMOUNT,value:v.UNMOUNT},p.intl.formatMessage({id:"Iq7/TN",defaultMessage:"Remove from Dropbox"})))),e.unshift(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",key:v.SHARE,value:v.SHARE},p.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"}))),m.default.createElement(u.RowActions,{handleOverflowActionSelection:this._handleMountedFolderOverflowActionSelection,importance:"tertiary",overflowActions:e,rowIsHovered:this.state.isHovered})},this.getOqaParams=()=>{let e="";return this.hasQuotaType()&&(e=(0,d.getOQA)(this.props.expSubgrowthProSharePageUpdates.quotaType)),e?`?oqa=${e}`:""},this.renderUnmountedFolderActions=()=>{const e=this.props.metadata.can_mount,t=E.SharePageStore.getIsSharedFolderSyncing(),a=this.props.expSubgrowthProSharePageUpdates&&this.props.expSubgrowthProSharePageUpdates.variant&&"V1"===this.props.expSubgrowthProSharePageUpdates.variant,s=[];let r={disabled:null!=this.props.pendingState||t,label:p.intl.formatMessage({id:"uZZoh8",defaultMessage:"Add to Dropbox"}),onClick:this.bindHandlerForShowAddContentModel(this.props.onMountClick)};if(a&&!e&&"owner"!==this.props.metadata.access_type){const e="/low-space-sharing";r={disabled:null!=this.props.pendingState||t,label:d.expSubgrowthProSharePageUpdatesButtonText,onClick:this.handleOnClick(e)}}const i=this.props.metadata.permissions;return i&&(i.edit_contents&&!i.edit_contents.allow&&s.push(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",key:T.VIEW_FOLDER,value:T.VIEW_FOLDER},p.intl.formatMessage({id:"GW4cXr",defaultMessage:"View folder"}))),i.relinquish_membership&&i.relinquish_membership.allow&&s.push(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",key:T.RELINQUISH_MEMBERSHIP,value:T.RELINQUISH_MEMBERSHIP},p.intl.formatMessage({id:"YYkIp8",defaultMessage:"Remove me"}))),i.unshare&&i.unshare.allow&&s.push(m.default.createElement(b.Menu.ActionItem,{"data-testid":"menu-action-item",className:"u-font-error",key:T.UNSHARE,value:T.UNSHARE},p.intl.formatMessage({id:"z/VsbM",defaultMessage:"Unshare folder"})))),m.default.createElement(u.RowActions,{disabled:null!=this.props.pendingState,handleOverflowActionSelection:this._handleUnmountedFolderOverflowActionSelection,importance:"secondary",mainAction:r,overflowActions:s,rowIsHovered:this.state.isHovered})},this.bindHandlerForShowAddContentModel=e=>null!=e?e.bind(this,this.props.user,this.props.metadata):null,this._handleMountedFolderOverflowActionSelection=e=>{var t,a,s,r,i,o,n,l;switch(e){case v.DOWNLOAD:null===(a=(t=this.props).onDownloadClick)||void 0===a||a.call(t,this.props.metadata);break;case v.OPEN_SETTINGS:null===(r=(s=this.props).onFolderSettingsClick)||void 0===r||r.call(s,this.props.metadata);break;case v.SHARE:null===(o=(i=this.props).onShareClick)||void 0===o||o.call(i,this.props.metadata);break;case v.UNMOUNT:null===(l=(n=this.props).onUnmountClick)||void 0===l||l.call(n,this.props.metadata)}},this._handleUnmountedFolderOverflowActionSelection=e=>{var t,a,s,r,i,o;switch(e){case T.RELINQUISH_MEMBERSHIP:null===(a=(t=this.props).onRelinquishMembershipClick)||void 0===a||a.call(t,this.props.metadata);break;case T.UNSHARE:null===(r=(s=this.props).onUnshareClick)||void 0===r||r.call(s,this.props.metadata);break;case T.VIEW_FOLDER:null===(o=(i=this.props).onViewFolderClick)||void 0===o||o.call(i,this.props.metadata)}}}render(){const e=null!=this.props.metadata.path_lower,t=this.props.metadata.time_invited;let a=this.props.metadata.folder_size;const r=this.props.metadata.can_mount,l=this.props.expSubgrowthProSharePageUpdates&&this.props.expSubgrowthProSharePageUpdates.variant&&"V1"===this.props.expSubgrowthProSharePageUpdates.variant;return l&&!a&&(a=0),m.default.createElement("tr",{className:(0,s.default)("share-page-folder-row",e?"share-page-folder-row--mounted":"share-page-folder-row--invitation",this.props.isMaestroDesign?["mu-height-8x","mu-pad-horizontal-2x"]:"u-pad-vertical-xs"),key:`shared-folder-${this.props.metadata.shared_folder_id}`,title:this.props.metadata.name,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},m.default.createElement("td",{className:(0,s.default)("filename-col u-l-ib u-l-ib--m",l?"filename-col--subgrowth_pro_share_page_updates":void 0,this.props.isMaestroDesign?"filename-col--pagelet":void 0)},e?m.default.createElement("a",{className:"u-l-b mu-height-8x share-page-row-name",href:(0,i.browse_uri_for_fq_path)(this.props.user,this.props.metadata.path_lower).toString(),onClick:()=>this.props.logClickFolder(this.props.metadata),target:"_blank",rel:"noreferrer"},this.renderIconAndNameForMountedFolders()):m.default.createElement(m.default.Fragment,null,m.default.createElement(S.ClickableUnmountedFolders.WhenEnabled,null,m.default.createElement("a",{className:"u-l-b mu-height-8x",href:"",onClick:this.onUnmountedFolderClick},this.renderIconAndNameForUnmountedFolders())),m.default.createElement(S.ClickableUnmountedFolders.WhenDisabled,null,m.default.createElement(m.default.Fragment,null,this.renderIconAndNameForUnmountedFolders())))),l&&m.default.createElement("td",{className:(0,s.default)("size-col",this.props.isMaestroDesign?"size-col--pagelet":void 0,"u-l-ib","u-l-ib--m","u-font-meta"),title:n.format_bytes(a,0)},m.default.createElement("span",{className:"share-page-folder-row share-page-folder-row__name-width u-l-ib u-l-ib--m",key:"folder-row-size"},m.default.createElement("span",{className:(0,s.default)(r||e?"share-page-folder-row__size-text":"share-page-folder-row__size-text-warning","u-l-ib","u-l-ib--m")},n.format_bytes(a,0)),!r&&!e&&m.default.createElement("span",{className:(0,s.default)("share-page-folder-row__not-enough-space","u-l-ib","u-l-ib--m")},p.intl.formatMessage({id:"h4S9M8",defaultMessage:"Not enough space to access folder"})))),m.default.createElement("td",{className:(0,s.default)("time-invited-col",this.props.isMaestroDesign?"time-invited-col--pagelet":void 0,"u-l-ib","u-l-ib--m","u-font-meta"),title:t&&o.ago(t)},t&&o.format_date(t,o.localized_datetime_format)),m.default.createElement("td",{className:(0,s.default)("actions-col u-l-ib u-l-ib--m u-font-right",this.props.isMaestroDesign?"actions-col--pagelet":void 0)},e?this.renderMountedFolderActions():this.renderUnmountedFolderActions()))}hasQuotaType(){return this.props.expSubgrowthProSharePageUpdates&&this.props.expSubgrowthProSharePageUpdates.quotaType}}y.displayName="FolderRow",y.defaultProps={logClickFolder:()=>!0},t.FolderRow=(0,l.requireCssWithComponent)(y,["/static/metaserver/static/css/sharing/share_page-vfldSBPq5.css","/static/metaserver/static/css/scooter/scooter-scoped-vflhkBqI_.css"])})),define("metaserver/static/js/sharing/share_page/views/folders_tab_redesign",["require","exports","tslib","react","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/util","metaserver/static/js/sharing/share_page/views/folder_listing_redesign","metaserver/static/js/sharing/share_page/views/tab_states"],(function(e,t,a,s,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldersTab=void 0,s=a.__importDefault(s);class l extends s.default.Component{constructor(){super(...arguments),this._renderListing=()=>{if(0===this.props.listing.listingEntries.count())return null;const e=(0,i.groupEntriesByMounted)(this.props.listing.listingEntries),t=e.has(!1)||e.has(!0);if(!t||0===this.props.listing.listingEntries.count())return null;let a;const r=s.default.createElement(o.FolderListingRedesign,{entries:this.props.listing.listingEntries,entryPendingStates:this.props.listing.entryPendingStates,folderRowActions:this.props.folderRowActions,isMaestroDesign:!0,maxInitialDisplay:void 0,user:this.props.user,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates});return a=t?s.default.createElement("div",null,r):s.default.createElement("div",null,void 0),a}}render(){return s.default.createElement("div",{className:"redesign"},s.default.createElement(n.PageTab,{className:"share-page-folders-tab",header:void 0,listingState:this.props.listing.state,onEmailWantToVerify:this.props.onEmailWantToVerify,user:this.props.user,tabType:r.SharePageTab.FOLDER},this._renderListing()))}}t.FoldersTab=l,l.displayName="FoldersTab"})),define("metaserver/static/js/sharing/share_page/views/share_column_header",["require","exports","tslib","classnames","react","spectrum/icon_form/index","spectrum/popover/index","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0}),t.ShareColumnHeader=t.SortDirection=void 0,s=a.__importDefault(s),r=a.__importDefault(r),(function(e){e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING"})(l=t.SortDirection||(t.SortDirection={}));class d extends r.default.Component{render(){return r.default.createElement("th",{className:this.props.headerClassName},r.default.createElement(o.Popover,{onSelection:this.props.onSelection},r.default.createElement(o.PopoverTrigger,{className:(0,s.default)({"column-header-menu-trigger-active":this.props.sortField===this.props.activeSortField}),title:this.props.label},r.default.createElement("span",null,this.props.label),this.props.showSort&&r.default.createElement("span",{className:"column-header-menu-label-icon-wrapper"},r.default.createElement(i.IconForm,{name:this.computeSortIcon()}))),this.props.showSort&&r.default.createElement(o.PopoverContent,null,r.default.createElement(o.PopoverItemGroup,null,r.default.createElement(o.PopoverItemGroupTitle,null,n.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})),r.default.createElement(o.PopoverSelectableItem,{selected:this.isSortingByThisColumn(l.ASCENDING),value:{newSortDirection:l.ASCENDING,newSortField:this.props.sortField}},n.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),r.default.createElement(o.PopoverSelectableItem,{selected:this.isSortingByThisColumn(l.DESCENDING),value:{newSortDirection:l.DESCENDING,newSortField:this.props.sortField}},n.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))))))}isSortingByThisColumn(e){return this.props.sortField===this.props.activeSortField&&e===this.props.activeSortDirection}computeSortIcon(){return this.isSortingByThisColumn(l.ASCENDING)?"sort-arrow-up":this.isSortingByThisColumn(l.DESCENDING)?"sort-arrow-down":"caret-down"}}t.ShareColumnHeader=d,d.defaultProps={showSort:!0},d.displayName="ShareColumnHeader"})),define("metaserver/static/js/sharing/share_page/views/share_page_redesign",["require","exports","tslib","classnames","react","metaserver/static/js/sharing/share_page/pap_logger","metaserver/static/js/clean/pagelet_logger","metaserver/static/js/clean/ui/app_actions_view","metaserver/static/js/async/loadable","metaserver/static/js/components/ui/css","metaserver/static/js/maestro/components/tab_nav","metaserver/static/js/edison/ui/spa_chrome","metaserver/static/js/maestro/layout/header","metaserver/static/js/tabs/tab_util","metaserver/static/js/sharing/share_page/types","metaserver/static/js/sharing/share_page/constants","metaserver/static/js/loggers/shared_page_logger","metaserver/static/js/sharing/share_page/views/files_tab_redesign","metaserver/static/js/sharing/share_page/views/signatures_tab","metaserver/static/js/sharing/share_page/views/folders_tab_redesign","metaserver/static/js/sharing/share_page/views/recents_tab","metaserver/static/js/core/i18n","metaserver/static/js/uuid/uuid","metaserver/static/js/sharing/upsells/util","metaserver/static/js/sharing/upsells/upsell_rich_banner","metaserver/static/js/sharing/ui_util","metaserver/static/js/stormcrow/gating_factory","typescript/component_libraries/deep-integrations/src/instrumentation/constants","metaserver/static/js/sharing/share_page/tracking_util","dig-components/tooltips"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S,E,b,v,T,y,P,w,M,C,N,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharePageRedesign=void 0,s=a.__importDefault(s),r=a.__importDefault(r),i=a.__importStar(i);const A=(0,l.Loadable)({loader:()=>a.__awaiter(void 0,void 0,void 0,(function*(){const{LinksTab:t}=yield new Promise((t,a)=>{e(["metaserver/static/js/sharing/share_page/views/links_tab"],t,a)}).then(a.__importStar);return t}))});class R extends r.default.Component{constructor(e){super(e),this.state={pageViewGid:T.UUID.v4({allowInsecure:!0}),showSignaturesTabTooltip:!1},this._createSharedFolderHandler=()=>{_.SharedPageLogger.logCreateSharedFolder(this.props.viewingTab,g.SharePageVersion.LEGACY),this.props.folderTabActions&&this.props.folderTabActions.onNewSharedFolderClick&&this.props.folderTabActions.onNewSharedFolderClick(this.props.user)},this._renderActionMenu=()=>r.default.createElement("div",{className:(0,s.default)("shared-app-actions-view")},r.default.createElement(n.AppActionsView,{primaryMenuItems:[{buttonVariant:"primary",displayName:v.intl.formatMessage({id:"94qVtE",defaultMessage:"Create shared folder"}),handleClick:this._createSharedFolderHandler,key:"created-shared-folder"}]})),this._handleTabSelect=e=>this.props.onChangeTab(e),this._isSignaturesTabEnabled=()=>"V1"===this.props.expSignaturesTabVariant||"V2"===this.props.expSignaturesTabVariant,this.pageletLogger=new o.PageletLogger("sharing",["SharePage"])}startContentCountLogging(){const e=t=>{0!==t&&this.props.viewingTab===m.SharePageTab.RECENT&&(_.SharedPageLogger.logContentCount(this.props.viewingTab,g.SharePageVersion.LEGACY,this.props.listingFiles.listingEntries.count().toString(),this.props.listingFolders.listingEntries.count().toString(),this.state.pageViewGid,(11-t).toString(),this.props.listingFolders.listingEntries.valueSeq().toArray(),"object"==typeof this.props.expSubgrowthProSharePageUpdates&&null!=this.props.expSubgrowthProSharePageUpdates&&"V1"===this.props.expSubgrowthProSharePageUpdates.variant),setTimeout(()=>{e(t-1)},1e3))};this.props.viewingTab===m.SharePageTab.RECENT&&setTimeout(()=>{e(10)},1e3)}checkTTI(){if(this.props.viewingTab!==m.SharePageTab.LINK&&this.props.viewingTab!==m.SharePageTab.SIGNATURES)return(this.props.viewingTab!==m.SharePageTab.FOLDER||"finished"!==this.props.listingFolders.state&&0===this.props.listingFolders.listingEntries.count())&&(this.props.viewingTab!==m.SharePageTab.FILE||"finished"!==this.props.listingFiles.state&&0===this.props.listingFiles.listingEntries.count())&&(this.props.viewingTab!==m.SharePageTab.RECENT||"finished"!==this.props.listingFiles.state&&0===this.props.listingFiles.listingEntries.count()||"finished"!==this.props.listingFolders.state&&0===this.props.listingFolders.listingEntries.count())?void 0:this.pageletLogger.componentReady(R.displayName)}_computeItemCount(){return this.props.listingFiles.listingEntries.count()+this.props.listingFolders.listingEntries.count()}componentDidMount(){this.checkTTI(),_.SharedPageLogger.logPageView(this.props.viewingTab,this.props.isLoadingBehindSyncModal,g.SharePageVersion.LEGACY,this.state.pageViewGid,this._computeItemCount()),i.logTabView({user:this.props.user,tab:this.props.viewingTab,isBehindSyncModal:this.props.isLoadingBehindSyncModal}),this.props.viewingTab===m.SharePageTab.RECENT&&this.startContentCountLogging(),this.userLeapTimeout=setTimeout(()=>{const e=this.props.listingFiles.listingEntries.count()+this.props.listingFolders.listingEntries.count();e>0&&(0,w.trackSharePageUserLeapEvent)(w.ReceiverUserLeapEvent.VISIT_SHARE_PAGE,e)},5e3),this._isSignaturesTabEnabled()&&this.props.isFirstTimeSeeingSignaturesTab&&(this.setState({pageViewGid:this.state.pageViewGid,showSignaturesTabTooltip:!0}),this.signaturesTabTooltipTimeout=setTimeout(()=>{this.setState({pageViewGid:this.state.pageViewGid,showSignaturesTabTooltip:!1})},11500),(0,N.trackSharedSignaturesTabAction)(this.props.user))}componentWillUnmount(){clearTimeout(this.userLeapTimeout),clearTimeout(this.signaturesTabTooltipTimeout)}componentDidUpdate(e,t){this.checkTTI(),this.props.viewingTab!==e.viewingTab&&(_.SharedPageLogger.logPageView(this.props.viewingTab,this.props.isLoadingBehindSyncModal,g.SharePageVersion.LEGACY,this.state.pageViewGid,this._computeItemCount()),i.logTabView({user:this.props.user,tab:this.props.viewingTab,isBehindSyncModal:this.props.isLoadingBehindSyncModal}))}render(){const{user:e,isMaestroDesign:t,expPgDocsendUpsellVariant:a,listingFiles:i,listingFolders:o,viewingTab:n}=this.props,l=i.listingEntries.count()+o.listingEntries.count(),d="V1"===a&&l>=5&&n===m.SharePageTab.RECENT,c=y.upsellBannerContext.docsend,p=d?r.default.createElement(P.UpsellBanner,{acceptText:c.acceptText,declineText:c.declineText,titleText:c.titleText,bodyText:c.bodyText,redirectHref:c.redirectHref,uxaPrefix:c.uxaPrefix,imgSrc:c.imgSrc,afterAccept:c.afterAccept,afterDecline:()=>{(0,y.trackDismissAction)(null==e?void 0:e.id)}}):null;return t?r.default.createElement(u.ChromeWrapper,{user:e,titleRegion:r.default.createElement(h.MaestroHeaderTitle,null,v.intl.formatMessage({id:"jWvR3a",defaultMessage:"Shared"}),p),chromeClass:(0,s.default)("dig2--enabled","shared-sidebar-portal"),embeddedAppRegion:this._renderBody(),actionSidebarRegion:this._renderActionMenu(),searchBarProps:{searchVariant:"full-page"},useMaestroPortal:!0}):r.default.createElement("div",{className:"share-page"},r.default.createElement("main",null,this._renderBody()))}_renderBody(){const e=[{value:m.SharePageTab.RECENT,label:v.intl.formatMessage({id:"hDgBBt",defaultMessage:"Recents"})},{value:m.SharePageTab.FOLDER,label:v.intl.formatMessage({id:"Ga3Ee+",defaultMessage:"Folders"})},{value:m.SharePageTab.FILE,label:v.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"})}];this.props.isMaestroDesign&&e.push({value:m.SharePageTab.LINK,label:v.intl.formatMessage({id:"AUvNZU",defaultMessage:"Links"})});const t="OFF"!==this.props.expSignaturesTabVariant,a=r.default.createRef();let i;switch(this._isSignaturesTabEnabled()&&e.push({value:m.SharePageTab.SIGNATURES,label:v.intl.formatMessage({id:"YPwdBa",defaultMessage:"Signature requests"}),ref:a}),t&&this.props.expSignaturesTabVariant&&((e,t)=>{const a={stormcrowVariantInfo:{feature:e,variant:t}};(0,M.getGatingClientSingleton)().logExposure(a)})(C.InstrFeatureType.SignaturesTabOnShare,this.props.expSignaturesTabVariant),this.props.viewingTab){case m.SharePageTab.RECENT:i=0;break;case m.SharePageTab.FOLDER:i=1;break;case m.SharePageTab.FILE:i=2;break;case m.SharePageTab.LINK:i=3;break;case m.SharePageTab.SIGNATURES:i=4;break;default:i=0}return r.default.createElement(r.default.Fragment,null,r.default.createElement(c.TabNav,{className:(0,s.default)({"share-page-view":!0,"maestro-pagelet-tab-nav":this.props.isMaestroDesign}),defaultSelectedIndex:i,onChange:this._handleTabSelect,tabs:e,variant:p.TabVariant.UNDERLINE},this._renderTab()),this._isSignaturesTabEnabled()&&this._renderSignatureTabTooltip(a))}_renderTab(){switch(this.props.viewingTab){case m.SharePageTab.RECENT:return r.default.createElement(b.RecentsTab,Object.assign({folderRowActions:this.props.folderRowActions,fileRowActions:this.props.fileRowActions,listingFolders:this.props.listingFolders,listingFiles:this.props.listingFiles,user:this.props.user,isTeamPolicyLoaded:this.props.isTeamPolicyLoaded,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates},this.props.recentTabActions));case m.SharePageTab.FOLDER:return r.default.createElement(E.FoldersTab,Object.assign({folderRowActions:this.props.folderRowActions,listing:this.props.listingFolders,user:this.props.user,isTeamPolicyLoaded:this.props.isTeamPolicyLoaded,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates},this.props.folderTabActions,this.props.fileTabActions));case m.SharePageTab.FILE:return r.default.createElement(f.FilesTab,Object.assign({fileRowActions:this.props.fileRowActions,listing:this.props.listingFiles,user:this.props.user,isMaestroDesign:this.props.isMaestroDesign,expSubgrowthProSharePageUpdates:this.props.expSubgrowthProSharePageUpdates},this.props.fileTabActions));case m.SharePageTab.LINK:return r.default.createElement(A,Object.assign({user:this.props.user},this.props.linkTabActions));case m.SharePageTab.SIGNATURES:return r.default.createElement(S.SignaturesTab,Object.assign({user:this.props.user,expVariant:this.props.expSignaturesTabVariant,parentTTILogger:this.pageletLogger,parentTTILoggerComponentName:R.displayName},this.props.signaturesTabActions));default:return}}_renderSignatureTabTooltip(e){return r.default.createElement(I.Tooltip.Control,{triggerRef:e,open:this.state.showSignaturesTabTooltip,openDelay:1500,placement:"bottom"},v.intl.formatMessage({id:"V9QqD2",defaultMessage:"Signatures you sent for signature"}))}}R.displayName="SharePage",R.defaultProps={fileTabActions:{},folderTabActions:{},recentTabActions:{},inviteCount:0,isTeamPolicyLoaded:!1,linkTabActions:{onEmailWantToVerify:()=>{}},signaturesTabActions:{}},t.SharePageRedesign=(0,d.requireCssWithComponent)(R,["/static/metaserver/static/css/scooter/scooter-scoped-vflhkBqI_.css","/static/metaserver/static/css/sharing/maestro-components-vflWvzXgS.css","/static/metaserver/static/css/sharing/maestro-layout-vflvEmc2B.css","/static/metaserver/static/css/sharing/share_page-vfldSBPq5.css"],[n.AppActionsView,c.TabNav])})),define("metaserver/static/js/sharing/share_page/views/shared_file_icon",["require","exports","tslib","react","typescript/libraries/spectrum-content-icon-compatibility/src/index"],(function(e,t,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedFileIcon=void 0,s=a.__importDefault(s);class i extends s.default.Component{render(){return s.default.createElement(r.FileIcon,{path:this.props.sharedFileMetadata.name,"aria-label":this.props.sharedFileMetadata.name,role:"img",className:this.props.className})}}t.SharedFileIcon=i,i.displayName="SharedFileIcon"})),define("metaserver/static/js/auth/login_or_register/modal",["require","exports","tslib","react","classnames","lodash","metaserver/static/js/auth/login_or_register/logging_util","metaserver/static/js/auth/login/form","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/auth/register/form","metaserver/static/js/auth/register/types","metaserver/static/js/growth/experiments/logger","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/ui/welcome_modal","metaserver/static/js/core/browser","metaserver/static/js/core/assert","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","spectrum/button/index","dig-components/modal","metaserver/static/js/maestro_nav/shared_code/dropbox_logo","react-intl"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S,E,b,v,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginOrRegisterModal=t.TestOnlyLoginOrRegisterModal=t.TestOnlyCommentsHeader=t.TestOnlyCommentTextVariantCssClass=t.ExperimentalToggleMessage=t.DefaultHeaderContent=void 0,s=a.__importDefault(s),r=a.__importDefault(r),u=a.__importDefault(u),g=a.__importStar(g);const y={[l.CommentTextVariant.DEFAULT]:"default-variant",[l.CommentTextVariant.POST]:"post-comment-variant",[l.CommentTextVariant.SUBSCRIBE]:"subscribe-variant"};t.TestOnlyCommentTextVariantCssClass=y;t.DefaultHeaderContent=({mode:e})=>s.default.createElement("div",{className:"modal-header"},s.default.createElement(v.DropboxLogo,{className:"modal-header__dropbox-logo"}),s.default.createElement("span",null,f.intl.formatMessage(e===l.Mode.LOGIN?(0,T.defineMessage)({id:"nOuyMw",defaultMessage:"Save it for later in your Dropbox account"}):(0,T.defineMessage)({id:"eUpi8/",defaultMessage:"Save it for later in Dropbox"}))));t.ExperimentalToggleMessage=({mode:e,onHeaderLinkClick:t})=>{const a=e===l.Mode.LOGIN?(0,T.defineMessage)({id:"vHTAAQ",defaultMessage:"Sign in or <a>create an account</a>"}):(0,T.defineMessage)({id:"+OG7LA",defaultMessage:"Sign up or <a>sign in to your account</a>"});return s.default.createElement(s.default.Fragment,null,f.intl.formatMessage(a,{a:e=>s.default.createElement(E.Button,{className:"button-as-link toggle-form-link",onClick:t,variant:"styleless"},e)}))};const P=({className:e,commentTextVariant:t,mode:a})=>{let r;switch(t){case l.CommentTextVariant.POST:r=a===l.Mode.LOGIN?f.intl.formatMessage({id:"KXgMVH",defaultMessage:"To post your comment, sign in to Dropbox."}):f.intl.formatMessage({id:"LakyAx",defaultMessage:"To post your comment, create a free Dropbox account."});break;case l.CommentTextVariant.SUBSCRIBE:r=a===l.Mode.LOGIN?f.intl.formatMessage({id:"oHZbXS",defaultMessage:"To subscribe to this file, sign in to Dropbox."}):f.intl.formatMessage({id:"fy/9XT",defaultMessage:"To subscribe to this file, create a free Dropbox account."});break;default:r=a===l.Mode.LOGIN?f.intl.formatMessage({id:"3qW+D4",defaultMessage:"To continue, sign in to Dropbox."}):f.intl.formatMessage({id:"uMjLqH",defaultMessage:"To continue, create a free Dropbox account."})}return s.default.createElement("div",{className:`text-variant ${e}`},r)};t.TestOnlyCommentsHeader=P;class w extends s.default.PureComponent{constructor(e){super(e),this.logWebActivityOnce=(0,i.once)(()=>(0,o.logModalMiscActivity)(this.props.kind,this.props.downloadAction)),this.renderHeader=()=>{if(this.state.isThirdPartyRegistrationContinuation)return s.default.createElement(b.Modal.Header,{hasBottomSpacing:"title-standard",className:"mc-util-modal-header center"},s.default.createElement("h1",null,f.intl.formatMessage({id:"Ft3ikL",defaultMessage:"Create account and continue"})));const{commentParams:e,customHeaderContent:a,kind:r}=this.props;if(a){const e=a;return s.default.createElement(e,{mode:this.state.mode,changeMode:this.toggleMode})}return s.default.createElement(b.Modal.Header,{hasBottomSpacing:"title-standard",className:"mc-util-modal-header center"},r===l.LoginOrRegisterKind.COMMENT?s.default.createElement(P,{className:y[e.variant],commentTextVariant:e.variant,mode:this.state.mode}):s.default.createElement(t.DefaultHeaderContent,{mode:this.state.mode}))},this.renderFooter=()=>{const{customFooterContent:e}=this.props;if(e){const t=e;return s.default.createElement(t,null)}return null},this.toggleMode=e=>{e.preventDefault(),this.setState({mode:this.state.mode===l.Mode.LOGIN?l.Mode.REGISTER:l.Mode.LOGIN},()=>(0,o.logAuthIntent)(this.state.mode))},this.onAuthenticateSuccess=(e,t)=>{const{mode:a}=this.state,{downloadAction:r,kind:i}=this.props;a===l.Mode.LOGIN?S.Notify.success(f.intl.formatMessage({id:"Ye/4Vz",defaultMessage:"Successfully signed in to Dropbox"})):S.Notify.success(f.intl.formatMessage({id:"4wqmq+",defaultMessage:"Successfully signed up for Dropbox"}));const o=t&&this.shouldRedirectToTeamDiscoveryPage(t);if(o)return g.redirect(o);if(this.props.onAuthenticateSuccess&&this.props.onAuthenticateSuccess(e),i===l.LoginOrRegisterKind.IMMEDIATE||i===l.LoginOrRegisterKind.SIDEBAR||r===l.DownloadAction.DIRECT_DOWNLOAD)if(a===l.Mode.REGISTER){if(t&&t.force_redirect_url&&t.redirect_url)return g.redirect(t.redirect_url);u.default.log("sharing","shared_link_welcome_modal_view"),this.closeModal(),p.Modal.showInstance(s.default.createElement(m.WelcomeModal,{id:"shared-link-welcome-modal"}))}else a===l.Mode.LOGIN&&g.reload();else this.closeModal()},this.onCancel=e=>{var t;e&&e.stopPropagation(),(0,o.logModalDismissed)(this.state.mode,null!==(t=this.props.kind)&&void 0!==t?t:void 0),this.props.onCancel&&this.props.onCancel(),this.closeModal()},this.closeModal=e=>{e&&e.stopPropagation(),this.setState(Object.assign(Object.assign({},this.state),{isOpen:!1}))},this.state={mode:e.initialMode||l.Mode.LOGIN,isThirdPartyRegistrationContinuation:!1,isOpen:!0},(0,_.assert)(!(e.kind===l.LoginOrRegisterKind.COMMENT&&!e.commentParams),"Comment parameters must be provided if calling this modal from comments code")}componentDidMount(){var e;(0,o.logAuthIntent)(this.state.mode),(0,o.logModalShown)(this.state.mode,null!==(e=this.props.kind)&&void 0!==e?e:void 0,this.props.loggingExtra),this.logWebActivityOnce()}render(){var e;const{mode:a}=this.state,{id:i,signup_tag:o,showGoogleRegistration:u,googleRegisterProps:h,customHeaderContent:p,customFooterContent:m,loginContinuationUrl:_,additionalLoginData:S,additionalRegisterData:E}=this.props;return s.default.createElement(b.Modal,{"aria-label":f.intl.formatMessage({id:"ByLOds",defaultMessage:"Login or register dialog"}),className:(0,r.default)("mc-util-modal mc-util-modal-regular login-or-register-modal","conversion-experiment"),id:i,withCloseButton:f.intl.formatMessage({id:"MbL/b4",defaultMessage:"Cancel"}),onRequestClose:this.onCancel,open:this.state.isOpen,overlayClassName:null!==(e=this.props.modalOverlayClassName)&&void 0!==e?e:"file-viewer-modal-overlay",width:400},this.renderHeader(),s.default.createElement(b.Modal.Body,{className:"mc-util-modal-body"},!p&&s.default.createElement(t.ExperimentalToggleMessage,{mode:this.state.mode,onHeaderLinkClick:this.toggleMode}),a===l.Mode.LOGIN&&s.default.createElement(n.LoginForm,{canRedirect:!1,continuationUrl:_||g.get_href(),className:"login-form-wrapper",googleLoginProps:{positionBelow:!0,signupTag:o},appleLoginProps:{positionBelow:!0},onLoginSuccess:this.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},encryptionOptions:this.props.encryptionOptions,additionalData:Object.assign(Object.assign({},S),{signup_tag:o||void 0})}),a===l.Mode.REGISTER&&s.default.createElement(d.RegisterForm,{additionalParams:Object.assign(Object.assign({},E),{signup_tag:o||void 0}),canRedirect:!1,className:"register-form-wrapper",onRegisterSuccess:this.onAuthenticateSuccess,tosCheckboxProps:{inline:!1},marketingOptInProps:{show:!!this.props.showMarketingOptIn,checked:!1},googleRegisterProps:u?Object.assign(Object.assign({},h||{}),{position:"BOTTOM"}):void 0,onRegisterFormEvent:e=>{e===c.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS&&this.setState({isThirdPartyRegistrationContinuation:!0})}})),m&&this.renderFooter())}shouldRedirectToTeamDiscoveryPage(e){const{mode:t}=this.state,{kind:a}=this.props;if(a===l.LoginOrRegisterKind.SIDEBAR&&t===l.Mode.REGISTER&&e.force_redirect_url&&e.redirect_url&&e.redirect_url.indexOf("/team/discover/suggest")>-1)return e.redirect_url}}t.TestOnlyLoginOrRegisterModal=w,w.defaultProps={showGoogleRegistration:!0},w.displayName="LoginOrRegisterModal";const M=(0,h.requireCssWithComponent)(w,["/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/components/login_or_register_modal-vflQwM7uH.css","/static/metaserver/static/css/legacy_packages/components-vfl86pl5V.css","/static/metaserver/static/css/components/button-vfl7d2xHj.css","/static/metaserver/static/css/scooter/scooter-scoped-vflhkBqI_.css","/static/metaserver/static/css/recaptcha_challenge-vflrcf67y.css","/static/metaserver/static/css/recaptcha_v2_challenge-vflYEW-GO.css"]);t.LoginOrRegisterModal=M})),define("metaserver/static/js/growth/experiments/logger",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importStar(s);class r{static start_counter(e,t){return Array.from(r.breakpoint_times).map(a=>(a=>r.breakpoints[e+a]=setTimeout(()=>t(e,{time_since_first_view:a}),1e3*a))(a))}static stop_counter(e){return Array.from(r.breakpoint_times).map(t=>clearTimeout(r.breakpoints[e+t]))}}r.breakpoints={},r.breakpoint_times=[5,15,60,120,300],r.start_times={},r.DEFAULT_TIMER_NAME="view_time",r.get_timer_name=e=>null==e||"boolean"==typeof e?r.DEFAULT_TIMER_NAME:e,r.set_start_time=e=>{const t=r.get_timer_name(e);return r.start_times[t]=Date.now()},r.do_log_view_time=(e,t)=>{const a=r.get_timer_name(t);return e[a]=Math.round((Date.now()-r.start_times[a])/1e3)},r.log=(e,t,a,i=!1)=>{switch(a=a||{},e){case"onboarding":return i&&r.do_log_view_time(a,i),s.SilentBackgroundRequest({url:"/growth_onboarding_log",data:{evt:t,extra:JSON.stringify(a)}});case"onboarding_server_view_experiments":return i&&r.do_log_view_time(a,i),s.SilentBackgroundRequest({url:"/uj_server_view_experiments_log",data:{evt:t,extra:JSON.stringify(a)}});case"sharing":return r.do_log_view_time(a),s.SilentBackgroundRequest({url:"/growth_sharing_log",data:{evt:t,extra:JSON.stringify(a)}});case"post_client_install_tab":return i&&r.do_log_view_time(a,i),s.SilentBackgroundRequest({url:"/growth_post_client_install_tab_log",data:{evt:t,extra:JSON.stringify(a)}});case"secondary_client_link":return i&&r.do_log_view_time(a,i),s.SilentBackgroundRequest({url:"/secondary_client_link_upsell_log",data:{evt:t,extra:JSON.stringify(a)}});default:throw new Error("Invalid series name")}},t.default=r})),define("metaserver/static/js/clean/ui/welcome_modal",["require","exports","tslib","react","metaserver/static/js/growth/experiments/logger","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/image","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/static_urls","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","spectrum/button/index","spectrum/modal/index"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WelcomeModal=t.TestOnlyWelcomeModal=void 0,s=a.__importStar(s),r=a.__importDefault(r),d=a.__importStar(d);const p=e=>{const t=e=>{e&&e.stopPropagation(),n.Modal.close(),d.reload()};return s.createElement(h.Modal,{appElement:document.body,ariaLabel:"Welcome to Dropbox modal",bodyClassName:"welcome-modal-body",bodyId:e.id||"welcome-modal",className:"welcome-modal",displayCloseButton:!0,onRequestClose:t,open:!0,overlayClassName:"file-viewer-modal-overlay"},s.createElement("div",{className:"welcome-modal-illo"},s.createElement(o.Image,{src:(0,l.static_url)("/static/metaserver/static/images/growth/dropbox_files-vfl7phztL.png"),srcHiRes:(0,l.static_url)("/static/metaserver/static/images/growth/dropbox_files@2x-vflABjXqu.png")})),s.createElement("h1",{className:"welcome-modal-title"},c.intl.formatMessage({id:"qoqdPt",defaultMessage:"Welcome to Dropbox!"})),s.createElement("div",{className:"welcome-modal-text"},c.intl.formatMessage({id:"LgDSr+",defaultMessage:"Now it’s easy to securely back up your files and photos, access them from any device, and share them with others."})),s.createElement(u.Button,{className:"go-to-dropbox-button",fullWidth:!0,href:e.redirect_url||"/home",onClick:()=>{r.default.log("sharing","shared_link_welcome_modal_button_click")},tagName:"a",variant:"primary"},c.intl.formatMessage({id:"Dkf+Pc",defaultMessage:"Go to my Dropbox"})),s.createElement("div",{className:"welcome-modal-no-thanks"},s.createElement(u.Button,{className:"button-as-link",fullWidth:!0,onClick:t,variant:"styleless"},c.intl.formatMessage({id:"ZZs8no",defaultMessage:"No thanks, stay on this page"}))))};t.TestOnlyWelcomeModal=p;const m=(0,i.requireCssWithComponent)(p,["/static/metaserver/static/css/welcome_modal-vfl8PUD8a.css"]);t.WelcomeModal=m})),define("metaserver/static/js/auth/multi_account_login_modal",["require","exports","tslib","react","metaserver/static/js/auth/login/form","metaserver/static/js/components/ui/modal","metaserver/static/js/clean/viewer","metaserver/static/js/core/assert","metaserver/static/js/core/i18n","spectrum/modal/index","metaserver/static/js/linked_users/linked_users_utils"],(function(e,t,a,s,r,i,o,n,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyMultiAccountLoginModal=t.TestOnlyAssumePersonalLockedModal=t.MultiAccountLoginModal=void 0,s=a.__importDefault(s);class u extends s.default.PureComponent{constructor(e){super(e),this.getUser=()=>{const{user:e,userId:t,role:a}=this.props;let s;return null!=e?s=e:null!=t?s=this.viewer.get_user_by_id(t,!0):null!=a&&(s=this.viewer.get_user_by_role(a,!0)),s},this.onLoginSuccess=e=>{this.viewer.sign_in_user_by_id(e.id),this.props.onAuthenticateSuccess&&!this.props.continuationUrl&&this.props.onAuthenticateSuccess(),this.closeModal()},this.closeModal=e=>{e&&e.stopPropagation(),this.props.onCancel&&this.props.onCancel(),i.Modal.close()},(0,n.assert)(null!==e.onAuthenticateSuccess&&void 0!==e.onAuthenticateSuccess||null!==e.continuationUrl&&void 0!==e.continuationUrl,"onAuthenticateSuccess and continuationUrl are mutually exclusive"),this.viewer=o.Viewer.get_viewer()}render(){if(this.viewer.is_team_assume_user_session)return s.default.createElement(p,{displayName:this.viewer.display_name,onRequestClose:this.closeModal,open:!0,teamName:this.viewer.team_name});const e=this.getUser();return(0,n.assert)(null!=e,"invalid user"),(0,n.assert)(!this.viewer.is_user_signed_in(e),"called multi-account login for a user that's already signed in"),s.default.createElement(h,{onRequestClose:this.closeModal,onAuthenticateSuccess:this.onLoginSuccess,open:!0,continuationUrl:this.props.continuationUrl,teamName:(null==e?void 0:e.team_name)||"",user:e,encryptionOptions:this.props.encryptionOptions,isLinkedUsersEnabled:(0,c.isMultipleLinkedUsersEnabled)(this.viewer)})}}t.MultiAccountLoginModal=u,u.displayName="MultiAccountLoginModal";const h=e=>{const{role:t}=e.user;if(!t)return null;return s.default.createElement(d.Modal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"lggZdA",defaultMessage:"Multi-account login modal"}),bodyClassName:"multiaccount-login-modal",bodyId:"multiaccount-login-modal",className:"mc-util-modal",displayCloseButton:!0,onRequestClose:e.onRequestClose,open:e.open,overlayClassName:"file-viewer-modal-overlay"},s.default.createElement("div",{className:"mc-util-modal-header"},e.isLinkedUsersEnabled?l.intl.formatMessage({id:"6y/0Hk",defaultMessage:"Sign in to your {email} Dropbox"},{email:e.user.email}):"personal"===t?l.intl.formatMessage({id:"DCfdq9",defaultMessage:"Sign in to your personal Dropbox"}):l.intl.formatMessage({id:"L5lWSy",defaultMessage:"Sign in to your {team_name} Dropbox"},{team_name:e.teamName})),s.default.createElement("div",{className:"mc-util-modal-body"},s.default.createElement(r.LoginForm,{canRedirect:!!e.continuationUrl,continuationUrl:e.continuationUrl||void 0,emailProps:{initialValue:e.user.email,readonly:!0},googleLoginProps:{positionBelow:!1},maestroStyle:!0,onLoginSuccess:e.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},type:"multi",encryptionOptions:e.encryptionOptions})))};t.TestOnlyMultiAccountLoginModal=h;const p=e=>{const{displayName:t,onRequestClose:a,teamName:r}=e;return s.default.createElement(d.UtilityModal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"XTU3gF",defaultMessage:"Personal account locked modal"}),className:"team-assume-user-modal",displayCloseButton:!0,onRequestClose:a,open:e.open,primaryAction:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),title:l.intl.formatMessage({id:"YcDQxL",defaultMessage:"Personal account not accessible"})},s.default.createElement("div",null,l.intl.formatMessage({id:"9uHtUs",defaultMessage:"{display_name}’s personal account isn’t managed by the {team_name} team, so its contents aren’t accessible to admins."},{display_name:t,team_name:r})))};t.TestOnlyAssumePersonalLockedModal=p})),define("metaserver/static/js/sharing/upsells/upsell_rich_banner",["require","exports","tslib","react","dig-components/typography","dig-components/buttons","metaserver/static/js/components/ui/css","react","metaserver/static/js/clean/ui/image","metaserver/static/js/clean/static_urls","metaserver/static/js/clean/analytics"],(function(e,t,a,s,r,i,o,n,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpsellBanner=void 0,s=a.__importStar(s);const u=({acceptText:e,declineText:t,titleText:a,bodyText:o,redirectHref:u,uxaPrefix:h,imgSrc:p,afterAccept:m,afterDecline:g})=>{const[_,f]=(0,n.useState)(!1);s.useEffect(()=>{c.ProEventsLogger.log(h)});return _?null:s.createElement("div",{className:"sharing-upsell-banner__container"},s.createElement("div",{className:"sharing-upsell-banner__text-info-container"},s.createElement(r.Title,{className:"sharing-upsell-banner__title-text",size:"small",isBold:!0},a),s.createElement(r.Text,{className:"sharing-upsell-banner__body-text",tagName:"p"},o),s.createElement("div",{className:"sharing-upsell-banner__footer"},s.createElement(i.Button,{variant:"outline",onClick:()=>m(f),href:u,"data-uxa-log":`${h}-upsell-banner-continue`,target:"_blank",rel:"noreferrer"},e),s.createElement("div",{className:"sharing-upsell-banner__secondary-button"},s.createElement(i.Button,{variant:"transparent",onClick:()=>{f(!0),g&&g()},"data-uxa-log":`${h}-upsell-banner-dismiss`},t)))),s.createElement("div",{className:"sharing-upsell-banner__image-container"},p?s.createElement(l.Image,{src:(0,d.static_url)(p)}):null))};u.displayName="UnstyledUpsellBanner",t.UpsellBanner=(0,o.requireCssWithComponent)(u,["/static/metaserver/static/css/sharing/share_page-vfldSBPq5.css"])})),define("metaserver/static/js/sharing/shared_content_link_mount_folder",["require","exports","tslib","react","metaserver/static/js/clean/browse_interface","metaserver/static/js/components/ui/modal","metaserver/static/js/auth/multi_account_login_modal","metaserver/static/js/sharing/api/client","metaserver/static/js/api_v2/user_client","metaserver/static/js/sharing/ui_notifications_util","metaserver/static/js/clean/viewer","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/flux/dispatcher","metaserver/static/js/sharing/share_page/action_types","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/auth/login_or_register/modal","metaserver/static/js/sharing/ui_util","metaserver/static/js/clean/analytics","metaserver/static/js/sharing/access_level","metaserver/static/js/clean/ui/snackbar"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S,E,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountSharedFolder=void 0,s=a.__importDefault(s),r=a.__importStar(r),u=a.__importStar(u),t.mountSharedFolder=function e(t){var a;const{shared_folder_id:v,origin:T,should_redirect:y,target_file:P,metadata:w,encryptionOptions:M,isEditFolderLink:C,rlkey:N,isFolderMember:I,addSavePreviewsVariant:A,user:R}=t,O=c.Viewer.get_viewer();let L;if(!R){const e=e=>u.reload();return void i.Modal.showInstance(s.default.createElement(_.LoginOrRegisterModal,{downloadAction:g.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:g.Mode.REGISTER,kind:g.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:e,signup_tag:"shmodel_modal_register",encryptionOptions:M}))}R&&!O.is_uid_signed_in(R.id)&&i.Modal.showInstance(s.default.createElement(o.MultiAccountLoginModal,{encryptionOptions:M,user:R,onAuthenticateSuccess:()=>{e({shared_folder_id:v,origin:T,should_redirect:y,target_file:null,metadata:w,encryptionOptions:M,isEditFolderLink:C,rlkey:N,isFolderMember:I,user:R})}})),L=R.id;let D=h.intl.formatMessage({id:"/sbniA",defaultMessage:"Adding to your Dropbox..."});["V1","V2","V3"].includes(A||"")?D=h.intl.formatMessage({id:"f1loFw",defaultMessage:"Joining this folder..."}):(O.is_paired||O.has_linked_users)&&(D=R.is_team?h.intl.formatMessage({id:"tvlH5P",defaultMessage:"Adding to your {team_name} Dropbox..."},{team_name:O.team_name}):h.intl.formatMessage({id:"vsrvkE",defaultMessage:"Adding to your personal Dropbox..."})),null===(a=b.Snackbar.manager)||void 0===a||a.reset(),(0,d.sharingNotificationInProgress)(D,!1);const F=new n.FolderShareApiClient({userId:L,client:new l.UserApiV2Client});p.Dispatcher.dispatch({type:m.SharePageActionTypes.MOUNT_FOLDER_REQUEST,metadata:w,user:R,shared_folder_id:v}),((e,t)=>!e||t?Promise.resolve():F.addMembers({accessLevel:E.ACCESS_LEVEL.WRITER,contentId:v,members:[{".tag":"email",email:R.email}],quiet:!0}))(C,I).then(()=>{F.mount({contentId:v}).then(e=>{(function(e){if(!e)return;let t=e;(null==P?void 0:P.ns_path)&&(t+=P.ns_path);const a=R,s=r.browse_uri_for_fq_path(a,t),i={role:R.role,file_id:P?P.file_id:null,ns_id:P?P.ns_id:v};S.ShareTibEventLogger.log(L,"BROWSE_SUCCESS",T,i),u.redirect(s.toString())})(e.path_lower)}).catch(e=>{var t;const a=e&&e.error&&e.error[".tag"];S.ShareTibEventLogger.log(L,"ADD_TO_DROPBOX_MOUNT_ERROR",T,{ns_id:v,rlkey:N,error_tag:a,error_summary:e&&e.summary}),null===(t=b.Snackbar.manager)||void 0===t||t.reset(),e&&e.error&&"insufficient_quota"===e.error[".tag"]?(0,d.sharingNotificationError)(h.intl.formatMessage({id:"jENkzW",defaultMessage:"Can’t add folder. Your Dropbox account is full."})):(0,f.isTotalMountsExceededError)(e)?(0,d.failSnackbarWithHelpCenter)((0,f.getTotalMountsExceededMountFoldersMsg)(e),f.NSF_HELP_ARTICLE_LINK):(0,f.isTreeSizeExceededError)(e)?(0,d.failSnackbarWithHelpCenter)((0,f.getTreeSizeExceededMountFoldersMsg)(e),f.NSF_HELP_ARTICLE_LINK):(0,f.isHomeMountsExceededError)(e)?(0,d.failSnackbarWithHelpCenter)((0,f.getHomeMountsExceededMountFoldersMsg)(e),f.NSF_HELP_ARTICLE_LINK):(0,d.sharingNotificationError)(h.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))})}).catch(e=>{var t;const a=e&&e.error&&e.error[".tag"];S.ShareTibEventLogger.log(L,"ADD_TO_DROPBOX_ADD_MEMBER_ERROR",T,{ns_id:v,rlkey:N,error_tag:a}),null===(t=b.Snackbar.manager)||void 0===t||t.reset(),(0,d.sharingNotificationError)(h.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))})}})),define("metaserver/static/js/sharing/confirmation_modals/confirm_with_option_modal",["require","exports","tslib","react","spectrum/modal/index","metaserver/static/js/ux_analytics/utils","metaserver/static/js/clean/ux_analytics_modal_tracking"],(function(e,t,a,s,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmWithOptionModal=void 0,s=a.__importDefault(s);class n extends s.default.Component{constructor(e){if(super(e),this.onCancel=()=>{this.props.onCancel&&this.props.onCancel(this.state.checked),(0,i.dispatchModalClosed)()},null==this.props.children)throw new Error("Must have children prop");this.state={checked:!1},this.handleOptionClick=this.handleOptionClick.bind(this),this.handleAccept=this.handleAccept.bind(this),this.handleDismissCompleted=this.handleDismissCompleted.bind(this)}render(){const e=this.props.id||"confirm-with-option-modal";return s.default.createElement(r.UtilityModal,{ariaLabel:this.props.title,title:this.props.title,overlayClickClose:!0,primaryAction:this.props.confirmText,secondaryAction:this.props.cancelText,onPrimaryAction:this.handleAccept,onSecondaryAction:this.onCancel,open:!0,onReady:i.dispatchModalOpened,onRequestClose:this.onCancel,overlayClassName:"file-viewer-modal-overlay confirmation-modal-overlay",link:this.props.link,onLink:this.props.onClickLink,style:{zIndex:10001}},s.default.createElement(o.UXAnalyticsModalTracking,{id:e}),this.renderContent())}renderContent(){return s.default.createElement("div",{className:"simple-modal-content"},s.default.createElement("div",{className:"confirm-with-option-modal__body-text"},this.props.children),this.renderOption())}renderOption(){return this.props.showOption?s.default.createElement("div",{className:"u-mar-vertical-s confirm-with-option-modal__option"},s.default.createElement("input",{"aria-checked":this.state.checked,checked:this.state.checked,className:"confirm-with-option-modal__option-input",id:"confirm-with-option-modal__input",name:"confirmation_option",onClick:this.handleOptionClick,role:"checkbox",type:"checkbox"}),s.default.createElement("label",{className:"confirm-with-option-modal__option-label",htmlFor:"confirm-with-option-modal__input"},this.props.optionLabel)):null}handleOptionClick(){this.setState({checked:!this.state.checked})}handleAccept(){this.props.onConfirm&&this.props.onConfirm(this.state.checked),(0,i.dispatchModalClosed)()}handleDismissCompleted(){this.props.onCancel&&this.props.onCancel(this.state.checked)}}t.ConfirmWithOptionModal=n,n.displayName="ConfirmWithOptionModal"})),define("metaserver/static/js/sharing/confirmation_modals/relinquish_membership_confirmation_modal",["require","exports","tslib","react","metaserver/static/js/sharing/confirmation_modals/confirm_with_option_modal","metaserver/static/js/core/i18n","metaserver/static/js/components/ui/modal"],(function(e,t,a,s,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showRelinquishMembershipConfirmationModal=void 0,s=a.__importDefault(s);t.showRelinquishMembershipConfirmationModal=function(e,t,a,n,l=!1,d=!1){let c,u,h=null;e?(u=i.intl.formatMessage({id:"UtDXzH",defaultMessage:"Remove your access to this folder?"}),c=t&&!d?i.intl.formatMessage({id:"u4EHIo",defaultMessage:"You may still have access to this folder through a company group or parent folder."}):i.intl.formatMessage({id:"1Oclqa",defaultMessage:"If you continue, you won’t be able to access this folder anymore."}),l&&(h=i.intl.formatMessage({id:"vZ/zQV",defaultMessage:"Keep a copy of this folder"}))):(u=i.intl.formatMessage({id:"l2Mi0q",defaultMessage:"Remove your access to this file?"}),c=i.intl.formatMessage({id:"N7+DBL",defaultMessage:"If you continue, you won’t be able to access this file anymore."}));const p=e?"relinquish-membership-folder-modal":"relinquish-membership-file-modal";return o.Modal.showInstance(s.default.createElement(r.ConfirmWithOptionModal,{cancelText:i.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),id:p,confirmText:i.intl.formatMessage({id:"eTtbKw",defaultMessage:"Remove my access"}),onCancel:n,onConfirm:a,optionLabel:h,showOption:null!=h,title:u},c))}})),define("metaserver/static/js/sharing/confirmation_modals/reset_access_modal",["require","exports","tslib","react","metaserver/static/js/clean/em_string","metaserver/static/js/components/ui/modal","metaserver/static/js/sharing/confirmation_modals/confirm_with_option_modal","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmResetAccess=void 0,s=a.__importDefault(s),t.confirmResetAccess=function(e){let t;t=e.isFolder?l.intl.formatMessage({id:"amJefU",defaultMessage:"Everyone will be removed from this folder. You’ll still keep a copy of this folder in your Dropbox."}):l.intl.formatMessage({id:"B69Z5q",defaultMessage:"Everyone will be removed from this file. You’ll still keep a copy of this file in your Dropbox."});const a=l.intl.formatMessage({id:"MH5OkG",defaultMessage:"Unshare “{content_name}”?"},{content_name:r.Emstring.em_snippet(e.contentName,n.SNIPPET_SIZES.FILENAME)});i.Modal.showInstance(s.default.createElement(o.ConfirmWithOptionModal,{cancelText:l.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),confirmText:l.intl.formatMessage({id:"oyC3Ha",defaultMessage:"Unshare"}),onCancel:e.onCancel,onConfirm:e.onConfirm,optionLabel:l.intl.formatMessage({id:"axFE/u",defaultMessage:"Let removed members keep a copy of this shared folder"}),showOption:e.allowLeaveACopy&&e.isFolder,title:a},t))}})),define("metaserver/static/js/sharing/upsells/util",["require","exports","metaserver/static/js/core/i18n","metaserver/static/js/growth/user_action/tracker"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.upsellBannerContext=t.trackDismissAction=t.DocsendUpsellUserAction=t.DocsendUpsellUserActionTracker=void 0;class r extends s.GrowthUserActionTracker{constructor(){super(...arguments),this.project="pg_docsend_contextual_upsell"}}var i;t.DocsendUpsellUserActionTracker=r,(function(e){e.DOCSEND_UPSELL_SHARING_DIALOG_OR_BANNER_DISMISSED_ACTION="docsend_upsell_sharing_dialog_or_banner_dismissed",e.POST_UPLOAD_SNACKBAR_SHOWN="post_upload_snackbar_shown"})(i=t.DocsendUpsellUserAction||(t.DocsendUpsellUserAction={}));t.trackDismissAction=e=>{if(void 0!==e){new r(e).track(i.DOCSEND_UPSELL_SHARING_DIALOG_OR_BANNER_DISMISSED_ACTION,{})}};const o={docsend:{acceptText:a.intl.formatMessage({id:"6dTn9+",defaultMessage:"Try DocSend"}),declineText:a.intl.formatMessage({id:"PaR0U3",defaultMessage:"Skip"}),titleText:a.intl.formatMessage({id:"hm8Dgf",defaultMessage:"Interested in analytics and advanced sharing controls?"}),bodyText:a.intl.formatMessage({id:"KKXTSe",defaultMessage:"With DocSend you can control document versions, track activity with analytics, and share multiple documents with a single link."}),afterAccept:e=>{e(!0)},redirectHref:"https://docsend.com/signup/dropbox?utm_source=Dropbox%20Referral&utm_medium=Referral&utm_campaign=sh-page-v1&signup_source=sh-page-v1",uxaPrefix:"docsend-shared-page-upsell-banner",imgSrc:"/static/metaserver/static/images/product_growth/docsend_upsell/shared_page_banner-vfll-NvSO.svg"}};t.upsellBannerContext=o})),define("metaserver/static/js/loggers/folder_preview_logger",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","metaserver/static/js/modules/constants/request","metaserver/static/js/previews/ui/constants","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/uuid/uuid","metaserver/static/js/loggers/device_type","metaserver/static/js/perf_tools/web_timing_utils"],(function(e,t,a,s,r,i,o,n,l,d){"use strict";var c;function u(e){return+!!e}function h(e){return JSON.stringify(Object.assign(Object.assign({},e),{has_cached_data:u(e.has_cached_data),folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:u(e.subfolder_nav_tracking),web_timing_data:JSON.stringify(e.web_timing_data)}))}function p(e){const t=Object.assign({},e.extra),a=window.performance.timing;return(null==a?void 0:a.fetchStart)&&(t.time_to_first_byte=a.responseStart-a.fetchStart,t.web_timing_data=a),{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:h(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.markPrimaryEvent=t.createSession=t.EventType=void 0,s=a.__importStar(s),r=a.__importStar(r),(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view",e.breadcrumbClicked="breadcrumb_clicked"})(c=t.EventType||(t.EventType={})),t.createSession=function({id:e=n.UUID.v4({allowInsecure:!0}),ns_id:t=0,deviceType:a=(0,l.getDeviceType)(),web_request_id:s=r.REQUEST_ID,source_action:c=i.PreviewSourceAction.Visit,subfolder_nav_tracking:u,has_cached_data:h,folder_id:p}={}){return{id:e,ns_id:t,web_request_id:s,deviceType:a,extra:{start_time:c===i.PreviewSourceAction.Visit?(0,o.start_time)():d.WebTimingUtil.getNow(),subfolder_nav_tracking:u,has_cached_data:h,source_action:c,folder_preview_timeline:{},folder_id:p}}},t.markPrimaryEvent=function(e){const{extra:t}=e;if(t.primary_mark_ts)return;const a=d.WebTimingUtil.getNow();t.primary_mark_ts=a;const{start_time:s}=t;s&&t.primary_mark_ts&&(t.time_to_primary_mark=t.primary_mark_ts-s)},t.logEvent=function(e,t){const{extra:{folder_preview_timeline:a}}=t,r=d.WebTimingUtil.getNow();if(!a.preview_session_ended_ts){switch(e){case c.attempted:if(a.preview_attempted_ts)return;a.preview_attempted_ts=r;break;case c.ended:if(a.preview_session_ended_ts)return;a.preview_session_ended_ts=r;break;case c.renderSucceeded:if(a.render_succeeded_ts)return;a.render_succeeded_ts=r;break;case c.renderFailed:if(a.render_failed_ts)return;a.render_failed_ts=r}return(function(e,t){return s.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:Object.assign(Object.assign({},p(t)),{event_name:e})})})(e,t)}}})),define("metaserver/static/js/breadcrumb/trail",["require","exports","tslib","react","classnames","typescript/libraries/spectrum-content-icon-compatibility/src/index","typescript/libraries/spectrum-content-icon-compatibility/src/index","spectrum/popover/index","metaserver/static/js/clean/em_string","metaserver/static/js/breadcrumb/constants","metaserver/static/js/breadcrumb/utils","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/flag","metaserver/static/js/clean/ui/sprite","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SmartBreadcrumbTrail=t.BreadcrumbTrail=void 0,s=a.__importDefault(s),r=a.__importDefault(r);class g extends s.default.Component{constructor(){super(...arguments),this.onSegmentClicked=(e,t)=>{this.onCrumbClicked(e,t)},this.onMenuClicked=(e,t,a)=>{this.onCrumbClicked(e,t)}}get crumbs(){return[...this.props.overflowCrumbs,...this.props.inlineCrumbs]}get lastCrumb(){return this.props.inlineCrumbs[this.props.inlineCrumbs.length-1]}onCrumbClicked(e,t){this.props.onChange&&this.props.onChange(e,t,this.crumbs.indexOf(t))}render(){return s.default.createElement("span",null,s.default.createElement("h1",{className:"ax-visually-hidden"},this.lastCrumb.label),s.default.createElement("nav",{className:"breadcrumb-trail u-l-fl","aria-label":m.intl.formatMessage({id:"j2wHLa",defaultMessage:"Folder Hierarchy"}),role:"navigation"},this.props.overflowCrumbs.length?s.default.createElement(S,{crumbs:this.props.overflowCrumbs,onChange:this.onMenuClicked,overflowAttachDirection:this.props.overflowAttachDirection,overflowAttachPosition:this.props.overflowAttachPosition}):null,this.props.inlineCrumbs.map((e,t)=>s.default.createElement(b,{key:t,crumb:e,isLastCrumb:e===this.lastCrumb,onClick:this.onSegmentClicked,maxWidth:(0,c.getMaxInlineTrailWidth)(!!this.props.overflowCrumbs.length)}))))}}g.defaultProps={overflowCrumbs:[]},g.displayName="BreadcrumbTrail";const _=(0,u.requireCssWithComponent)(g,["/static/metaserver/static/css/breadcrumbs-vflfL28sW.css"]);t.BreadcrumbTrail=_;t.SmartBreadcrumbTrail=e=>{const{overflowCrumbs:t,inlineCrumbs:a}=(0,c.splitCrumbs)(e.crumbs,(0,c.getMaxInlineTrailWidth)(!0));return s.default.createElement(_,{overflowCrumbs:t,inlineCrumbs:a,onChange:e.onChange,overflowAttachDirection:e.overflowAttachDirection,overflowAttachPosition:e.overflowAttachPosition})};class f extends s.default.Component{render(){return s.default.createElement(p.Sprite,{group:"web",name:"chevron",className:"breadcrumb-separator",alt:""})}}f.displayName="BreadcrumbSeparator";class S extends s.default.Component{constructor(){super(...arguments),this.onClick=(e,t)=>{this.props.onChange&&this.props.onChange(e,t,this.props.crumbs.indexOf(t))}}render(){const e=[...this.props.crumbs];return e.reverse(),s.default.createElement("span",{className:"breadcrumb-menu-container"},s.default.createElement(n.Popover,null,s.default.createElement(n.PopoverTrigger,{className:"breadcrumb-trigger","aria-label":m.intl.formatMessage({id:"HcOP1H",defaultMessage:"Breadcrumb target"})},s.default.createElement("span",{className:"u-unbutton breadcrumb-overflow-button u-l-fl","aria-label":m.intl.formatMessage({id:"ku7o1P",defaultMessage:"Breadcrumb overflow"})},s.default.createElement(o.IconContent,{name:"folder_dropdown-small"}))),s.default.createElement(n.PopoverContent,{attachment:this.props.overflowAttachDirection,position:this.props.overflowAttachPosition},e.map(e=>s.default.createElement(E,{key:e.label,crumb:e,onClick:this.onClick})))),s.default.createElement(f,null))}}S.displayName="BreadcrumbMenu";class E extends s.default.Component{constructor(){super(...arguments),this.onClick=e=>{this.props.onClick&&this.props.onClick(e,this.props.crumb)}}render(){const{crumb:e}=this.props,t=l.Emstring.em_snippet(e.label,d.MAX_MENU_ITEM_WIDTH_IN_EMS);return s.default.createElement(n.PopoverContentItem,{className:"breadcrumb-menu-item",href:e.href,onClick:this.onClick},s.default.createElement(h.Flag,{leftAttachment:e.isFile?s.default.createElement(i.FileIcon,{path:e.label}):s.default.createElement(o.IconContent,{name:"folder-small"})},s.default.createElement("div",{className:"breadcrumb-menu-item__text u-pad-left-xs"},t)))}}E.displayName="BreadcrumbMenuItem";class b extends s.default.Component{constructor(){super(...arguments),this.onClick=e=>{this.props.onClick&&this.props.onClick(e,this.props.crumb)}}getLabel(){return l.Emstring.em_snippet(this.props.crumb.label,this.props.maxWidth)}render(){const e=this.getLabel();return this.props.isLastCrumb?s.default.createElement("span",{className:"breadcrumb-segment"},e):s.default.createElement("span",null,s.default.createElement("a",{className:(0,r.default)("breadcrumb-segment","ancestor-breadcrumb-segment"),href:this.props.crumb.href,onClick:this.onClick},e),s.default.createElement(f,null))}}b.displayName="BreadcrumbSegment"})),define("metaserver/static/js/breadcrumb/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEPARATOR_WIDTH_IN_EMS=t.MENU_TARGET_WIDTH_IN_EMS=t.MAX_TRAIL_WIDTH_IN_EMS=t.MAX_MENU_ITEM_WIDTH_IN_EMS=void 0,t.MAX_MENU_ITEM_WIDTH_IN_EMS=37,t.MAX_TRAIL_WIDTH_IN_EMS=28,t.MENU_TARGET_WIDTH_IN_EMS=2.625,t.SEPARATOR_WIDTH_IN_EMS=1.64})),define("metaserver/static/js/breadcrumb/utils",["require","exports","metaserver/static/js/clean/em_string","metaserver/static/js/breadcrumb/constants"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMaxInlineTrailWidth=t.splitCrumbs=void 0,t.splitCrumbs=function(e,t){if(1===e.length)return{overflowCrumbs:[],inlineCrumbs:e};const r=e.map(e=>new a.Emstring(e.label).length);let i=1,o=r[e.length-1];for(let a=e.length-2;a>=0;a--){const e=s.SEPARATOR_WIDTH_IN_EMS+r[a];if(o+e>t)break;i+=1,o+=e}const n=e.length-i;return{overflowCrumbs:e.slice(0,n),inlineCrumbs:e.slice(n)}},t.getMaxInlineTrailWidth=function(e){return e?s.MAX_TRAIL_WIDTH_IN_EMS-s.MENU_TARGET_WIDTH_IN_EMS:s.MAX_TRAIL_WIDTH_IN_EMS}})),define("metaserver/static/js/overquota/overquota_modal_helpers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructImageObject=void 0;t.constructImageObject=(e="")=>{const t=e=>`/static/metaserver/static/images/pro/overquota/${e}.png`,a=(e,a,s)=>({height:s,width:a,src:t(e),srcHiRes:t(`${e}@2x`)});switch(e){case"V1":return a("illo-catbox",138,98);case"V2":return a("illo-clown-car",138,111);default:return a("overquota-folder",130,90)}}})),define("metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_modal",["require","exports","tslib","metaserver/static/js/clean/analytics","metaserver/static/js/clean/history","metaserver/static/js/async/loadable","metaserver/static/js/components/ui/modal","metaserver/static/js/overquota/overquota_modal_helpers","metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_modal_content","metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_buttons","metaserver/static/js/clean/viewer","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/modules/constants/payments","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/core/uri","react","react-intl","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants"],(function(e,t,a,s,r,i,o,n,l,d,c,u,h,p,m,g,_,f,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfQuotaModal=void 0,r=a.__importDefault(r),u=a.__importStar(u),h=a.__importStar(h),p=a.__importStar(p),_=a.__importDefault(_);class E extends _.default.Component{constructor(t){super(t),this.ASK="ask",this.ASKING="asking",this._closeSyncModal=()=>{const e=this.props.outOfQuotaQP;s.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),this.logOutOfQuotaClose(),r.default.remove_query_param("sm"),this.refs.modal.close()},this.getTitleText=()=>m.intl.formatMessage({id:"60BabM",defaultMessage:"Not enough space"}),this._renderTipBody=()=>this.props.usageRemaining?m.intl.formatMessage({id:"ARfvq4",defaultMessage:"To add this folder, you’ll need {needed} of space in your Dropbox. You currently have {remaining} of space left."},{remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):this.props.usageNeeded?m.intl.formatMessage({id:"wZBdwd",defaultMessage:"To add this folder, you’ll need {needed} of space in your Dropbox. You currently have no space left."},{needed:this.props.usageNeeded}):m.intl.formatMessage({id:"ffc4Og",defaultMessage:"To add this folder, you’ll need {needed} of space in your Dropbox. You currently have not enough space left."},{needed:this.props.folderSize}),this.logOutOfQuotaClose=()=>{const e=u.start_time(),t=(new Date).getTime();s.ShareTibEventLogger.log(this.props.activeUserId,"OUT_OF_QUOTA_MODAL_CLOSE",S.SHARE_ACTION_ORIGIN_TYPE.OUT_OF_QUOTA_MODAL,{timing:t-e,ns_id:this.props.syncNSId})},this.onDismiss=()=>{const e=this.props.outOfQuotaQP;s.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),this.logOutOfQuotaClose()},this.logOutOfQuotaSubmit=()=>{const t=S.SHARE_ACTION_ORIGIN_TYPE.OUT_OF_QUOTA_MODAL;s.ShareTibEventLogger.log(this.props.activeUserId,"OUT_OF_QUOTA_MODAL_UPGRADE",t,{ns_id:this.props.syncNSId,cta_text:this.state.buttonTextUntranslated,usage_remaining:this.props.usageRemaining,usage_needed:this.props.usageNeeded}),new Promise((t,a)=>{e(["metaserver/static/js/loggers/shared_page_logger"],t,a)}).then(a.__importStar).then(e=>{e.SharedPageLogger.logFromOverQuotaModal(e.SharedPageEventType.GET_MORE_SPACE_CLICK_IN_MODAL,this.props.syncNSId.toString(),this.props.accessLevel,this.props.activeUserId)})},this.redirectToUpgradePage=()=>{const e=this.props.outOfQuotaQP,t="wb_nq_shm_share_w"===e||"wb_nq_shm_share_ro"===e?h.LOW_SPACE_URL:h.OUT_OF_SPACE_URL,a=new g.URI({path:t}).updateQuery({oqa:e});p.redirect(a.toString())},this.onSyncButtonClicked=()=>{this.setState({state:this.ASKING});const e=this.props.outOfQuotaQP;s.NQOQLogger.logAcceptModal(e,{modal_type:"billboard",cta_text:"upgrade to add folder"}),this.logOutOfQuotaSubmit(),this.redirectToUpgradePage()},this.onPreviewButtonClicked=()=>{const e=this.props.outOfQuotaQP;s.NQOQLogger.logPreviewLink(e,{modal_type:"billboard"}),this.props.previewCallback&&this.props.previewCallback()},this.state={state:this.ASK}}static showInstance(e){o.Modal.showInstance(e);const t=e.props.outOfQuotaQP;s.NQOQLogger.logViewModal(t,{modal_type:"billboard"})}componentWillMount(){this.user=c.Viewer.get_viewer().get_user_by_id(this.props.activeUserId);const e=(0,f.defineMessage)({id:"Jm2Zmr",defaultMessage:"Get more space"}),t={buttonText:m.intl.formatMessage(e),buttonTextUntranslated:e.defaultMessage};this.setState(t)}componentDidMount(){u.mark_time_to_interactive(),new Promise((t,a)=>{e(["metaserver/static/js/loggers/shared_page_logger"],t,a)}).then(a.__importStar).then(e=>{e.SharedPageLogger.logFromOverQuotaModal(e.SharedPageEventType.GET_MORE_SPACE_MODAL_RENDER,this.props.syncNSId.toString(),this.props.accessLevel,this.props.activeUserId)})}render(){const{outOfQuotaQP:e,className:t}=this.props;return e?this.renderOverquotaModal(e):_.default.createElement(o.Modal,{autoClose:!1,buttonComponent:this.renderButtons(),className:t,clickOutToClose:!1,ref:"modal",showX:!1,title:"",onDismiss:this.onDismiss},_.default.createElement(l.OutOfQuotaModalContent,{showX:!0,ownerName:this.props.ownerName,folderName:this.props.folderName,folderSize:this.props.folderSize,targetFile:this.props.targetFile,onClose:this._closeSyncModal,accessText:this.getTitleText(),tipBody:this._renderTipBody()}))}renderOverquotaModal(t,s){const r=(0,i.Loadable)({loader:()=>new Promise((t,a)=>{e(["metaserver/static/js/overquota/overquota_modal"],t,a)}).then(a.__importStar).then(({OverquotaModal:e})=>e)}),o=(0,n.constructImageObject)();return _.default.createElement(r,{headline:m.intl.formatMessage({id:"R4XFxQ",defaultMessage:"Not enough space"}),tagline:m.intl.formatMessage({id:"TGEyA+",defaultMessage:"To add this folder, you’ll need more space in your Dropbox."}),oqa:t,imageObject:o,ctaUrl:s,ctaText:this.state.buttonText,ctaTextUntranslated:this.state.buttonTextUntranslated,onClose:this.logOutOfQuotaClose,showX:!0,isFamily:this.props.isFamily,activeUserId:this.props.activeUserId,nsId:this.props.syncNSId})}renderButtons(){const e=this.state.buttonText||m.intl.formatMessage({id:"TZD+x6",defaultMessage:"Upgrade to add folder"});return _.default.createElement(d.OutOfQuotaModalButtons,{disabled:this.state.state===this.ASKING,onSyncButtonClicked:this.onSyncButtonClicked,buttonText:e,accessLevel:this.props.accessLevel,activeUserId:this.props.activeUserId,targetFile:this.props.targetFile,previewCallback:this.onPreviewButtonClicked,previewUrl:this.props.previewUrl,syncNSId:this.props.syncNSId})}}t.OutOfQuotaModal=E,E.displayName="OutOfQuotaModal"})),define("metaserver/static/js/sharing/out_of_quota_modal/preview_button",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/clean/analytics","typescript/component_libraries/spectrum-sharing/src/utils/sharing_constants","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","metaserver/static/js/core/uri"],(function(e,t,a,s,r,i,o,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewButton=void 0,s=a.__importDefault(s),n=a.__importStar(n);class c extends s.default.Component{constructor(){super(...arguments),this.onPreviewButtonClicked=()=>{if(this.props.previewCallback){const e=o.SHARE_ACTION_ORIGIN_TYPE.OUT_OF_QUOTA_MODAL;i.ShareTibEventLogger.log(this.props.activeUserId,"UNMOUNTED_SEARCH_PREVIEW",e,{ns_id:this.props.syncNSId}),this.props.previewCallback()}else{const e=this.props.previewUrl?d.URI.parse(this.props.previewUrl):n.get_uri().removeQuery("sm");n.redirect(e)}}}render(){return s.default.createElement(r.Button,{variant:"opacity",onClick:this.onPreviewButtonClicked,className:"sync-modal-preview-button"},!this.props.targetFile||this.props.targetFile.is_dir?l.intl.formatMessage({id:"nkiGW5",defaultMessage:"Preview folder"}):l.intl.formatMessage({id:"lom/AO",defaultMessage:"Preview file"}))}}t.PreviewButton=c,c.displayName="PreviewButton"})),define("metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_modal_content",["require","exports","tslib","react","typescript/component_libraries/spectrum-sharing/src/components/sharing_modal_banner/index","metaserver/static/js/core/i18n","metaserver/static/js/sharing/out_of_quota_modal/shared_folder_info","metaserver/static/js/sharing/out_of_quota_modal/top_panel"],(function(e,t,a,s,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfQuotaModalContent=void 0,s=a.__importDefault(s),t.OutOfQuotaModalContent=function(e){const{showX:t}=e;return s.default.createElement("div",{className:"content-link-sync-modal__content"},s.default.createElement(n.TopPanel,{showX:t,ownerName:e.ownerName,folderName:e.folderName,folderSize:e.folderSize,targetFile:e.targetFile,onClose:e.onClose}),e.showOffTeamBanner&&s.default.createElement(r.SharingModalBanner,{borderHidden:!0,className:"content-link-sync-modal__off-team-warning",message:i.intl.formatMessage({id:"XPkdu6",defaultMessage:"This person is outside your Dropbox team."}),type:"warn"}),s.default.createElement("div",{className:"content-link-sync-modal__tip-panel u-pad-top-m u-pad-horizontal-m"},e.targetFile?s.default.createElement(o.SharedFolderInfo,{folderName:e.folderName,folderSize:e.folderSize,targetFile:e.targetFile}):s.default.createElement("div",{className:"content-link-sync-modal__access-text"},e.accessText),s.default.createElement("div",{className:"content-link-sync-modal__tip-body"},e.tipBody)))}})),define("metaserver/static/js/sharing/out_of_quota_modal/shared_folder_info",["require","exports","tslib","react","metaserver/static/js/clean/ui/sprite","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedFolderInfo=void 0,s=a.__importDefault(s),t.SharedFolderInfo=function(e){return s.default.createElement("div",{className:"content-link-sync-modal__shared-folder-info"},s.default.createElement("div",{className:"content-link-sync-modal__shared-folder-text"},e.targetFile.is_dir?i.intl.formatMessage({id:"cVFJYA",defaultMessage:"This folder is part of a shared folder:"}):i.intl.formatMessage({id:"1NI2g/",defaultMessage:"This file is part of a shared folder:"})),s.default.createElement("div",null,s.default.createElement(r.Sprite,{alt:"",group:"web",name:"folder_user_32"})),s.default.createElement("p",{className:"u-font-meta"},e.folderName,s.default.createElement("br",null),e.folderSize))}})),define("metaserver/static/js/sharing/out_of_quota_modal/out_of_quota_buttons",["require","exports","tslib","react","dig-components/buttons","metaserver/static/js/sharing/out_of_quota_modal/preview_button","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfQuotaModalButtons=void 0,s=a.__importDefault(s),t.OutOfQuotaModalButtons=function(e){return s.default.createElement("div",{className:"content-link-sync-modal__buttons u-pad-m"},s.default.createElement(r.Button,{className:"content-link-sync-modal__add-to-dropbox-button",disabled:e.disabled,onClick:e.onSyncButtonClicked,variant:"primary"},e.buttonText),"can_view"===e.accessLevel&&s.default.createElement("div",null,s.default.createElement("span",{className:"content-link-sync-modal__or"},o.intl.formatMessage({id:"Gzdvtw",defaultMessage:"Or"})),s.default.createElement(i.PreviewButton,{activeUserId:e.activeUserId,targetFile:e.targetFile,previewCallback:e.previewCallback,previewUrl:e.previewUrl,syncNSId:e.syncNSId})))}})),define("metaserver/static/js/sharing/out_of_quota_modal/top_panel",["require","exports","tslib","react","metaserver/static/js/clean/em_string","js/filepath/filepath","metaserver/static/js/clean/ui/sprite","metaserver/static/js/sharing/views/hover_close_button","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopPanel=void 0,s=a.__importDefault(s),i=a.__importStar(i),n=a.__importDefault(n);class d extends s.default.Component{constructor(){super(...arguments),this.topPanelIcon=()=>this.props.targetFile?s.default.createElement(o.Sprite,{alt:"",group:"web",name:this.props.targetFile.icon}):s.default.createElement(o.Sprite,{alt:"",group:"web",name:"folder_user_32"}),this.topPanelTitleText=()=>this.props.targetFile?r.Emstring.em_snippet(i.filename(this.props.targetFile.fq_path),15):r.Emstring.em_snippet(this.props.folderName,15),this.topPanelSubtitleText=()=>this.props.targetFile?this.props.ownerName?l.intl.formatMessage({id:"31w6qR",defaultMessage:"Owned by {name}"},{name:this.props.ownerName}):l.intl.formatMessage({id:"JERs0V",defaultMessage:"Not currently owned"}):this.props.folderSize}render(){return s.default.createElement("div",{className:"content-link-sync-modal__top-panel u-pad-s"},s.default.createElement("div",{className:"content-link-sync-modal__icon u-pad-top-xs"},this.topPanelIcon()),s.default.createElement("div",{className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},s.default.createElement("h3",{className:"u-font-strong"},this.topPanelTitleText()),s.default.createElement("h4",{className:"u-trim-margin u-font-meta"},this.topPanelSubtitleText())),this.props.showX&&s.default.createElement("div",{className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},s.default.createElement(n.default,{onClick:this.props.onClose})))}}t.TopPanel=d,d.displayName="TopPanel"})),define("metaserver/static/js/sharing/views/hover_close_button",["require","exports","tslib","classnames","react","metaserver/static/js/clean/ui/sprite","metaserver/static/js/core/i18n"],(function(e,t,a,s,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importDefault(r);class n extends r.default.Component{constructor(){super(...arguments),this.state={hover:!1}}render(){const e=o.intl.formatMessage({id:"lNU//O",defaultMessage:"Close Modal"});return r.default.createElement("button",Object.assign({},this.props,{"aria-label":e,className:(0,s.default)("c-borderless-button",this.props.className),onMouseOut:()=>this.setState({hover:!1}),onMouseOver:()=>this.setState({hover:!0})}),r.default.createElement(i.Sprite,{group:"web",name:this.state.hover?"xclose":"xclose_light_gray",alt:e}))}}n.displayName="HoverCloseButton",t.default=n})),define("typescript/component_libraries/spectrum-sharing/src/components/sharing_modal_banner/index",["require","exports","tslib","typescript/component_libraries/spectrum-sharing/src/components/sharing_modal_banner/sharing_modal_banner"],(function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a.__exportStar(s,t)})),define("typescript/component_libraries/spectrum-sharing/src/components/sharing_modal_banner/sharing_modal_banner",["require","exports","tslib","classnames","react","dig-components/typography"],(function(e,t,a,s,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalBanner=void 0,s=a.__importDefault(s),r=a.__importStar(r);class o extends r.PureComponent{typeClassName(){return`scl-sharing-modal-banner--${this.props.type}`}render(){const{borderHidden:e,className:t,message:a,descriptionLinkUrl:o,descriptionLinkText:n}=this.props,l=(0,s.default)("scl-sharing-modal-banner",this.typeClassName(),t,{"scl-sharing-modal-banner--bottom-border":!e}),d=o&&n?r.createElement("div",null,r.createElement(i.Link,{href:o,hasNoUnderline:!0},n)):void 0;return r.createElement("div",{className:l},a,d)}}t.SharingModalBanner=o,o.defaultProps={type:"default"},o.displayName="SharingModalBanner"}));
//# sourceMappingURL=pkg-sharing-sync.min.js-vfl3pUbI4.map