define("metaserver/static/js/folder_dialog/api",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_as_promised_jquery","metaserver/static/js/api_v2/user_client","metaserver/static/js/folder_dialog/constants","metaserver/static/js/core/exception"],(function(e,t,r,o,s,n,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFolderSuggestion=t.getFolderContentsAPIv2=t.getFolderContents=t.getFolderContentsWithCache=void 0,o=r.__importStar(o);const i={};function a(e,t){const r={folder:t};return o.WebRequestOref({url:"/browse_util/tree_view_folders",type:"POST",subject_user:e,data:r,dataType:"json",skipNotifyError:!0})}t.getFolderContentsWithCache=function(e,t){return(!i[t]||Date.now()-i[t].timestamp>n.CACHE_TTL_MS)&&(i[t]={folderContents:a(e,t),timestamp:Date.now()}),i[t].folderContents},t.getFolderContents=a,t.getFolderContentsAPIv2=function(e,t,o,n){return r.__awaiter(this,void 0,void 0,(function*(){const r=new s.UserApiV2Client;try{const s=yield r.ns("files").rpc("list_subfolders",{path:t,max_height:o,limit_sub_folder_count:n},{subjectUserId:e}),_=[];return(s.subfolder_entries||[]).forEach(e=>{const t=e.folder_metadata;let r=!1,o=!1,s=0;t.sharing_info&&(r=t.sharing_info.read_only||!!t.sharing_info.no_access,o=!!t.sharing_info.no_access,void 0!==t.sharing_info.shared_folder_id&&(s=parseInt(t.sharing_info.shared_folder_id,10))),_.push({path:t.path_display||"",has_subdirs:e.has_subfolders||!1,icon:t.icon||"",read_only:r||!1,contained_ns:e.contained_ns||0,target_ns:s,no_access:o})}),_}catch(e){throw(0,_.reportException)({err:e.raw?new Error(e.raw.responseBody):e,severity:"non-critical",tags:["js:browse"]}),e}}))},t.getFolderSuggestion=function(e,t,r){return(new s.UserApiV2Client).ns("ml").rpc("get_folder_suggestion",{paths:t,action:r},{subjectUserId:e})}})),define("metaserver/static/js/folder_dialog/constants",["require","exports","metaserver/static/js/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_TTL_MS=t.DEFAULT_REVISION_ID=t.FOLDER_INPUT_HEIGHT=t.FOLDER_SUGGESTION_HEIGHT=t.LOADING_MIN_TIME=t.DIALOG_BODY_PADDING=t.PATH_BREADCRUMB_HEIGHT=t.DIALOG_ACTIONS_HEIGHT=t.DIALOG_HEAD_HEIGHT=t.errorDialogProps=t.FolderPickerLoadingState=t.Operation=t.ACCESS_LEVEL=t.TEAM_MEMBER=t.MAX_FOLDER_NAME_LENGTH=t.INVALID_FOCUS_INDEX=t.SUGGESTED_LOCATION_KEY_SCOPE=t.KEY_SCOPE=void 0,t.KEY_SCOPE="folder_picker_keyboard_selection",t.SUGGESTED_LOCATION_KEY_SCOPE="suggested_location_keyboard_selection",t.INVALID_FOCUS_INDEX=-1,t.MAX_FOLDER_NAME_LENGTH=20,t.TEAM_MEMBER="team_member",(function(e){e[e.ACCESS=0]="ACCESS",e.LIMITED_ACCESS="locked",e.LIMITED_ACCESS_VAULT="vault",e.NO_ACCESS="no_access"})(t.ACCESS_LEVEL||(t.ACCESS_LEVEL={})),(function(e){e[e.COPY=0]="COPY",e[e.MOVE=1]="MOVE",e[e.UPLOAD=2]="UPLOAD",e[e.EXPORT_LEGAL_HOLD=3]="EXPORT_LEGAL_HOLD"})(t.Operation||(t.Operation={})),(function(e){e[e.LOADING=0]="LOADING",e[e.ERROR=1]="ERROR",e[e.LOADED=2]="LOADED"})(t.FolderPickerLoadingState||(t.FolderPickerLoadingState={})),t.errorDialogProps={primaryAction:r.intl.formatMessage({id:"BCyGLk",defaultMessage:"Try again"}),secondaryAction:r.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),title:r.intl.formatMessage({id:"v3oTv1",defaultMessage:"Something went wrong on our end"}),ariaLabel:"",open:!0,variant:"regular"},t.DIALOG_HEAD_HEIGHT=64,t.DIALOG_ACTIONS_HEIGHT=64,t.PATH_BREADCRUMB_HEIGHT=40,t.DIALOG_BODY_PADDING=26,t.LOADING_MIN_TIME=200,t.FOLDER_SUGGESTION_HEIGHT=89,t.FOLDER_INPUT_HEIGHT=93,t.DEFAULT_REVISION_ID="0000000000000000",t.CACHE_TTL_MS=3e3}));
//# sourceMappingURL=pkg-folder-dialog-api.min.js-vflBq3lnO.map