define(["require","exports","tslib","react","prop-types","dig-components/icons/src","dig-components/buttons","dig-components/icons","dig-components/tooltips","react-intl","dig-components/typography","dig-components/buttons","typescript/libraries/comments2/src/components/types/index","typescript/libraries/comments2/src/components/comment_editor/index.module.css","typescript/libraries/comments2/src/components/comment_editor/layers/hyperlinks"],(function(e,t,o,r,n,a,l,i,s,c,u,d,m,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecorderButton=t.CAPTURE_COMMENTS_EXPERIMENT=void 0,r=o.__importStar(r),n=o.__importDefault(n),p=o.__importDefault(p),t.CAPTURE_COMMENTS_EXPERIMENT="core_act_capture_previews_comments";const v=({variant:e,source:o=""})=>({experiment:t.CAPTURE_COMMENTS_EXPERIMENT,variant:e,source:o});t.RecorderButton=({captureUploadRef:e,emitter:t,isRecorderShownRef:o,logger:n,onClick:E=(()=>{}),onDismiss:g,onImpression:_=(()=>{}),setHasSeenCaptureExp:C=(()=>{}),showTooltip:M,setShowTooltip:T,featureVariant:R},{container:h,scope:S})=>{var b;const[k,y]=(0,r.useState)((null===(b=null==e?void 0:e.current)||void 0===b?void 0:b.capture_link)||""),I=(0,r.useRef)(null),N=(0,c.useIntl)(),P="V1"===R&&o.current,x=(0,r.useCallback)((e="")=>{y(()=>(t.emit("reset-capture-value"),e))},[t]);(0,r.useEffect)(()=>{var t;if(null===(t=null==e?void 0:e.current)||void 0===t?void 0:t.capture_link){const{capture_link:t}=null==e?void 0:e.current;setTimeout(()=>{x(t)},0)}},[e,x]),(0,r.useEffect)(()=>{const e=e=>{(null==e?void 0:e.capture_link)&&x(e.capture_link)};return null==t||t.on("capture-link",e),()=>{null==t||t.off("capture-link",e)}},[t,x]),(0,r.useEffect)(()=>{var e,t;if(k){const o=null==h?void 0:h.getTriggers(S),r=h.getStatus().draft.editorState,a=(0,f.createLinkInEditorState)({url:k,editorState:r});null===(e=null==o?void 0:o.draft)||void 0===e||e.change(a),null===(t=null==o?void 0:o.draft)||void 0===t||t.pasteHTML({text:" ",html:" "}),null==n||n.logToProEvents(m.CommentsCaptureLogEvents.COMMENT_DRAFTED,v({variant:R}))}},[k,h]),(0,r.useEffect)(()=>{(null==o?void 0:o.current)&&(C(!0),_(M||!1))},[]);const B=e=>{null==n||n.logToProEvents(m.CommentsCaptureLogEvents.CLICK,v({variant:R,source:e})),T(!1),E()},w=N.formatMessage({id:"NlEZ/b",defaultMessage:"Add a screen recording"}),A=N.formatMessage({id:"n0B9J5",defaultMessage:"Comment with a screen recording"}),L=N.formatMessage({id:"/rYMZM",defaultMessage:"Give more context to your thoughts with a video."}),D=N.formatMessage({id:"yg/f0P",defaultMessage:"Close"}),O=N.formatMessage({id:"o+Zwcg",defaultMessage:"Add a recording"});return r.default.createElement(r.default.Fragment,null,P&&r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{ref:I},r.default.createElement(s.Tooltip,{title:w,placement:"bottom",maxWidth:300},r.default.createElement(l.IconButton,{"aria-haspopup":"true","aria-label":"Create a recording",onClick:()=>B("video_icon"),variant:"transparent"},r.default.createElement(i.UIIcon,{src:a.VideoLine})))),M&&r.default.createElement(s.Tooltip.Control,{variant:"rich",shouldReturnFocus:!1,open:M,triggerRef:I,auto:!0,placement:"bottom-start"},r.default.createElement(u.Title,{size:"standard",inverse:!0},A),r.default.createElement(u.Text,{tagName:"p",color:"standard",inverse:!0},L),r.default.createElement("div",{className:p.default.scCommentEditorVideoRecorderTooltip},r.default.createElement(d.Button,{variant:"transparent",inverse:!0,onClick:()=>{null==n||n.logToProEvents(m.CommentsCaptureLogEvents.DISMISS,v({variant:R})),T(!1),g()}},D),r.default.createElement(d.Button,{variant:"outline",inverse:!0,onClick:()=>B("tooltip_CTA")},O)))))},t.RecorderButton.displayName="RecorderButton",t.RecorderButton.contextTypes={container:n.default.object,scope:n.default.object}}));
//# sourceMappingURL=record_button.min.js-vflRkRTWp.map